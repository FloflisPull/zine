{
  "source": {
    "LICENSE": {
      "path": "LICENSE",
      "content": "MIT License\n\nCopyright (c) 2016 Daniel X Moore\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n",
      "mode": "100644",
      "type": "blob"
    },
    "NOTES.md": {
      "path": "NOTES.md",
      "content": "Apps and Associations\n---------------------\n\nWould be cool to have apps that can auto-update and register associations.\n\nWhat's needed?\n\nname: String\nicon: Emoji (maybe could get from favicon in url?)\nsrc: URL\nassociations: associations for paths and types that this app can open\nlaunchAtStartup: false|true|\"hidden\"  whether this application auto-starts\nwidth:\nheight:\n\nWe could also have json urls that point to a package that is installed. The\npackage could contain its own metadata. We can cache it locally and check for\nupdates periodically.\n\nWe need a way to persist the list of apps locally, maybe just a file in the\n`/System/` folder. Perhaps `/System/apps.json`\n",
      "mode": "100644",
      "type": "blob"
    },
    "README.md": {
      "path": "README.md",
      "content": "# Zine OS\n\nDIY E-Zine and Operating System\n\nInterfaces\n==========\n\nFS Interface\n------------\n\nRead a blob from a path, returns a promise fulfilled with the blob object. The\nblob is annotated with the path i.e.: blob.path == path\n\n    read: (path) ->\n\nWrite a blob to a path, returns a promise that is fulfilled when the write succeeds.\n\n    write: (path, blob) ->\n\nDelete a file at a path, returns a promise that is fulfilled when the delete succeeds.\n\n    delete: (path) ->\n\nReturns a promise\n\n    list: (directoryPath) ->\n\n\nFileEntry Interface\n-------------------\n\n    path:\n    size:\n    type:\n\nFolderEntry Interface\n---------------------\n\n    folder: true\n    path:\n",
      "mode": "100644",
      "type": "blob"
    },
    "TODO.md": {
      "path": "TODO.md",
      "content": "TODO\n====\n\nSystem Features\n---------------\n[X] File Browser\n\n[X] App Associations\n\n[X] File Context Menu\n\n[X] Folders\n\n[X] Desktop Icons\n\n[ ] Desktop Background\n\n[ ] Help Documentation\n\n[X] Compilerz\n\n[X] Require/Include Local Files\n\n[ ] Drag 'n' Drop\n\n[X] Cloud Briefcase\n\nApplications\n------------\n\nSpreadsheet\n- Save/Load Data\n- Custom Cell Views\n- Data Relationships\n- Forms\n\nTactics Game Sandbox\n\nMarkdown / Wiki\n\nImage Munger\n\nProgramatic Animator\n\nPixel Editor\n\nMusic Maker\n\nDatabase?\n\nNetwork Social\n--------------\n\n[x] Comments\n\n[ ] Sharing\n\n[ ] Remote Files (Network Neighborhood)\n\n[X] Personal Homepage\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/achievement-status.coffee": {
      "path": "apps/achievement-status.coffee",
      "content": "module.exports = ->\n  {Achievement, UI} = system\n  {Window} = UI\n\n  cheevoElement = Achievement.progressView()\n  cheevoElement.style.width = \"100%\"\n  cheevoElement.style.padding = \"1em\"\n\n  Achievement.unlock \"Check yo' self\"\n\n  windowView = Window\n    title: \"Cheevos\"\n    content: cheevoElement\n    width: 640\n    height: 480\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/audio-bro.coffee": {
      "path": "apps/audio-bro.coffee",
      "content": "# Play Audio\n\nFileIO = require \"../os/file-io\"\nModel = require \"model\"\n\nmodule.exports = ->\n  # Global system\n  {ContextMenu, MenuBar, Modal, Observable, Progress, Util:{parseMenu}, Window} = system.UI\n  {Achievement} = system\n\n  Achievement.unlock \"Pump up the jam\"\n\n  audio = document.createElement 'audio'\n  audio.controls = true\n  audio.autoplay = true\n\n  filePath = Observable()\n\n  handlers = Model().include(FileIO).extend\n    loadFile: (blob) ->\n      filePath blob.path\n      audio.src = URL.createObjectURL blob\n\n    exit: ->\n      windowView.element.remove()\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [O]pen\n        -\n        E[x]it\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: ->\n      if path = filePath()\n        \"Audio Bro - #{path}\"\n      else\n        \"Audio Bro\"\n    content: audio\n    menuBar: menuBar.element\n    width: 308\n    height: 80\n    iconEmoji: \"🎶\"\n\n  windowView.loadFile = handlers.loadFile\n\n  return windowView\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/chateau.coffee": {
      "path": "apps/chateau.coffee",
      "content": "IFrameApp = require \"../lib/iframe-app\"\n\nmodule.exports = ->\n  {Achievement} = system\n\n  app = IFrameApp\n    src: \"https://danielx.net/chateau/\"\n    width: 960\n    height: 540\n    title: \"Chateau\"\n    iconEmoji: \"🍷\"\n\n  app.on \"event\", (name) ->\n    switch name\n      when \"login\"\n        Achievement.unlock \"Enter the Chateau\"\n      when \"custom-avatar\"\n        Achievement.unlock \"Puttin' on the Ritz\"\n      when \"custom-background\"\n        Achievement.unlock \"Paint the town red\"\n      when \"file-upload\"\n        Achievement.unlock \"It's in the cloud\"\n\n  return app\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/contrasaurus.coffee": {
      "path": "apps/contrasaurus.coffee",
      "content": "module.exports = ->\n  {Achievement, iframeApp} = system\n\n  app = iframeApp\n    src: \"https://contrasaur.us/\"\n    width: 960\n    height: 540\n    title: \"Contrasaurus: Defender of the American Dream\"\n\n  Achievement.unlock \"Rawr\"\n\n  app.on \"event\", (name) ->\n    switch name\n      when \"win\"\n        Achievement.unlock \"A winner is you\"\n\n  return app\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/dungeon-of-sadness.coffee": {
      "path": "apps/dungeon-of-sadness.coffee",
      "content": "module.exports = ->\n  {Achievement, iframeApp} = system\n\n  app = iframeApp\n    title: \"Dungeon of Sadness\"\n    src: \"https://danielx.net/ld33/\"\n    width: 648\n    height: 507\n\n  Achievement.unlock \"The dungeon is in our heart\"\n\n  return app\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/explorer.coffee": {
      "path": "apps/explorer.coffee",
      "content": "# Explorer File Browser\n#\n# Explore the file system like adventureres of old!\n\n# TODO: Select multiple\n# TOOD: Keyboard Input\n\nDrop = require \"../lib/drop\"\nFileTemplate = require \"../templates/file\"\nFolderTemplate = require \"../templates/folder\"\n\n{emptyElement} = require \"../util\"\n\nextractPath = (element) ->\n  while element\n    path = element.getAttribute(\"path\")\n    return path if path\n    element = element.parentElement\n\nmodule.exports = Explorer = (options={}) ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n  {path} = options\n  path ?= '/'\n\n  explorer = document.createElement \"explorer\"\n  explorer.setAttribute(\"path\", path)\n\n  Drop explorer, (e) ->\n    return if e.defaultPrevented\n\n    targetPath = extractPath(e.target) or path\n    folderTarget = targetPath.match(/\\/$/)\n\n    fileSelectionData = e.dataTransfer.getData(\"zineos/file-selection\")\n\n    if fileSelectionData\n      data = JSON.parse fileSelectionData\n\n      if folderTarget\n        system.moveFileSelection(data, targetPath)\n      else\n        # Attempt to open file in app\n        selectedFile = data.files[0]\n        console.log \"Open in app #{targetPath} <- #{selectedFile}\"\n        system.readFile(selectedFile.path)\n        .then (file) ->\n          system.execPathWithFile(targetPath, file)\n      e.preventDefault()\n\n      return\n\n    files = e.dataTransfer.files\n\n    if files.length\n      e.preventDefault()\n      if folderTarget\n        files.forEach (file) ->\n          newPath = targetPath + file.name\n          system.writeFile(newPath, file, true)\n      else\n        file = files[0]\n        system.execPathWithFile(targetPath, file)\n\n  explorerContextMenu = ContextMenu\n    items: parseMenu \"\"\"\n      [N]ew File\n    \"\"\"\n    handlers:\n      newFile: ->\n        Modal.prompt \"Filename\", \"#{path}newfile.txt\"\n        .then (newFilePath) ->\n          if newFilePath\n            system.writeFile newFilePath, new Blob [], type: \"text/plain\"\n\n  explorer.oncontextmenu = (e) ->\n    return if e.defaultPrevented\n    e.preventDefault()\n\n    explorerContextMenu.display\n      inElement: document.body\n      x: e.pageX\n      y: e.pageY\n\n  contextMenuFor = (file, e) ->\n    return if e.defaultPrevented\n    e.preventDefault()\n\n    contextMenuHandlers =\n      open: ->\n        system.open(file)\n      cut: -> #TODO\n      copy: -> #TODO\n      delete: ->\n        system.deleteFile(file.path)\n      rename: ->\n        Modal.prompt \"Filename\", file.path\n        .then (newPath) ->\n          if newPath\n            system.moveFile(file.path, newPath)\n      properties: ->\n        pre = document.createElement \"pre\"\n        pre.textContent = JSON.stringify(file, null, 2)\n        pre.style = \"padding: 1rem\"\n        Modal.show pre\n      editMIMEType: ->\n        Modal.prompt \"MIME Type\", file.type\n        .then (newType) ->\n          if newType\n            system.updateFile file.path,\n              type: newType\n            .then console.log\n\n    openers = system.openersFor(file)\n\n    openerOptions = openers.map ({name, fn}, i) ->\n      handlerName = \"opener#{i}\"\n      contextMenuHandlers[handlerName] = ->\n        fn(file)\n\n      \"  #{name} -> #{handlerName}\"\n    .join(\"\\n\")\n\n    openWithMenu = \"\"\n    if openers.length > 0\n      openWithMenu = \"\"\"\n        Open With\n        #{openerOptions}\n      \"\"\"\n\n    # TODO: Open With Options\n    # TODO: Set Mime Type\n    contextMenu = ContextMenu\n      items: parseMenu \"\"\"\n        Open\n        #{openWithMenu}\n        -\n        Cut\n        Copy\n        -\n        Delete\n        Rename\n        -\n        Edit MIME Type\n        Properties\n      \"\"\"\n      handlers: contextMenuHandlers\n\n\n    contextMenu.display\n        inElement: document.body\n        x: e.pageX\n        y: e.pageY\n\n  contextMenuForFolder = (folder, e) ->\n    return if e.defaultPrevented\n    e.preventDefault()\n\n    # TODO: Cut/Copy\n    contextMenu = ContextMenu\n      items: parseMenu \"\"\"\n        Open\n        -\n        Cut\n        Copy\n        -\n        Delete\n        Rename\n        -\n        Properties\n      \"\"\"\n      handlers:\n        open: ->\n          addWindow(folder.path)\n        delete: ->\n          system.readTree(folder.path)\n          .then (results) ->\n            Promise.all results.map (result) ->\n              system.deleteFile(result.path)\n        rename: ->\n          Modal.prompt \"Name\", folder.path\n          .then (newName) ->\n            return unless newName\n\n            # Ensure trailing slash\n            newName = newName.replace(/\\/*$/, \"/\")\n\n            system.readTree(folder.path)\n            .then (files) ->\n              Promise.all files.map (file) ->\n                newPath = file.path.replace(folder.path, newName)\n                system.moveFile(file.path, newPath)\n        properties: -> # TODO\n\n    contextMenu.display\n        inElement: document.body\n        x: e.pageX\n        y: e.pageY\n\n  update = ->\n    system.fs.list(path)\n    .then (files) ->\n      emptyElement explorer\n\n      addedFolders = {}\n\n      files.forEach (file) ->\n        if file.relativePath.match /\\/$/ # folder\n          folderPath = file.relativePath\n          addedFolders[folderPath] = true\n          return\n\n        Object.assign file,\n          displayName: file.relativePath\n\n          dblclick: ->\n            system.open file\n\n          contextmenu: (e) ->\n            contextMenuFor(file, e)\n\n          dragstart: (e) ->\n            # Note: Blobs don't make it through the stringify\n            e.dataTransfer.setData \"zineos/file-selection\", JSON.stringify\n              sourcePath: path\n              files: [ file ]\n\n        fileElement = FileTemplate file\n        if file.type.match /^image\\//\n          file.blob.getURL()\n          .then (url) ->\n            icon = fileElement.querySelector('icon')\n            icon.style.backgroundImage = \"url(#{url})\"\n            icon.style.backgroundSize = \"100%\"\n            icon.style.backgroundPosition = \"50%\"\n\n        explorer.appendChild fileElement\n\n      Object.keys(addedFolders).reverse().forEach (folderName) ->\n        folder =\n          path: \"#{path}#{folderName}\"\n          relativePath: folderName\n          displayName: folderName.replace(/\\/$/, \"\")\n          contextmenu: (e) ->\n            contextMenuForFolder(folder, e)\n          dblclick: ->\n            # Open folder in new window\n            addWindow(folder.path)\n          dragstart: (e) ->\n            e.dataTransfer.setData \"zineos/file-selection\", JSON.stringify\n              sourcePath: folder.path.slice(0, folder.path.length - folder.relativePath.length)\n              files: [ folder ]\n\n        folderElement = FolderTemplate folder\n        explorer.insertBefore(folderElement, explorer.firstChild)\n\n  update()\n\n  # Refresh files when they change\n  system.fs.on \"write\", (path) -> update()\n  system.fs.on \"delete\", (path) -> update()\n  system.fs.on \"update\", (path) -> update()\n\n  addWindow = (path) ->\n    element = Explorer\n      path: path\n\n    windowView = Window\n      title: path\n      content: element\n      menuBar: null\n      width: 640\n      height: 480\n      iconEmoji: \"📂\"\n\n    document.body.appendChild windowView.element\n\n  return explorer\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/filter.coffee": {
      "path": "apps/filter.coffee",
      "content": "# View and Manipulate Images\n\nFileIO = require \"../os/file-io\"\nModel = require \"model\"\n\nmodule.exports = ->\n  # Global system\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n\n  system.Achievement.unlock \"Look at that\"\n\n  canvas = document.createElement 'canvas'\n  context = canvas.getContext('2d')\n\n  modalForm = system.compileTemplate \"\"\"\n    form\n      label\n        h2 Width\n        input(name=\"width\")\n      label\n        h2 Height\n        input(name=\"height\")\n  \"\"\"\n\n  handlers = Model().include(FileIO).extend\n    loadFile: (blob) ->\n      Image.fromBlob blob\n      .then (img) ->\n        canvas.width = img.width\n        canvas.height = img.height\n        context.drawImage(img, 0, 0)\n\n    saveData: ->\n      new Promise (resolve) ->\n        canvas.toBlob resolve\n\n    exit: ->\n      windowView.element.remove()\n\n    crop: ->\n      Modal.form modalForm()\n      .then console.log\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [O]pen\n        [S]ave\n        Save [A]s\n        -\n        E[x]it\n      [E]dit\n        [C]rop\n        [F]ilter\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: \"Spectacle Image Viewer\"\n    content: canvas\n    menuBar: menuBar.element\n    width: 640\n    height: 480\n\n  windowView.loadFile = handlers.loadFile\n\n  return windowView\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/markdown.coffee": {
      "path": "apps/markdown.coffee",
      "content": "# Render Markdown\n\nFileIO = require \"../os/file-io\"\nModel = require \"model\"\n\n{absolutizePath} = require \"../util\"\n\nisRelative = (url) ->\n  url.match /^\\.\\.?\\//\n\nmodule.exports = ->\n  # Global system\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n\n  container = document.createElement 'container'\n  container.style.padding = \"1rem\"\n  container.style.userSelect = \"initial\"\n\n  baseDir = \"\"\n  navigationStack = []\n  # TODO: Maintain a container stack to keep state\n\n  navigateToPath = (path) ->\n    system.readFile(path)\n    .then (blob) ->\n      handlers.loadFile(blob, path)\n\n  rewriteURL = (url) ->\n    Promise.resolve()\n    .then ->\n      if isRelative(url)\n        targetPath = absolutizePath baseDir, url\n\n        system.urlForPath(targetPath)\n      else if url.match /^\\// # Absolute paths\n        targetPath = absolutizePath \"\", url\n        system.urlForPath(targetPath)\n      else\n        url\n\n  rewriteURLs = (container) ->\n    container.querySelectorAll(\"img\").forEach (img) ->\n      url = img.getAttribute(\"src\")\n\n      if url\n        rewriteURL(url)\n        .then (url) ->\n          img.src = url\n\n  handlers = Model().include(FileIO).extend\n    loadFile: (blob, path) ->\n      navigationStack.push path\n      baseDir = path.replace /\\/[^/]*$/, \"\"\n\n      blob.readAsText()\n      .then (textContent) ->\n        if path.match /\\.html$/\n          container.innerHTML = textContent\n        else\n          container.innerHTML = marked(textContent)\n\n        rewriteURLs(container)\n\n    saveData: ->\n\n    exit: ->\n      windowView.element.remove()\n\n  # Handle Links\n  container.addEventListener \"click\", (e) ->\n    [anchor] = e.path.filter (element) ->\n      element.nodeName is \"A\"\n\n    if anchor\n      url = anchor.getAttribute(\"href\")\n\n      if isRelative(url)\n        e.preventDefault()\n        path = absolutizePath baseDir, url\n\n        # Navigate to page\n        navigateToPath(path)\n\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [O]pen\n        -\n        E[x]it\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: \"Markdown\"\n    content: container\n    menuBar: menuBar.element\n    width: 720\n    height: 480\n\n  windowView.element.setAttribute(\"tabindex\", -1)\n  windowView.element.addEventListener \"keydown\", (e) ->\n    {key} = e\n\n    if key is \"Backspace\"\n      e.preventDefault()\n      if navigationStack.length > 1\n        navigationStack.pop()\n\n        lastPath = navigationStack.pop()\n        navigateToPath(lastPath)\n\n  windowView.loadFile = handlers.loadFile\n\n  return windowView\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/my-briefcase.coffee": {
      "path": "apps/my-briefcase.coffee",
      "content": "###\nUse the madness that is Amazon Cognito to support a 'My Briefcase' functionality.\n\nThis depends on having the AWS library available:\n- https://sdk.amazonaws.com/js/aws-sdk-2.2.42.min.js\n\nThis is where you can put the files that you want to access from the cloud.\n\nThey'll live in the whimsy-fs bucket under the path to your aws user id.\n\nThe subdomain -> s3 proxy will have a map from simple names to the crazy ids.\n\nThe proxy will serve the /public folder in your 'briefcase'. You can put your\nblog or apps or whatever there. The rest currently isn't 'private', but maybe\nit should be. We can set the access control when uploading.\n\nIdeally the briefcase will be browsable like the local FS and you'll be able to\nrun files from it, load them in applications, save files there, and drag n drop\nbetween them.\n###\n\nExplorer = require \"./explorer\"\nFileTemplate = require \"../templates/file\"\nFolderTemplate = require \"../templates/folder\"\n\nS3FS = require \"../lib/s3-fs\"\n\n{emptyElement, extensionFor, generalType, pinvoke, readTree} = require \"../util\"\n\nwindow.onAmazonLoginReady = ->\n  amazon.Login.setClientId('amzn1.application-oa2-client.29b275f9076a406c90a66b025fab96bf')\n\ndo (d=document) ->\n  r = d.createElement 'div'\n  r.id = \"amazon-root\"\n  d.body.appendChild r\n  a = d.createElement('script')\n  a.type = 'text/javascript'\n  a.async = true\n  a.id = 'amazon-login-sdk'\n  a.src = 'https://api-cdn.amazon.com/sdk/login1.js'\n  r.appendChild(a)\n\n\nmodule.exports = ->\n  {Observable, Window} = system.UI\n\n  system.Achievement.unlock \"Oh no, my files!\"\n\n  LoginTemplate = system.compileTemplate \"\"\"\n    span(style=\"text-align: center; padding: 0 2em;\")\n      h1 My Briefcase\n      p= @description\n      a#LoginWithAmazon(@click)\n        img(border=\"0\" alt=\"Login with Amazon\" src=\"https://images-na.ssl-images-amazon.com/images/G/01/lwa/btnLWA_gold_156x32.png\" width=\"156\" height=\"32\")\n  \"\"\"\n\n  LoadedTemplate = system.compileTemplate \"\"\"\n    section\n      h1 Connected!\n      p Loading files...\n  \"\"\"\n\n  # Observable holding content element\n  content = Observable null\n\n  receivedCredentials = ->\n    console.log AWS.config.credentials\n    id = AWS.config.credentials.identityId\n\n    content LoadedTemplate()\n\n    bucket = new AWS.S3\n      params:\n        Bucket: \"whimsy-fs\"\n\n    fs = S3FS(id, bucket)\n\n    bindAlgoliaIndex(id, fs)\n\n    uuidToken = id.split(\":\")[1]\n\n    system.fs.mount \"/My Briefcase/\", fs\n\n    infoBlob = new Blob [\"\"\"\n      Welcome to Your Cloud Briefcase\n      ===============================\n\n      Store your files in a magical cloud that floats between computers.\n\n      Files stored in `My Briefcase/public` are available to anyone on the\n      internet. (Technically so are all the files in your cloud briefcase...\n      Security: Coming Soon™)\n\n      But the ones in /public are easily accessible, like when computing was fun\n      again. [Check this out](https://#{uuidToken}.whimsy.space/info.md)\n      and see what I mean.\n\n      You can get your own cool and non-ugly subdomain if you contact me (the\n      creator of this computing system). Just send me your id and the short\n      name you'd prefer. DM me in the friendsofjack slack or something.\n    \"\"\"] , type: \"text/markdown; charset=utf-8\"\n    system.writeFile \"/My Briefcase/public/info.md\", infoBlob\n    system.writeFile \"/My Briefcase/public/.keep\", new Blob []\n\n    content Explorer\n      path: \"/My Briefcase/\"\n\n  AWS.config.update\n    region: 'us-east-1'\n\n  try\n    logins = JSON.parse localStorage.WHIMSY_FS_AWS_LOGIN\n\n  AWS.config.credentials = new AWS.CognitoIdentityCredentials\n    IdentityPoolId: 'us-east-1:4fe22da5-bb5e-4a78-a260-74ae0a140bf9'\n    Logins: logins\n\n  if logins\n    pinvoke AWS.config.credentials, \"get\"\n    .then receivedCredentials\n    .catch (e) ->\n      unless e.message is \"Invalid login token.\"\n        console.warn e, e.message\n\n  content LoginTemplate\n    description: ->\n      \"\"\"\n        Maintain access to your files across different machines. Publish\n        effortlessly to the internet. Your briefcase holds all of your hopes\n        and dreams in a magical cloud that is available anywhere there is an\n        internet connection. 💼\n      \"\"\"\n    click: ->\n      options = { scope : 'profile' }\n      amazon.Login.authorize options, (resp) ->\n        if !resp.error\n          console.log resp\n          token = resp.access_token\n          creds = AWS.config.credentials\n\n          logins =\n            'www.amazon.com': token\n          localStorage.WHIMSY_FS_AWS_LOGIN = JSON.stringify(logins)\n\n          creds.params.Logins = logins\n\n          creds.expired = true\n\n          queryUserInfo(token)\n\n          pinvoke AWS.config.credentials, \"get\"\n          .then receivedCredentials\n\n  windowView = Window\n    title: \"My Briefcase\"\n    width: 640\n    height: 480\n    content: content\n    iconEmoji: \"💼\"\n\n  return windowView\n\nqueryUserInfo = (token) ->\n  fetch \"https://api.amazon.com/user/profile\",\n    headers:\n      Authorization: \"bearer #{token}\"\n      Accept: \"application/json\"\n  .then (response) ->\n    response.json()\n  .then (json) ->\n    console.log json\n  .catch (e) ->\n    console.error e\n\nbindAlgoliaIndex = (id, fs) ->\n  {ALGOLIA_SECRET} = localStorage\n  unless ALGOLIA_SECRET\n    console.warn \"No Algolia key present, 'My Briefcase' will not be indexed.\"\n    return\n\n  console.log \"Initializing Algolia indexing of 'My Briefcase'\"\n\n  client = algoliasearch(\"QM41V7R53B\", ALGOLIA_SECRET)\n  index = client.initIndex('My Briefcase')\n\n  matchesContentType = (type) ->\n    type.match /text|javascript/\n\n  isPublic = (path) ->\n    path.match /^\\/public\\//\n\n  indexableContent = (blob) ->\n    if matchesContentType(blob.type)\n      blob.readAsText()\n    else\n      Promise.resolve()\n\n  performIndex = (path, blob) ->\n    return unless isPublic(path)\n\n    console.log \"Indexing:\", path\n\n    contentType = blob.type\n    type = generalType(contentType)\n\n    indexableContent(blob)\n    .then (content) ->\n      new Promise (resolve, reject) ->\n        index.addObjects [{\n          objectID: id + path\n          path: path\n          extension: extensionFor(path)\n          content: content?.slice(0, 8192) # There's limits to the \"full text\" amount in the Algolia free tier. Records above 10k are rejected.\n          contentType: contentType\n          type: type\n          size: blob.size\n        }], (err, content) ->\n          return reject(err) if err\n          resolve(content)\n\n  # TODO: Public URLs\n  # TODO: Image metadata (width x height)\n\n  fs.on \"write\", (path) ->\n    # This taps into all writes, we should be able to trigger an Algolia\n    # index action here\n    console.log \"Write: #{path}\"\n    fs.read(path).then (blob) ->\n      performIndex(path, blob)\n\n  # Remove index on delete\n  fs.on \"delete\", (path) ->\n    new Promise (resolve, reject) ->\n      index.deleteObject id + path, (err) ->\n        return reject(err) if err\n        resolve()\n\n  global.reindexBriefcase = ->\n    readTree fs, \"/public\"\n    .then (files) ->\n      console.log \"All Bfiles\", files\n\n      queue = files\n      RETRY = {}\n\n      processFile = (file) ->\n        path = file.path\n        \n        fs.read(path)\n        .then (blob) ->\n          performIndex(path, blob)\n        .catch (e) ->\n          handleError e, file\n        .then (result) ->\n          if result is RETRY\n            processFile(file)\n          else\n            return result\n\n      handleError = (e, file) ->\n        console.error e\n\n        file.retries ?= 3\n        if file.retries <= 0\n          throw e\n        else # retry\n          file.retries -= 1\n          return RETRY\n\n      work = ->\n        file = files.shift()\n\n        if file\n          processFile(file)\n          .then ->\n            work()\n\n      work()\n      work()\n      work()\n      work()\n\n  return\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/notepad.coffee": {
      "path": "apps/notepad.coffee",
      "content": "FileIO = require \"../os/file-io\"\nModel = require \"model\"\n\nmodule.exports = ->\n  # Global system\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n\n  system.Achievement.unlock \"Notepad.exe\"\n\n  exec = (cmd) ->\n    ->\n      textarea.focus()\n      document.execCommand(cmd)\n\n  TODO = -> console.log \"TODO\"\n\n  textarea = document.createElement \"textarea\"\n  textarea.spellcheck = false\n\n  initialValue = \"\"\n\n  textarea.addEventListener \"input\", ->\n    handlers.saved textarea.value is initialValue\n\n  handlers = Model().include(FileIO).extend\n    loadFile: (blob, path) ->\n      blob.readAsText()\n      .then (text) ->\n        handlers.currentPath path\n        initialValue = text\n        textarea.value = initialValue\n    newFile: ->\n      initialValue = \"\"\n      textarea.value = initialValue\n    saveData: ->\n      data = new Blob [textarea.value],\n        type: \"text/plain\"\n\n      return Promise.resolve data\n\n    # Printing\n    pageSetup: TODO\n    print: TODO\n\n    exit: ->\n      windowView.element.remove()\n\n    undo: exec \"undo\"\n    redo: exec \"redo\"\n    cut: exec \"cut\"\n    copy: exec \"copy\"\n    # NOTE: Can't paste from system clipboard for security reasons\n    # Can probably paste from an in-app clipboard equivalent\n    paste: exec \"paste\"\n    delete: exec \"delete\"\n\n    find: TODO\n    findNext: TODO\n    replace: TODO\n    goTo: TODO\n\n    selectAll: ->\n      textarea.select()\n\n    timeDate: ->\n      textarea.focus()\n      dateText = (new Date).toString().split(\" \").slice(0, -4).join(\" \")\n      document.execCommand(\"insertText\", false, dateText)\n\n    wordWrap: TODO\n\n    font: ->\n      Modal.prompt \"Font\", textarea.style.fontFamily or \"monospace\"\n      .then (font) ->\n        if font\n          textarea.style.fontFamily = font\n\n    statusBar: TODO\n    viewHelp: TODO\n    aboutNotepad: TODO\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [N]ew\n        [O]pen\n        [S]ave\n        Save [A]s\n        -\n        Page Set[u]p\n        [P]rint\n        -\n        E[x]it\n      [E]dit\n        [U]ndo\n        Redo\n        -\n        Cu[t]\n        [C]opy\n        [P]aste\n        De[l]ete\n        -\n        [F]ind\n        Find [N]ext\n        [R]eplace\n        [G]o To\n        -\n        Select [A]ll\n        Time/[D]ate\n      F[o]rmat\n        [W]ord Wrap\n        [F]ont...\n      [V]iew\n        [S]tatus Bar\n      [H]elp\n        View [H]elp\n        -\n        [A]bout Notepad\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: ->\n      path = handlers.currentPath()\n      if handlers.saved()\n        savedIndicator = \"\"\n      else\n        savedIndicator = \"*\"\n\n      if path\n        path = \" - #{path}\"\n\n      \"Notepad.exe#{path}#{savedIndicator}\"\n\n    content: textarea\n    menuBar: menuBar.element\n    width: 640\n    height: 480\n\n  # Key handling\n  windowView.element.setAttribute(\"tabindex\", \"-1\")\n  windowView.element.addEventListener \"keydown\", (e) ->\n    {ctrlKey:ctrl, key} = e\n    if ctrl\n      switch key\n        when \"s\"\n          e.preventDefault()\n          handlers.save()\n        when \"o\"\n          e.preventDefault()\n          handlers.open()\n\n  windowView.loadFile = handlers.loadFile\n\n  return windowView\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/pixel.coffee": {
      "path": "apps/pixel.coffee",
      "content": "IFrameApp = require \"../lib/iframe-app\"\nFileIO = require \"../os/file-io\"\nModel = require \"model\"\n\nmodule.exports = ->\n  {MenuBar, Modal, Observable, Util:{parseMenu}} = system.UI\n\n  handlers = Model().include(FileIO).extend\n    loadFile: (blob) ->\n      app.send \"loadFile\", blob\n    newFile: ->\n    saveData: ->\n      app.send \"getBlob\"\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [N]ew\n        [O]pen\n        [S]ave\n        Save [A]s\n        -\n        E[x]it\n      [H]elp\n        View [H]elp\n        -\n        [A]bout\n    \"\"\"\n    handlers: handlers\n\n  app = IFrameApp\n    title: Observable \"Pixie Paint\"\n    src: \"https://danielx.net/pixel-editor/\"\n    menuBar: menuBar\n    handlers: handlers\n    width: 640\n    height: 480\n\n  app.handlers = handlers\n  app.loadFile = handlers.loadFile\n\n  system.Achievement.unlock \"Pixel perfect\"\n\n  return app\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/spreadsheet.coffee": {
      "path": "apps/spreadsheet.coffee",
      "content": "FileIO = require \"../os/file-io\"\nModel = require \"model\"\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Observable, Progress, Table, Util:{parseMenu}, Window} = system.UI\n\n  system.Achievement.unlock \"Microsoft Access 97\"\n\n  sourceData = []\n\n  headers = [\"id\", \"name\", \"color\"]\n\n  RowModel = (datum) ->\n    Model(datum).attrObservable headers...\n\n  models = sourceData.map RowModel\n\n  InputTemplate = require \"../templates/input\"\n  RowElement = (datum) ->\n    tr = document.createElement \"tr\"\n    types = [\n      \"number\"\n      \"text\"\n      \"color\"\n    ]\n\n    headers.forEach (key, i) ->\n      td = document.createElement \"td\"\n      td.appendChild InputTemplate\n        value: datum[key]\n        type: types[i]\n\n      tr.appendChild td\n\n    return tr\n\n  {element} = tableView = Table {\n    data: models\n    RowElement: RowElement\n    headers: headers\n  }\n\n  handlers = Model().include(FileIO).extend\n    loadFile: (blob) ->\n      blob.readAsJSON()\n      .then (json) ->\n        console.log json\n\n        unless Array.isArray json\n          throw new Error \"Data must be an array\"\n\n        sourceData = json\n        # Update models data\n        models.splice(0, models.length, sourceData.map(RowModel)...)\n\n        # Re-render\n        tableView.render()\n\n    newFile: -> # TODO\n    saveData: ->\n      Promise.resolve new Blob [JSON.stringify(sourceData)],\n        type: \"application/json\"\n\n    about: ->\n      Modal.alert \"Spreadsheet v0.0.1 by Daniel X Moore\"\n    insertRow: ->\n      # TODO: Data template\n      datum =\n        id: 0\n        name: \"new\"\n        color: \"#FF00FF\"\n\n      sourceData.push datum\n      models.push RowModel(datum)\n\n      # Re-render\n      tableView.render()\n    exit: ->\n      windowView.element.remove()\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [N]ew\n        [O]pen\n        [S]ave\n        Save [A]s\n        -\n        E[x]it\n      Insert\n        Row -> insertRow\n      Help\n        About\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: \"MS Access 97 [DEMO VERSION]\"\n    content: element\n    menuBar: menuBar.element\n    width: 640\n    height: 480\n\n  windowView.loadFile = handlers.loadFile\n\n  return windowView\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/story-reader.coffee": {
      "path": "apps/story-reader.coffee",
      "content": "module.exports = (opts) ->\n  {title, width, height, text} = opts\n  width ?= 380\n  height ?= 480\n\n  div = document.createElement \"div\"\n  div.textContent = text\n  div.style.padding = \"1em\"\n  div.style.whiteSpace = \"pre-wrap\"\n  div.style.textAlign = \"justify\"\n\n  system.UI.Window\n    title: title\n    content: div\n    width: width\n    height: height\n",
      "mode": "100644",
      "type": "blob"
    },
    "apps/text-editor.coffee": {
      "path": "apps/text-editor.coffee",
      "content": "Model = require \"model\"\nFileIO = require \"../os/file-io\"\n\nace.require(\"ace/ext/language_tools\")\n\n{extensionFor} = require \"../util\"\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Observable, Progress, Table, Util:{parseMenu}, Window} = system.UI\n\n  system.Achievement.unlock \"Notepad.exe\"\n\n  aceWrap = document.createElement \"div\"\n  aceWrap.style.width = aceWrap.style.height = \"100%\"\n\n  aceElement = document.createElement \"div\"\n  aceElement.style.width = aceElement.style.height = \"100%\"\n\n  aceWrap.appendChild aceElement\n\n  aceEditor = ace.edit aceElement\n  aceEditor.$blockScrolling = Infinity\n  aceEditor.setOptions\n    fontSize: \"16px\"\n    enableBasicAutocompletion: true\n    enableLiveAutocompletion: true\n    highlightActiveLine: true\n\n  session = aceEditor.getSession()\n  session.setUseSoftTabs true\n  session.setTabSize 2\n\n  mode = \"coffee\"\n  session.setMode(\"ace/mode/#{mode}\")\n\n  global.aceEditor = aceEditor\n\n  modes =\n    cson: \"coffeescript\"\n    jadelet: \"jade\"\n    js: \"javascript\"\n    md: \"markdown\"\n    styl: \"stylus\"\n\n  mimeTypeFor = (path) ->\n    type = system.mimeTypeFor(path)\n\n    \"#{type}; charset=utf-8\"\n\n  setModeFor = (path) ->\n    extension = extensionFor(path)\n    mode = modes[extension] or extension\n\n    session.setMode(\"ace/mode/#{mode}\")\n\n  initSession = (file, path) ->\n    file.readAsText()\n    .then (content) ->\n      if path\n        handlers.currentPath path\n        setModeFor(path)\n\n      session.setValue(content)\n      handlers.saved true\n\n  session.on \"change\", ->\n    handlers.saved false\n\n  handlers = Model().include(FileIO).extend\n    loadFile: initSession\n    newFile: ->\n      session.setValue \"\"\n    saveData: ->\n      data = new Blob [session.getValue()],\n        type: mimeTypeFor(handlers.currentPath())\n\n      return Promise.resolve data\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [F]ile\n        [N]ew\n        [O]pen\n        [S]ave\n        Save [A]s\n        -\n        E[x]it\n      [H]elp\n        View [H]elp\n        -\n        [A]bout\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: ->\n      path = handlers.currentPath()\n      if handlers.saved()\n        savedIndicator = \"\"\n      else\n        savedIndicator = \"*\"\n\n      if path\n        path = \" - #{path}\"\n\n      \"Ace#{path}#{savedIndicator}\"\n\n    content: aceWrap\n    menuBar: menuBar.element\n    width: 640\n    height: 480\n\n  windowView.loadFile = initSession\n\n  windowView.on \"resize\", ->\n    aceEditor.resize()\n\n  # Key handling\n  windowView.element.setAttribute(\"tabindex\", \"-1\")\n  windowView.element.addEventListener \"keydown\", (e) ->\n    {ctrlKey:ctrl, key} = e\n    if ctrl\n      switch key\n        when \"s\"\n          e.preventDefault()\n          handlers.save()\n        when \"o\"\n          e.preventDefault()\n          handlers.open()\n\n  return windowView\n",
      "mode": "100644",
      "type": "blob"
    },
    "extensions.coffee": {
      "path": "extensions.coffee",
      "content": "# Pretend Jadelet is a real package\nPACKAGE.dependencies[\"_SYS_jadelet\"] =\n  entryPoint: \"main\"\n  distribution:\n    main: PACKAGE.distribution[\"lib/jadelet.min\"]\n\n# Extend JSON with toBlob method\nJSON.toBlob ?= (object) ->\n  new Blob [JSON.stringify(object)], type: \"application/json; charset=utf-8\"\n\n# Add some utility readers to the Blob API\nBlob::readAsText = ->\n  file = this\n\n  new Promise (resolve, reject) ->\n    reader = new FileReader\n    reader.onload = ->\n      resolve reader.result\n    reader.onerror = reject\n    reader.readAsText(file)\n\nBlob::getURL = ->\n  Promise.resolve URL.createObjectURL(this)\n\nBlob::readAsJSON = ->\n  @readAsText()\n  .then JSON.parse\n\nBlob::readAsDataURL = ->\n  file = this\n\n  new Promise (resolve, reject) ->\n    reader = new FileReader\n    reader.onload = ->\n      resolve reader.result\n    reader.onerror = reject\n    reader.readAsDataURL(file)\n\n# BlobSham interface must implement getURL and readAs* methods\n\n# Load an image from a blob returning a promise that is fulfilled with the\n# loaded image or rejected with an error\nImage.fromBlob = (blob) ->\n  blob.getURL()\n  .then (url) ->\n    new Promise (resolve, reject) ->\n      img = new Image\n      img.onload = ->\n        resolve img\n      img.onerror = reject\n\n      img.src = url\n\nFileList::forEach ?= (args...) ->\n  Array::forEach.apply(this, args)\n\n# Event#path polyfill for Firefox\nunless \"path\" in Event.prototype\n  Object.defineProperty Event.prototype, \"path\",\n    get: ->\n      path = []\n      currentElem = this.target\n      while currentElem\n        path.push currentElem\n        currentElem = currentElem.parentElement\n\n      if path.indexOf(window) is -1 && path.indexOf(document) is -1\n        path.push(document)\n\n      if path.indexOf(window) is -1\n        path.push(window)\n\n      path\n",
      "mode": "100644",
      "type": "blob"
    },
    "feedback.coffee": {
      "path": "feedback.coffee",
      "content": "# Open a feedback form\nmodule.exports = ->\n  iframe = document.createElement \"iframe\"\n  iframe.src = \"https://docs.google.com/forms/d/e/1FAIpQLSfAK8ZYmMd4-XsDqyTK4soYGWApGD9R33nReuqwG-TxjXaGFg/viewform?embedded=true\"\n\n  Window = system.UI.Window\n\n  windowView = Window\n    title: \"Whimsy Space Feedback\"\n    content: iframe\n    menuBar: null\n    width: 600\n    height: 500\n\n  system.Achievement.unlock \"We value your input\"\n\n  document.body.appendChild windowView.element\n",
      "mode": "100644",
      "type": "blob"
    },
    "issues/2016-12.coffee": {
      "path": "issues/2016-12.coffee",
      "content": "Notepad = require \"../apps/notepad\"\nCommentFormTemplate = require \"../social/comment-form\"\nCommentsTemplate = require \"../social/comments\"\n\nAjax = require \"ajax\"\najax = Ajax()\n\nissueTag = \"2016-12\"\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n\n  system.Achievement.unlock \"Issue 1\"\n\n  img = document.createElement \"img\"\n  img.src = \"https://68.media.tumblr.com/6a141d69564a29ac7d4071df5d519808/tumblr_o0rbb4TA1k1urr1ryo1_500.gif\"\n\n  handlers =\n    waitAroundForABit: ->\n      initialMessage = \"Waiting\"\n      progressView = Progress\n        value: 0\n        max: 2\n        message: initialMessage\n\n      Modal.show progressView.element,\n        cancellable: false\n\n      intervalId = setInterval ->\n        newValue = progressView.value() + 1/60\n        ellipsesCount = Math.floor(newValue * 4) % 4\n        ellipses = [0...ellipsesCount].map ->\n          \".\"\n        .join(\"\")\n        progressView.value(newValue)\n        progressView.message(initialMessage + ellipses)\n        if newValue > 2\n          system.Achievement.unlock \"No rush\"\n          clearInterval intervalId\n          Modal.hide()\n      , 15\n    comment: ->\n      Modal.form CommentFormTemplate\n        area: issueTag\n      .then (data) ->\n        ajax\n          url: \"https://whimsy-space.glitch.me/comments\"\n          data: JSON.stringify(data)\n          headers:\n            \"Content-Type\": \"application/json\"\n          method: \"POST\"\n      .then ->\n        handlers.viewComments()\n\n    viewComments: ->\n      ajax.getJSON \"https://whimsy-space.glitch.me/comments/#{issueTag}\"\n      .then (data) ->\n        data = data.reverse()\n\n        if data.length is 0\n          data = [{\n            body: \"no comments\"\n            author: \"mgmt\"\n          }]\n\n        Modal.show CommentsTemplate data\n\n    like: ->\n      Modal.alert \"I like you too, but we don't have a facebook or anything yet :)\"\n    subscribe: ->\n      require(\"../mailchimp\").show()\n    notepadexe: ->\n      app = Notepad()\n      document.body.appendChild app.element\n    mSAccess97: ->\n      app = Spreadsheet()\n      document.body.appendChild app.element\n    mysterySmell: ->\n      system.Achievement.unlock \"Cover-2-cover\"\n\n      div = document.createElement \"div\"\n      div.textContent = require \"../stories/mystery-smell\"\n      div.style.padding = \"1em\"\n      div.style.whiteSpace = \"pre-wrap\"\n      div.style.textAlign = \"justify\"\n      storyWindow = Window\n        title: \"Mystery Smell\"\n        content: div\n        width: 380\n        height: 480\n      document.body.appendChild storyWindow.element\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [H]ello\n        [W]ait Around For A Bit\n      [A]pps\n        [N]otepad.exe\n      [S]tories\n        [M]ystery Smell\n      S[o]cial Media\n        [V]iew Comments\n        [C]omment\n        [L]ike\n        [S]ubscribe\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: \"ZineOS Volume 1 | Issue 1 | December 2016\"\n    content: img\n    menuBar: menuBar.element\n    width: 508\n    height: 604\n\n  document.body.appendChild windowView.element\n",
      "mode": "100644",
      "type": "blob"
    },
    "issues/2017-02.coffee": {
      "path": "issues/2017-02.coffee",
      "content": "Achievement = require \"../lib/achievement\"\nModel = require \"model\"\nChateau = require \"../apps/chateau\"\nPixiePaint = require \"../apps/pixel\"\nSpreadsheet = require \"../apps/spreadsheet\"\nTextEditor = require \"../apps/text-editor\"\n\nSocial = require \"../social/social\"\n\n{parentElementOfType, emptyElement} = require \"../util\"\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n\n  container = document.createElement \"container\"\n\n  system.Achievement.unlock \"Issue 2\"\n\n  system.writeFile \"issue-2/around.md\", new Blob [require \"../stories/around-the-world\"], type: \"text/markdown\"\n  system.writeFile \"issue-2/provision.txt\", new Blob [require \"../stories/provision\"], type: \"text/plain\"\n  system.writeFile \"issue-2/dungeon-dog.txt\", new Blob [require \"../stories/dungeon-dog\"], type: \"text/plain\"\n  system.writeFile \"issue-2/dsad.exe\", new Blob [\"\"], type: \"application/exe\"\n\n  pages =\n    front: \"\"\"\n      a(href=\"#vista\")\n        img(src=\"https://s-media-cache-ak0.pinimg.com/originals/a3/ba/56/a3ba56cef667d14b54023cd624d4e070.jpg\")\n    \"\"\"\n    vista: \"\"\"\n      a(href=\"#table\")\n        img(width=640 height=\"auto\" src=\"https://books.google.com/books/content?id=2cgDAAAAMBAJ&rview=1&pg=PA10&img=1&zoom=3&hl=en&sig=ACfU3U3477L46r0KxSQusJrQ6w9qxIQ70w&w=1280\")\n    \"\"\"\n    table: \"\"\"\n      div(style=\"padding: 1em;\")\n        h1 Table of Contents\n        ul\n          li\n            a(href=\"#front\") Cover\n          li\n            a(href=\"#vista\") Excerpt from Windows Vista Magazine\n          li\n            a(href=\"#table\") Table of Contents\n          li\n            a(href=\"#random\") Random Thoughts\n          li\n            a(href=\"#cheevos\") Cheevos\n          li\n            a(href=\"#contributors\") Contributors\n    \"\"\"\n    random: \"\"\"\n      div(style=\"padding: 1em;\")\n        h1 Random Thoughts\n        p Don't you hate it when you're cooking something and you look at the stove clock and think it's 3:75 and you're late for your appointment but it was just the temperature and also 3:75 isn't even a real time?\n        p I suggest you bone up a bit on torts before the next attempt at the bar exam.\n        p Does anyone remember thepalace.com avatar based chat and virtual worlds?\n        p Those spreadsheets you like are going back in style.\n    \"\"\"\n    cheevos: \"\"\"\n      div(style=\"padding: 1em;\")\n        h1 Cheevos\n\n        p No matter if you guy/girl or whatever, Cheevos impress people. It's almost like saying 'Well, I got tons of Cheevos. There are tons of people online that are interested and respect me.\"\n\n        p You might be thinking 'Oh that's complete BS, I personally don't care about Cheevos when dating'. And yeah, you are probably telling the truth, but it's in your sub-concious.  Sort of like how girls always like the bad guy, but never admit it.\n\n        p Braggin about your Cheevos sometimes makes you look conceited, but that's a good thing.  It like how celebraties look conceited because they're rolling VIP into clubs and you're stuck in line.\n\n        p 'Brewer' asks 'What happens if you're cheevo talking at a bar, club or party and someone says they have more cheevos that you?'\n\n        p Well, hopefully they are just hating and are lying. First look up their score with your cellphone, make sure you have a page bookmarked where you can check. If you catch them in a lie, you look even better. If they are telling the truth and have more Cheevos than you, leave. Nothing else you can do. Buy the person a drink and leave, unless you're willing to look 2nd best. If you brought a date, odds are she's going to be impressed with the higher gamer score and ditch you. Get out as soon as you can and go to some other party.\n\n        p\n          a(href=\"http://cheevos.com\") Learn more about cheevos from Bboy360 at cheevos.com\n\n    \"\"\"\n    contributors: \"\"\"\n      div(style=\"padding: 1em;\")\n        h1 Contributors\n        ul\n          li Daniel X\n          li Lan\n          li pketh\n          li Mayor\n          li and you!\n\n        p\n          a(href=\"#table\") Return to table of contents\n    \"\"\"\n\n  Object.keys(pages).forEach (pageName) ->\n    value = pages[pageName]\n    pages[pageName] = system.compileTemplate(value)({})\n\n  pages.cheevos.appendChild system.Achievement.progressView()\n\n  handlers = Model().include(Social).extend\n    area: ->\n      \"2017-01\"\n    mSAccess97: ->\n      app = Spreadsheet(system)\n      document.body.appendChild app.element\n    textEditor: ->\n      app = TextEditor(system)\n      document.body.appendChild app.element\n    pixiePaint: ->\n      app = PixiePaint(system)\n      document.body.appendChild app.element\n    chateau: ->\n      app = Chateau(system)\n      document.body.appendChild app.element\n    credits: ->\n      displayPage \"contributors\"\n    tableofContents: ->\n      displayPage \"table\"\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [A]pps\n        [T]ext Editor\n        [P]ixie Paint\n      #{Social.menuText}\n      H[e]lp\n        [T]able of Contents\n        [C]redits\n    \"\"\"\n    handlers: handlers\n\n  windowView = Window\n    title: \"ZineOS Volume 1 | Issue 2 | ENTER THE DUNGEON | February 2017\"\n    content: container\n    menuBar: menuBar.element\n    width: 1228\n    height: 936\n    x: 32\n    y: 32\n\n  windowView.element.addEventListener \"click\", (e) ->\n    anchor = parentElementOfType(\"a\", e.target)\n\n    if anchor\n      next = anchor.getAttribute('href')\n\n      if next.match /^\\#/\n        e.preventDefault()\n        page = next.substr(1)\n\n        displayPage(page)\n\n  currentPage = \"front\"\n\n  visited = {}\n\n  displayPage = (page) ->\n    return unless page\n\n    visited[page] = true\n\n    if Object.keys(visited).length is Object.keys(pages).length\n      system.Achievement.unlock \"Cover-2-cover 2: 2 cover 2 furious\"\n\n    if page is \"vista\"\n      system.Achievement.unlock \"Lol wut\"\n\n    if page is \"cheevos\"\n      system.Achievement.unlock \"Check yo' self\"\n\n    emptyElement(container)\n    container.appendChild(pages[page])\n\n    currentPage = page\n\n  displayPage currentPage\n\n  nextPage = (n=1) ->\n    pageKeys = Object.keys(pages)\n    nextIndex = pageKeys.indexOf(currentPage) + n\n\n    return pageKeys[nextIndex]\n\n  windowView.element.addEventListener \"keydown\", (e) ->\n    switch e.key\n      when \"Enter\", \"ArrowRight\", \" \"\n        displayPage nextPage()\n      when \"ArrowLeft\"\n        displayPage nextPage(-1)\n\n  document.body.appendChild windowView.element\n\n  windowView.element.tabIndex = 0\n  windowView.element.focus()\n",
      "mode": "100644",
      "type": "blob"
    },
    "issues/2017-03.coffee": {
      "path": "issues/2017-03.coffee",
      "content": "Model = require \"model\"\nChateau = require \"../apps/chateau\"\nContrasaurus = require \"../apps/contrasaurus\"\nPixiePaint = require \"../apps/pixel\"\nSpreadsheet = require \"../apps/spreadsheet\"\nTextEditor = require \"../apps/text-editor\"\n\nSocial = require \"../social/social\"\n\n{parentElementOfType, emptyElement} = require \"../util\"\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n  {Achievement} = system\n\n  visitedAreas =\n    blue: false\n    csaur: false\n    chateau: false\n    cheevo: false\n    evan: false\n\n  visit = (area) ->\n    visitedAreas[area] = true\n\n    visitedAll = Object.keys(visitedAreas).every (key) ->\n      visitedAreas[key]\n\n    if visitedAll\n      Achievement.unlock \"Cover-2-cover 3: Tokyo Drift\"\n\n  system.writeFile \"issue-3/blue-light-special.txt\", new Blob [require \"../stories/blue-light-special\"], type: \"text/plain\"\n\n  system.Achievement.unlock \"Issue 3\"\n\n  handlers = Model().include(Social).extend\n    area: ->\n      \"2017-03\"\n\n    mSAccess97: ->\n      app = Spreadsheet(system)\n      document.body.appendChild app.element\n\n    chateau: ->\n      visit \"chateau\"\n      app = Chateau(system)\n      document.body.appendChild app.element\n\n    contrasaurus: ->\n      visit \"csaur\"\n      document.body.appendChild Contrasaurus().element\n\n    achievementStatus: ->\n      visit \"cheevo\"\n      cheevoElement = system.Achievement.progressView()\n      cheevoElement.style.width = \"100%\"\n      cheevoElement.style.padding = \"1em\"\n\n      system.Achievement.unlock \"Check yo' self\"\n\n      windowView = Window\n        title: \"Cheevos\"\n        content: cheevoElement\n        width: 640\n        height: 480\n\n      document.body.appendChild windowView.element\n\n    evanAndMore: ->\n      visit \"evan\"\n      url = \"https://s3.amazonaws.com/whimsyspace-databucket-1g3p6d9lcl6x1/danielx/IMG_9794.JPG\"\n      img = document.createElement \"img\"\n      img.src = url\n\n      {element} = system.UI.Window\n        title: \"Evan And More\"\n        content: img\n        width: 600\n        height: 480\n\n      document.body.appendChild element\n\n    blueLightSpecial: ->\n      Achievement.unlock \"Blue light special\"\n      visit \"blue\"\n\n      storyWindow = StoryWindow(\"Blue Light Special\", require(\"../stories/blue-light-special\"))\n\n      document.body.appendChild storyWindow.element\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [A]pps\n        [C]hateau\n        Contra[s]aurus\n      [S]tories\n        [B]lue Light Special\n        [E]van And More\n      #{Social.menuText}\n      [H]elp\n        [A]chievement Status\n    \"\"\"\n    handlers: handlers\n\n  kmartGif = document.createElement \"img\"\n  kmartGif.src = \"http://media.boingboing.net/wp-content/uploads/2015/07/m66DBJ.gif\"\n  kmartGif.style = \"width: 100%; height: 100%\"\n\n  windowView = Window\n    title: \"ZineOS Volume 1 | Issue 3 | ATTN: K-Mart Shoppers | March 2017\"\n    content: kmartGif\n    menuBar: menuBar.element\n    width: 800\n    height: 600\n    x: 32\n    y: 32\n\n  document.body.appendChild windowView.element\n\nStoryWindow = (title, text) ->\n  div = document.createElement \"div\"\n  div.textContent = text\n  div.style.padding = \"1em\"\n  div.style.whiteSpace = \"pre-wrap\"\n  div.style.textAlign = \"justify\"\n\n  system.UI.Window\n    title: title\n    content: div\n    width: 380\n    height: 480\n",
      "mode": "100644",
      "type": "blob"
    },
    "issues/2017-04.coffee": {
      "path": "issues/2017-04.coffee",
      "content": "Model = require \"model\"\nChateau = require \"../apps/chateau\"\nContrasaurus = require \"../apps/contrasaurus\"\nPixiePaint = require \"../apps/pixel\"\nSpreadsheet = require \"../apps/spreadsheet\"\nTextEditor = require \"../apps/text-editor\"\nMyBriefcase = require \"../apps/my-briefcase\"\n\nSocial = require \"../social/social\"\n\n{parentElementOfType, emptyElement} = require \"../util\"\n\nwriteIfNotPresent = (destination, sourceURL) ->\n  system.readFile destination\n  .then (file) ->\n    throw new Error \"File not found\" unless file\n    return file\n  .catch ->\n    ajax\n      url: sourceURL\n      responseType: \"blob\"\n    .then (blob) ->\n      system.writeFile destination, blob\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n  {Achievement, ajax} = system\n\n  visitedAreas =\n    bikes: false\n    izzy: false\n    residue: false\n    chateau: false\n    cheevo: false\n    briefcase: false\n    podcast: false\n\n  visit = (area) ->\n    visitedAreas[area] = true\n\n    visitedAll = Object.keys(visitedAreas).every (key) ->\n      visitedAreas[key]\n\n    if visitedAll\n      Achievement.unlock \"Cover-2-cover 4: Fast & Furious\"\n\n  system.writeFile \"issue-4/izzy.txt\", new Blob [require \"../stories/izzy\"], type: \"text/plain\"\n  system.writeFile \"issue-4/residue.txt\", new Blob [require \"../stories/residue\"], type: \"text/plain\"\n\n  downloadBikes = ->\n    [\"and-yet-they-rode-bikes.md\", \"infog.png\", \"lanes.png\", \"totally-a.html\"].forEach (path) ->\n      filePath = \"issue-4/bikes/#{path}\"\n\n      writeIfNotPresent filePath, \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/bikes/#{path}\"\n\n  downloadBikes()\n\n  writeIfNotPresent \"issue-4/Funkytown.mp3\", \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/music/Funkytown.mp3\"\n  .then ->\n    system.openPath \"issue-4/Funkytown.mp3\"\n\n  writeIfNotPresent \"issue-4/zinecast1.mp3\", \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/podcasts/zinecast1.mp3\"\n\n  system.Achievement.unlock \"Issue 4\"\n\n  handlers = Model().include(Social).extend\n    area: ->\n      \"2017-04\"\n\n    zinecast1: ->\n      visit \"podcast\"\n      system.readFile \"issue-4/zinecast1.mp3\"\n      .then system.open\n\n    bikes: ->\n      visit \"bikes\"\n      system.readFile \"issue-4/bikes/and-yet-they-rode-bikes.md\"\n      .then system.open\n\n    chateau: ->\n      visit \"chateau\"\n      app = Chateau(system)\n      document.body.appendChild app.element\n\n    achievementStatus: ->\n      visit \"cheevo\"\n      cheevoElement = system.Achievement.progressView()\n      cheevoElement.style.width = \"100%\"\n      cheevoElement.style.padding = \"1em\"\n\n      system.Achievement.unlock \"Check yo' self\"\n\n      windowView = Window\n        title: \"Cheevos\"\n        content: cheevoElement\n        width: 640\n        height: 480\n\n      document.body.appendChild windowView.element\n\n    myBriefcase: ->\n      visit \"briefcase\"\n      app = MyBriefcase()\n      document.body.appendChild app.element\n\n    izzy: ->\n      Achievement.unlock \"Izzy\"\n      visit \"izzy\"\n      storyWindow = StoryWindow(\"Izzy\", require(\"../stories/izzy\"))\n\n      document.body.appendChild storyWindow.element\n\n    residue: ->\n      Achievement.unlock \"Residue\"\n      visit \"residue\"\n\n      storyWindow = StoryWindow(\"Residue\", require(\"../stories/residue\"))\n\n      document.body.appendChild storyWindow.element\n\n    funkytown8bitRemix: ->\n      system.readFile \"issue-4/Funkytown.mp3\"\n      .then system.open\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [A]pps\n        [C]hateau\n        My [B]riefcase\n      [M]usic\n        [F]unkytown (8-bit Remix)\n        [Z]inecast 1\n      [S]tories\n        [B]ikes\n        [I]zzy\n        [R]esidue\n      #{Social.menuText}\n      [H]elp\n        [A]chievement Status\n    \"\"\"\n    handlers: handlers\n\n  content = document.createElement \"content\"\n  content.style = \"width: 100%; height: 100%\"\n\n  img = document.createElement \"img\"\n  img.src = \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/images/708e9398a4b4bea08d7c61ff7a0f863f.gif\"\n  img.style = \"width: 100%; height: 100%\"\n\n  windowView = Window\n    title: \"ZineOS Volume 1 | Issue 4 | DISCO TECH | April 2017\"\n    content: img\n    menuBar: menuBar.element\n    width: 480\n    height: 600\n    x: 64\n    y: 64\n\n  windowView.element.querySelector('viewport').style.overflow = \"initial\"\n\n  document.body.appendChild windowView.element\n\nStoryWindow = (title, text) ->\n  div = document.createElement \"div\"\n  div.textContent = text\n  div.style.padding = \"1em\"\n  div.style.whiteSpace = \"pre-wrap\"\n  div.style.textAlign = \"justify\"\n\n  system.UI.Window\n    title: title\n    content: div\n    width: 380\n    height: 480\n",
      "mode": "100644",
      "type": "blob"
    },
    "issues/2017-05.coffee": {
      "path": "issues/2017-05.coffee",
      "content": "Model = require \"model\"\n\nAchievementStatus = require \"../apps/achievement-status\"\nChateau = require \"../apps/chateau\"\nContrasaurus = require \"../apps/contrasaurus\"\nPixiePaint = require \"../apps/pixel\"\nSpreadsheet = require \"../apps/spreadsheet\"\nTextEditor = require \"../apps/text-editor\"\nMyBriefcase = require \"../apps/my-briefcase\"\n\nStoryReader = require \"../apps/story-reader\"\n\nSocial = require \"../social/social\"\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n  {Achievement, ajax} = system\n\n  ggPath = \"issue-5/gleep-glorp.m4a\"\n\n  system.readFile ggPath\n  .then (file) ->\n    throw new Error \"File not found\" unless file\n  .catch ->\n    ajax\n      url: \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/hao/gleep-glorp.m4a\"\n      responseType: \"blob\"\n    .then (blob) ->\n      system.writeFile ggPath, blob\n\n  handlers = Model().include(Social).extend\n    area: ->\n      \"2017-05\"\n\n    achievementStatus: ->\n      system.launchApp AchievementStatus\n\n    chateau: ->\n      system.launchApp Chateau\n\n    crescent: ->\n      app = StoryReader\n        text: require \"../stories/crescent\"\n        title: \"Crescent\"\n\n      document.body.appendChild app.element\n\n    gleepGlorp: ->\n      system.openPath ggPath\n\n    marigold: ->\n      app = StoryReader\n        text: require \"../stories/marigold\"\n        title: \"Marigold\"\n\n      document.body.appendChild app.element\n\n    myBriefcase: ->\n      system.launchApp MyBriefcase\n\n    pixiePaint: ->\n      system.launchApp PixiePaint\n\n    textEditor: ->\n      system.launchApp TextEditor\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [A]pps\n        [C]hateau\n        My [B]riefcase\n        [P]ixie Paint\n        [T]ext Editor\n      [C]ontent\n        [C]rescent\n        [G]leep Glorp\n        [M]arigold\n      #{Social.menuText}\n      [H]elp\n        [A]chievement Status\n    \"\"\"\n    handlers: handlers\n\n  img = document.createElement \"img\"\n  img.src = \"https://i.imgur.com/hKOGoex.jpg\"\n  img.style = \"width: 100%; height: 100%\"\n\n  windowView = Window\n    title: \"ZineOS Volume 1 | Issue 5 | A May Zine | May 2017\"\n    content: img\n    menuBar: menuBar.element\n    width: 640\n    height: 360\n    x: 64\n    y: 64\n\n  windowView.element.querySelector('viewport').style.overflow = \"initial\"\n\n  document.body.appendChild windowView.element\n",
      "mode": "100644",
      "type": "blob"
    },
    "issues/2017-06.coffee": {
      "path": "issues/2017-06.coffee",
      "content": "Model = require \"model\"\n\nAchievementStatus = require \"../apps/achievement-status\"\nChateau = require \"../apps/chateau\"\nContrasaurus = require \"../apps/contrasaurus\"\nPixiePaint = require \"../apps/pixel\"\nSpreadsheet = require \"../apps/spreadsheet\"\nTextEditor = require \"../apps/text-editor\"\nMyBriefcase = require \"../apps/my-briefcase\"\n\nStoryReader = require \"../apps/story-reader\"\n\nSocial = require \"../social/social\"\n\nfetchContent = (targetFile, sourcePath=targetFile) ->\n  targetPath = \"/issue-6/#{targetFile}\"\n\n  system.readFile targetPath\n  .then (file) ->\n    throw new Error \"File not found\" unless file\n  .catch ->\n    system.ajax\n      url: \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/#{sourcePath}\"\n      responseType: \"blob\"\n    .then (blob) ->\n      system.writeFile targetPath, blob\n\nmodule.exports = ->\n  {ContextMenu, MenuBar, Modal, Progress, Util:{parseMenu}, Window} = system.UI\n  {Achievement, ajax} = system\n\n  fetchContent \"bee.md\"\n  fetchContent \"tree.md\"\n\n  system.Achievement.unlock \"Issue 6\"\n\n  launch = (App) ->\n    system.attachApplication App()\n\n  handlers = Model().include(Social).extend\n    area: ->\n      \"2017-06\"\n\n    bee: ->\n      system.Achievement.unlock \"Bee afraid\"\n      system.openPath \"/issue-6/bee.md\"\n\n    tree: ->\n      system.Achievement.unlock \"Tree story\"\n      system.openPath \"/issue-6/tree.md\"\n\n    achievementStatus: ->\n      launch AchievementStatus\n\n    chateau: ->\n      launch Chateau\n\n    crescent: ->\n      app = StoryReader\n        text: require \"../stories/crescent\"\n        title: \"Crescent\"\n\n      document.body.appendChild app.element\n\n    marigold: ->\n      app = StoryReader\n        text: require \"../stories/marigold\"\n        title: \"Marigold\"\n\n      document.body.appendChild app.element\n\n    myBriefcase: ->\n      launch MyBriefcase\n\n    pixiePaint: ->\n      launch PixiePaint\n\n    textEditor: ->\n      launch TextEditor\n\n  menuBar = MenuBar\n    items: parseMenu \"\"\"\n      [A]pps\n        [C]hateau\n        My [B]riefcase\n        [P]ixie Paint\n        [T]ext Editor\n      [C]ontent\n        [B]ee\n        [T]ree\n      #{Social.menuText}\n      [H]elp\n        [A]chievement Status\n    \"\"\"\n    handlers: handlers\n\n  img = document.createElement \"img\"\n  img.src = \"https://forgettheprotocol.com/wp-content/uploads/2017/04/09-bee-movie.w536.h357.2x.jpg\"\n  img.style = \"width: 100%; height: 100%\"\n\n  windowView = Window\n    title: \"WhimsySpace Volume 1 | Episode 6 | Summertime Radness | June 2017\"\n    content: img\n    iconEmoji: \"🐝\"\n    menuBar: menuBar.element\n    width: 536 + 8\n    height: 357 + 46\n    x: 64\n    y: 64\n\n  windowView.element.querySelector('viewport').style.overflow = \"initial\"\n\n  document.body.appendChild windowView.element\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/achievement.coffee": {
      "path": "lib/achievement.coffee",
      "content": "AchievementTemplate = require \"../templates/achievement\"\n\npending = []\ndisplaying = false\n\naudioPath = \"https://cdn.gomix.com/294e834f-223f-4792-9323-5b1fa8d0402b/unlock2.mp3\"\n\nplaySound = ->\n  audio = new Audio(audioPath)\n  audio.autoplay = true\n\n  audio\n\nmodule.exports = Achievement =\n  display: (options={}) ->\n    if displaying\n      return pending.push(options)\n\n    options.title ?= \"Achievement Unlocked\"\n\n    achievementElement = AchievementTemplate options\n    document.body.appendChild achievementElement\n    achievementElement.classList.add \"display\"\n    achievementElement.appendChild playSound()\n\n    displaying = true\n\n    achievementElement.addEventListener \"animationend\", (e) ->\n      achievementElement.remove()\n\n      displaying = false\n      if pending.length\n        Achievement.display(pending.shift())\n\n    , false\n\n    return achievementElement\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/app-drop.coffee": {
      "path": "lib/app-drop.coffee",
      "content": "Drop = require \"./drop\"\n{fileFromDropEvent}  = require \"../util\"\n\n# General drop handling for apps\nmodule.exports = (app) ->\n  {element} = app\n\n  Drop element, (e) ->\n    {handlers} = app\n\n    fileFromDropEvent e\n    .then (file) ->\n      if file\n        path = file.path\n\n        handlers.loadFile file\n        .then ->\n          if path\n            handlers.currentPath path\n          else\n            handlers.currentPath null\n      else\n        handlers.currentPath null\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/dexie-fs.coffee": {
      "path": "lib/dexie-fs.coffee",
      "content": "Bindable = require \"bindable\"\nModel = require \"model\"\n\nFolderEntry = (path, prefix) ->\n  folder: true\n  path: prefix + path\n  relativePath: path\n\n# FS Wrapper to Dexie database\nmodule.exports = (db) ->\n  Files = db.files\n\n  notify = (eventType, path) ->\n    (result) ->\n      self.trigger eventType, path\n      return result\n\n  self = Model()\n  .include(Bindable)\n  .extend\n    # Read a blob from a path\n    read: (path) ->\n      Files.get(path)\n      .then (result) ->\n        result?.blob\n      .then notify \"read\", path\n\n    # Write a blob to a path\n    write: (path, blob) ->\n      now = +new Date\n\n      Files.put\n        path: path\n        blob: blob\n        size: blob.size\n        type: blob.type\n        createdAt: now\n        updatedAt: now\n      .then notify \"write\", path\n\n    # Delete a file at a path\n    delete: (path) ->\n      Files.delete(path)\n      .then notify \"delete\", path\n\n    # List files and folders in a directory\n    list: (dir) ->\n      Files.where(\"path\").startsWith(dir).toArray()\n      .then (files) ->\n        folderPaths = {}\n\n        files = files.filter (file) ->\n          file.relativePath = file.path.replace(dir, \"\")\n\n          if file.relativePath.match /\\// # folder\n            folderPath = file.relativePath.replace /\\/.*$/, \"/\"\n            folderPaths[folderPath] = true\n            return\n          else\n            return file\n\n        folders = Object.keys(folderPaths).map (folderPath) ->\n          FolderEntry folderPath, dir\n\n        return folders.concat(files)\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/drop.coffee": {
      "path": "lib/drop.coffee",
      "content": "module.exports = (element, handler) ->\n  cancel = (e) ->\n    e.preventDefault()\n    return false\n\n  element.addEventListener \"dragover\", cancel\n  element.addEventListener \"dragenter\", cancel\n  element.addEventListener \"drop\", (e) ->\n    handler(e)\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/error-reporter.coffee": {
      "path": "lib/error-reporter.coffee",
      "content": "window.addEventListener \"error\", (e) ->\n  system.Achievement.unlock \"I AM ERROR\"\n\nwindow.addEventListener \"unhandledrejection\", (e) ->\n  system.Achievement.unlock \"I AM ERROR\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/hamlet.js": {
      "path": "lib/hamlet.js",
      "content": "(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Hamlet = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var Hamlet, compile;\n\n  Hamlet = require(\"./runtime\");\n\n  compile = require(\"hamlet-compiler\").compile;\n\n  Hamlet.compile = compile;\n\n  module.exports = Hamlet;\n\n}).call(this);\n\n},{\"./runtime\":2,\"hamlet-compiler\":5}],2:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  \"use strict\";\n  var Observable, Runtime, bindEvent, bindObservable, bufferTo, classes, createElement, empty, eventNames, get, id, isEvent, isFragment, makeElement, observeAttribute, observeAttributes, observeContent, specialBindings, valueBind, valueIndexOf;\n\n  Observable = require(\"o_0\");\n\n  eventNames = \"abort\\nblur\\nchange\\nclick\\ncontextmenu\\ndblclick\\ndrag\\ndragend\\ndragenter\\ndragexit\\ndragleave\\ndragover\\ndragstart\\ndrop\\nerror\\nfocus\\ninput\\nkeydown\\nkeypress\\nkeyup\\nload\\nmousedown\\nmousemove\\nmouseout\\nmouseover\\nmouseup\\nreset\\nresize\\nscroll\\nselect\\nsubmit\\ntouchcancel\\ntouchend\\ntouchenter\\ntouchleave\\ntouchmove\\ntouchstart\\nunload\".split(\"\\n\");\n\n  isEvent = function(name) {\n    return eventNames.indexOf(name) !== -1;\n  };\n\n  isFragment = function(node) {\n    return (node != null ? node.nodeType : void 0) === 11;\n  };\n\n  valueBind = function(element, value, context) {\n    Observable(function() {\n      var update;\n      value = Observable(value, context);\n      switch (element.nodeName) {\n        case \"SELECT\":\n          element.oninput = element.onchange = function() {\n            var optionValue, _ref, _value;\n            _ref = this.children[this.selectedIndex], optionValue = _ref.value, _value = _ref._value;\n            return value(_value || optionValue);\n          };\n          update = function(newValue) {\n            var options;\n            element._value = newValue;\n            if ((options = element._options)) {\n              if (newValue.value != null) {\n                return element.value = (typeof newValue.value === \"function\" ? newValue.value() : void 0) || newValue.value;\n              } else {\n                return element.selectedIndex = valueIndexOf(options, newValue);\n              }\n            } else {\n              return element.value = newValue;\n            }\n          };\n          return bindObservable(element, value, context, update);\n        default:\n          element.oninput = element.onchange = function() {\n            return value(element.value);\n          };\n          if (typeof element.attachEvent === \"function\") {\n            element.attachEvent(\"onkeydown\", function() {\n              return setTimeout(function() {\n                return value(element.value);\n              }, 0);\n            });\n          }\n          return bindObservable(element, value, context, function(newValue) {\n            if (element.value !== newValue) {\n              return element.value = newValue;\n            }\n          });\n      }\n    });\n  };\n\n  specialBindings = {\n    INPUT: {\n      checked: function(element, value, context) {\n        element.onchange = function() {\n          return typeof value === \"function\" ? value(element.checked) : void 0;\n        };\n        return bindObservable(element, value, context, function(newValue) {\n          return element.checked = newValue;\n        });\n      }\n    },\n    SELECT: {\n      options: function(element, values, context) {\n        var updateValues;\n        values = Observable(values, context);\n        updateValues = function(values) {\n          empty(element);\n          element._options = values;\n          return values.map(function(value, index) {\n            var option, optionName, optionValue;\n            option = createElement(\"option\");\n            option._value = value;\n            if (typeof value === \"object\") {\n              optionValue = (value != null ? value.value : void 0) || index;\n            } else {\n              optionValue = value.toString();\n            }\n            bindObservable(option, optionValue, value, function(newValue) {\n              return option.value = newValue;\n            });\n            optionName = (value != null ? value.name : void 0) || value;\n            bindObservable(option, optionName, value, function(newValue) {\n              return option.textContent = option.innerText = newValue;\n            });\n            element.appendChild(option);\n            if (value === element._value) {\n              element.selectedIndex = index;\n            }\n            return option;\n          });\n        };\n        return bindObservable(element, values, context, updateValues);\n      }\n    }\n  };\n\n  observeAttribute = function(element, context, name, value) {\n    var binding, nodeName, _ref;\n    nodeName = element.nodeName;\n    if (name === \"value\") {\n      valueBind(element, value);\n    } else if (binding = (_ref = specialBindings[nodeName]) != null ? _ref[name] : void 0) {\n      binding(element, value, context);\n    } else if (name.match(/^on/) && isEvent(name.substr(2))) {\n      bindEvent(element, name, value, context);\n    } else if (isEvent(name)) {\n      bindEvent(element, \"on\" + name, value, context);\n    } else {\n      bindObservable(element, value, context, function(newValue) {\n        if ((newValue != null) && newValue !== false) {\n          return element.setAttribute(name, newValue);\n        } else {\n          return element.removeAttribute(name);\n        }\n      });\n    }\n    return element;\n  };\n\n  observeAttributes = function(element, context, attributes) {\n    return Object.keys(attributes).forEach(function(name) {\n      var value;\n      value = attributes[name];\n      return observeAttribute(element, context, name, value);\n    });\n  };\n\n  bindObservable = function(element, value, context, update) {\n    var observable, observe, unobserve;\n    observable = Observable(value, context);\n    observe = function() {\n      observable.observe(update);\n      return update(observable());\n    };\n    unobserve = function() {\n      return observable.stopObserving(update);\n    };\n    observe();\n    return element;\n  };\n\n  bindEvent = function(element, name, fn, context) {\n    return element[name] = function() {\n      return fn.apply(context, arguments);\n    };\n  };\n\n  id = function(element, context, sources) {\n    var lastId, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(newId) {\n      return element.id = newId;\n    };\n    lastId = function() {\n      return value.last();\n    };\n    return bindObservable(element, lastId, context, update);\n  };\n\n  classes = function(element, context, sources) {\n    var classNames, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(classNames) {\n      return element.className = classNames;\n    };\n    classNames = function() {\n      return value.join(\" \");\n    };\n    return bindObservable(element, classNames, context, update);\n  };\n\n  createElement = function(name) {\n    return document.createElement(name);\n  };\n\n  observeContent = function(element, context, contentFn) {\n    var append, contents, update;\n    contents = [];\n    contentFn.call(context, {\n      buffer: bufferTo(context, contents),\n      element: makeElement\n    });\n    append = function(item) {\n      if (item == null) {\n\n      } else if (typeof item === \"string\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"number\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"boolean\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item.each === \"function\") {\n        return item.each(append);\n      } else if (typeof item.forEach === \"function\") {\n        return item.forEach(append);\n      } else {\n        return element.appendChild(item);\n      }\n    };\n    update = function(contents) {\n      empty(element);\n      return contents.forEach(append);\n    };\n    return update(contents);\n  };\n\n  bufferTo = function(context, collection) {\n    return function(content) {\n      if (typeof content === 'function') {\n        content = Observable(content, context);\n      }\n      collection.push(content);\n      return content;\n    };\n  };\n\n  makeElement = function(name, context, attributes, fn) {\n    var element;\n    if (attributes == null) {\n      attributes = {};\n    }\n    element = createElement(name);\n    Observable(function() {\n      if (attributes.id != null) {\n        id(element, context, attributes.id);\n        return delete attributes.id;\n      }\n    });\n    Observable(function() {\n      if (attributes[\"class\"] != null) {\n        classes(element, context, attributes[\"class\"]);\n        return delete attributes[\"class\"];\n      }\n    });\n    Observable(function() {\n      return observeAttributes(element, context, attributes);\n    }, context);\n    if (element.nodeName !== \"SELECT\") {\n      Observable(function() {\n        return observeContent(element, context, fn);\n      }, context);\n    }\n    return element;\n  };\n\n  Runtime = function(context) {\n    var self;\n    self = {\n      buffer: function(content) {\n        if (self.root) {\n          throw \"Cannot have multiple root elements\";\n        }\n        return self.root = content;\n      },\n      element: makeElement,\n      filter: function(name, content) {}\n    };\n    return self;\n  };\n\n  Runtime.VERSION = require(\"../package.json\").version;\n\n  Runtime.Observable = Observable;\n\n  module.exports = Runtime;\n\n  empty = function(node) {\n    var child, _results;\n    _results = [];\n    while (child = node.firstChild) {\n      _results.push(node.removeChild(child));\n    }\n    return _results;\n  };\n\n  valueIndexOf = function(options, value) {\n    if (typeof value === \"object\") {\n      return options.indexOf(value);\n    } else {\n      return options.map(function(option) {\n        return option.toString();\n      }).indexOf(value.toString());\n    }\n  };\n\n  get = function(x) {\n    if (typeof x === 'function') {\n      return x();\n    } else {\n      return x;\n    }\n  };\n\n}).call(this);\n\n},{\"../package.json\":13,\"o_0\":10}],3:[function(require,module,exports){\n\n},{}],4:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var ROOT_NAME, indentText, util;\n\n  indentText = function(text, indent) {\n    if (indent == null) {\n      indent = \"  \";\n    }\n    return indent + text.replace(/\\n/g, \"\\n\" + indent);\n  };\n\n  ROOT_NAME = \"__root\";\n\n  util = {\n    indent: indentText,\n    filters: {\n      verbatim: function(content, compiler) {\n        return compiler.buffer('\"\"\"' + content.replace(/(#|\")/g, \"\\\\$1\") + '\"\"\"');\n      },\n      plain: function(content, compiler) {\n        return compiler.buffer(JSON.stringify(content));\n      },\n      coffeescript: function(content, compiler) {\n        return [content];\n      },\n      javascript: function(content, compiler) {\n        return [\"`\", compiler.indent(content), \"`\"];\n      }\n    },\n    element: function(tag, attributes, contents) {\n      var lines;\n      if (attributes == null) {\n        attributes = [];\n      }\n      if (contents == null) {\n        contents = [];\n      }\n      return lines = [\"\" + ROOT_NAME + \".buffer \" + ROOT_NAME + \".element \" + (JSON.stringify(tag)) + \", this, {\" + (attributes.join('\\n')) + \"}, (\" + ROOT_NAME + \") ->\", indentText(contents.join(\"\\n\")), \"  return\"];\n    },\n    buffer: function(value) {\n      return [\"\" + ROOT_NAME + \".buffer \" + value];\n    },\n    attributes: function(node) {\n      var attributeLines, attributes, classes, id, ids, idsAndClasses;\n      id = node.id, classes = node.classes, attributes = node.attributes;\n      if (id) {\n        ids = [JSON.stringify(id)];\n      } else {\n        ids = [];\n      }\n      classes = (classes || []).map(JSON.stringify);\n      if (attributes) {\n        attributes = attributes.filter(function(_arg) {\n          var name, value;\n          name = _arg.name, value = _arg.value;\n          if (name === \"class\") {\n            classes.push(value);\n            return false;\n          } else if (name === \"id\") {\n            ids.push(value);\n            return false;\n          } else {\n            return true;\n          }\n        });\n      } else {\n        attributes = [];\n      }\n      idsAndClasses = [];\n      if (ids.length) {\n        idsAndClasses.push(\"id: [\" + (ids.join(', ')) + \"]\");\n      }\n      if (classes.length) {\n        idsAndClasses.push(\"class: [\" + (classes.join(', ')) + \"]\");\n      }\n      attributeLines = attributes.map(function(_arg) {\n        var name, value;\n        name = _arg.name, value = _arg.value;\n        name = JSON.stringify(name);\n        return \"\" + name + \": \" + value;\n      });\n      return idsAndClasses.concat(attributeLines);\n    },\n    render: function(node) {\n      var filter, tag, text;\n      tag = node.tag, filter = node.filter, text = node.text;\n      if (tag) {\n        return this.tag(node);\n      } else if (filter) {\n        return this.filter(node);\n      } else {\n        return this.contents(node);\n      }\n    },\n    filter: function(node) {\n      var filter, filterName;\n      filterName = node.filter;\n      if (filter = this.filters[filterName]) {\n        return [].concat.apply([], this.filters[filterName](node.content, this));\n      } else {\n        return [\"\" + ROOT_NAME + \".filter(\" + (JSON.stringify(filterName)) + \", \" + (JSON.stringify(node.content)) + \")\"];\n      }\n    },\n    contents: function(node) {\n      var bufferedCode, childContent, children, contents, indent, text, unbufferedCode;\n      children = node.children, bufferedCode = node.bufferedCode, unbufferedCode = node.unbufferedCode, text = node.text;\n      if (unbufferedCode) {\n        indent = true;\n        contents = [unbufferedCode];\n      } else if (bufferedCode) {\n        contents = this.buffer(bufferedCode);\n      } else if (text) {\n        contents = this.buffer(JSON.stringify(text));\n      } else if (node.tag) {\n        contents = [];\n      } else if (node.comment) {\n        return [];\n      } else {\n        contents = [];\n        console.warn(\"No content for node:\", node);\n      }\n      if (children) {\n        childContent = this.renderNodes(children);\n        if (indent) {\n          childContent = this.indent(childContent.join(\"\\n\"));\n        }\n        contents = contents.concat(childContent);\n      }\n      return contents;\n    },\n    renderNodes: function(nodes) {\n      return [].concat.apply([], nodes.map(this.render, this));\n    },\n    tag: function(node) {\n      var tag;\n      tag = node.tag;\n      return this.element(tag, this.attributes(node), this.contents(node));\n    }\n  };\n\n  exports.compile = function(parseTree, _arg) {\n    var compiler, exports, items, options, program, programSource, runtime, source, _ref;\n    _ref = _arg != null ? _arg : {}, compiler = _ref.compiler, runtime = _ref.runtime, exports = _ref.exports;\n    if (runtime == null) {\n      runtime = \"require\" + \"(\\\"hamlet-runtime\\\")\";\n    }\n    if (exports == null) {\n      exports = \"module.exports\";\n    }\n    items = util.renderNodes(parseTree);\n    if (exports) {\n      exports = \"\" + exports + \" = \";\n    } else {\n      exports = \"\";\n    }\n    source = \"\" + exports + \"(data) ->\\n  \\\"use strict\\\"\\n  (->\\n    \" + ROOT_NAME + \" = \" + runtime + \"(this)\\n\\n\" + (util.indent(items.join(\"\\n\"), \"    \")) + \"\\n    return \" + ROOT_NAME + \".root\\n  ).call(data)\";\n    options = {\n      bare: true\n    };\n    programSource = source;\n    program = compiler.compile(programSource, options);\n    return program;\n  };\n\n}).call(this);\n\n},{}],5:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var compile, parser;\n\n  compile = require(\"./compiler\").compile;\n\n  parser = require(\"hamlet-parser\");\n\n  module.exports = {\n    compile: function(input, options) {\n      if (options == null) {\n        options = {};\n      }\n      if (typeof input === \"string\") {\n        input = parser.parse(input, options.mode);\n      }\n      return compile(input, options);\n    }\n  };\n\n}).call(this);\n\n},{\"./compiler\":4,\"hamlet-parser\":8}],6:[function(require,module,exports){\n/* generated by jison-lex 0.2.1 */\nvar haml_lexer = (function(){\nvar lexer = {\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input) {\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len - 1);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function (match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex() {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin(condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState() {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules() {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState(n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState(condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"moduleName\":\"haml_lexer\"},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\n\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:return 'SEPARATOR';\nbreak;\ncase 1:this.popState(); return 'RIGHT_PARENTHESIS';\nbreak;\ncase 2:return 'ATTRIBUTE';\nbreak;\ncase 3:this.begin('value'); return 'EQUAL';\nbreak;\ncase 4:return 'AT_ATTRIBUTE';\nbreak;\ncase 5:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 6:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 7:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 8:yy.indent = 0; this.popState(); return 'NEWLINE';\nbreak;\ncase 9:return 'FILTER_LINE';\nbreak;\ncase 10:yy.indent = 0; return 'NEWLINE';\nbreak;\ncase 11:yy.indent += 1; if(yy.indent > yy.filterIndent){this.begin('filter'); }; return 'INDENT';\nbreak;\ncase 12:this.begin(\"parentheses_attributes\"); return 'LEFT_PARENTHESIS';\nbreak;\ncase 13:yy_.yytext = yy_.yytext.substring(1); return 'COMMENT';\nbreak;\ncase 14:yy.filterIndent = yy.indent; yy_.yytext = yy_.yytext.substring(1); return 'FILTER';\nbreak;\ncase 15:yy_.yytext = yy_.yytext.substring(1); return 'ID';\nbreak;\ncase 16:yy_.yytext = yy_.yytext.substring(1); return 'CLASS';\nbreak;\ncase 17:yy_.yytext = yy_.yytext.substring(1); return 'TAG';\nbreak;\ncase 18:yy_.yytext = yy_.yytext.substring(1).trim(); return 'BUFFERED_CODE';\nbreak;\ncase 19:yy_.yytext = yy_.yytext.substring(1).trim(); return 'UNBUFFERED_CODE';\nbreak;\ncase 20:yy_.yytext = yy_.yytext.trim(); return 'TEXT';\nbreak;\n}\n},\nrules: [/^(?:[ \\t]+)/,/^(?:\\))/,/^(?:([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:=)/,/^(?:@([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:\"(\\\\.|[^\\\\\"])*\")/,/^(?:'(\\\\.|[^\\\\'])*')/,/^(?:[^ \\t\\)]*)/,/^(?:(\\n|$))/,/^(?:[^\\n]*)/,/^(?:\\s*(\\n|$))/,/^(?:(  |\\\\t))/,/^(?:\\()/,/^(?:\\/.*)/,/^(?::([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:#((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:\\.((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:%((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:=.*)/,/^(?:-.*)/,/^(?:.*)/],\nconditions: {\"filter\":{\"rules\":[8,9],\"inclusive\":false},\"value\":{\"rules\":[5,6,7],\"inclusive\":false},\"parentheses_attributes\":{\"rules\":[0,1,2,3,4],\"inclusive\":false},\"INITIAL\":{\"rules\":[10,11,12,13,14,15,16,17,18,19,20],\"inclusive\":true}}\n};\nreturn lexer;\n})();module.exports = haml_lexer;\n\n},{}],7:[function(require,module,exports){\n/* generated by jison-lex 0.2.1 */\nvar jade_lexer = (function(){\nvar lexer = {\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input) {\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len - 1);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function (match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex() {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin(condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState() {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules() {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState(n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState(condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"moduleName\":\"jade_lexer\"},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\n\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:return 'SEPARATOR';\nbreak;\ncase 1:this.popState(); return 'RIGHT_PARENTHESIS';\nbreak;\ncase 2:return 'ATTRIBUTE';\nbreak;\ncase 3:this.begin('value'); return 'EQUAL';\nbreak;\ncase 4:return 'AT_ATTRIBUTE';\nbreak;\ncase 5:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 6:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 7:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 8:yy.indent = 0; this.popState(); return 'NEWLINE';\nbreak;\ncase 9:return 'FILTER_LINE';\nbreak;\ncase 10:yy.indent = 0; return 'NEWLINE';\nbreak;\ncase 11:yy.indent += 1; if(yy.indent > yy.filterIndent){this.begin('filter'); }; return 'INDENT';\nbreak;\ncase 12:this.begin(\"parentheses_attributes\"); return 'LEFT_PARENTHESIS';\nbreak;\ncase 13:yy_.yytext = yy_.yytext.substring(2); return 'COMMENT';\nbreak;\ncase 14:yy.filterIndent = yy.indent; yy_.yytext = yy_.yytext.substring(1); return 'FILTER';\nbreak;\ncase 15:yy_.yytext = yy_.yytext.substring(1); return 'ID';\nbreak;\ncase 16:yy_.yytext = yy_.yytext.substring(1); return 'CLASS';\nbreak;\ncase 17:return 'TAG';\nbreak;\ncase 18:yy_.yytext = yy_.yytext.substring(1).trim(); return 'BUFFERED_CODE';\nbreak;\ncase 19:yy_.yytext = yy_.yytext.substring(1).trim(); return 'UNBUFFERED_CODE';\nbreak;\ncase 20:yy_.yytext = yy_.yytext.trim(); return 'TEXT';\nbreak;\n}\n},\nrules: [/^(?:[ \\t]+)/,/^(?:\\))/,/^(?:([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:=)/,/^(?:@([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:\"(\\\\.|[^\\\\\"])*\")/,/^(?:'(\\\\.|[^\\\\'])*')/,/^(?:[^ \\t\\)]*)/,/^(?:(\\n|$))/,/^(?:[^\\n]*)/,/^(?:\\s*(\\n|$))/,/^(?:(  |\\\\t))/,/^(?:\\()/,/^(?:\\/\\/.*)/,/^(?::([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:#((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:\\.((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:=.*)/,/^(?:-.*)/,/^(?:.*)/],\nconditions: {\"filter\":{\"rules\":[8,9],\"inclusive\":false},\"value\":{\"rules\":[5,6,7],\"inclusive\":false},\"parentheses_attributes\":{\"rules\":[0,1,2,3,4],\"inclusive\":false},\"INITIAL\":{\"rules\":[10,11,12,13,14,15,16,17,18,19,20],\"inclusive\":true}}\n};\nreturn lexer;\n})();module.exports = jade_lexer;\n\n},{}],8:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var extend, lexers, oldParse, parser,\n    __slice = [].slice;\n\n  parser = require(\"./parser\").parser;\n\n  lexers = {\n    haml: require(\"./haml_lexer\"),\n    jade: require(\"./jade_lexer\")\n  };\n\n  extend = function() {\n    var name, source, sources, target, _i, _len;\n    target = arguments[0], sources = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n    for (_i = 0, _len = sources.length; _i < _len; _i++) {\n      source = sources[_i];\n      for (name in source) {\n        target[name] = source[name];\n      }\n    }\n    return target;\n  };\n\n  oldParse = parser.parse;\n\n  extend(parser, {\n    parse: function(input, mode) {\n      if (mode == null) {\n        mode = \"haml\";\n      }\n      parser.lexer = lexers[mode];\n      extend(parser.yy, {\n        indent: 0,\n        nodePath: [\n          {\n            children: []\n          }\n        ],\n        filterIndent: void 0\n      });\n      return oldParse.call(parser, input);\n    }\n  });\n\n  extend(parser.yy, {\n    extend: extend,\n    newline: function() {\n      var lastNode;\n      lastNode = this.nodePath[this.nodePath.length - 1];\n      if (lastNode.filter) {\n        return this.appendFilterContent(lastNode, \"\");\n      }\n    },\n    lastParent: function(indentation) {\n      var parent;\n      while (!(parent = this.nodePath[indentation])) {\n        indentation -= 1;\n      }\n      return parent;\n    },\n    append: function(node, indentation) {\n      var index, lastNode, parent;\n      if (indentation == null) {\n        indentation = 0;\n      }\n      if (node.filterLine) {\n        lastNode = this.nodePath[this.nodePath.length - 1];\n        this.appendFilterContent(lastNode, node.filterLine);\n        return;\n      }\n      parent = this.lastParent(indentation);\n      this.appendChild(parent, node);\n      index = indentation + 1;\n      this.nodePath[index] = node;\n      this.nodePath.length = index + 1;\n      return node;\n    },\n    appendChild: function(parent, child) {\n      if (!child.filter) {\n        this.filterIndent = void 0;\n        this.lexer.popState();\n      }\n      parent.children || (parent.children = []);\n      return parent.children.push(child);\n    },\n    appendFilterContent: function(filter, content) {\n      filter.content || (filter.content = \"\");\n      return filter.content += \"\" + content + \"\\n\";\n    }\n  });\n\n  module.exports = parser;\n\n}).call(this);\n\n},{\"./haml_lexer\":6,\"./jade_lexer\":7,\"./parser\":9}],9:[function(require,module,exports){\n(function (process){\n/* parser generated by jison 0.4.6 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar parser = {trace: function trace() { },\nyy: {},\nsymbols_: {\"error\":2,\"root\":3,\"lines\":4,\"line\":5,\"indentation\":6,\"indentationLevel\":7,\"INDENT\":8,\"lineMain\":9,\"end\":10,\"tag\":11,\"rest\":12,\"COMMENT\":13,\"FILTER\":14,\"FILTER_LINE\":15,\"NEWLINE\":16,\"name\":17,\"tagComponents\":18,\"attributes\":19,\"idComponent\":20,\"classComponents\":21,\"ID\":22,\"CLASS\":23,\"LEFT_PARENTHESIS\":24,\"attributePairs\":25,\"RIGHT_PARENTHESIS\":26,\"SEPARATOR\":27,\"attributePair\":28,\"ATTRIBUTE\":29,\"EQUAL\":30,\"ATTRIBUTE_VALUE\":31,\"AT_ATTRIBUTE\":32,\"TAG\":33,\"BUFFERED_CODE\":34,\"UNBUFFERED_CODE\":35,\"TEXT\":36,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",8:\"INDENT\",13:\"COMMENT\",14:\"FILTER\",15:\"FILTER_LINE\",16:\"NEWLINE\",22:\"ID\",23:\"CLASS\",24:\"LEFT_PARENTHESIS\",26:\"RIGHT_PARENTHESIS\",27:\"SEPARATOR\",29:\"ATTRIBUTE\",30:\"EQUAL\",31:\"ATTRIBUTE_VALUE\",32:\"AT_ATTRIBUTE\",33:\"TAG\",34:\"BUFFERED_CODE\",35:\"UNBUFFERED_CODE\",36:\"TEXT\"},\nproductions_: [0,[3,1],[4,2],[4,1],[6,0],[6,1],[7,2],[7,1],[5,3],[5,1],[9,2],[9,1],[9,1],[9,1],[9,1],[9,1],[10,1],[11,2],[11,2],[11,1],[11,1],[18,3],[18,2],[18,2],[18,2],[18,1],[18,1],[20,1],[21,2],[21,1],[19,3],[25,3],[25,1],[28,3],[28,1],[17,1],[12,1],[12,1],[12,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:return this.$ = yy.nodePath[0].children;\nbreak;\ncase 2:this.$ = $$[$0-1];\nbreak;\ncase 3:this.$ = $$[$0];\nbreak;\ncase 4:this.$ = 0;\nbreak;\ncase 5:this.$ = $$[$0];\nbreak;\ncase 6:this.$ = $$[$0-1] + 1;\nbreak;\ncase 7:this.$ = 1;\nbreak;\ncase 8:this.$ = yy.append($$[$0-1], $$[$0-2]);\nbreak;\ncase 9:this.$ = (function () {\n        if ($$[$0].newline) {\n          return yy.newline();\n        }\n      }());\nbreak;\ncase 10:this.$ = yy.extend($$[$0-1], $$[$0]);\nbreak;\ncase 11:this.$ = $$[$0];\nbreak;\ncase 12:this.$ = $$[$0];\nbreak;\ncase 13:this.$ = {\n          comment: $$[$0]\n        };\nbreak;\ncase 14:this.$ = {\n          filter: $$[$0]\n        };\nbreak;\ncase 15:this.$ = {\n          filterLine: $$[$0]\n        };\nbreak;\ncase 16:this.$ = {\n          newline: true\n        };\nbreak;\ncase 17:this.$ = (function () {\n        $$[$0].tag = $$[$0-1];\n        return $$[$0];\n      }());\nbreak;\ncase 18:this.$ = {\n          tag: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 19:this.$ = {\n          tag: $$[$0]\n        };\nbreak;\ncase 20:this.$ = yy.extend($$[$0], {\n          tag: \"div\"\n        });\nbreak;\ncase 21:this.$ = {\n          id: $$[$0-2],\n          classes: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 22:this.$ = {\n          id: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 23:this.$ = {\n          classes: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 24:this.$ = {\n          id: $$[$0-1],\n          classes: $$[$0]\n        };\nbreak;\ncase 25:this.$ = {\n          id: $$[$0]\n        };\nbreak;\ncase 26:this.$ = {\n          classes: $$[$0]\n        };\nbreak;\ncase 27:this.$ = $$[$0];\nbreak;\ncase 28:this.$ = $$[$0-1].concat($$[$0]);\nbreak;\ncase 29:this.$ = [$$[$0]];\nbreak;\ncase 30:this.$ = $$[$0-1];\nbreak;\ncase 31:this.$ = $$[$0-2].concat($$[$0]);\nbreak;\ncase 32:this.$ = [$$[$0]];\nbreak;\ncase 33:this.$ = {\n          name: $$[$0-2],\n          value: $$[$0]\n        };\nbreak;\ncase 34:this.$ = {\n          name: $$[$0].substring(1),\n          value: $$[$0]\n        };\nbreak;\ncase 35:this.$ = $$[$0];\nbreak;\ncase 36:this.$ = {\n          bufferedCode: $$[$0]\n        };\nbreak;\ncase 37:this.$ = {\n          unbufferedCode: $$[$0]\n        };\nbreak;\ncase 38:this.$ = {\n          text: $$[$0] + \"\\n\"\n        };\nbreak;\n}\n},\ntable: [{3:1,4:2,5:3,6:4,7:6,8:[1,8],10:5,13:[2,4],14:[2,4],15:[2,4],16:[1,7],22:[2,4],23:[2,4],33:[2,4],34:[2,4],35:[2,4],36:[2,4]},{1:[3]},{1:[2,1],5:9,6:4,7:6,8:[1,8],10:5,13:[2,4],14:[2,4],15:[2,4],16:[1,7],22:[2,4],23:[2,4],33:[2,4],34:[2,4],35:[2,4],36:[2,4]},{1:[2,3],8:[2,3],13:[2,3],14:[2,3],15:[2,3],16:[2,3],22:[2,3],23:[2,3],33:[2,3],34:[2,3],35:[2,3],36:[2,3]},{9:10,11:11,12:12,13:[1,13],14:[1,14],15:[1,15],17:16,18:17,20:22,21:23,22:[1,24],23:[1,25],33:[1,21],34:[1,18],35:[1,19],36:[1,20]},{1:[2,9],8:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[2,9],22:[2,9],23:[2,9],33:[2,9],34:[2,9],35:[2,9],36:[2,9]},{8:[1,26],13:[2,5],14:[2,5],15:[2,5],22:[2,5],23:[2,5],33:[2,5],34:[2,5],35:[2,5],36:[2,5]},{1:[2,16],8:[2,16],13:[2,16],14:[2,16],15:[2,16],16:[2,16],22:[2,16],23:[2,16],33:[2,16],34:[2,16],35:[2,16],36:[2,16]},{8:[2,7],13:[2,7],14:[2,7],15:[2,7],22:[2,7],23:[2,7],33:[2,7],34:[2,7],35:[2,7],36:[2,7]},{1:[2,2],8:[2,2],13:[2,2],14:[2,2],15:[2,2],16:[2,2],22:[2,2],23:[2,2],33:[2,2],34:[2,2],35:[2,2],36:[2,2]},{10:27,16:[1,7]},{12:28,16:[2,11],34:[1,18],35:[1,19],36:[1,20]},{16:[2,12]},{16:[2,13]},{16:[2,14]},{16:[2,15]},{16:[2,19],18:29,19:30,20:22,21:23,22:[1,24],23:[1,25],24:[1,31],34:[2,19],35:[2,19],36:[2,19]},{16:[2,20],34:[2,20],35:[2,20],36:[2,20]},{16:[2,36]},{16:[2,37]},{16:[2,38]},{16:[2,35],22:[2,35],23:[2,35],24:[2,35],34:[2,35],35:[2,35],36:[2,35]},{16:[2,25],19:33,21:32,23:[1,25],24:[1,31],34:[2,25],35:[2,25],36:[2,25]},{16:[2,26],19:34,23:[1,35],24:[1,31],34:[2,26],35:[2,26],36:[2,26]},{16:[2,27],23:[2,27],24:[2,27],34:[2,27],35:[2,27],36:[2,27]},{16:[2,29],23:[2,29],24:[2,29],34:[2,29],35:[2,29],36:[2,29]},{8:[2,6],13:[2,6],14:[2,6],15:[2,6],22:[2,6],23:[2,6],33:[2,6],34:[2,6],35:[2,6],36:[2,6]},{1:[2,8],8:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[2,8],22:[2,8],23:[2,8],33:[2,8],34:[2,8],35:[2,8],36:[2,8]},{16:[2,10]},{16:[2,17],34:[2,17],35:[2,17],36:[2,17]},{16:[2,18],34:[2,18],35:[2,18],36:[2,18]},{25:36,28:37,29:[1,38],32:[1,39]},{16:[2,24],19:40,23:[1,35],24:[1,31],34:[2,24],35:[2,24],36:[2,24]},{16:[2,22],34:[2,22],35:[2,22],36:[2,22]},{16:[2,23],34:[2,23],35:[2,23],36:[2,23]},{16:[2,28],23:[2,28],24:[2,28],34:[2,28],35:[2,28],36:[2,28]},{26:[1,41],27:[1,42]},{26:[2,32],27:[2,32]},{30:[1,43]},{26:[2,34],27:[2,34]},{16:[2,21],34:[2,21],35:[2,21],36:[2,21]},{16:[2,30],34:[2,30],35:[2,30],36:[2,30]},{28:44,29:[1,38],32:[1,39]},{31:[1,45]},{26:[2,31],27:[2,31]},{26:[2,33],27:[2,33]}],\ndefaultActions: {12:[2,12],13:[2,13],14:[2,14],15:[2,15],18:[2,36],19:[2,37],20:[2,38],28:[2,10]},\nparseError: function parseError(str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        throw new Error(str);\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    this.lexer.setInput(input);\n    this.lexer.yy = this.yy;\n    this.yy.lexer = this.lexer;\n    this.yy.parser = this;\n    if (typeof this.lexer.yylloc == 'undefined') {\n        this.lexer.yylloc = {};\n    }\n    var yyloc = this.lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = this.lexer.options && this.lexer.options.ranges;\n    if (typeof this.yy.parseError === 'function') {\n        this.parseError = this.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n    function lex() {\n        var token;\n        token = self.lexer.lex() || EOF;\n        if (typeof token !== 'number') {\n            token = self.symbols_[token] || token;\n        }\n        return token;\n    }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n                    if (typeof action === 'undefined' || !action.length || !action[0]) {\n                var errStr = '';\n                expected = [];\n                for (p in table[state]) {\n                    if (this.terminals_[p] && p > TERROR) {\n                        expected.push('\\'' + this.terminals_[p] + '\\'');\n                    }\n                }\n                if (this.lexer.showPosition) {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + this.lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n                } else {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n                }\n                this.parseError(errStr, {\n                    text: this.lexer.match,\n                    token: this.terminals_[symbol] || symbol,\n                    line: this.lexer.yylineno,\n                    loc: yyloc,\n                    expected: expected\n                });\n            }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(this.lexer.yytext);\n            lstack.push(this.lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = this.lexer.yyleng;\n                yytext = this.lexer.yytext;\n                yylineno = this.lexer.yylineno;\n                yyloc = this.lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.call(yyval, yytext, yyleng, yylineno, this.yy, action[1], vstack, lstack);\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\nundefined\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain(args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}\n}).call(this,require('_process'))\n},{\"_process\":12,\"fs\":3,\"path\":11}],10:[function(require,module,exports){\n(function (global){\n// Generated by CoffeeScript 1.8.0\n(function() {\n  var Observable, PROXY_LENGTH, computeDependencies, copy, extend, flatten, get, last, magicDependency, remove, splat, tryCallWithFinallyPop,\n    __slice = [].slice;\n\n  module.exports = Observable = function(value, context) {\n    var changed, fn, listeners, notify, notifyReturning, self;\n    if (typeof (value != null ? value.observe : void 0) === \"function\") {\n      return value;\n    }\n    listeners = [];\n    notify = function(newValue) {\n      return copy(listeners).forEach(function(listener) {\n        return listener(newValue);\n      });\n    };\n    if (typeof value === 'function') {\n      fn = value;\n      self = function() {\n        magicDependency(self);\n        return value;\n      };\n      changed = function() {\n        value = computeDependencies(self, fn, changed, context);\n        return notify(value);\n      };\n      changed();\n    } else {\n      self = function(newValue) {\n        if (arguments.length > 0) {\n          if (value !== newValue) {\n            value = newValue;\n            notify(newValue);\n          }\n        } else {\n          magicDependency(self);\n        }\n        return value;\n      };\n    }\n    self.each = function(callback) {\n      magicDependency(self);\n      if (value != null) {\n        [value].forEach(function(item) {\n          return callback.call(item, item);\n        });\n      }\n      return self;\n    };\n    if (Array.isArray(value)) {\n      [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"reduce\", \"reduceRight\", \"slice\", \"some\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          magicDependency(self);\n          return value[method].apply(value, args);\n        };\n      });\n      [\"pop\", \"push\", \"reverse\", \"shift\", \"splice\", \"sort\", \"unshift\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          return notifyReturning(value[method].apply(value, args));\n        };\n      });\n      if (PROXY_LENGTH) {\n        Object.defineProperty(self, 'length', {\n          get: function() {\n            magicDependency(self);\n            return value.length;\n          },\n          set: function(length) {\n            value.length = length;\n            return notifyReturning(value.length);\n          }\n        });\n      }\n      notifyReturning = function(returnValue) {\n        notify(value);\n        return returnValue;\n      };\n      extend(self, {\n        each: function(callback) {\n          self.forEach(function(item, index) {\n            return callback.call(item, item, index, self);\n          });\n          return self;\n        },\n        remove: function(object) {\n          var index;\n          index = value.indexOf(object);\n          if (index >= 0) {\n            return notifyReturning(value.splice(index, 1)[0]);\n          }\n        },\n        get: function(index) {\n          magicDependency(self);\n          return value[index];\n        },\n        first: function() {\n          magicDependency(self);\n          return value[0];\n        },\n        last: function() {\n          magicDependency(self);\n          return value[value.length - 1];\n        },\n        size: function() {\n          magicDependency(self);\n          return value.length;\n        }\n      });\n    }\n    extend(self, {\n      listeners: listeners,\n      observe: function(listener) {\n        return listeners.push(listener);\n      },\n      stopObserving: function(fn) {\n        return remove(listeners, fn);\n      },\n      toggle: function() {\n        return self(!value);\n      },\n      increment: function(n) {\n        return self(value + n);\n      },\n      decrement: function(n) {\n        return self(value - n);\n      },\n      toString: function() {\n        return \"Observable(\" + value + \")\";\n      }\n    });\n    return self;\n  };\n\n  Observable.concat = function() {\n    var arg, args, collection, i, o, _i, _len;\n    args = new Array(arguments.length);\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      arg = arguments[i];\n      args[i] = arguments[i];\n    }\n    collection = Observable(args);\n    o = Observable(function() {\n      return flatten(collection.map(splat));\n    });\n    o.push = collection.push;\n    return o;\n  };\n\n  extend = function(target) {\n    var i, name, source, _i, _len;\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      source = arguments[i];\n      if (i > 0) {\n        for (name in source) {\n          target[name] = source[name];\n        }\n      }\n    }\n    return target;\n  };\n\n  global.OBSERVABLE_ROOT_HACK = [];\n\n  magicDependency = function(self) {\n    var observerSet;\n    observerSet = last(global.OBSERVABLE_ROOT_HACK);\n    if (observerSet) {\n      return observerSet.add(self);\n    }\n  };\n\n  tryCallWithFinallyPop = function(fn, context) {\n    try {\n      return fn.call(context);\n    } finally {\n      global.OBSERVABLE_ROOT_HACK.pop();\n    }\n  };\n\n  computeDependencies = function(self, fn, update, context) {\n    var deps, value, _ref;\n    deps = new Set;\n    global.OBSERVABLE_ROOT_HACK.push(deps);\n    value = tryCallWithFinallyPop(fn, context);\n    if ((_ref = self._deps) != null) {\n      _ref.forEach(function(observable) {\n        return observable.stopObserving(update);\n      });\n    }\n    self._deps = deps;\n    deps.forEach(function(observable) {\n      return observable.observe(update);\n    });\n    return value;\n  };\n\n  try {\n    Object.defineProperty((function() {}), 'length', {\n      get: function() {},\n      set: function() {}\n    });\n    PROXY_LENGTH = true;\n  } catch (_error) {\n    PROXY_LENGTH = false;\n  }\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n  copy = function(array) {\n    return array.concat([]);\n  };\n\n  get = function(arg) {\n    if (typeof arg === \"function\") {\n      return arg();\n    } else {\n      return arg;\n    }\n  };\n\n  splat = function(item) {\n    var result, results;\n    results = [];\n    if (item == null) {\n      return results;\n    }\n    if (typeof item.forEach === \"function\") {\n      item.forEach(function(i) {\n        return results.push(i);\n      });\n    } else {\n      result = get(item);\n      if (result != null) {\n        results.push(result);\n      }\n    }\n    return results;\n  };\n\n  last = function(array) {\n    return array[array.length - 1];\n  };\n\n  flatten = function(array) {\n    return array.reduce(function(a, b) {\n      return a.concat(b);\n    }, []);\n  };\n\n}).call(this);\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],11:[function(require,module,exports){\n(function (process){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n\n}).call(this,require('_process'))\n},{\"_process\":12}],12:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],13:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"hamlet.coffee\",\n  \"version\": \"0.7.6\",\n  \"description\": \"Truly amazing templating!\",\n  \"devDependencies\": {\n    \"browserify\": \"^12.0.1\",\n    \"coffee-script\": \"~1.7.1\",\n    \"jsdom\": \"^7.2.0\",\n    \"mocha\": \"^2.3.3\"\n  },\n  \"dependencies\": {\n    \"hamlet-compiler\": \"0.7.0\",\n    \"o_0\": \"0.3.8\"\n  },\n  \"homepage\": \"hamlet.coffee\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/dr-coffee-labs/hamlet.git\"\n  },\n  \"scripts\": {\n    \"prepublish\": \"script/prepublish\",\n    \"test\": \"script/test\"\n  },\n  \"files\": [\n    \"dist/\"\n  ],\n  \"main\": \"dist/runtime.js\"\n}\n\n},{}]},{},[1])(1)\n});\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/iframe-app.coffee": {
      "path": "lib/iframe-app.coffee",
      "content": "###\nIFrameApp loads an app in an iframe and returns a UI window that the system can\nuse to interact with it.\n\nThe apps can be sandboxed by passing in the sandbox option.\n\nApps can be loaded from a json package or from a source url.\n\nApps are communicated with via `postMessage`\n\nThe iframed app is responsible for sending the `ready` message when it is in a\nstate that can respond to messages from the OS.\n\n###\n\nModel = require \"model\"\nPostmaster = require \"postmaster\"\nDrop = require \"./drop\"\nFileIO = require \"../os/file-io\"\n\n{version} = require \"../pixie\"\n\nmodule.exports = (opts={}) ->\n  {Window} = system.UI\n\n  {height, menuBar, src, handlers, title, width, sandbox, pkg, packageOptions, iconEmoji} = opts\n\n  frame = document.createElement \"iframe\"\n\n  if sandbox\n    frame.setAttribute(\"sandbox\", sandbox)\n\n  if src\n    frame.src = src\n  else if pkg\n    html = system.htmlForPackage(pkg, packageOptions)\n    blob = new Blob [html],\n      type: \"text/html; charset=utf-8\"\n    frame.src = URL.createObjectURL blob\n\n  # Keep track of waiting for child window to load, all remote invocations are\n  # queued behind a promise until the child has loaded\n  # May want to move it into the postmaster library\n  resolveLoaded = null\n  loadedPromise = new Promise (resolve) ->\n    resolveLoaded = resolve\n\n  loaded = false\n  setTimeout ->\n    console.warn \"Child never loaded\" unless loaded\n  , 5000\n\n  # Attach a postmaster to receive events from the child frame\n  postmaster = Postmaster()\n\n  acceptClient = ->\n    resolveLoaded()\n    loaded = true\n\n    ZineOS:\n      version: version\n      env: {} # TODO: Can pass env vars here\n      args: {} # TODO: Can pass args here, args can be an object\n\n  # TODO: use postmaster.delegate\n  # TODO: Set menu bar from within app\n\n  Object.assign postmaster,\n    remoteTarget: ->\n      frame.contentWindow\n\n    ready: (clientData) ->\n      console.info clientData\n      acceptClient()\n\n    childLoaded: ->\n      console.log \"child loaded\"\n      acceptClient()\n\n    # Send events from the iframe app to the application\n    event: ->\n      application.trigger \"event\", arguments...\n\n      return\n\n    # Add application method access to client iFrame\n    application: (method, args...) ->\n      application[method](args...)\n\n    # Add system method access to client iFrame\n    # TODO: Security :P\n    system: (method, args...) ->\n      system[method](args...)\n\n  handlers ?= Model().include(FileIO).extend\n    loadFile: (blob) ->\n      loadedPromise.then ->\n        postmaster.invokeRemote \"loadFile\", blob\n        .catch (e) ->\n          console.error \"invokeRemote 'loadFile' failed\", e\n\n  application = Window\n    title: title\n    content: frame\n    menuBar: menuBar?.element\n    width: width\n    height: height\n    iconEmoji: iconEmoji\n\n  Object.assign application,\n    exit: ->\n      # TODO: Prompt unsaved, etc.\n      setTimeout ->\n        application.element.remove()\n      , 0\n      return\n    handlers: handlers\n    loadFile: handlers.loadFile\n    send: (args...) ->\n      loadedPromise.then ->\n        postmaster.invokeRemote args...\n\n  return application\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/jadelet.min.js": {
      "path": "lib/jadelet.min.js",
      "content": "!function(t){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{(\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this).Jadelet=t()}}(function(){return function t(e,n,i){function r(o,c){if(!n[o]){if(!e[o]){var a=\"function\"==typeof require&&require;if(!c&&a)return a(o,!0);if(s)return s(o,!0);var u=new Error(\"Cannot find module '\"+o+\"'\");throw u.code=\"MODULE_NOT_FOUND\",u}var l=n[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return r(n||t)},l,l.exports,t,e,n,i)}return n[o].exports}for(var s=\"function\"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){(function(){var n,i,r,s;r=t(\"./parser/main\"),e.exports=function(t,e){return null==e&&(e={}),\"string\"==typeof t&&(t=r.parse(t)),n(t,e)},s={indent:i=function(t,e){return null==e&&(e=\"  \"),e+t.replace(/\\n/g,\"\\n\"+e)},filters:{verbatim:function(t,e){return e.buffer('\"\"\"'+t.replace(/(#|\")/g,\"\\\\$1\")+'\"\"\"')},plain:function(t,e){return e.buffer(JSON.stringify(t))},coffeescript:function(t,e){return[t]},javascript:function(t,e){return[\"`\",e.indent(t),\"`\"]}},element:function(t,e,n){return null==e&&(e=[]),null==n&&(n=[]),[\"__root.buffer __root.element \"+JSON.stringify(t)+\", this, {\"+e.join(\"\\n\")+\"}, (__root) ->\",i(n.join(\"\\n\")),\"  return\"]},buffer:function(t){return[\"__root.buffer \"+t]},attributes:function(t){var e,n,i,r,s,o,c;return r=t.id,i=t.classes,n=t.attributes,s=r?[JSON.stringify(r)]:[],i=(i||[]).map(JSON.stringify),c=[],n=n?n.filter(function(t){var e,n;if(e=t.name,n=t.value,\"class\"===e)i.push(n);else if(\"id\"===e)s.push(n);else{if(\"style\"!==e)return!0;c.push(n)}}):[],o=[],s.length&&o.push(\"id: [\"+s.join(\", \")+\"]\"),i.length&&o.push(\"class: [\"+i.join(\", \")+\"]\"),c.length&&o.push(\"style: [\"+c.join(\", \")+\"]\"),e=n.map(function(t){var e,n;return e=t.name,n=t.value,(e=JSON.stringify(e))+\": \"+n}),o.concat(e)},render:function(t){var e,n;return n=t.tag,e=t.filter,t.text,n?this.tag(t):e?this.filter(t):this.contents(t)},filter:function(t){var e;return e=t.filter,this.filters[e]?[].concat.apply([],this.filters[e](t.content,this)):[\"__root.filter(\"+JSON.stringify(e)+\", \"+JSON.stringify(t.content)+\")\"]},contents:function(t){var e,n,i,r,s,o,c;if(i=t.children,e=t.bufferedCode,c=t.unbufferedCode,o=t.text,c)s=!0,r=[c];else if(e)r=this.buffer(e);else if(o)r=this.buffer(JSON.stringify(o));else if(t.tag)r=[];else{if(t.comment)return[];r=[],console.warn(\"No content for node:\",t)}return i&&(n=this.renderNodes(i),s&&(n=this.indent(n.join(\"\\n\"))),r=r.concat(n)),r},renderNodes:function(t){return[].concat.apply([],t.map(this.render,this))},tag:function(t){var e;return e=t.tag,this.element(e,this.attributes(t),this.contents(t))}},n=function(t,e){var n,i,r,o,c,a,u,l;return l=null!=e?e:{},n=l.compiler,a=l.runtime,i=l.exports,null==a&&(a='require(\"jadelet\")'),null==i&&(i=\"module.exports\"),r=s.renderNodes(t),i?i+=\" = \":i=\"\",u=i+'(data) ->\\n  \"use strict\"\\n  (->\\n    __root = '+a+\"(this)\\n\"+s.indent(r.join(\"\\n\"),\"    \")+\"\\n    return __root.root\\n  ).call(data)\",o={bare:!0},c=u,n.compile(c,o)}}).call(this)},{\"./parser/main\":4}],2:[function(t,e,n){(function(){var n;(n=t(\"./runtime\")).compile=t(\"./compiler\"),e.exports=n}).call(this)},{\"./compiler\":1,\"./runtime\":6}],3:[function(t,e,n){var i=function(){return{EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match=\"\",this.conditionStack=[\"INITIAL\"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\\r\\n?|\\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\\r\\n?|\\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var i=this.match.split(/(?:\\r\\n?|\\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?\"...\":\"\")+t.substr(-20).replace(/\\n/g,\"\")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?\"...\":\"\")).replace(/\\n/g,\"\")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join(\"-\");return t+this.upcomingInput()+\"\\n\"+e+\"^\"},test_match:function(t,e){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(i=t[0].match(/(?:\\r\\n?|\\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\\r?\\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in r)this[s]=r[s];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i;this._more||(this.yytext=\"\",this.match=\"\");for(var r=this._currentRules(),s=0;s<r.length;s++)if((n=this._input.match(this.rules[r[s]]))&&(!e||n[0].length>e[0].length)){if(e=n,i=s,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,r[s])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,r[i]))&&t:\"\"===this._input?this.EOF:this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". Unrecognized text.\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:\"INITIAL\"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{moduleName:\"lexer\"},performAction:function(t,e,n,i){switch(n){case 0:return\"SEPARATOR\";case 1:return this.popState(),\"RIGHT_PARENTHESIS\";case 2:return\"ATTRIBUTE\";case 3:return this.begin(\"value\"),\"EQUAL\";case 4:return\"AT_ATTRIBUTE\";case 5:case 6:case 7:return this.popState(),\"ATTRIBUTE_VALUE\";case 8:return t.indent=0,this.popState(),\"NEWLINE\";case 9:return\"FILTER_LINE\";case 10:return t.indent=0,\"NEWLINE\";case 11:return t.indent+=1,t.indent>t.filterIndent&&this.begin(\"filter\"),\"INDENT\";case 12:return this.begin(\"parentheses_attributes\"),\"LEFT_PARENTHESIS\";case 13:return e.yytext=e.yytext.substring(2),\"COMMENT\";case 14:return t.filterIndent=t.indent,e.yytext=e.yytext.substring(1),\"FILTER\";case 15:return e.yytext=e.yytext.substring(1),\"ID\";case 16:return e.yytext=e.yytext.substring(1),\"CLASS\";case 17:return\"TAG\";case 18:return e.yytext=e.yytext.substring(1).trim(),\"BUFFERED_CODE\";case 19:return e.yytext=e.yytext.substring(1).trim(),\"UNBUFFERED_CODE\";case 20:return e.yytext=e.yytext.trim(),\"TEXT\"}},rules:[/^(?:[ \\t]+)/,/^(?:\\))/,/^(?:([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:=)/,/^(?:@([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:\"(\\\\.|[^\\\\\"])*\")/,/^(?:'(\\\\.|[^\\\\'])*')/,/^(?:[^ \\t\\)]*)/,/^(?:(\\n|$))/,/^(?:[^\\n]*)/,/^(?:\\s*(\\n|$))/,/^(?:(  |\\\\t))/,/^(?:\\()/,/^(?:\\/\\/.*)/,/^(?::([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:#((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:\\.((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:=.*)/,/^(?:-.*)/,/^(?:.*)/],conditions:{filter:{rules:[8,9],inclusive:!1},value:{rules:[5,6,7],inclusive:!1},parentheses_attributes:{rules:[0,1,2,3,4],inclusive:!1},INITIAL:{rules:[10,11,12,13,14,15,16,17,18,19,20],inclusive:!0}}}}();e.exports=i},{}],4:[function(t,e,n){(function(){var n,i,r,s;n=Object.assign,i=t(\"./lexer\"),s=t(\"./parser\").parser,r=s.parse,n(s,{parse:function(t){return s.lexer=i,n(s.yy,{indent:0,nodePath:[{children:[]}],filterIndent:void 0}),r.call(s,t)}}),n(s.yy,{extend:n,newline:function(){var t;if((t=this.nodePath[this.nodePath.length-1]).filter)return this.appendFilterContent(t,\"\")},lastParent:function(t){for(var e;!(e=this.nodePath[t]);)t-=1;return e},append:function(t,e){var n,i,r;return null==e&&(e=0),t.filterLine?(i=this.nodePath[this.nodePath.length-1],void this.appendFilterContent(i,t.filterLine)):(r=this.lastParent(e),this.appendChild(r,t),n=e+1,this.nodePath[n]=t,this.nodePath.length=n+1,t)},appendChild:function(t,e){return e.filter||(this.filterIndent=void 0,this.lexer.popState()),t.children||(t.children=[]),t.children.push(e)},appendFilterContent:function(t,e){return t.content||(t.content=\"\"),t.content+=e+\"\\n\"}}),e.exports=s}).call(this)},{\"./lexer\":3,\"./parser\":5}],5:[function(t,e,n){(function(i){var r=function(){function t(){this.yy={}}var e=function(t,e,n,i){for(n=n||{},i=t.length;i--;n[t[i]]=e);return n},n=[13,14,15,22,23,33,34,35,36],i=[2,4],r=[1,8],s=[1,7],o=[1,8,13,14,15,16,22,23,33,34,35,36],c=[1,24],a=[1,25],u=[1,18],l=[1,19],h=[1,20],f=[8,13,14,15,22,23,33,34,35,36],p=[16,34,35,36],y=[1,31],d=[1,35],g=[16,23,24,34,35,36],m=[1,38],v=[1,39],_=[26,27],b={trace:function(){},yy:{},symbols_:{error:2,root:3,lines:4,line:5,indentation:6,indentationLevel:7,INDENT:8,lineMain:9,end:10,tag:11,rest:12,COMMENT:13,FILTER:14,FILTER_LINE:15,NEWLINE:16,name:17,tagComponents:18,attributes:19,idComponent:20,classComponents:21,ID:22,CLASS:23,LEFT_PARENTHESIS:24,attributePairs:25,RIGHT_PARENTHESIS:26,SEPARATOR:27,attributePair:28,ATTRIBUTE:29,EQUAL:30,ATTRIBUTE_VALUE:31,AT_ATTRIBUTE:32,TAG:33,BUFFERED_CODE:34,UNBUFFERED_CODE:35,TEXT:36,$accept:0,$end:1},terminals_:{2:\"error\",8:\"INDENT\",13:\"COMMENT\",14:\"FILTER\",15:\"FILTER_LINE\",16:\"NEWLINE\",22:\"ID\",23:\"CLASS\",24:\"LEFT_PARENTHESIS\",26:\"RIGHT_PARENTHESIS\",27:\"SEPARATOR\",29:\"ATTRIBUTE\",30:\"EQUAL\",31:\"ATTRIBUTE_VALUE\",32:\"AT_ATTRIBUTE\",33:\"TAG\",34:\"BUFFERED_CODE\",35:\"UNBUFFERED_CODE\",36:\"TEXT\"},productions_:[0,[3,1],[4,2],[4,1],[6,0],[6,1],[7,2],[7,1],[5,3],[5,1],[9,2],[9,1],[9,1],[9,1],[9,1],[9,1],[10,1],[11,2],[11,2],[11,1],[11,1],[18,3],[18,2],[18,2],[18,2],[18,1],[18,1],[20,1],[21,2],[21,1],[19,3],[25,3],[25,1],[28,3],[28,1],[17,1],[12,1],[12,1],[12,1]],performAction:function(t,e,n,i,r,s,o){var c=s.length-1;switch(r){case 1:return this.$=i.nodePath[0].children;case 2:case 30:this.$=s[c-1];break;case 3:case 5:case 11:case 12:case 27:case 35:this.$=s[c];break;case 4:this.$=0;break;case 6:this.$=s[c-1]+1;break;case 7:this.$=1;break;case 8:this.$=i.append(s[c-1],s[c-2]);break;case 9:this.$=function(){if(s[c].newline)return i.newline()}();break;case 10:this.$=i.extend(s[c-1],s[c]);break;case 13:this.$={comment:s[c]};break;case 14:this.$={filter:s[c]};break;case 15:this.$={filterLine:s[c]};break;case 16:this.$={newline:!0};break;case 17:this.$=function(){return s[c].tag=s[c-1],s[c]}();break;case 18:this.$={tag:s[c-1],attributes:s[c]};break;case 19:this.$={tag:s[c]};break;case 20:this.$=i.extend(s[c],{tag:\"div\"});break;case 21:this.$={id:s[c-2],classes:s[c-1],attributes:s[c]};break;case 22:this.$={id:s[c-1],attributes:s[c]};break;case 23:this.$={classes:s[c-1],attributes:s[c]};break;case 24:this.$={id:s[c-1],classes:s[c]};break;case 25:this.$={id:s[c]};break;case 26:this.$={classes:s[c]};break;case 28:this.$=s[c-1].concat(s[c]);break;case 29:case 32:this.$=[s[c]];break;case 31:this.$=s[c-2].concat(s[c]);break;case 33:this.$={name:s[c-2],value:s[c]};break;case 34:this.$={name:s[c].substring(1),value:s[c]};break;case 36:this.$={bufferedCode:s[c]};break;case 37:this.$={unbufferedCode:s[c]};break;case 38:this.$={text:s[c]+\"\\n\"}}},table:[e(n,i,{3:1,4:2,5:3,6:4,10:5,7:6,8:r,16:s}),{1:[3]},e(n,i,{6:4,10:5,7:6,5:9,1:[2,1],8:r,16:s}),e(o,[2,3]),{9:10,11:11,12:12,13:[1,13],14:[1,14],15:[1,15],17:16,18:17,20:22,21:23,22:c,23:a,33:[1,21],34:u,35:l,36:h},e(o,[2,9]),e(n,[2,5],{8:[1,26]}),e(o,[2,16]),e(f,[2,7]),e(o,[2,2]),{10:27,16:s},{12:28,16:[2,11],34:u,35:l,36:h},{16:[2,12]},{16:[2,13]},{16:[2,14]},{16:[2,15]},e(p,[2,19],{20:22,21:23,18:29,19:30,22:c,23:a,24:y}),e(p,[2,20]),{16:[2,36]},{16:[2,37]},{16:[2,38]},e([16,22,23,24,34,35,36],[2,35]),e(p,[2,25],{21:32,19:33,23:a,24:y}),e(p,[2,26],{19:34,23:d,24:y}),e(g,[2,27]),e(g,[2,29]),e(f,[2,6]),e(o,[2,8]),{16:[2,10]},e(p,[2,17]),e(p,[2,18]),{25:36,28:37,29:m,32:v},e(p,[2,24],{19:40,23:d,24:y}),e(p,[2,22]),e(p,[2,23]),e(g,[2,28]),{26:[1,41],27:[1,42]},e(_,[2,32]),{30:[1,43]},e(_,[2,34]),e(p,[2,21]),e(p,[2,30]),{28:44,29:m,32:v},{31:[1,45]},e(_,[2,31]),e(_,[2,33])],defaultActions:{12:[2,12],13:[2,13],14:[2,14],15:[2,15],18:[2,36],19:[2,37],20:[2,38],28:[2,10]},parseError:function(t,e){function n(t,e){this.message=t,this.hash=e}if(!e.recoverable)throw n.prototype=Error,new n(t,e);this.trace(t)},parse:function(t){var e=this,n=[0],i=[null],r=[],s=this.table,o=\"\",c=0,a=0,u=0,l=r.slice.call(arguments,1),h=Object.create(this.lexer),f={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(f.yy[p]=this.yy[p]);h.setInput(t,f.yy),f.yy.lexer=h,f.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var y=h.yylloc;r.push(y);var d=h.options&&h.options.ranges;\"function\"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,m,v,_,b,E,T,x,k,A=function(){var t;return\"number\"!=typeof(t=h.lex()||1)&&(t=e.symbols_[t]||t),t},S={};;){if(v=n[n.length-1],this.defaultActions[v]?_=this.defaultActions[v]:(null!==g&&void 0!==g||(g=A()),_=s[v]&&s[v][g]),void 0===_||!_.length||!_[0]){var I=\"\";k=[];for(E in s[v])this.terminals_[E]&&E>2&&k.push(\"'\"+this.terminals_[E]+\"'\");I=h.showPosition?\"Parse error on line \"+(c+1)+\":\\n\"+h.showPosition()+\"\\nExpecting \"+k.join(\", \")+\", got '\"+(this.terminals_[g]||g)+\"'\":\"Parse error on line \"+(c+1)+\": Unexpected \"+(1==g?\"end of input\":\"'\"+(this.terminals_[g]||g)+\"'\"),this.parseError(I,{text:h.match,token:this.terminals_[g]||g,line:h.yylineno,loc:y,expected:k})}if(_[0]instanceof Array&&_.length>1)throw new Error(\"Parse Error: multiple actions possible at state: \"+v+\", token: \"+g);switch(_[0]){case 1:n.push(g),i.push(h.yytext),r.push(h.yylloc),n.push(_[1]),g=null,m?(g=m,m=null):(a=h.yyleng,o=h.yytext,c=h.yylineno,y=h.yylloc,u>0&&u--);break;case 2:if(T=this.productions_[_[1]][1],S.$=i[i.length-T],S._$={first_line:r[r.length-(T||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(T||1)].first_column,last_column:r[r.length-1].last_column},d&&(S._$.range=[r[r.length-(T||1)].range[0],r[r.length-1].range[1]]),void 0!==(b=this.performAction.apply(S,[o,a,c,f.yy,_[1],i,r].concat(l))))return b;T&&(n=n.slice(0,-1*T*2),i=i.slice(0,-1*T),r=r.slice(0,-1*T)),n.push(this.productions_[_[1]][0]),i.push(S.$),r.push(S._$),x=s[n[n.length-2]][n[n.length-1]],n.push(x);break;case 3:return!0}}return!0}};return t.prototype=b,b.Parser=t,new t}();void 0!==t&&void 0!==n&&(n.parser=r,n.Parser=r.Parser,n.parse=function(){return r.parse.apply(r,arguments)},n.main=function(e){e[1]||(console.log(\"Usage: \"+e[0]+\" FILE\"),i.exit(1));var r=t(\"fs\").readFileSync(t(\"path\").normalize(e[1]),\"utf8\");return n.parser.parse(r)},void 0!==e&&t.main===e&&n.main(i.argv.slice(1)))}).call(this,t(\"_process\"))},{_process:10,fs:7,path:9}],6:[function(t,e,n){(function(){\"use strict\";var n,i,r,s,o,c,a,u,l,h,f,p,y,d,g,m,v,_,b,E,T,x,k,A,S;n=t(\"o_0\"),l=new WeakMap,h=new WeakMap,T=function(t){var e;e=h.get(t)||0,h.set(t,e+1)},E=function(t){var e;e=h.get(t)||0,--e>0?h.set(t,e):(h.delete(t),u(t))},u=function(t){var e,n;null!=(e=t.children)&&Array.prototype.forEach.call(e,u),null!=(n=l.get(t))&&n.forEach(function(e){e(),l.delete(t)})},r=function(t,e){var n;(n=l.get(t))?n.push(e):l.set(t,[e])},p=/^on(touch|animation|transition)(start|iteration|move|end|cancel)$/,d=function(t,e){return t.match(p)||t in e},A=function(t,e,n){switch(t.nodeName){case\"SELECT\":t.oninput=t.onchange=function(){var t,n,i;t=(n=this.children[this.selectedIndex]).value,i=n._value,\"function\"==typeof e&&e(i||t)},o(t,e,n,function(e){var n;t._value=e,(n=t._options)?null!=e.value?t.value=(\"function\"==typeof e.value?e.value():void 0)||e.value:t.selectedIndex=S(n,e):t.value=e});break;default:t.oninput=t.onchange=function(){\"function\"==typeof e&&e(t.value)},o(t,e,n,function(e){t.value!==e&&(t.value=e)})}},x={INPUT:{checked:function(t,e,n){return t.onchange=function(){\"function\"==typeof e&&e(t.checked)},o(t,e,n,function(e){t.checked=e})}},SELECT:{options:function(t,e,n){o(t,e,n,function(e){f(t),t._options=e,e.map(function(e,n){var i,r,s;return i=a(\"option\"),i._value=e,s=g(e)?(null!=e?e.value:void 0)||n:e.toString(),o(i,s,e,function(t){i.value=t}),r=(null!=e?e.name:void 0)||e,o(i,r,e,function(t){i.textContent=t}),t.appendChild(i),e===t._value&&(t.selectedIndex=n),i})})}}},v=function(t,e,n,i){var r,c,a;c=t.nodeName,\"value\"===n?A(t,i):(r=null!=(a=x[c])?a[n]:void 0)?r(t,i,e):n.match(/^on/)&&d(n,t)?s(t,n.substr(2),i,e):d(\"on\"+n,t)?s(t,n,i,e):o(t,i,e,function(e){null!=e&&!1!==e?t.setAttribute(n,e):t.removeAttribute(n)})},_=function(t,e,n){c(t,e,n,\"id\",function(e){var n;n=e[e.length-1],t.id=n}),c(t,e,n,\"class\",function(e){t.className=e.join(\" \")}),c(t,e,n,\"style\",function(e){t.style=\"\",e.forEach(function(e){return g(e)?Object.assign(t.style,e):t.style=e})}),Object.keys(n).forEach(function(i){v(t,e,i,n[i])})},o=function(t,e,i,s){var o;o=n(function(){s(y(e,i))}),r(t,o.releaseDependencies)},s=function(t,e,n,i){\"function\"==typeof n&&t.addEventListener(e,n.bind(i))},c=function(t,e,n,i,r){var s;null!=(s=n[i])&&(delete n[i],o(t,function(){return k(s,e)},e,r))},b=function(t,e,n){var r;r=function(e){null==e||(\"function\"==typeof e.forEach?e.forEach(r):e instanceof Node?(T(e),t.appendChild(e)):t.appendChild(document.createTextNode(e)))},o(t,function(){var t;return t=[],n.call(e,{buffer:function(n){t.push(y(n,e))},element:m,filter:function(t,n){return i.filters[t].call(e,n,this)}}),t},e,function(e){f(t),e.forEach(r)})},m=function(t,e,n,i){var r;return r=a(t),_(r,e,n),\"SELECT\"!==r.nodeName&&b(r,e,i),r},(i=function(t){var e;return e={buffer:function(t){if(e.root)throw new Error(\"Cannot have multiple root elements\");e.root=t},element:m,filter:function(e,n){return i.filters[e].call(t,n,this)}}}).Observable=n,i._elementCleaners=l,i._dispose=u,i.retain=T,i.release=E,i.filters={},e.exports=i,a=function(t){return document.createElement(t)},f=function(t){for(var e;e=t.firstChild;)t.removeChild(e),E(e)},g=function(t){return\"object\"==typeof t},S=function(t,e){return g(e)?t.indexOf(e):t.map(function(t){return t.toString()}).indexOf(e.toString())},k=function(t,e){return t.map(function(t){return y(t,e)}).reduce(function(t,e){return t.concat(y(e))},[]).filter(function(t){return null!=t})},y=function(t,e){return\"function\"==typeof t?t.call(e):t}}).call(this)},{o_0:8}],7:[function(t,e,n){},{}],8:[function(t,e,n){(function(t){(function(){\"use strict\";var n,i,r,s,o,c,a,u,l=[].slice;e.exports=function(t,e){var s,h,f,p,y;return\"function\"==typeof(null!=t?t.observe:void 0)?t:(f=[],p=function(t){return i(f).forEach(function(e){return e(t)})},\"function\"==typeof t?(h=t,(y=function(){return o(y),t}).releaseDependencies=function(){var t;return null!=(t=y._observableDependencies)?t.forEach(function(t){return t.stopObserving(s)}):void 0},(s=function(){var n;return n=new Set,t=u(n,h,e),y.releaseDependencies(),y._observableDependencies=n,n.forEach(function(t){return t.observe(s)}),p(t)})()):(y=function(e){return arguments.length>0?t!==e&&(t=e,p(e)):o(y),t}).releaseDependencies=c,Array.isArray(t)&&([\"concat\",\"every\",\"filter\",\"forEach\",\"indexOf\",\"join\",\"lastIndexOf\",\"map\",\"reduce\",\"reduceRight\",\"slice\",\"some\"].forEach(function(e){return y[e]=function(){var n;return n=1<=arguments.length?l.call(arguments,0):[],o(y),t[e].apply(t,n)}}),[\"pop\",\"push\",\"reverse\",\"shift\",\"splice\",\"sort\",\"unshift\"].forEach(function(e){return y[e]=function(){var n,i;return n=1<=arguments.length?l.call(arguments,0):[],i=t[e].apply(t,n),p(t),i}}),n&&Object.defineProperty(y,\"length\",{get:function(){return o(y),t.length},set:function(e){var n;return n=t.length=e,p(t),n}}),r(y,{remove:function(e){var n,i;if((n=t.indexOf(e))>=0)return i=t.splice(n,1)[0],p(t),i},get:function(e){return o(y),t[e]},first:function(){return o(y),t[0]},last:function(){return o(y),t[t.length-1]},size:function(){return o(y),t.length}})),r(y,{listeners:f,observe:function(t){return f.push(t)},stopObserving:function(t){return a(f,t)},toggle:function(){return y(!t)},increment:function(e){return null==e&&(e=1),y(t+e)},decrement:function(e){return null==e&&(e=1),y(t-e)},toString:function(){return\"Observable(\"+t+\")\"}}),y)},r=Object.assign,t.OBSERVABLE_ROOT_HACK=[],o=function(e){var n;if(n=s(t.OBSERVABLE_ROOT_HACK))return n.add(e)},u=function(e,n,i){t.OBSERVABLE_ROOT_HACK.push(e);try{return n.call(i)}finally{t.OBSERVABLE_ROOT_HACK.pop()}},a=function(t,e){var n;if((n=t.indexOf(e))>=0)return t.splice(n,1)[0]},i=function(t){return t.concat([])},s=function(t){return t[t.length-1]},c=function(){};try{Object.defineProperty(function(){},\"length\",{get:c,set:c}),n=!0}catch(t){n=!1}}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],9:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];\".\"===r?t.splice(i,1):\"..\"===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift(\"..\");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var r=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/,s=function(t){return r.exec(t).slice(1)};n.resolve=function(){for(var n=\"\",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:t.cwd();if(\"string\"!=typeof o)throw new TypeError(\"Arguments to path.resolve must be strings\");o&&(n=o+\"/\"+n,r=\"/\"===o.charAt(0))}return n=e(i(n.split(\"/\"),function(t){return!!t}),!r).join(\"/\"),(r?\"/\":\"\")+n||\".\"},n.normalize=function(t){var r=n.isAbsolute(t),s=\"/\"===o(t,-1);return(t=e(i(t.split(\"/\"),function(t){return!!t}),!r).join(\"/\"))||r||(t=\".\"),t&&s&&(t+=\"/\"),(r?\"/\":\"\")+t},n.isAbsolute=function(t){return\"/\"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(i(t,function(t,e){if(\"string\"!=typeof t)throw new TypeError(\"Arguments to path.join must be strings\");return t}).join(\"/\"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&\"\"===t[e];e++);for(var n=t.length-1;n>=0&&\"\"===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var r=i(t.split(\"/\")),s=i(e.split(\"/\")),o=Math.min(r.length,s.length),c=o,a=0;a<o;a++)if(r[a]!==s[a]){c=a;break}for(var u=[],a=c;a<r.length;a++)u.push(\"..\");return(u=u.concat(s.slice(c))).join(\"/\")},n.sep=\"/\",n.delimiter=\":\",n.dirname=function(t){var e=s(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):\".\"},n.basename=function(t,e){var n=s(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return s(t)[3]};var o=\"b\"===\"ab\".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,t(\"_process\"))},{_process:10}],10:[function(t,e,n){function i(){throw new Error(\"setTimeout has not been defined\")}function r(){throw new Error(\"clearTimeout has not been defined\")}function s(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function c(){g&&y&&(g=!1,y.length?d=y.concat(d):m=-1,d.length&&a())}function a(){if(!g){var t=s(c);g=!0;for(var e=d.length;e;){for(y=d,d=[];++m<e;)y&&y[m].run();m=-1,e=d.length}y=null,g=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var h,f,p=e.exports={};!function(){try{h=\"function\"==typeof setTimeout?setTimeout:i}catch(t){h=i}try{f=\"function\"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var y,d=[],g=!1,m=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||g||s(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title=\"browser\",p.browser=!0,p.env={},p.argv=[],p.version=\"\",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(t){throw new Error(\"process.binding is not supported\")},p.cwd=function(){return\"/\"},p.chdir=function(t){throw new Error(\"process.chdir is not supported\")},p.umask=function(){return 0}},{}]},{},[2])(2)});\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/mount-fs.coffee": {
      "path": "lib/mount-fs.coffee",
      "content": "{startsWith} = require \"../util\"\n\nBindable = require \"bindable\"\nModel = require \"model\"\n\nmodule.exports = (I) ->\n  mounts = {}\n  mountPaths = []\n\n  longestToShortest = (a, b) ->\n    b.length - a.length\n\n  findMountPathFor = (path) ->\n    [mountPath] = mountPaths.filter (p) ->\n      startsWith path, p\n\n    return mountPath\n\n  proxyToMount = (method) ->\n    (path, params...) ->\n      mountPath = findMountPathFor path\n\n      if mountPath\n        mount = mounts[mountPath]\n      else\n        throw new Error \"No mounted filesystem for #{path}\"\n\n      subsystemPath = path.replace(mountPath, \"/\")\n\n      if method is \"list\"\n        # Remap paths when retrieving entries\n        mount[method](subsystemPath, params...)\n        .then (entries) ->\n          entries.forEach (entry) ->\n            entry.path = entry.path.replace(\"/\", mountPath)\n\n          return entries\n      else if method is \"read\"\n        mount[method](subsystemPath, params...)\n        .then (blob) ->\n          if blob\n            blob.path = path\n\n            return blob\n      else\n        mount[method](subsystemPath, params...)\n\n  bindSubsystemEvent = (folderPath, subsystem, eventName) ->\n    subsystem.on eventName, (path) ->\n      self.trigger eventName, path.replace(\"/\", folderPath)\n\n  self = Model()\n  .include(Bindable)\n  .extend\n    read: proxyToMount \"read\"\n\n    write: proxyToMount \"write\"\n\n    delete: proxyToMount \"delete\"\n\n    list: proxyToMount \"list\"\n\n    mount: (folderPath, subsystem) ->\n      mounts[folderPath] = subsystem\n      mountPaths.push folderPath\n      mountPaths.sort longestToShortest\n\n      # TODO: Want to be able to pass through all events\n      bindSubsystemEvent(folderPath, subsystem, \"write\")\n      bindSubsystemEvent(folderPath, subsystem, \"update\")\n      bindSubsystemEvent(folderPath, subsystem, \"delete\")\n\n      return self\n\n  return self\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/outbound-clicks.coffee": {
      "path": "lib/outbound-clicks.coffee",
      "content": "{parentElementOfType} = require \"../util\"\n\n# Outbound clicker\ndocument.addEventListener \"click\", (e) ->\n  anchor = parentElementOfType(\"a\", e.target)\n\n  if anchor\n    href = anchor.getAttribute('href')\n\n    if href?.match /^http/\n      e.preventDefault()\n\n      if href.match /frogfeels\\.com/\n        system.Achievement.unlock \"Feeling the frog\"\n\n      window.open href\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/pkg-fs.coffee": {
      "path": "lib/pkg-fs.coffee",
      "content": "Bindable = require \"bindable\"\nModel = require \"model\"\n\nFolderEntry = (path, prefix) ->\n  folder: true\n  path: prefix + path\n  relativePath: path\n\n# Keys in the package's source object don't begin with slashes\nsourcePath = (path) ->\n  path.replace(/^\\//, \"\")\n\n# Strip out extension suffixes\ndistributionPath = (path) ->\n  path.replace(/\\..*$/, \"\")\n\n# FS Wrapper to a pixie package\nmodule.exports = (pkg, persistencePath) ->\n  notify = (eventType, path) ->\n    (result) ->\n      self.trigger eventType, path\n      return result\n\n  persist = ->\n    # Persist entire pkg\n    pkgBlob = new Blob [JSON.stringify(pkg)],\n      type: \"application/json; charset=utf8\"\n    system.writeFile persistencePath, pkgBlob\n\n  compileAndWrite = (path, blob) ->\n    writeSource = blob.readAsText()\n    .then (text) ->\n      srcPath = sourcePath(path)\n      pkg.source[srcPath] =\n        content: text\n        type: blob.type or \"\"\n        path: srcPath\n\n    # Compilers expect blob to be annotated with the path\n    blob.path = path\n\n    writeCompiled = system.compileFile(blob)\n    .then (compiledSource) ->\n      if typeof compiledSource is \"string\"\n        pkg.distribution[distributionPath(sourcePath(path))] =\n          content: compiledSource\n      else\n        console.warn \"Can't package files like #{path} yet\", compiledSource\n\n    Promise.all [writeSource, writeCompiled]\n    .then persist\n\n  self = Model()\n  .include(Bindable)\n  .extend\n    # Read a blob from a path\n    read: (path) ->\n      {content, type} = pkg.source[sourcePath(path)]\n      type ?= \"\"\n\n      blob = new Blob [content],\n        type: type\n\n      Promise.resolve blob\n      .then notify \"read\", path\n\n    # Write a blob to a path\n    write: (path, blob) ->\n      compileAndWrite(path, blob)\n      .then notify \"write\", path\n\n    # Delete a file at a path\n    delete: (path) ->\n      Promise.resolve()\n      .then ->\n        delete pkg.source[sourcePath(path)]\n      .then notify \"delete\", path\n\n    # List files and folders in a directory\n    list: (dir) ->\n      sourceDir = sourcePath(dir)\n\n      Promise.resolve()\n      .then ->\n        Object.keys(pkg.source).filter (path) ->\n          path.indexOf(sourceDir) is 0\n        .map (path) ->\n          path: \"/\" + path\n          relativePath: path.replace(sourceDir, \"\")\n          type: pkg.source[path].type or \"\"\n      .then (files) ->\n        folderPaths = {}\n\n        files = files.filter (file) ->\n          if file.relativePath.match /\\// # folder\n            folderPath = file.relativePath.replace /\\/.*$/, \"/\"\n            folderPaths[folderPath] = true\n            return\n          else\n            return file\n\n        folders = Object.keys(folderPaths).map (folderPath) ->\n          FolderEntry folderPath, dir\n\n        return folders.concat(files)\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/s3-fs.coffee": {
      "path": "lib/s3-fs.coffee",
      "content": "Bindable = require \"bindable\"\nModel = require \"model\"\n\n{pinvoke, startsWith, endsWith} = require \"../util\"\n\ndelimiter = \"/\"\n\n# NOTE: Not scoped for multi-bucket yet\nlocalCache = {}\n\nstatus = (response) ->\n  if response.status >= 200 && response.status < 300\n    return response\n  else\n    throw response\n\njson = (response) ->\n  response.json()\n\nblob = (response) ->\n  response.blob()\n\nuploadToS3 = (bucket, key, file, options={}) ->\n  {cacheControl} = options\n\n  cacheControl ?= 0\n\n  # Optimistically Cache\n  localCache[key] = file\n\n  pinvoke bucket, \"putObject\",\n    Key: key\n    ContentType: file.type\n    Body: file\n    CacheControl: \"max-age=#{cacheControl}\"\n\ngetRemote = (bucket, key) ->\n  cachedItem = localCache[key]\n\n  if cachedItem\n    if cachedItem instanceof Blob\n      return Promise.resolve(cachedItem)\n    else\n      return Promise.reject(cachedItem)\n\n  pinvoke bucket, \"getObject\",\n    Key: key\n  .then (data) ->\n    {Body, ContentType} = data\n\n    new Blob [Body],\n      type: ContentType\n  .then (data) ->\n    localCache[key] = data\n  .catch (e) ->\n    # Cache Not Founds too, since that's often what is slow\n    localCache[key] = e\n    throw e\n\ndeleteFromS3 = (bucket, key) ->\n  localCache[key] = new Error \"Not Found\"\n\n  pinvoke bucket, \"deleteObject\",\n    Key: key\n\nlist = (bucket, id, dir) ->\n  unless startsWith dir, delimiter\n    dir = \"#{delimiter}#{dir}\"\n\n  unless endsWith dir, delimiter\n    dir = \"#{dir}#{delimiter}\"\n\n  prefix = \"#{id}#{dir}\"\n\n  pinvoke bucket, \"listObjects\",\n    Prefix: prefix\n    Delimiter: delimiter\n  .then (result) ->\n    results = result.CommonPrefixes.map (p) ->\n      FolderEntry p.Prefix, id, prefix\n    .concat result.Contents.map (o) ->\n      FileEntry o, id, prefix, bucket\n    .map (entry) ->\n      fetchMeta(entry, bucket)\n\n    Promise.all results\n\nmodule.exports = (id, bucket) ->\n\n  notify = (eventType, path) ->\n    (result) ->\n      self.trigger eventType, path\n      return result\n\n  self = Model()\n  .include Bindable\n  .extend\n    read: (path) ->\n      unless startsWith path, delimiter\n        path = delimiter + path\n\n      key = \"#{id}#{path}\"\n\n      getRemote(bucket, key)\n      .then notify \"read\", path\n\n    write: (path, blob) ->\n      unless startsWith path, delimiter\n        path = delimiter + path\n\n      key = \"#{id}#{path}\"\n\n      uploadToS3 bucket, key, blob\n      .then notify \"write\", path\n\n    delete: (path) ->\n      unless startsWith path, delimiter\n        path = delimiter + path\n\n      key = \"#{id}#{path}\"\n\n      deleteFromS3 bucket, key\n      .then notify \"delete\", path\n\n    list: (folderPath=\"/\") ->\n      list bucket, id, folderPath\n\nfetchFileMeta = (fileEntry, bucket) ->\n  pinvoke bucket, \"headObject\",\n    Key: fileEntry.remotePath\n  .then (result) ->\n    fileEntry.type = result.ContentType\n\n    fileEntry\n\nfetchMeta = (entry, bucket) ->\n  Promise.resolve()\n  .then ->\n    return entry if entry.folder\n\n    fetchFileMeta entry, bucket\n\nFolderEntry = (path, id, prefix) ->\n  folder: true\n  path: path.replace(id, \"\")\n  relativePath: path.replace(prefix, \"\")\n  remotePath: path\n\nFileEntry = (object, id, prefix, bucket) ->\n  path = object.Key\n\n  entry =\n    path: path.replace(id, \"\")\n    relativePath: path.replace(prefix, \"\")\n    remotePath: path\n    size: object.Size\n\n  entry.blob = BlobSham(entry, bucket)\n\n  return entry\n\nBlobSham = (entry, bucket) ->\n  remotePath = entry.remotePath\n\n  getURL: ->\n    getRemote(bucket, remotePath)\n    .then URL.createObjectURL\n  readAsText: ->\n    getRemote(bucket, remotePath)\n    .then (blob) ->\n      blob.readAsText()\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/stylus.min.js": {
      "path": "lib/stylus.min.js",
      "content": "if(Function.prototype.name===undefined&&Object.defineProperty!==undefined){Object.defineProperty(Function.prototype,\"name\",{get:function(){var regex=/function\\s([^(]{1,})\\(/,match=regex.exec(this.toString());return match&&match.length>1?match[1].trim():\"\"}})}if(String.prototype.trimRight===undefined){String.prototype.trimRight=function(){return String(this).replace(/\\s+$/,\"\")}}var stylus=module.exports=function(){function require(p){var path=require.resolve(p),mod=require.modules[path];if(!mod)throw new Error('failed to require \"'+p+'\"');if(!mod.exports){mod.exports={};mod.call(mod.exports,mod,mod.exports,require.relative(path))}return mod.exports}var bifs=\"called-from = ()\\n\\nvendors = moz webkit o ms official\\n\\n// stringify the given arg\\n\\n-string(arg)\\n  type(arg) + ' ' + arg\\n\\n// require a color\\n\\nrequire-color(color)\\n  unless color is a 'color'\\n    error('RGB or HSL value expected, got a ' + -string(color))\\n\\n// require a unit\\n\\nrequire-unit(n)\\n  unless n is a 'unit'\\n    error('unit expected, got a ' + -string(n))\\n\\n// require a string\\n\\nrequire-string(str)\\n  unless str is a 'string' or str is a 'ident'\\n    error('string expected, got a ' + -string(str))\\n\\n// Math functions\\n\\nabs(n) { math(n, 'abs') }\\nmin(a, b) { a < b ? a : b }\\nmax(a, b) { a > b ? a : b }\\n\\n// Trigonometrics\\nPI = -math-prop('PI')\\n\\nradians-to-degrees(angle)\\n  angle * (180 / PI)\\n\\ndegrees-to-radians(angle)\\n  unit(angle * (PI / 180),'')\\n\\nsin(n)\\n  n = degrees-to-radians(n) if unit(n) == 'deg'\\n  round(math(n, 'sin'), 9)\\n\\ncos(n)\\n  n = degrees-to-radians(n) if unit(n) == 'deg'\\n  round(math(n, 'cos'), 9)\\n\\n// Rounding Math functions\\n\\nceil(n, precision = 0)\\n  multiplier = 10 ** precision\\n  math(n * multiplier, 'ceil') / multiplier\\n\\nfloor(n, precision = 0)\\n  multiplier = 10 ** precision\\n  math(n * multiplier, 'floor') / multiplier\\n\\nround(n, precision = 0)\\n  multiplier = 10 ** precision\\n  math(n * multiplier, 'round') / multiplier\\n\\n// return the sum of the given numbers\\n\\nsum(nums)\\n  sum = 0\\n  sum += n for n in nums\\n\\n// return the average of the given numbers\\n\\navg(nums)\\n  sum(nums) / length(nums)\\n\\n// return a unitless number, or pass through\\n\\nremove-unit(n)\\n  if typeof(n) is 'unit'\\n    unit(n, '')\\n  else\\n    n\\n\\n// convert a percent to a decimal, or pass through\\n\\npercent-to-decimal(n)\\n  if unit(n) is '%'\\n    remove-unit(n) / 100\\n  else\\n    n\\n\\n// check if n is an odd number\\n\\nodd(n)\\n  1 == n % 2\\n\\n// check if n is an even number\\n\\neven(n)\\n  0 == n % 2\\n\\n// check if color is light\\n\\nlight(color)\\n  lightness(color) >= 50%\\n\\n// check if color is dark\\n\\ndark(color)\\n  lightness(color) < 50%\\n\\n// desaturate color by amount\\n\\ndesaturate(color, amount)\\n  adjust(color, 'saturation', - amount)\\n\\n// saturate color by amount\\n\\nsaturate(color = '', amount = 100%)\\n  if color is a 'color'\\n    adjust(color, 'saturation', amount)\\n  else\\n    unquote( 'saturate(' + color + ')' )\\n\\n// darken by the given amount\\n\\ndarken(color, amount)\\n  adjust(color, 'lightness', - amount)\\n\\n// lighten by the given amount\\n\\nlighten(color, amount)\\n  adjust(color, 'lightness', amount)\\n\\n// decrease opacity by amount\\n\\nfade-out(color, amount)\\n  color - rgba(black, percent-to-decimal(amount))\\n\\n// increase opacity by amount\\n\\nfade-in(color, amount)\\n  color + rgba(black, percent-to-decimal(amount))\\n\\n// spin hue by a given amount\\n\\nspin(color, amount)\\n  color + unit(amount, deg)\\n\\n// mix two colors by a given amount\\n\\nmix(color1, color2, weight = 50%)\\n  unless weight in 0..100\\n    error('Weight must be between 0% and 100%')\\n\\n  if length(color1) == 2\\n    weight = color1[0]\\n    color1 = color1[1]\\n\\n  else if length(color2) == 2\\n    weight = 100 - color2[0]\\n    color2 = color2[1]\\n\\n  require-color(color1)\\n  require-color(color2)\\n\\n  p = unit(weight / 100, '')\\n  w = p * 2 - 1\\n\\n  a = alpha(color1) - alpha(color2)\\n\\n  w1 = (((w * a == -1) ? w : (w + a) / (1 + w * a)) + 1) / 2\\n  w2 = 1 - w1\\n\\n  channels = (red(color1) red(color2)) (green(color1) green(color2)) (blue(color1) blue(color2))\\n  rgb = ()\\n\\n  for pair in channels\\n    push(rgb, floor(pair[0] * w1 + pair[1] * w2))\\n\\n  a1 = alpha(color1) * p\\n  a2 = alpha(color2) * (1 - p)\\n  alpha = a1 + a2\\n\\n  rgba(rgb[0], rgb[1], rgb[2], alpha)\\n\\n// invert colors, leave alpha intact\\n\\ninvert(color = '')\\n  if color is a 'color'\\n    rgba(#fff - color, alpha(color))\\n  else\\n    unquote( 'invert(' + color + ')' )\\n\\n// give complement of the given color\\n\\ncomplement( color )\\n  spin( color, 180 )\\n\\n// give grayscale of the given color\\n\\ngrayscale( color = '' )\\n  if color is a 'color'\\n    desaturate( color, 100% )\\n  else\\n    unquote( 'grayscale(' + color + ')' )\\n\\n// mix the given color with white\\n\\ntint( color, percent )\\n  mix( white, color, percent )\\n\\n// mix the given color with black\\n\\nshade( color, percent )\\n  mix( black, color, percent )\\n\\n// return the last value in the given expr\\n\\nlast(expr)\\n  expr[length(expr) - 1]\\n\\n// return keys in the given pairs or object\\n\\nkeys(pairs)\\n  ret = ()\\n  if type(pairs) == 'object'\\n    for key in pairs\\n      push(ret, key)\\n  else\\n    for pair in pairs\\n      push(ret, pair[0]);\\n  ret\\n\\n// return values in the given pairs or object\\n\\nvalues(pairs)\\n  ret = ()\\n  if type(pairs) == 'object'\\n    for key, val in pairs\\n      push(ret, val)\\n  else\\n    for pair in pairs\\n      push(ret, pair[1]);\\n  ret\\n\\n// join values with the given delimiter\\n\\njoin(delim, vals...)\\n  buf = ''\\n  vals = vals[0] if length(vals) == 1\\n  for val, i in vals\\n    buf += i ? delim + val : val\\n\\n// add a CSS rule to the containing block\\n\\n// - This definition allows add-property to be used as a mixin\\n// - It has the same effect as interpolation but allows users\\n//   to opt for a functional style\\n\\nadd-property-function = add-property\\nadd-property(name, expr)\\n  if mixin\\n    {name} expr\\n  else\\n    add-property-function(name, expr)\\n\\nprefix-classes(prefix)\\n  -prefix-classes(prefix, block)\\n\\n// Caching mixin, use inside your functions to enable caching by extending.\\n\\n$stylus_mixin_cache = {}\\ncache()\\n  $key = (current-media() or 'no-media') + '__' + called-from[0] + '__' + arguments\\n  if $key in $stylus_mixin_cache\\n    @extend {'$cache_placeholder_for_' + $stylus_mixin_cache[$key]}\\n  else if 'cache' in called-from\\n    {block}\\n  else\\n    $id = length($stylus_mixin_cache)\\n\\n    &,\\n    /$cache_placeholder_for_{$id}\\n      $stylus_mixin_cache[$key] = $id\\n      {block}\\n\";require.modules={};require.resolve=function(path){var orig=path,reg=path+\".js\",index=path+\"/index.js\";return require.modules[reg]&&reg||require.modules[index]&&index||orig};require.register=function(path,fn){require.modules[path]=fn};require.relative=function(parent){return function(p){if(\".\"!=p[0])return require(p);var path=parent.split(\"/\"),segs=p.split(\"/\");path.pop();for(var i=0;i<segs.length;i++){var seg=segs[i];if(\"..\"==seg)path.pop();else if(\".\"!=seg)path.push(seg)}return require(path.join(\"/\"))}};require.register(\"path.js\",function(module,exports,require){var isWindows=false;function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==\".\"){parts.splice(i,1)}else if(last===\"..\"){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift(\"..\")}}return parts}var splitPathRe=/^([\\s\\S]+\\/(?!$)|\\/)?((?:[\\s\\S]+?)?(\\.[^.]*)?)$/;exports.normalize=function(path){var isAbsolute=path.charAt(0)===\"/\",trailingSlash=path.slice(-1)===\"/\";path=normalizeArray(path.split(\"/\").filter(function(p){return!!p}),!isAbsolute).join(\"/\");if(!path&&!isAbsolute){path=\".\"}if(path&&trailingSlash){path+=\"/\"}return(isAbsolute?\"/\":\"\")+path};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(paths.filter(function(p,index){return p&&typeof p===\"string\"}).join(\"/\"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!==\"\")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!==\"\")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split(\"/\"));var toParts=trim(to.split(\"/\"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push(\"..\")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join(\"/\")};exports.dirname=function(path){var dir=splitPathRe.exec(path)[1]||\"\";if(!dir){return\".\"}else if(dir.length===1||isWindows&&dir.length<=3&&dir.charAt(1)===\":\"){return dir}else{return dir.substring(0,dir.length-1)}};exports.basename=function(path,ext){var f=splitPathRe.exec(path)[2]||\"\";if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){return splitPathRe.exec(path)[3]||\"\"}});require.register(\"colors.js\",function(module,exports,require){module.exports={aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],transparent:[0,0,0,0],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1],rebeccapurple:[102,51,153,1]}});require.register(\"errors.js\",function(module,exports,require){exports.ParseError=ParseError;exports.SyntaxError=SyntaxError;SyntaxError.prototype.__proto__=Error.prototype;function ParseError(msg){this.name=\"ParseError\";this.message=msg;Error.captureStackTrace(this,ParseError)}ParseError.prototype.__proto__=Error.prototype;function SyntaxError(msg){this.name=\"SyntaxError\";this.message=msg;Error.captureStackTrace(this,ParseError)}SyntaxError.prototype.__proto__=Error.prototype});require.register(\"units.js\",function(module,exports,require){module.exports=[\"em\",\"ex\",\"ch\",\"rem\",\"vw\",\"vh\",\"vmin\",\"vmax\",\"cm\",\"mm\",\"in\",\"pt\",\"pc\",\"px\",\"deg\",\"grad\",\"rad\",\"turn\",\"s\",\"ms\",\"Hz\",\"kHz\",\"dpi\",\"dpcm\",\"dppx\",\"x\",\"%\",\"fr\"]});require.register(\"functions/index.js\",function(module,exports,require){exports[\"add-property\"]=require(\"./add-property\");exports.adjust=require(\"./adjust\");exports.alpha=require(\"./alpha\");exports[\"base-convert\"]=require(\"./base-convert\");exports.basename=require(\"./basename\");exports.blend=require(\"./blend\");exports.blue=require(\"./blue\");exports.clone=require(\"./clone\");exports.component=require(\"./component\");exports.contrast=require(\"./contrast\");exports.convert=require(\"./convert\");exports[\"current-media\"]=require(\"./current-media\");exports.define=require(\"./define\");exports.dirname=require(\"./dirname\");exports.error=require(\"./error\");exports.extname=require(\"./extname\");exports.green=require(\"./green\");exports.hsl=require(\"./hsl\");exports.hsla=require(\"./hsla\");exports.hue=require(\"./hue\");exports.length=require(\"./length\");exports.lightness=require(\"./lightness\");exports[\"list-separator\"]=require(\"./list-separator\");exports.lookup=require(\"./lookup\");exports.luminosity=require(\"./luminosity\");exports.match=require(\"./match\");exports.math=require(\"./math\");exports.merge=exports.extend=require(\"./merge\");exports.operate=require(\"./operate\");exports[\"opposite-position\"]=require(\"./opposite-position\");exports.p=require(\"./p\");exports.pathjoin=require(\"./pathjoin\");exports.pop=require(\"./pop\");exports.push=exports.append=require(\"./push\");exports.range=require(\"./range\");exports.red=require(\"./red\");exports.remove=require(\"./remove\");exports.replace=require(\"./replace\");exports.rgb=require(\"./rgb\");exports.rgba=require(\"./rgba\");exports.s=require(\"./s\");exports.saturation=require(\"./saturation\");exports[\"selector-exists\"]=require(\"./selector-exists\");exports.selector=require(\"./selector\");exports.selectors=require(\"./selectors\");exports.shift=require(\"./shift\");exports.split=require(\"./split\");exports.substr=require(\"./substr\");exports.tan=require(\"./tan\");exports.trace=require(\"./trace\");exports.transparentify=require(\"./transparentify\");exports.type=exports.typeof=exports[\"type-of\"]=require(\"./type\");exports.unit=require(\"./unit\");exports.unquote=require(\"./unquote\");exports.unshift=exports.prepend=require(\"./unshift\");exports.warn=require(\"./warn\");exports[\"-math-prop\"]=require(\"./math-prop\");exports[\"-prefix-classes\"]=require(\"./prefix-classes\")});require.register(\"functions/url.js\",function(module,exports,require){var Compiler=require(\"../visitor/compiler\"),events=require(\"../renderer\").events,nodes=require(\"../nodes\"),extname=require(\"../path\").extname,utils=require(\"../utils\");var defaultMimes={\".gif\":\"image/gif\",\".png\":\"image/png\",\".jpg\":\"image/jpeg\",\".jpeg\":\"image/jpeg\",\".svg\":\"image/svg+xml\",\".webp\":\"image/webp\",\".ttf\":\"application/x-font-ttf\",\".eot\":\"application/vnd.ms-fontobject\",\".woff\":\"application/font-woff\",\".woff2\":\"application/font-woff2\"};module.exports=function(options){options=options||{};var _paths=options.paths||[];var sizeLimit=null!=options.limit?options.limit:3e4;var mimes=options.mimes||defaultMimes;function fn(url){var compiler=new Compiler(url);compiler.isURL=true;url=url.nodes.map(function(node){return compiler.visit(node)}).join(\"\");url=parse(url);var ext=extname(url.pathname),mime=mimes[ext],hash=url.hash||\"\",literal=new nodes.Literal('url(\"'+url.href+'\")'),paths=_paths.concat(this.paths),buf;if(!mime)return literal;if(url.protocol)return literal;var found=utils.lookup(url.pathname,paths);if(!found){events.emit(\"file not found\",\"File \"+literal+\" could not be found, literal url retained!\");return literal}buf=fs.readFileSync(found);if(false!==sizeLimit&&buf.length>sizeLimit)return literal;return new nodes.Literal('url(\"data:'+mime+\";base64,\"+buf.toString(\"base64\")+hash+'\")')}fn.raw=true;return fn};module.exports.mimes=defaultMimes});require.register(\"functions/add-property.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function addProperty(name,expr){utils.assertType(name,\"expression\",\"name\");name=utils.unwrap(name).first;utils.assertString(name,\"name\");utils.assertType(expr,\"expression\",\"expr\");var prop=new nodes.Property([name],expr);var block=this.closestBlock;var len=block.nodes.length,head=block.nodes.slice(0,block.index),tail=block.nodes.slice(block.index++,len);head.push(prop);block.nodes=head.concat(tail);return prop}).raw=true});require.register(\"functions/adjust.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function adjust(color,prop,amount){utils.assertColor(color,\"color\");utils.assertString(prop,\"prop\");utils.assertType(amount,\"unit\",\"amount\");var hsl=color.hsla.clone();prop={hue:\"h\",saturation:\"s\",lightness:\"l\"}[prop.string];if(!prop)throw new Error(\"invalid adjustment property\");var val=amount.val;if(\"%\"==amount.type){val=\"l\"==prop&&val>0?(100-hsl[prop])*val/100:hsl[prop]*(val/100)}hsl[prop]+=val;return hsl.rgba}});require.register(\"functions/alpha.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function alpha(color,value){color=color.rgba;if(value){return rgba(new nodes.Unit(color.r),new nodes.Unit(color.g),new nodes.Unit(color.b),value)}return new nodes.Unit(color.a,\"\")}});require.register(\"functions/base-convert.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function(num,base,width){utils.assertPresent(num,\"number\");utils.assertPresent(base,\"base\");num=utils.unwrap(num).nodes[0].val;base=utils.unwrap(base).nodes[0].val;width=width&&utils.unwrap(width).nodes[0].val||2;var result=Number(num).toString(base);while(result.length<width){result=\"0\"+result}return new nodes.Literal(result)}).raw=true});require.register(\"functions/basename.js\",function(module,exports,require){var utils=require(\"../utils\"),path=require(\"../path\");module.exports=function basename(p,ext){utils.assertString(p,\"path\");return path.basename(p.val,ext&&ext.val)}});require.register(\"functions/blend.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function blend(top,bottom){utils.assertColor(top);top=top.rgba;bottom=bottom||new nodes.RGBA(255,255,255,1);utils.assertColor(bottom);bottom=bottom.rgba;return new nodes.RGBA(top.r*top.a+bottom.r*(1-top.a),top.g*top.a+bottom.g*(1-top.a),top.b*top.a+bottom.b*(1-top.a),top.a+bottom.a-top.a*bottom.a)}});require.register(\"functions/blue.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function blue(color,value){color=color.rgba;if(value){return rgba(new nodes.Unit(color.r),new nodes.Unit(color.g),value,new nodes.Unit(color.a))}return new nodes.Unit(color.b,\"\")}});require.register(\"functions/clone.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function clone(expr){utils.assertPresent(expr,\"expr\");return expr.clone()}).raw=true});require.register(\"functions/component.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");var componentMap={red:\"r\",green:\"g\",blue:\"b\",alpha:\"a\",hue:\"h\",saturation:\"s\",lightness:\"l\"};var unitMap={hue:\"deg\",saturation:\"%\",lightness:\"%\"};var typeMap={red:\"rgba\",blue:\"rgba\",green:\"rgba\",alpha:\"rgba\",hue:\"hsla\",saturation:\"hsla\",lightness:\"hsla\"};module.exports=function component(color,name){utils.assertColor(color,\"color\");utils.assertString(name,\"name\");var name=name.string,unit=unitMap[name],type=typeMap[name],name=componentMap[name];if(!name)throw new Error('invalid color component \"'+name+'\"');return new nodes.Unit(color[type][name],unit)}});require.register(\"functions/contrast.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),blend=require(\"./blend\"),luminosity=require(\"./luminosity\");module.exports=function contrast(top,bottom){if(\"rgba\"!=top.nodeName&&\"hsla\"!=top.nodeName){return new nodes.Literal(\"contrast(\"+(top.isNull?\"\":top.toString())+\")\")}var result=new nodes.Object;top=top.rgba;bottom=bottom||new nodes.RGBA(255,255,255,1);utils.assertColor(bottom);bottom=bottom.rgba;function contrast(top,bottom){if(1>top.a){top=blend(top,bottom)}var l1=luminosity(bottom).val+.05,l2=luminosity(top).val+.05,ratio=l1/l2;if(l2>l1){ratio=1/ratio}return Math.round(ratio*10)/10}if(1<=bottom.a){var resultRatio=new nodes.Unit(contrast(top,bottom));result.set(\"ratio\",resultRatio);result.set(\"error\",new nodes.Unit(0));result.set(\"min\",resultRatio);result.set(\"max\",resultRatio)}else{var onBlack=contrast(top,blend(bottom,new nodes.RGBA(0,0,0,1))),onWhite=contrast(top,blend(bottom,new nodes.RGBA(255,255,255,1))),max=Math.max(onBlack,onWhite);function processChannel(topChannel,bottomChannel){return Math.min(Math.max(0,(topChannel-bottomChannel*bottom.a)/(1-bottom.a)),255)}var closest=new nodes.RGBA(processChannel(top.r,bottom.r),processChannel(top.g,bottom.g),processChannel(top.b,bottom.b),1);var min=contrast(top,blend(bottom,closest));result.set(\"ratio\",new nodes.Unit(Math.round((min+max)*50)/100));result.set(\"error\",new nodes.Unit(Math.round((max-min)*50)/100));result.set(\"min\",new nodes.Unit(min));result.set(\"max\",new nodes.Unit(max))}return result}});require.register(\"functions/convert.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function convert(str){utils.assertString(str,\"str\");return utils.parseString(str.string)}});require.register(\"functions/current-media.js\",function(module,exports,require){var nodes=require(\"../nodes\");module.exports=function currentMedia(){return new nodes.String(lookForMedia(this.closestBlock.node)||\"\");function lookForMedia(node){if(\"media\"==node.nodeName){return node.toString()}else if(node.block.parent.node){return lookForMedia(node.block.parent.node)}}}});require.register(\"functions/define.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function define(name,expr){utils.assertType(name,\"string\",\"name\");expr=utils.unwrap(expr);var scope=this.currentScope;var node=new nodes.Ident(name.val,expr);scope.add(node);return nodes.nil}});require.register(\"functions/dirname.js\",function(module,exports,require){var utils=require(\"../utils\"),path=require(\"../path\");module.exports=function dirname(p){utils.assertString(p,\"path\");return path.dirname(p.val).replace(/\\\\/g,\"/\")}});require.register(\"functions/error.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function error(msg){utils.assertType(msg,\"string\",\"msg\");var err=new Error(msg.val);err.fromStylus=true;throw err}});require.register(\"functions/extname.js\",function(module,exports,require){var utils=require(\"../utils\"),path=require(\"../path\");module.exports=function extname(p){utils.assertString(p,\"path\");return path.extname(p.val)}});require.register(\"functions/green.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function green(color,value){color=color.rgba;if(value){return rgba(new nodes.Unit(color.r),value,new nodes.Unit(color.b),new nodes.Unit(color.a))}return new nodes.Unit(color.g,\"\")}});require.register(\"functions/hsl.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),hsla=require(\"./hsla\");module.exports=function hsl(hue,saturation,lightness){if(1==arguments.length){utils.assertColor(hue,\"color\");return hue.hsla}else{return hsla(hue,saturation,lightness,new nodes.Unit(1))}}});require.register(\"functions/hsla.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function hsla(hue,saturation,lightness,alpha){switch(arguments.length){case 1:utils.assertColor(hue);return hue.hsla;case 2:utils.assertColor(hue);var color=hue.hsla;utils.assertType(saturation,\"unit\",\"alpha\");var alpha=saturation.clone();if(\"%\"==alpha.type)alpha.val/=100;return new nodes.HSLA(color.h,color.s,color.l,alpha.val);default:utils.assertType(hue,\"unit\",\"hue\");utils.assertType(saturation,\"unit\",\"saturation\");utils.assertType(lightness,\"unit\",\"lightness\");utils.assertType(alpha,\"unit\",\"alpha\");var alpha=alpha.clone();if(alpha&&\"%\"==alpha.type)alpha.val/=100;return new nodes.HSLA(hue.val,saturation.val,lightness.val,alpha.val)}}});require.register(\"functions/hue.js\",function(module,exports,require){var nodes=require(\"../nodes\"),hsla=require(\"./hsla\"),component=require(\"./component\");module.exports=function hue(color,value){if(value){var hslaColor=color.hsla;return hsla(value,new nodes.Unit(hslaColor.s),new nodes.Unit(hslaColor.l),new nodes.Unit(hslaColor.a))}return component(color,new nodes.String(\"hue\"))}});require.register(\"functions/length.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function length(expr){if(expr){if(expr.nodes){var nodes=utils.unwrap(expr).nodes;if(1==nodes.length&&\"object\"==nodes[0].nodeName){return nodes[0].length}else{return nodes.length}}else{return 1}}return 0}).raw=true});require.register(\"functions/lightness.js\",function(module,exports,require){var nodes=require(\"../nodes\"),hsla=require(\"./hsla\"),component=require(\"./component\");module.exports=function lightness(color,value){if(value){var hslaColor=color.hsla;return hsla(new nodes.Unit(hslaColor.h),new nodes.Unit(hslaColor.s),value,new nodes.Unit(hslaColor.a))}return component(color,new nodes.String(\"lightness\"))}});require.register(\"functions/list-separator.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function listSeparator(list){list=utils.unwrap(list);return new nodes.String(list.isList?\",\":\" \")}).raw=true});require.register(\"functions/lookup.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function lookup(name){utils.assertType(name,\"string\",\"name\");var node=this.lookup(name.val);if(!node)return nodes.nil;return this.visit(node)}});require.register(\"functions/luminosity.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function luminosity(color){utils.assertColor(color);color=color.rgba;function processChannel(channel){channel=channel/255;return.03928>channel?channel/12.92:Math.pow((channel+.055)/1.055,2.4)}return new nodes.Unit(.2126*processChannel(color.r)+.7152*processChannel(color.g)+.0722*processChannel(color.b))}});require.register(\"functions/match.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function match(pattern,val){utils.assertType(pattern,\"string\",\"pattern\");utils.assertString(val,\"val\");var re=new RegExp(pattern.val);return new nodes.Boolean(re.test(val.string))}});require.register(\"functions/math-prop.js\",function(module,exports,require){var nodes=require(\"../nodes\");module.exports=function math(prop){return new nodes.Unit(Math[prop.string])}});require.register(\"functions/math.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function math(n,fn){utils.assertType(n,\"unit\",\"n\");utils.assertString(fn,\"fn\");return new nodes.Unit(Math[fn.string](n.val),n.type)}});require.register(\"functions/merge.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function merge(dest){utils.assertPresent(dest,\"dest\");dest=utils.unwrap(dest).first;utils.assertType(dest,\"object\",\"dest\");var last=utils.unwrap(arguments[arguments.length-1]).first,deep=true===last.val;for(var i=1,len=arguments.length-deep;i<len;++i){utils.merge(dest.vals,utils.unwrap(arguments[i]).first.vals,deep)}return dest}).raw=true});require.register(\"functions/operate.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function operate(op,left,right){utils.assertType(op,\"string\",\"op\");utils.assertPresent(left,\"left\");utils.assertPresent(right,\"right\");return left.operate(op.val,right)}});require.register(\"functions/opposite-position.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function oppositePosition(positions){var expr=[];utils.unwrap(positions).nodes.forEach(function(pos,i){utils.assertString(pos,\"position \"+i);pos=function(){switch(pos.string){case\"top\":return\"bottom\";case\"bottom\":return\"top\";case\"left\":return\"right\";case\"right\":return\"left\";case\"center\":return\"center\";default:throw new Error(\"invalid position \"+pos)}}();expr.push(new nodes.Literal(pos))});return expr}).raw=true});require.register(\"functions/p.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function p(){[].slice.call(arguments).forEach(function(expr){expr=utils.unwrap(expr);if(!expr.nodes.length)return;console.log(\"\u001b[90minspect:\u001b[0m %s\",expr.toString().replace(/^\\(|\\)$/g,\"\"))});return nodes.nil}).raw=true});require.register(\"functions/pathjoin.js\",function(module,exports,require){var path=require(\"../path\");(module.exports=function pathjoin(){var paths=[].slice.call(arguments).map(function(path){return path.first.string});return path.join.apply(null,paths).replace(/\\\\/g,\"/\")}).raw=true});require.register(\"functions/pop.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function pop(expr){expr=utils.unwrap(expr);return expr.nodes.pop()}).raw=true});require.register(\"functions/prefix-classes.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function prefixClasses(prefix,block){utils.assertString(prefix,\"prefix\");utils.assertType(block,\"block\",\"block\");var _prefix=this.prefix;this.options.prefix=this.prefix=prefix.string;block=this.visit(block);this.options.prefix=this.prefix=_prefix;return block}});require.register(\"functions/push.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function(expr){expr=utils.unwrap(expr);for(var i=1,len=arguments.length;i<len;++i){expr.nodes.push(utils.unwrap(arguments[i]).clone())}return expr.nodes.length}).raw=true});require.register(\"functions/range.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function range(start,stop,step){utils.assertType(start,\"unit\",\"start\");utils.assertType(stop,\"unit\",\"stop\");if(step){utils.assertType(step,\"unit\",\"step\");if(0==step.val){throw new Error('ArgumentError: \"step\" argument must not be zero')}}else{step=new nodes.Unit(1)}var list=new nodes.Expression;for(var i=start.val;i<=stop.val;i+=step.val){list.push(new nodes.Unit(i,start.type))\n}return list}});require.register(\"functions/red.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function red(color,value){color=color.rgba;if(value){return rgba(value,new nodes.Unit(color.g),new nodes.Unit(color.b),new nodes.Unit(color.a))}return new nodes.Unit(color.r,\"\")}});require.register(\"functions/remove.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function remove(object,key){utils.assertType(object,\"object\",\"object\");utils.assertString(key,\"key\");delete object.vals[key.string];return object}});require.register(\"functions/replace.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function replace(pattern,replacement,val){utils.assertString(pattern,\"pattern\");utils.assertString(replacement,\"replacement\");utils.assertString(val,\"val\");pattern=new RegExp(pattern.string,\"g\");var res=val.string.replace(pattern,replacement.string);return val instanceof nodes.Ident?new nodes.Ident(res):new nodes.String(res)}});require.register(\"functions/rgb.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function rgb(red,green,blue){switch(arguments.length){case 1:utils.assertColor(red);var color=red.rgba;return new nodes.RGBA(color.r,color.g,color.b,1);default:return rgba(red,green,blue,new nodes.Unit(1))}}});require.register(\"functions/rgba.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function rgba(red,green,blue,alpha){switch(arguments.length){case 1:utils.assertColor(red);return red.rgba;case 2:utils.assertColor(red);var color=red.rgba;utils.assertType(green,\"unit\",\"alpha\");alpha=green.clone();if(\"%\"==alpha.type)alpha.val/=100;return new nodes.RGBA(color.r,color.g,color.b,alpha.val);default:utils.assertType(red,\"unit\",\"red\");utils.assertType(green,\"unit\",\"green\");utils.assertType(blue,\"unit\",\"blue\");utils.assertType(alpha,\"unit\",\"alpha\");var r=\"%\"==red.type?Math.round(red.val*2.55):red.val,g=\"%\"==green.type?Math.round(green.val*2.55):green.val,b=\"%\"==blue.type?Math.round(blue.val*2.55):blue.val;alpha=alpha.clone();if(alpha&&\"%\"==alpha.type)alpha.val/=100;return new nodes.RGBA(r,g,b,alpha.val)}}});require.register(\"functions/s.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),Compiler=require(\"../visitor/compiler\");(module.exports=function s(fmt){fmt=utils.unwrap(fmt).nodes[0];utils.assertString(fmt);var self=this,str=fmt.string,args=arguments,i=1;str=str.replace(/%(s|d)/g,function(_,specifier){var arg=args[i++]||nodes.nil;switch(specifier){case\"s\":return new Compiler(arg,self.options).compile();case\"d\":arg=utils.unwrap(arg).first;if(\"unit\"!=arg.nodeName)throw new Error(\"%d requires a unit\");return arg.val}});return new nodes.Literal(str)}).raw=true});require.register(\"functions/saturation.js\",function(module,exports,require){var nodes=require(\"../nodes\"),hsla=require(\"./hsla\"),component=require(\"./component\");module.exports=function saturation(color,value){if(value){var hslaColor=color.hsla;return hsla(new nodes.Unit(hslaColor.h),value,new nodes.Unit(hslaColor.l),new nodes.Unit(hslaColor.a))}return component(color,new nodes.String(\"saturation\"))}});require.register(\"functions/selector-exists.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function selectorExists(sel){utils.assertString(sel,\"selector\");if(!this.__selectorsMap__){var Normalizer=require(\"../visitor/normalizer\"),visitor=new Normalizer(this.root.clone());visitor.visit(visitor.root);this.__selectorsMap__=visitor.map}return sel.string in this.__selectorsMap__}});require.register(\"functions/selector.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function selector(){var stack=this.selectorStack,args=[].slice.call(arguments);if(1==args.length){var expr=utils.unwrap(args[0]),len=expr.nodes.length;if(1==len){utils.assertString(expr.first,\"selector\");var SelectorParser=require(\"../selector-parser\"),val=expr.first.string,parsed=new SelectorParser(val).parse().val;if(parsed==val)return val;stack.push(parse(val))}else if(len>1){if(expr.isList){pushToStack(expr.nodes,stack)}else{stack.push(parse(expr.nodes.map(function(node){utils.assertString(node,\"selector\");return node.string}).join(\" \")))}}}else if(args.length>1){pushToStack(args,stack)}return stack.length?utils.compileSelectors(stack).join(\",\"):\"&\"}).raw=true;function pushToStack(selectors,stack){selectors.forEach(function(sel){sel=sel.first;utils.assertString(sel,\"selector\");stack.push(parse(sel.string))})}function parse(selector){var Parser=new require(\"../parser\"),parser=new Parser(selector),nodes;parser.state.push(\"selector-parts\");nodes=parser.selector();nodes.forEach(function(node){node.val=node.segments.map(function(seg){return seg.toString()}).join(\"\")});return nodes}});require.register(\"functions/selectors.js\",function(module,exports,require){var nodes=require(\"../nodes\"),Parser=require(\"../selector-parser\");module.exports=function selectors(){var stack=this.selectorStack,expr=new nodes.Expression(true);if(stack.length){for(var i=0;i<stack.length;i++){var group=stack[i],nested;if(group.length>1){expr.push(new nodes.String(group.map(function(selector){nested=new Parser(selector.val).parse().nested;return(nested&&i?\"& \":\"\")+selector.val}).join(\",\")))}else{var selector=group[0].val;nested=new Parser(selector).parse().nested;expr.push(new nodes.String((nested&&i?\"& \":\"\")+selector))}}}else{expr.push(new nodes.String(\"&\"))}return expr}});require.register(\"functions/shift.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function(expr){expr=utils.unwrap(expr);return expr.nodes.shift()}).raw=true});require.register(\"functions/split.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function split(delim,val){utils.assertString(delim,\"delimiter\");utils.assertString(val,\"val\");var splitted=val.string.split(delim.string);var expr=new nodes.Expression;var ItemNode=val instanceof nodes.Ident?nodes.Ident:nodes.String;for(var i=0,len=splitted.length;i<len;++i){expr.nodes.push(new ItemNode(splitted[i]))}return expr}});require.register(\"functions/substr.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function substr(val,start,length){utils.assertString(val,\"val\");utils.assertType(start,\"unit\",\"start\");length=length&&length.val;var res=val.string.substr(start.val,length);return val instanceof nodes.Ident?new nodes.Ident(res):new nodes.String(res)}});require.register(\"functions/tan.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function tan(angle){utils.assertType(angle,\"unit\",\"angle\");var radians=angle.val;if(angle.type===\"deg\"){radians*=Math.PI/180}var m=Math.pow(10,9);var sin=Math.round(Math.sin(radians)*m)/m,cos=Math.round(Math.cos(radians)*m)/m,tan=Math.round(m*sin/cos)/m;return new nodes.Unit(tan,\"\")}});require.register(\"functions/trace.js\",function(module,exports,require){var nodes=require(\"../nodes\");module.exports=function trace(){console.log(this.stack);return nodes.nil}});require.register(\"functions/transparentify.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function transparentify(top,bottom,alpha){utils.assertColor(top);top=top.rgba;bottom=bottom||new nodes.RGBA(255,255,255,1);if(!alpha&&bottom&&!bottom.rgba){alpha=bottom;bottom=new nodes.RGBA(255,255,255,1)}utils.assertColor(bottom);bottom=bottom.rgba;var bestAlpha=[\"r\",\"g\",\"b\"].map(function(channel){return(top[channel]-bottom[channel])/((0<top[channel]-bottom[channel]?255:0)-bottom[channel])}).sort(function(a,b){return a<b})[0];if(alpha){utils.assertType(alpha,\"unit\",\"alpha\");if(\"%\"==alpha.type){bestAlpha=alpha.val/100}else if(!alpha.type){bestAlpha=alpha=alpha.val}}bestAlpha=Math.max(Math.min(bestAlpha,1),0);function processChannel(channel){if(0==bestAlpha){return bottom[channel]}else{return bottom[channel]+(top[channel]-bottom[channel])/bestAlpha}}return new nodes.RGBA(processChannel(\"r\"),processChannel(\"g\"),processChannel(\"b\"),Math.round(bestAlpha*100)/100)}});require.register(\"functions/type.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function type(node){utils.assertPresent(node,\"expression\");return node.nodeName}});require.register(\"functions/unit.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function unit(unit,type){utils.assertType(unit,\"unit\",\"unit\");if(type){utils.assertString(type,\"type\");return new nodes.Unit(unit.val,type.string)}else{return unit.type||\"\"}}});require.register(\"functions/unquote.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function unquote(string){utils.assertString(string,\"string\");return new nodes.Literal(string.string)}});require.register(\"functions/unshift.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function(expr){expr=utils.unwrap(expr);for(var i=1,len=arguments.length;i<len;++i){expr.nodes.unshift(utils.unwrap(arguments[i]))}return expr.nodes.length}).raw=true});require.register(\"functions/warn.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function warn(msg){utils.assertType(msg,\"string\",\"msg\");console.warn(\"Warning: %s\",msg.val);return nodes.nil}});require.register(\"lexer.js\",function(module,exports,require){var Token=require(\"./token\"),nodes=require(\"./nodes\"),errors=require(\"./errors\");exports=module.exports=Lexer;var alias={and:\"&&\",or:\"||\",is:\"==\",isnt:\"!=\",\"is not\":\"!=\",\":=\":\"?=\"};function Lexer(str,options){options=options||{};this.stash=[];this.indentStack=[];this.indentRe=null;this.lineno=1;this.column=1;function comment(str,val,offset,s){var inComment=s.lastIndexOf(\"/*\",offset)>s.lastIndexOf(\"*/\",offset),commentIdx=s.lastIndexOf(\"//\",offset),i=s.lastIndexOf(\"\\n\",offset),double=0,single=0;if(~commentIdx&&commentIdx>i){while(i!=offset){if(\"'\"==s[i])single?single--:single++;if('\"'==s[i])double?double--:double++;if(\"/\"==s[i]&&\"/\"==s[i+1]){inComment=!single&&!double;break}++i}}return inComment?str:val+\"\\r\"}if(\"﻿\"==str.charAt(0))str=str.slice(1);this.str=str.replace(/\\s+$/,\"\\n\").replace(/\\r\\n?/g,\"\\n\").replace(/\\\\ *\\n/g,\"\\r\").replace(/([,(:](?!\\/\\/[^ ])) *(?:\\/\\/[^\\n]*)?\\n\\s*/g,comment).replace(/\\s*\\n[ \\t]*([,)])/g,comment)}Lexer.prototype={inspect:function(){var tok,tmp=this.str,buf=[];while(\"eos\"!=(tok=this.next()).type){buf.push(tok.inspect())}this.str=tmp;return buf.concat(tok.inspect()).join(\"\\n\")},lookahead:function(n){var fetch=n-this.stash.length;while(fetch-->0)this.stash.push(this.advance());return this.stash[--n]},skip:function(len){var chunk=len[0];len=chunk?chunk.length:len;this.str=this.str.substr(len);if(chunk){this.move(chunk)}else{this.column+=len}},move:function(str){var lines=str.match(/\\n/g),idx=str.lastIndexOf(\"\\n\");if(lines)this.lineno+=lines.length;this.column=~idx?str.length-idx:this.column+str.length},next:function(){var tok=this.stashed()||this.advance();this.prev=tok;return tok},isPartOfSelector:function(){var tok=this.stash[this.stash.length-1]||this.prev;switch(tok&&tok.type){case\"color\":return 2==tok.val.raw.length;case\".\":case\"[\":return true}return false},advance:function(){var column=this.column,line=this.lineno,tok=this.eos()||this.nil()||this.sep()||this.keyword()||this.urlchars()||this.comment()||this.newline()||this.escaped()||this.important()||this.literal()||this.fun()||this.anonFunc()||this.atrule()||this.brace()||this.paren()||this.color()||this.string()||this.unit()||this.namedop()||this.boolean()||this.unicode()||this.ident()||this.op()||this.eol()||this.space()||this.selector();tok.lineno=line;tok.column=column;return tok},peek:function(){return this.lookahead(1)},stashed:function(){return this.stash.shift()},eos:function(){if(this.str.length)return;if(this.indentStack.length){this.indentStack.shift();return new Token(\"outdent\")}else{return new Token(\"eos\")}},urlchars:function(){var captures;if(!this.isURL)return;if(captures=/^[\\/:@.;?&=*!,<>#%0-9]+/.exec(this.str)){this.skip(captures);return new Token(\"literal\",new nodes.Literal(captures[0]))}},sep:function(){var captures;if(captures=/^;[ \\t]*/.exec(this.str)){this.skip(captures);return new Token(\";\")}},eol:function(){if(\"\\r\"==this.str[0]){++this.lineno;this.skip(1);return this.advance()}},space:function(){var captures;if(captures=/^([ \\t]+)/.exec(this.str)){this.skip(captures);return new Token(\"space\")}},escaped:function(){var captures;if(captures=/^\\\\(.)[ \\t]*/.exec(this.str)){var c=captures[1];this.skip(captures);return new Token(\"ident\",new nodes.Literal(c))}},literal:function(){var captures;if(captures=/^@css[ \\t]*\\{/.exec(this.str)){this.skip(captures);var c,braces=1,css=\"\",node;while(c=this.str[0]){this.str=this.str.substr(1);switch(c){case\"{\":++braces;break;case\"}\":--braces;break;case\"\\n\":case\"\\r\":++this.lineno;break}css+=c;if(!braces)break}css=css.replace(/\\s*}$/,\"\");node=new nodes.Literal(css);node.css=true;return new Token(\"literal\",node)}},important:function(){var captures;if(captures=/^!important[ \\t]*/.exec(this.str)){this.skip(captures);return new Token(\"ident\",new nodes.Literal(\"!important\"))}},brace:function(){var captures;if(captures=/^([{}])/.exec(this.str)){this.skip(1);var brace=captures[1];return new Token(brace,brace)}},paren:function(){var captures;if(captures=/^([()])([ \\t]*)/.exec(this.str)){var paren=captures[1];this.skip(captures);if(\")\"==paren)this.isURL=false;var tok=new Token(paren,paren);tok.space=captures[2];return tok}},nil:function(){var captures,tok;if(captures=/^(null)\\b[ \\t]*/.exec(this.str)){this.skip(captures);if(this.isPartOfSelector()){tok=new Token(\"ident\",new nodes.Ident(captures[0]))}else{tok=new Token(\"null\",nodes.nil)}return tok}},keyword:function(){var captures,tok;if(captures=/^(return|if|else|unless|for|in)\\b[ \\t]*/.exec(this.str)){var keyword=captures[1];this.skip(captures);if(this.isPartOfSelector()){tok=new Token(\"ident\",new nodes.Ident(captures[0]))}else{tok=new Token(keyword,keyword)}return tok}},namedop:function(){var captures,tok;if(captures=/^(not|and|or|is a|is defined|isnt|is not|is)(?!-)\\b([ \\t]*)/.exec(this.str)){var op=captures[1];this.skip(captures);if(this.isPartOfSelector()){tok=new Token(\"ident\",new nodes.Ident(captures[0]))}else{op=alias[op]||op;tok=new Token(op,op)}tok.space=captures[2];return tok}},op:function(){var captures;if(captures=/^([.]{1,3}|&&|\\|\\||[!<>=?:]=|\\*\\*|[-+*\\/%]=?|[,=?:!~<>&\\[\\]])([ \\t]*)/.exec(this.str)){var op=captures[1];this.skip(captures);op=alias[op]||op;var tok=new Token(op,op);tok.space=captures[2];this.isURL=false;return tok}},anonFunc:function(){var tok;if(\"@\"==this.str[0]&&\"(\"==this.str[1]){this.skip(2);tok=new Token(\"function\",new nodes.Ident(\"anonymous\"));tok.anonymous=true;return tok}},atrule:function(){var captures;if(captures=/^@(?:-(\\w+)-)?([a-zA-Z0-9-_]+)[ \\t]*/.exec(this.str)){this.skip(captures);var vendor=captures[1],type=captures[2],tok;switch(type){case\"require\":case\"import\":case\"charset\":case\"namespace\":case\"media\":case\"scope\":case\"supports\":return new Token(type);case\"document\":return new Token(\"-moz-document\");case\"block\":return new Token(\"atblock\");case\"extend\":case\"extends\":return new Token(\"extend\");case\"keyframes\":return new Token(type,vendor);default:return new Token(\"atrule\",vendor?\"-\"+vendor+\"-\"+type:type)}}},comment:function(){if(\"/\"==this.str[0]&&\"/\"==this.str[1]){var end=this.str.indexOf(\"\\n\");if(-1==end)end=this.str.length;this.skip(end);return this.advance()}if(\"/\"==this.str[0]&&\"*\"==this.str[1]){var end=this.str.indexOf(\"*/\");if(-1==end)end=this.str.length;var str=this.str.substr(0,end+2),lines=str.split(/\\n|\\r/).length-1,suppress=true,inline=false;this.lineno+=lines;this.skip(end+2);if(\"!\"==str[2]){str=str.replace(\"*!\",\"*\");suppress=false}if(this.prev&&\";\"==this.prev.type)inline=true;return new Token(\"comment\",new nodes.Comment(str,suppress,inline))}},\"boolean\":function(){var captures;if(captures=/^(true|false)\\b([ \\t]*)/.exec(this.str)){var val=nodes.Boolean(\"true\"==captures[1]);this.skip(captures);var tok=new Token(\"boolean\",val);tok.space=captures[2];return tok}},unicode:function(){var captures;if(captures=/^u\\+[0-9a-f?]{1,6}(?:-[0-9a-f]{1,6})?/i.exec(this.str)){this.skip(captures);return new Token(\"literal\",new nodes.Literal(captures[0]))}},fun:function(){var captures;if(captures=/^(-*[_a-zA-Z$][-\\w\\d$]*)\\(([ \\t]*)/.exec(this.str)){var name=captures[1];this.skip(captures);this.isURL=\"url\"==name;var tok=new Token(\"function\",new nodes.Ident(name));tok.space=captures[2];return tok}},ident:function(){var captures;if(captures=/^-*[_a-zA-Z$][-\\w\\d$]*/.exec(this.str)){this.skip(captures);return new Token(\"ident\",new nodes.Ident(captures[0]))}},newline:function(){var captures,re;if(this.indentRe){captures=this.indentRe.exec(this.str)}else{re=/^\\n([\\t]*)[ \\t]*/;captures=re.exec(this.str);if(captures&&!captures[1].length){re=/^\\n([ \\t]*)/;captures=re.exec(this.str)}if(captures&&captures[1].length)this.indentRe=re}if(captures){var tok,indents=captures[1].length;this.skip(captures);if(this.str[0]===\" \"||this.str[0]===\"\t\"){throw new errors.SyntaxError(\"Invalid indentation. You can use tabs or spaces to indent, but not both.\")}if(\"\\n\"==this.str[0])return this.advance();if(this.indentStack.length&&indents<this.indentStack[0]){while(this.indentStack.length&&this.indentStack[0]>indents){this.stash.push(new Token(\"outdent\"));this.indentStack.shift()}tok=this.stash.pop()}else if(indents&&indents!=this.indentStack[0]){this.indentStack.unshift(indents);tok=new Token(\"indent\")}else{tok=new Token(\"newline\")}return tok}},unit:function(){var captures;if(captures=/^(-)?(\\d+\\.\\d+|\\d+|\\.\\d+)(%|[a-zA-Z]+)?[ \\t]*/.exec(this.str)){this.skip(captures);var n=parseFloat(captures[2]);if(\"-\"==captures[1])n=-n;var node=new nodes.Unit(n,captures[3]);node.raw=captures[0];return new Token(\"unit\",node)}},string:function(){var captures;if(captures=/^(\"[^\"]*\"|'[^']*')[ \\t]*/.exec(this.str)){var str=captures[1],quote=captures[0][0];this.skip(captures);str=str.slice(1,-1).replace(/\\\\n/g,\"\\n\");return new Token(\"string\",new nodes.String(str,quote))}},color:function(){return this.rrggbbaa()||this.rrggbb()||this.rgba()||this.rgb()||this.nn()||this.n()},n:function(){var captures;if(captures=/^#([a-fA-F0-9]{1})[ \\t]*/.exec(this.str)){this.skip(captures);var n=parseInt(captures[1]+captures[1],16),color=new nodes.RGBA(n,n,n,1);color.raw=captures[0];return new Token(\"color\",color)}},nn:function(){var captures;if(captures=/^#([a-fA-F0-9]{2})[ \\t]*/.exec(this.str)){this.skip(captures);var n=parseInt(captures[1],16),color=new nodes.RGBA(n,n,n,1);color.raw=captures[0];return new Token(\"color\",color)}},rgb:function(){var captures;if(captures=/^#([a-fA-F0-9]{3})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb[0]+rgb[0],16),g=parseInt(rgb[1]+rgb[1],16),b=parseInt(rgb[2]+rgb[2],16),color=new nodes.RGBA(r,g,b,1);color.raw=captures[0];return new Token(\"color\",color)}},rgba:function(){var captures;if(captures=/^#([a-fA-F0-9]{4})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb[0]+rgb[0],16),g=parseInt(rgb[1]+rgb[1],16),b=parseInt(rgb[2]+rgb[2],16),a=parseInt(rgb[3]+rgb[3],16),color=new nodes.RGBA(r,g,b,a/255);color.raw=captures[0];return new Token(\"color\",color)}},rrggbb:function(){var captures;if(captures=/^#([a-fA-F0-9]{6})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb.substr(0,2),16),g=parseInt(rgb.substr(2,2),16),b=parseInt(rgb.substr(4,2),16),color=new nodes.RGBA(r,g,b,1);color.raw=captures[0];return new Token(\"color\",color)}},rrggbbaa:function(){var captures;if(captures=/^#([a-fA-F0-9]{8})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb.substr(0,2),16),g=parseInt(rgb.substr(2,2),16),b=parseInt(rgb.substr(4,2),16),a=parseInt(rgb.substr(6,2),16),color=new nodes.RGBA(r,g,b,a/255);color.raw=captures[0];return new Token(\"color\",color)}},selector:function(){var captures;if(captures=/^\\^|.*?(?=\\/\\/(?![^\\[]*\\])|[,\\n{])/.exec(this.str)){var selector=captures[0];this.skip(captures);return new Token(\"selector\",selector)}}}});require.register(\"nodes/arguments.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"../nodes\"),utils=require(\"../utils\");var Arguments=module.exports=function Arguments(){nodes.Expression.call(this);this.map={}};Arguments.prototype.__proto__=nodes.Expression.prototype;Arguments.fromExpression=function(expr){var args=new Arguments,len=expr.nodes.length;args.lineno=expr.lineno;args.column=expr.column;args.isList=expr.isList;for(var i=0;i<len;++i){args.push(expr.nodes[i])}return args};Arguments.prototype.clone=function(parent){var clone=nodes.Expression.prototype.clone.call(this,parent);clone.map={};for(var key in this.map){clone.map[key]=this.map[key].clone(parent,clone)}clone.isList=this.isList;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Arguments.prototype.toJSON=function(){return{__type:\"Arguments\",map:this.map,isList:this.isList,preserve:this.preserve,lineno:this.lineno,column:this.column,filename:this.filename,nodes:this.nodes}}});require.register(\"nodes/binop.js\",function(module,exports,require){var Node=require(\"./node\");var BinOp=module.exports=function BinOp(op,left,right){Node.call(this);this.op=op;this.left=left;this.right=right};BinOp.prototype.__proto__=Node.prototype;BinOp.prototype.clone=function(parent){var clone=new BinOp(this.op);clone.left=this.left.clone(parent,clone);clone.right=this.right&&this.right.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;if(this.val)clone.val=this.val.clone(parent,clone);return clone};BinOp.prototype.toString=function(){return this.left.toString()+\" \"+this.op+\" \"+this.right.toString()};BinOp.prototype.toJSON=function(){var json={__type:\"BinOp\",left:this.left,right:this.right,op:this.op,lineno:this.lineno,column:this.column,filename:this.filename};if(this.val)json.val=this.val;return json}});require.register(\"nodes/block.js\",function(module,exports,require){var Node=require(\"./node\");var Block=module.exports=function Block(parent,node){Node.call(this);this.nodes=[];this.parent=parent;this.node=node;this.scope=true};Block.prototype.__proto__=Node.prototype;Block.prototype.__defineGetter__(\"hasProperties\",function(){for(var i=0,len=this.nodes.length;i<len;++i){if(\"property\"==this.nodes[i].nodeName){return true}}});Block.prototype.__defineGetter__(\"hasMedia\",function(){for(var i=0,len=this.nodes.length;i<len;++i){var nodeName=this.nodes[i].nodeName;if(\"media\"==nodeName){return true}}return false});Block.prototype.__defineGetter__(\"isEmpty\",function(){return!this.nodes.length});Block.prototype.clone=function(parent,node){parent=parent||this.parent;var clone=new Block(parent,node||this.node);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.scope=this.scope;this.nodes.forEach(function(node){clone.push(node.clone(clone,clone))});return clone};Block.prototype.push=function(node){this.nodes.push(node)};Block.prototype.toJSON=function(){return{__type:\"Block\",scope:this.scope,lineno:this.lineno,column:this.column,filename:this.filename,nodes:this.nodes}}});require.register(\"nodes/boolean.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Boolean=module.exports=function Boolean(val){Node.call(this);if(this.nodeName){this.val=!!val}else{return new Boolean(val)}};Boolean.prototype.__proto__=Node.prototype;Boolean.prototype.toBoolean=function(){return this};Boolean.prototype.__defineGetter__(\"isTrue\",function(){return this.val});Boolean.prototype.__defineGetter__(\"isFalse\",function(){return!this.val});Boolean.prototype.negate=function(){return new Boolean(!this.val)};Boolean.prototype.inspect=function(){return\"[Boolean \"+this.val+\"]\"};Boolean.prototype.toString=function(){return this.val?\"true\":\"false\"};Boolean.prototype.toJSON=function(){return{__type:\"Boolean\",val:this.val}}});require.register(\"nodes/call.js\",function(module,exports,require){var Node=require(\"./node\");var Call=module.exports=function Call(name,args){Node.call(this);this.name=name;this.args=args};Call.prototype.__proto__=Node.prototype;Call.prototype.clone=function(parent){var clone=new Call(this.name);clone.args=this.args.clone(parent,clone);if(this.block)clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Call.prototype.toString=function(){var args=this.args.nodes.map(function(node){var str=node.toString();return str.slice(1,str.length-1)}).join(\", \");return this.name+\"(\"+args+\")\"};Call.prototype.toJSON=function(){var json={__type:\"Call\",name:this.name,args:this.args,lineno:this.lineno,column:this.column,filename:this.filename};if(this.block)json.block=this.block;return json}});require.register(\"nodes/charset.js\",function(module,exports,require){var Node=require(\"./node\");var Charset=module.exports=function Charset(val){Node.call(this);this.val=val};Charset.prototype.__proto__=Node.prototype;Charset.prototype.toString=function(){return\"@charset \"+this.val};Charset.prototype.toJSON=function(){return{__type:\"Charset\",val:this.val,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/namespace.js\",function(module,exports,require){var Node=require(\"./node\");var Namespace=module.exports=function Namespace(val,prefix){Node.call(this);this.val=val;this.prefix=prefix};Namespace.prototype.__proto__=Node.prototype;Namespace.prototype.toString=function(){return\"@namespace \"+(this.prefix?this.prefix+\" \":\"\")+this.val};Namespace.prototype.toJSON=function(){return{__type:\"Namespace\",val:this.val,prefix:this.prefix,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/comment.js\",function(module,exports,require){var Node=require(\"./node\");var Comment=module.exports=function Comment(str,suppress,inline){Node.call(this);this.str=str;this.suppress=suppress;this.inline=inline};Comment.prototype.__proto__=Node.prototype;Comment.prototype.toJSON=function(){return{__type:\"Comment\",str:this.str,suppress:this.suppress,inline:this.inline,lineno:this.lineno,column:this.column,filename:this.filename}};Comment.prototype.toString=function(){return this.str}});require.register(\"nodes/each.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Each=module.exports=function Each(val,key,expr,block){Node.call(this);this.val=val;this.key=key;this.expr=expr;this.block=block};Each.prototype.__proto__=Node.prototype;Each.prototype.clone=function(parent){var clone=new Each(this.val,this.key);clone.expr=this.expr.clone(parent,clone);clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Each.prototype.toJSON=function(){return{__type:\"Each\",val:this.val,key:this.key,expr:this.expr,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/expression.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"../nodes\"),utils=require(\"../utils\");var Expression=module.exports=function Expression(isList){Node.call(this);this.nodes=[];this.isList=isList};Expression.prototype.__defineGetter__(\"isEmpty\",function(){return!this.nodes.length});Expression.prototype.__defineGetter__(\"first\",function(){return this.nodes[0]?this.nodes[0].first:nodes.nil});Expression.prototype.__defineGetter__(\"hash\",function(){return this.nodes.map(function(node){return node.hash}).join(\"::\")});Expression.prototype.__proto__=Node.prototype;Expression.prototype.clone=function(parent){var clone=new this.constructor(this.isList);clone.preserve=this.preserve;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.nodes=this.nodes.map(function(node){return node.clone(parent,clone)});return clone};Expression.prototype.push=function(node){this.nodes.push(node)};Expression.prototype.operate=function(op,right,val){switch(op){case\"[]=\":var self=this,range=utils.unwrap(right).nodes,val=utils.unwrap(val),len,node;range.forEach(function(unit){len=self.nodes.length;if(\"unit\"==unit.nodeName){var i=unit.val<0?len+unit.val:unit.val,n=i;while(i-->len)self.nodes[i]=nodes.nil;self.nodes[n]=val}else if(unit.string){node=self.nodes[0];if(node&&\"object\"==node.nodeName)node.set(unit.string,val.clone())}});return val;case\"[]\":var expr=new nodes.Expression,vals=utils.unwrap(this).nodes,range=utils.unwrap(right).nodes,node;range.forEach(function(unit){if(\"unit\"==unit.nodeName){node=vals[unit.val<0?vals.length+unit.val:unit.val]}else if(\"object\"==vals[0].nodeName){node=vals[0].get(unit.string)}if(node)expr.push(node)});return expr.isEmpty?nodes.nil:utils.unwrap(expr);case\"||\":return this.toBoolean().isTrue?this:right;case\"in\":return Node.prototype.operate.call(this,op,right);case\"!=\":return this.operate(\"==\",right,val).negate();case\"==\":var len=this.nodes.length,right=right.toExpression(),a,b;if(len!=right.nodes.length)return nodes.no;for(var i=0;i<len;++i){a=this.nodes[i];b=right.nodes[i];if(a.operate(op,b).isTrue)continue;return nodes.no}return nodes.yes;break;default:return this.first.operate(op,right,val)}};Expression.prototype.toBoolean=function(){if(this.nodes.length>1)return nodes.yes;return this.first.toBoolean()};Expression.prototype.toString=function(){return\"(\"+this.nodes.map(function(node){return node.toString()}).join(this.isList?\", \":\" \")+\")\"};Expression.prototype.toJSON=function(){return{__type:\"Expression\",isList:this.isList,preserve:this.preserve,lineno:this.lineno,column:this.column,filename:this.filename,nodes:this.nodes}}});require.register(\"nodes/function.js\",function(module,exports,require){var Node=require(\"./node\");var Function=module.exports=function Function(name,params,body){Node.call(this);this.name=name;this.params=params;this.block=body;if(\"function\"==typeof params)this.fn=params};Function.prototype.__defineGetter__(\"arity\",function(){return this.params.length});Function.prototype.__proto__=Node.prototype;Function.prototype.__defineGetter__(\"hash\",function(){return\"function \"+this.name});Function.prototype.clone=function(parent){if(this.fn){var clone=new Function(this.name,this.fn)}else{var clone=new Function(this.name);clone.params=this.params.clone(parent,clone);clone.block=this.block.clone(parent,clone)}clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Function.prototype.toString=function(){if(this.fn){return this.name+\"(\"+this.fn.toString().match(/^function *\\w*\\((.*?)\\)/).slice(1).join(\", \")+\")\"}else{return this.name+\"(\"+this.params.nodes.join(\", \")+\")\"}};Function.prototype.toJSON=function(){var json={__type:\"Function\",name:this.name,lineno:this.lineno,column:this.column,filename:this.filename};if(this.fn){json.fn=this.fn}else{json.params=this.params;json.block=this.block}return json}});require.register(\"nodes/group.js\",function(module,exports,require){var Node=require(\"./node\");var Group=module.exports=function Group(){Node.call(this);this.nodes=[];this.extends=[]};Group.prototype.__proto__=Node.prototype;Group.prototype.push=function(selector){this.nodes.push(selector)};Group.prototype.__defineGetter__(\"block\",function(){return this.nodes[0].block});Group.prototype.__defineSetter__(\"block\",function(block){for(var i=0,len=this.nodes.length;i<len;++i){this.nodes[i].block=block}});Group.prototype.__defineGetter__(\"hasOnlyPlaceholders\",function(){return this.nodes.every(function(selector){return selector.isPlaceholder})});Group.prototype.clone=function(parent){var clone=new Group;clone.lineno=this.lineno;clone.column=this.column;this.nodes.forEach(function(node){clone.push(node.clone(parent,clone))\n});clone.filename=this.filename;clone.block=this.block.clone(parent,clone);return clone};Group.prototype.toJSON=function(){return{__type:\"Group\",nodes:this.nodes,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/hsla.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var HSLA=exports=module.exports=function HSLA(h,s,l,a){Node.call(this);this.h=clampDegrees(h);this.s=clampPercentage(s);this.l=clampPercentage(l);this.a=clampAlpha(a);this.hsla=this};HSLA.prototype.__proto__=Node.prototype;HSLA.prototype.toString=function(){return\"hsla(\"+this.h+\",\"+this.s.toFixed(0)+\"%,\"+this.l.toFixed(0)+\"%,\"+this.a+\")\"};HSLA.prototype.clone=function(parent){var clone=new HSLA(this.h,this.s,this.l,this.a);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};HSLA.prototype.toJSON=function(){return{__type:\"HSLA\",h:this.h,s:this.s,l:this.l,a:this.a,lineno:this.lineno,column:this.column,filename:this.filename}};HSLA.prototype.__defineGetter__(\"rgba\",function(){return nodes.RGBA.fromHSLA(this)});HSLA.prototype.__defineGetter__(\"hash\",function(){return this.rgba.toString()});HSLA.prototype.add=function(h,s,l){return new HSLA(this.h+h,this.s+s,this.l+l,this.a)};HSLA.prototype.sub=function(h,s,l){return this.add(-h,-s,-l)};HSLA.prototype.operate=function(op,right){switch(op){case\"==\":case\"!=\":case\"<=\":case\">=\":case\"<\":case\">\":case\"is a\":case\"||\":case\"&&\":return this.rgba.operate(op,right);default:return this.rgba.operate(op,right).hsla}};exports.fromRGBA=function(rgba){var r=rgba.r/255,g=rgba.g/255,b=rgba.b/255,a=rgba.a;var min=Math.min(r,g,b),max=Math.max(r,g,b),l=(max+min)/2,d=max-min,h,s;switch(max){case min:h=0;break;case r:h=60*(g-b)/d;break;case g:h=60*(b-r)/d+120;break;case b:h=60*(r-g)/d+240;break}if(max==min){s=0}else if(l<.5){s=d/(2*l)}else{s=d/(2-2*l)}h%=360;s*=100;l*=100;return new HSLA(h,s,l,a)};HSLA.prototype.adjustLightness=function(percent){this.l=clampPercentage(this.l+this.l*(percent/100));return this};HSLA.prototype.adjustHue=function(deg){this.h=clampDegrees(this.h+deg);return this};function clampDegrees(n){n=n%360;return n>=0?n:360+n}function clampPercentage(n){return Math.max(0,Math.min(n,100))}function clampAlpha(n){return Math.max(0,Math.min(n,1))}});require.register(\"nodes/ident.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Ident=module.exports=function Ident(name,val,mixin){Node.call(this);this.name=name;this.string=name;this.val=val||nodes.nil;this.mixin=!!mixin};Ident.prototype.__defineGetter__(\"isEmpty\",function(){return undefined==this.val});Ident.prototype.__defineGetter__(\"hash\",function(){return this.name});Ident.prototype.__proto__=Node.prototype;Ident.prototype.clone=function(parent){var clone=new Ident(this.name);clone.val=this.val.clone(parent,clone);clone.mixin=this.mixin;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.property=this.property;clone.rest=this.rest;return clone};Ident.prototype.toJSON=function(){return{__type:\"Ident\",name:this.name,val:this.val,mixin:this.mixin,property:this.property,rest:this.rest,lineno:this.lineno,column:this.column,filename:this.filename}};Ident.prototype.toString=function(){return this.name};Ident.prototype.coerce=function(other){switch(other.nodeName){case\"ident\":case\"string\":case\"literal\":return new Ident(other.string);case\"unit\":return new Ident(other.toString());default:return Node.prototype.coerce.call(this,other)}};Ident.prototype.operate=function(op,right){var val=right.first;switch(op){case\"-\":if(\"unit\"==val.nodeName){var expr=new nodes.Expression;val=val.clone();val.val=-val.val;expr.push(this);expr.push(val);return expr}case\"+\":return new nodes.Ident(this.string+this.coerce(val).string)}return Node.prototype.operate.call(this,op,right)}});require.register(\"nodes/if.js\",function(module,exports,require){var Node=require(\"./node\");var If=module.exports=function If(cond,negate){Node.call(this);this.cond=cond;this.elses=[];if(negate&&negate.nodeName){this.block=negate}else{this.negate=negate}};If.prototype.__proto__=Node.prototype;If.prototype.clone=function(parent){var clone=new If;clone.cond=this.cond.clone(parent,clone);clone.block=this.block.clone(parent,clone);clone.elses=this.elses.map(function(node){return node.clone(parent,clone)});clone.negate=this.negate;clone.postfix=this.postfix;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};If.prototype.toJSON=function(){return{__type:\"If\",cond:this.cond,block:this.block,elses:this.elses,negate:this.negate,postfix:this.postfix,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/import.js\",function(module,exports,require){var Node=require(\"./node\");var Import=module.exports=function Import(expr,once){Node.call(this);this.path=expr;this.once=once||false};Import.prototype.__proto__=Node.prototype;Import.prototype.clone=function(parent){var clone=new Import;clone.path=this.path.nodeName?this.path.clone(parent,clone):this.path;clone.once=this.once;clone.mtime=this.mtime;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Import.prototype.toJSON=function(){return{__type:\"Import\",path:this.path,once:this.once,mtime:this.mtime,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/extend.js\",function(module,exports,require){var Node=require(\"./node\");var Extend=module.exports=function Extend(selectors){Node.call(this);this.selectors=selectors};Extend.prototype.__proto__=Node.prototype;Extend.prototype.clone=function(){return new Extend(this.selectors)};Extend.prototype.toString=function(){return\"@extend \"+this.selectors.join(\", \")};Extend.prototype.toJSON=function(){return{__type:\"Extend\",selectors:this.selectors,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/index.js\",function(module,exports,require){exports.Node=require(\"./node\");exports.Root=require(\"./root\");exports.Null=require(\"./null\");exports.Each=require(\"./each\");exports.If=require(\"./if\");exports.Call=require(\"./call\");exports.UnaryOp=require(\"./unaryop\");exports.BinOp=require(\"./binop\");exports.Ternary=require(\"./ternary\");exports.Block=require(\"./block\");exports.Unit=require(\"./unit\");exports.String=require(\"./string\");exports.HSLA=require(\"./hsla\");exports.RGBA=require(\"./rgba\");exports.Ident=require(\"./ident\");exports.Group=require(\"./group\");exports.Literal=require(\"./literal\");exports.Boolean=require(\"./boolean\");exports.Return=require(\"./return\");exports.Media=require(\"./media\");exports.QueryList=require(\"./query-list\");exports.Query=require(\"./query\");exports.Feature=require(\"./feature\");exports.Params=require(\"./params\");exports.Comment=require(\"./comment\");exports.Keyframes=require(\"./keyframes\");exports.Member=require(\"./member\");exports.Charset=require(\"./charset\");exports.Namespace=require(\"./namespace\");exports.Import=require(\"./import\");exports.Extend=require(\"./extend\");exports.Object=require(\"./object\");exports.Function=require(\"./function\");exports.Property=require(\"./property\");exports.Selector=require(\"./selector\");exports.Expression=require(\"./expression\");exports.Arguments=require(\"./arguments\");exports.Atblock=require(\"./atblock\");exports.Atrule=require(\"./atrule\");exports.Supports=require(\"./supports\");exports.yes=new exports.Boolean(true);exports.no=new exports.Boolean(false);exports.nil=new exports.Null});require.register(\"nodes/keyframes.js\",function(module,exports,require){var Atrule=require(\"./atrule\");var Keyframes=module.exports=function Keyframes(segs,prefix){Atrule.call(this,\"keyframes\");this.segments=segs;this.prefix=prefix||\"official\"};Keyframes.prototype.__proto__=Atrule.prototype;Keyframes.prototype.clone=function(parent){var clone=new Keyframes;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});clone.prefix=this.prefix;clone.block=this.block.clone(parent,clone);return clone};Keyframes.prototype.toJSON=function(){return{__type:\"Keyframes\",segments:this.segments,prefix:this.prefix,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}};Keyframes.prototype.toString=function(){return\"@keyframes \"+this.segments.join(\"\")}});require.register(\"nodes/literal.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Literal=module.exports=function Literal(str){Node.call(this);this.val=str;this.string=str;this.prefixed=false};Literal.prototype.__proto__=Node.prototype;Literal.prototype.__defineGetter__(\"hash\",function(){return this.val});Literal.prototype.toString=function(){return this.val};Literal.prototype.coerce=function(other){switch(other.nodeName){case\"ident\":case\"string\":case\"literal\":return new Literal(other.string);default:return Node.prototype.coerce.call(this,other)}};Literal.prototype.operate=function(op,right){var val=right.first;switch(op){case\"+\":return new nodes.Literal(this.string+this.coerce(val).string);default:return Node.prototype.operate.call(this,op,right)}};Literal.prototype.toJSON=function(){return{__type:\"Literal\",val:this.val,string:this.string,prefixed:this.prefixed,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/media.js\",function(module,exports,require){var Atrule=require(\"./atrule\");var Media=module.exports=function Media(val){Atrule.call(this,\"media\");this.val=val};Media.prototype.__proto__=Atrule.prototype;Media.prototype.clone=function(parent){var clone=new Media;clone.val=this.val.clone(parent,clone);clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Media.prototype.toJSON=function(){return{__type:\"Media\",val:this.val,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}};Media.prototype.toString=function(){return\"@media \"+this.val}});require.register(\"nodes/query-list.js\",function(module,exports,require){var Node=require(\"./node\");var QueryList=module.exports=function QueryList(){Node.call(this);this.nodes=[]};QueryList.prototype.__proto__=Node.prototype;QueryList.prototype.clone=function(parent){var clone=new QueryList;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;for(var i=0;i<this.nodes.length;++i){clone.push(this.nodes[i].clone(parent,clone))}return clone};QueryList.prototype.push=function(node){this.nodes.push(node)};QueryList.prototype.merge=function(other){var list=new QueryList,merged;this.nodes.forEach(function(query){for(var i=0,len=other.nodes.length;i<len;++i){merged=query.merge(other.nodes[i]);if(merged)list.push(merged)}});return list};QueryList.prototype.toString=function(){return\"(\"+this.nodes.map(function(node){return node.toString()}).join(\", \")+\")\"};QueryList.prototype.toJSON=function(){return{__type:\"QueryList\",nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/query.js\",function(module,exports,require){var Node=require(\"./node\");var Query=module.exports=function Query(){Node.call(this);this.nodes=[];this.type=\"\";this.predicate=\"\"};Query.prototype.__proto__=Node.prototype;Query.prototype.clone=function(parent){var clone=new Query;clone.predicate=this.predicate;clone.type=this.type;for(var i=0,len=this.nodes.length;i<len;++i){clone.push(this.nodes[i].clone(parent,clone))}clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Query.prototype.push=function(feature){this.nodes.push(feature)};Query.prototype.__defineGetter__(\"resolvedType\",function(){if(this.type){return this.type.nodeName?this.type.string:this.type}});Query.prototype.__defineGetter__(\"resolvedPredicate\",function(){if(this.predicate){return this.predicate.nodeName?this.predicate.string:this.predicate}});Query.prototype.merge=function(other){var query=new Query,p1=this.resolvedPredicate,p2=other.resolvedPredicate,t1=this.resolvedType,t2=other.resolvedType,type,pred;t1=t1||t2;t2=t2||t1;if(\"not\"==p1^\"not\"==p2){if(t1==t2)return;type=\"not\"==p1?t2:t1;pred=\"not\"==p1?p2:p1}else if(\"not\"==p1&&\"not\"==p2){if(t1!=t2)return;type=t1;pred=\"not\"}else if(t1!=t2){return}else{type=t1;pred=p1||p2}query.predicate=pred;query.type=type;query.nodes=this.nodes.concat(other.nodes);return query};Query.prototype.toString=function(){var pred=this.predicate?this.predicate+\" \":\"\",type=this.type||\"\",len=this.nodes.length,str=pred+type;if(len){str+=(type&&\" and \")+this.nodes.map(function(expr){return expr.toString()}).join(\" and \")}return str};Query.prototype.toJSON=function(){return{__type:\"Query\",predicate:this.predicate,type:this.type,nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/feature.js\",function(module,exports,require){var Node=require(\"./node\");var Feature=module.exports=function Feature(segs){Node.call(this);this.segments=segs;this.expr=null};Feature.prototype.__proto__=Node.prototype;Feature.prototype.clone=function(parent){var clone=new Feature;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});if(this.expr)clone.expr=this.expr.clone(parent,clone);if(this.name)clone.name=this.name;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Feature.prototype.toString=function(){if(this.expr){return\"(\"+this.segments.join(\"\")+\": \"+this.expr.toString()+\")\"}else{return this.segments.join(\"\")}};Feature.prototype.toJSON=function(){var json={__type:\"Feature\",segments:this.segments,lineno:this.lineno,column:this.column,filename:this.filename};if(this.expr)json.expr=this.expr;if(this.name)json.name=this.name;return json}});require.register(\"nodes/node.js\",function(module,exports,require){var Evaluator=require(\"../visitor/evaluator\"),utils=require(\"../utils\"),nodes=require(\"./index\");function CoercionError(msg){this.name=\"CoercionError\";this.message=msg;Error.captureStackTrace(this,CoercionError)}CoercionError.prototype.__proto__=Error.prototype;var Node=module.exports=function Node(){this.lineno=nodes.lineno||1;this.column=nodes.column||1;this.filename=nodes.filename};Node.prototype={constructor:Node,get first(){return this},get hash(){return this.val},get nodeName(){return this.constructor.name.toLowerCase()},clone:function(){return this},toJSON:function(){return{lineno:this.lineno,column:this.column,filename:this.filename}},eval:function(){return new Evaluator(this).evaluate()},toBoolean:function(){return nodes.yes},toExpression:function(){if(\"expression\"==this.nodeName)return this;var expr=new nodes.Expression;expr.push(this);return expr},shouldCoerce:function(op){switch(op){case\"is a\":case\"in\":case\"||\":case\"&&\":return false;default:return true}},operate:function(op,right){switch(op){case\"is a\":if(\"string\"==right.nodeName){return nodes.Boolean(this.nodeName==right.val)}else{throw new Error('\"is a\" expects a string, got '+right.toString())}case\"==\":return nodes.Boolean(this.hash==right.hash);case\"!=\":return nodes.Boolean(this.hash!=right.hash);case\">=\":return nodes.Boolean(this.hash>=right.hash);case\"<=\":return nodes.Boolean(this.hash<=right.hash);case\">\":return nodes.Boolean(this.hash>right.hash);case\"<\":return nodes.Boolean(this.hash<right.hash);case\"||\":return this.toBoolean().isTrue?this:right;case\"in\":var vals=utils.unwrap(right).nodes,len=vals&&vals.length,hash=this.hash;if(!vals)throw new Error('\"in\" given invalid right-hand operand, expecting an expression');if(1==len&&\"object\"==vals[0].nodeName){return nodes.Boolean(vals[0].has(this.hash))}for(var i=0;i<len;++i){if(hash==vals[i].hash){return nodes.yes}}return nodes.no;case\"&&\":var a=this.toBoolean(),b=right.toBoolean();return a.isTrue&&b.isTrue?right:a.isFalse?this:right;default:if(\"[]\"==op){var msg=\"cannot perform \"+this+\"[\"+right+\"]\"}else{var msg=\"cannot perform\"+\" \"+this+\" \"+op+\" \"+right}throw new Error(msg)}},coerce:function(other){if(other.nodeName==this.nodeName)return other;throw new CoercionError(\"cannot coerce \"+other+\" to \"+this.nodeName)}}});require.register(\"nodes/null.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Null=module.exports=function Null(){};Null.prototype.__proto__=Node.prototype;Null.prototype.inspect=Null.prototype.toString=function(){return\"null\"};Null.prototype.toBoolean=function(){return nodes.no};Null.prototype.__defineGetter__(\"isNull\",function(){return true});Null.prototype.__defineGetter__(\"hash\",function(){return null});Null.prototype.toJSON=function(){return{__type:\"Null\",lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/params.js\",function(module,exports,require){var Node=require(\"./node\");var Params=module.exports=function Params(){Node.call(this);this.nodes=[]};Params.prototype.__defineGetter__(\"length\",function(){return this.nodes.length});Params.prototype.__proto__=Node.prototype;Params.prototype.push=function(node){this.nodes.push(node)};Params.prototype.clone=function(parent){var clone=new Params;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;this.nodes.forEach(function(node){clone.push(node.clone(parent,clone))});return clone};Params.prototype.toJSON=function(){return{__type:\"Params\",nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/property.js\",function(module,exports,require){var Node=require(\"./node\");var Property=module.exports=function Property(segs,expr){Node.call(this);this.segments=segs;this.expr=expr};Property.prototype.__proto__=Node.prototype;Property.prototype.clone=function(parent){var clone=new Property(this.segments);clone.name=this.name;if(this.literal)clone.literal=this.literal;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});if(this.expr)clone.expr=this.expr.clone(parent,clone);return clone};Property.prototype.toJSON=function(){var json={__type:\"Property\",segments:this.segments,name:this.name,lineno:this.lineno,column:this.column,filename:this.filename};if(this.expr)json.expr=this.expr;if(this.literal)json.literal=this.literal;return json};Property.prototype.toString=function(){return\"property(\"+this.segments.join(\"\")+\", \"+this.expr+\")\"};Property.prototype.operate=function(op,right,val){return this.expr.operate(op,right,val)}});require.register(\"nodes/return.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Return=module.exports=function Return(expr){this.expr=expr||nodes.nil};Return.prototype.__proto__=Node.prototype;Return.prototype.clone=function(parent){var clone=new Return;clone.expr=this.expr.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Return.prototype.toJSON=function(){return{__type:\"Return\",expr:this.expr,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/rgba.js\",function(module,exports,require){var Node=require(\"./node\"),HSLA=require(\"./hsla\"),functions=require(\"../functions\"),adjust=functions.adjust,nodes=require(\"./index\");var RGBA=exports=module.exports=function RGBA(r,g,b,a){Node.call(this);this.r=clamp(r);this.g=clamp(g);this.b=clamp(b);this.a=clampAlpha(a);this.name=\"\";this.rgba=this};RGBA.prototype.__proto__=Node.prototype;RGBA.withoutClamping=function(r,g,b,a){var rgba=new RGBA(0,0,0,0);rgba.r=r;rgba.g=g;rgba.b=b;rgba.a=a;return rgba};RGBA.prototype.clone=function(){var clone=new RGBA(this.r,this.g,this.b,this.a);clone.raw=this.raw;clone.name=this.name;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};RGBA.prototype.toJSON=function(){return{__type:\"RGBA\",r:this.r,g:this.g,b:this.b,a:this.a,raw:this.raw,name:this.name,lineno:this.lineno,column:this.column,filename:this.filename}};RGBA.prototype.toBoolean=function(){return nodes.yes};RGBA.prototype.__defineGetter__(\"hsla\",function(){return HSLA.fromRGBA(this)});RGBA.prototype.__defineGetter__(\"hash\",function(){return this.toString()});RGBA.prototype.add=function(r,g,b,a){return new RGBA(this.r+r,this.g+g,this.b+b,this.a+a)};RGBA.prototype.sub=function(r,g,b,a){return new RGBA(this.r-r,this.g-g,this.b-b,a==1?this.a:this.a-a)};RGBA.prototype.multiply=function(n){return new RGBA(this.r*n,this.g*n,this.b*n,this.a)};RGBA.prototype.divide=function(n){return new RGBA(this.r/n,this.g/n,this.b/n,this.a)};RGBA.prototype.operate=function(op,right){if(\"in\"!=op)right=right.first;switch(op){case\"is a\":if(\"string\"==right.nodeName&&\"color\"==right.string){return nodes.yes}break;case\"+\":switch(right.nodeName){case\"unit\":var n=right.val;switch(right.type){case\"%\":return adjust(this,new nodes.String(\"lightness\"),right);case\"deg\":return this.hsla.adjustHue(n).rgba;default:return this.add(n,n,n,0)}case\"rgba\":return this.add(right.r,right.g,right.b,right.a);case\"hsla\":return this.hsla.add(right.h,right.s,right.l)}break;case\"-\":switch(right.nodeName){case\"unit\":var n=right.val;switch(right.type){case\"%\":return adjust(this,new nodes.String(\"lightness\"),new nodes.Unit(-n,\"%\"));case\"deg\":return this.hsla.adjustHue(-n).rgba;default:return this.sub(n,n,n,0)}case\"rgba\":return this.sub(right.r,right.g,right.b,right.a);case\"hsla\":return this.hsla.sub(right.h,right.s,right.l)}break;case\"*\":switch(right.nodeName){case\"unit\":return this.multiply(right.val)}break;case\"/\":switch(right.nodeName){case\"unit\":return this.divide(right.val)}break}return Node.prototype.operate.call(this,op,right)};RGBA.prototype.toString=function(){function pad(n){return n<16?\"0\"+n.toString(16):n.toString(16)}if(\"transparent\"==this.name)return this.name;if(1==this.a){var r=pad(this.r),g=pad(this.g),b=pad(this.b);if(r[0]==r[1]&&g[0]==g[1]&&b[0]==b[1]){return\"#\"+r[0]+g[0]+b[0]}else{return\"#\"+r+g+b}}else{return\"rgba(\"+this.r+\",\"+this.g+\",\"+this.b+\",\"+ +this.a.toFixed(3)+\")\"}};exports.fromHSLA=function(hsla){var h=hsla.h/360,s=hsla.s/100,l=hsla.l/100,a=hsla.a;var m2=l<=.5?l*(s+1):l+s-l*s,m1=l*2-m2;var r=hue(h+1/3)*255,g=hue(h)*255,b=hue(h-1/3)*255;function hue(h){if(h<0)++h;if(h>1)--h;if(h*6<1)return m1+(m2-m1)*h*6;if(h*2<1)return m2;if(h*3<2)return m1+(m2-m1)*(2/3-h)*6;return m1}return new RGBA(r,g,b,a)};function clamp(n){return Math.max(0,Math.min(n.toFixed(0),255))}function clampAlpha(n){return Math.max(0,Math.min(n,1))}});require.register(\"nodes/root.js\",function(module,exports,require){var Node=require(\"./node\");var Root=module.exports=function Root(){this.nodes=[]};Root.prototype.__proto__=Node.prototype;Root.prototype.push=function(node){this.nodes.push(node)};Root.prototype.unshift=function(node){this.nodes.unshift(node)};Root.prototype.clone=function(){var clone=new Root;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;this.nodes.forEach(function(node){clone.push(node.clone(clone,clone))});return clone};Root.prototype.toString=function(){return\"[Root]\"};Root.prototype.toJSON=function(){return{__type:\"Root\",nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/selector.js\",function(module,exports,require){var Block=require(\"./block\"),Node=require(\"./node\");var Selector=module.exports=function Selector(segs){Node.call(this);this.inherits=true;this.segments=segs;this.optional=false};Selector.prototype.__proto__=Node.prototype;Selector.prototype.toString=function(){return this.segments.join(\"\")+(this.optional?\" !optional\":\"\")};Selector.prototype.__defineGetter__(\"isPlaceholder\",function(){return this.val&&~this.val.substr(0,2).indexOf(\"$\")});Selector.prototype.clone=function(parent){var clone=new Selector;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.inherits=this.inherits;clone.val=this.val;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});clone.optional=this.optional;return clone};Selector.prototype.toJSON=function(){return{__type:\"Selector\",inherits:this.inherits,segments:this.segments,optional:this.optional,val:this.val,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/string.js\",function(module,exports,require){var Node=require(\"./node\"),sprintf=require(\"../functions\").s,utils=require(\"../utils\"),nodes=require(\"./index\");var String=module.exports=function String(val,quote){Node.call(this);this.val=val;this.string=val;this.prefixed=false;if(typeof quote!==\"string\"){this.quote=\"'\"}else{this.quote=quote}};String.prototype.__proto__=Node.prototype;String.prototype.toString=function(){return this.quote+this.val+this.quote};String.prototype.clone=function(){var clone=new String(this.val,this.quote);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};String.prototype.toJSON=function(){return{__type:\"String\",val:this.val,quote:this.quote,lineno:this.lineno,column:this.column,filename:this.filename}};String.prototype.toBoolean=function(){return nodes.Boolean(this.val.length)};String.prototype.coerce=function(other){switch(other.nodeName){case\"string\":return other;case\"expression\":return new String(other.nodes.map(function(node){return this.coerce(node).val},this).join(\" \"));default:return new String(other.toString())}};String.prototype.operate=function(op,right){switch(op){case\"%\":var expr=new nodes.Expression;expr.push(this);var args=\"expression\"==right.nodeName?utils.unwrap(right).nodes:[right];return sprintf.apply(null,[expr].concat(args));case\"+\":var expr=new nodes.Expression;expr.push(new String(this.val+this.coerce(right).val));return expr;default:return Node.prototype.operate.call(this,op,right)}}});require.register(\"nodes/ternary.js\",function(module,exports,require){var Node=require(\"./node\");var Ternary=module.exports=function Ternary(cond,trueExpr,falseExpr){Node.call(this);this.cond=cond;this.trueExpr=trueExpr;this.falseExpr=falseExpr};Ternary.prototype.__proto__=Node.prototype;Ternary.prototype.clone=function(parent){var clone=new Ternary;clone.cond=this.cond.clone(parent,clone);clone.trueExpr=this.trueExpr.clone(parent,clone);clone.falseExpr=this.falseExpr.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Ternary.prototype.toJSON=function(){return{__type:\"Ternary\",cond:this.cond,trueExpr:this.trueExpr,falseExpr:this.falseExpr,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/unaryop.js\",function(module,exports,require){var Node=require(\"./node\");var UnaryOp=module.exports=function UnaryOp(op,expr){Node.call(this);this.op=op;this.expr=expr};UnaryOp.prototype.__proto__=Node.prototype;UnaryOp.prototype.clone=function(parent){var clone=new UnaryOp(this.op);clone.expr=this.expr.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};UnaryOp.prototype.toJSON=function(){return{__type:\"UnaryOp\",op:this.op,expr:this.expr,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/unit.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var FACTOR_TABLE={mm:{val:1,label:\"mm\"},cm:{val:10,label:\"mm\"},\"in\":{val:25.4,label:\"mm\"},pt:{val:25.4/72,label:\"mm\"},ms:{val:1,label:\"ms\"},s:{val:1e3,label:\"ms\"},Hz:{val:1,label:\"Hz\"},kHz:{val:1e3,label:\"Hz\"}};var Unit=module.exports=function Unit(val,type){Node.call(this);this.val=val;this.type=type};Unit.prototype.__proto__=Node.prototype;Unit.prototype.toBoolean=function(){return nodes.Boolean(this.type?true:this.val)};Unit.prototype.toString=function(){return this.val+(this.type||\"\")};Unit.prototype.clone=function(){var clone=new Unit(this.val,this.type);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Unit.prototype.toJSON=function(){return{__type:\"Unit\",val:this.val,type:this.type,lineno:this.lineno,column:this.column,filename:this.filename}};Unit.prototype.operate=function(op,right){var type=this.type||right.first.type;if(\"rgba\"==right.nodeName||\"hsla\"==right.nodeName){return right.operate(op,this)}if(this.shouldCoerce(op)){right=right.first;if(\"%\"!=this.type&&(\"-\"==op||\"+\"==op)&&\"%\"==right.type){right=new Unit(this.val*(right.val/100),\"%\")}else{right=this.coerce(right)}switch(op){case\"-\":return new Unit(this.val-right.val,type);case\"+\":type=type||right.type==\"%\"&&right.type;return new Unit(this.val+right.val,type);case\"/\":return new Unit(this.val/right.val,type);case\"*\":return new Unit(this.val*right.val,type);case\"%\":return new Unit(this.val%right.val,type);case\"**\":return new Unit(Math.pow(this.val,right.val),type);case\"..\":case\"...\":var start=this.val,end=right.val,expr=new nodes.Expression,inclusive=\"..\"==op;if(start<end){do{expr.push(new nodes.Unit(start))}while(inclusive?++start<=end:++start<end)}else{do{expr.push(new nodes.Unit(start))}while(inclusive?--start>=end:--start>end)}return expr}}return Node.prototype.operate.call(this,op,right)};Unit.prototype.coerce=function(other){if(\"unit\"==other.nodeName){var a=this,b=other,factorA=FACTOR_TABLE[a.type],factorB=FACTOR_TABLE[b.type];if(factorA&&factorB&&factorA.label==factorB.label){var bVal=b.val*(factorB.val/factorA.val);return new nodes.Unit(bVal,a.type)}else{return new nodes.Unit(b.val,a.type)}}else if(\"string\"==other.nodeName){if(\"%\"==other.val)return new nodes.Unit(0,\"%\");var val=parseFloat(other.val);if(isNaN(val))Node.prototype.coerce.call(this,other);return new nodes.Unit(val)}else{return Node.prototype.coerce.call(this,other)}}});require.register(\"nodes/object.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\"),nativeObj={}.constructor;var Object=module.exports=function Object(){Node.call(this);this.vals={}};Object.prototype.__proto__=Node.prototype;Object.prototype.set=function(key,val){this.vals[key]=val;return this};Object.prototype.__defineGetter__(\"length\",function(){return nativeObj.keys(this.vals).length});Object.prototype.get=function(key){return this.vals[key]||nodes.nil};Object.prototype.has=function(key){return key in this.vals};Object.prototype.operate=function(op,right){switch(op){case\".\":case\"[]\":return this.get(right.hash);case\"==\":var vals=this.vals,a,b;if(\"object\"!=right.nodeName||this.length!=right.length)return nodes.no;for(var key in vals){a=vals[key];b=right.vals[key];if(a.operate(op,b).isFalse)return nodes.no}return nodes.yes;case\"!=\":return this.operate(\"==\",right).negate();default:return Node.prototype.operate.call(this,op,right)}};Object.prototype.toBoolean=function(){return nodes.Boolean(this.length)};Object.prototype.toBlock=function(){var str=\"{\",key,val;for(key in this.vals){val=this.get(key);if(\"object\"==val.first.nodeName){str+=key+\" \"+val.first.toBlock()}else{switch(key){case\"@charset\":str+=key+\" \"+val.first.toString()+\";\";break;default:str+=key+\":\"+toString(val)+\";\"}}}str+=\"}\";return str;function toString(node){if(node.nodes){return node.nodes.map(toString).join(node.isList?\",\":\" \")}else if(\"literal\"==node.nodeName&&\",\"==node.val){return\"\\\\,\"}return node.toString()}};Object.prototype.clone=function(parent){var clone=new Object;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;for(var key in this.vals){clone.vals[key]=this.vals[key].clone(parent,clone)}return clone};Object.prototype.toJSON=function(){return{__type:\"Object\",vals:this.vals,lineno:this.lineno,column:this.column,filename:this.filename}};Object.prototype.toString=function(){var obj={};for(var prop in this.vals){obj[prop]=this.vals[prop].toString()}return JSON.stringify(obj)}});require.register(\"nodes/supports.js\",function(module,exports,require){var Atrule=require(\"./atrule\");var Supports=module.exports=function Supports(condition){Atrule.call(this,\"supports\");this.condition=condition};Supports.prototype.__proto__=Atrule.prototype;Supports.prototype.clone=function(parent){var clone=new Supports;clone.condition=this.condition.clone(parent,clone);\nclone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Supports.prototype.toJSON=function(){return{__type:\"Supports\",condition:this.condition,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}};Supports.prototype.toString=function(){return\"@supports \"+this.condition}});require.register(\"nodes/member.js\",function(module,exports,require){var Node=require(\"./node\");var Member=module.exports=function Member(left,right){Node.call(this);this.left=left;this.right=right};Member.prototype.__proto__=Node.prototype;Member.prototype.clone=function(parent){var clone=new Member;clone.left=this.left.clone(parent,clone);clone.right=this.right.clone(parent,clone);if(this.val)clone.val=this.val.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Member.prototype.toJSON=function(){var json={__type:\"Member\",left:this.left,right:this.right,lineno:this.lineno,column:this.column,filename:this.filename};if(this.val)json.val=this.val;return json};Member.prototype.toString=function(){return this.left.toString()+\".\"+this.right.toString()}});require.register(\"nodes/atblock.js\",function(module,exports,require){var Node=require(\"./node\");var Atblock=module.exports=function Atblock(){Node.call(this)};Atblock.prototype.__defineGetter__(\"nodes\",function(){return this.block.nodes});Atblock.prototype.__proto__=Node.prototype;Atblock.prototype.clone=function(parent){var clone=new Atblock;clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Atblock.prototype.toString=function(){return\"@block\"};Atblock.prototype.toJSON=function(){return{__type:\"Atblock\",block:this.block,lineno:this.lineno,column:this.column,fileno:this.fileno}}});require.register(\"nodes/atrule.js\",function(module,exports,require){var Node=require(\"./node\");var Atrule=module.exports=function Atrule(type){Node.call(this);this.type=type};Atrule.prototype.__proto__=Node.prototype;Atrule.prototype.__defineGetter__(\"hasOnlyProperties\",function(){if(!this.block)return false;var nodes=this.block.nodes;for(var i=0,len=nodes.length;i<len;++i){var nodeName=nodes[i].nodeName;switch(nodes[i].nodeName){case\"property\":case\"expression\":case\"comment\":continue;default:return false}}return true});Atrule.prototype.clone=function(parent){var clone=new Atrule(this.type);if(this.block)clone.block=this.block.clone(parent,clone);clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Atrule.prototype.toJSON=function(){var json={__type:\"Atrule\",type:this.type,segments:this.segments,lineno:this.lineno,column:this.column,filename:this.filename};if(this.block)json.block=this.block;return json};Atrule.prototype.toString=function(){return\"@\"+this.type};Atrule.prototype.__defineGetter__(\"hasOutput\",function(){return!!this.block&&hasOutput(this.block)});function hasOutput(block){var nodes=block.nodes;if(nodes.every(function(node){return\"group\"==node.nodeName&&node.hasOnlyPlaceholders}))return false;return nodes.some(function(node){switch(node.nodeName){case\"property\":case\"literal\":case\"import\":return true;case\"block\":return hasOutput(node);default:if(node.block)return hasOutput(node.block)}})}});require.register(\"parser.js\",function(module,exports,require){var Lexer=require(\"./lexer\"),nodes=require(\"./nodes\"),Token=require(\"./token\"),units=require(\"./units\"),errors=require(\"./errors\");var selectorTokens=[\"ident\",\"string\",\"selector\",\"function\",\"comment\",\"boolean\",\"space\",\"color\",\"unit\",\"for\",\"in\",\"[\",\"]\",\"(\",\")\",\"+\",\"-\",\"*\",\"*=\",\"<\",\">\",\"=\",\":\",\"&\",\"&&\",\"~\",\"{\",\"}\",\".\",\"..\",\"/\"];var pseudoSelectors=[\"matches\",\"not\",\"dir\",\"lang\",\"any-link\",\"link\",\"visited\",\"local-link\",\"target\",\"scope\",\"hover\",\"active\",\"focus\",\"drop\",\"current\",\"past\",\"future\",\"enabled\",\"disabled\",\"read-only\",\"read-write\",\"placeholder-shown\",\"checked\",\"indeterminate\",\"valid\",\"invalid\",\"in-range\",\"out-of-range\",\"required\",\"optional\",\"user-error\",\"root\",\"empty\",\"blank\",\"nth-child\",\"nth-last-child\",\"first-child\",\"last-child\",\"only-child\",\"nth-of-type\",\"nth-last-of-type\",\"first-of-type\",\"last-of-type\",\"only-of-type\",\"nth-match\",\"nth-last-match\",\"nth-column\",\"nth-last-column\",\"first-line\",\"first-letter\",\"before\",\"after\",\"selection\"];var Parser=module.exports=function Parser(str,options){var self=this;options=options||{};this.lexer=new Lexer(str,options);this.prefix=options.prefix||\"\";this.root=options.root||new nodes.Root;this.state=[\"root\"];this.stash=[];this.parens=0;this.css=0;this.state.pop=function(){self.prevState=[].pop.call(this)}};Parser.prototype={constructor:Parser,currentState:function(){return this.state[this.state.length-1]},previousState:function(){return this.state[this.state.length-2]},parse:function(){var block=this.parent=this.root;while(\"eos\"!=this.peek().type){this.skipWhitespace();if(\"eos\"==this.peek().type)break;var stmt=this.statement();this.accept(\";\");if(!stmt)this.error(\"unexpected token {peek}, not allowed at the root level\");block.push(stmt)}return block},error:function(msg){var type=this.peek().type,val=undefined==this.peek().val?\"\":\" \"+this.peek().toString();if(val.trim()==type.trim())val=\"\";throw new errors.ParseError(msg.replace(\"{peek}\",'\"'+type+val+'\"'))},accept:function(type){if(type==this.peek().type){return this.next()}},expect:function(type){if(type!=this.peek().type){this.error('expected \"'+type+'\", got {peek}')}return this.next()},next:function(){var tok=this.stash.length?this.stash.pop():this.lexer.next(),line=tok.lineno,column=tok.column||1;if(tok.val&&tok.val.nodeName){tok.val.lineno=line;tok.val.column=column}nodes.lineno=line;nodes.column=column;return tok},peek:function(){return this.lexer.peek()},lookahead:function(n){return this.lexer.lookahead(n)},isSelectorToken:function(n){var la=this.lookahead(n).type;switch(la){case\"for\":return this.bracketed;case\"[\":this.bracketed=true;return true;case\"]\":this.bracketed=false;return true;default:return~selectorTokens.indexOf(la)}},isPseudoSelector:function(n){var val=this.lookahead(n).val;return val&&~pseudoSelectors.indexOf(val.name)},lineContains:function(type){var i=1,la;while(la=this.lookahead(i++)){if(~[\"indent\",\"outdent\",\"newline\",\"eos\"].indexOf(la.type))return;if(type==la.type)return true}},selectorToken:function(){if(this.isSelectorToken(1)){if(\"{\"==this.peek().type){if(!this.lineContains(\"}\"))return;var i=0,la;while(la=this.lookahead(++i)){if(\"}\"==la.type){if(i==2||i==3&&this.lookahead(i-1).type==\"space\")return;break}if(\":\"==la.type)return}}return this.next()}},skip:function(tokens){while(~tokens.indexOf(this.peek().type))this.next()},skipWhitespace:function(){this.skip([\"space\",\"indent\",\"outdent\",\"newline\"])},skipNewlines:function(){while(\"newline\"==this.peek().type)this.next()},skipSpaces:function(){while(\"space\"==this.peek().type)this.next()},skipSpacesAndComments:function(){while(\"space\"==this.peek().type||\"comment\"==this.peek().type)this.next()},looksLikeFunctionDefinition:function(i){return\"indent\"==this.lookahead(i).type||\"{\"==this.lookahead(i).type},looksLikeSelector:function(fromProperty){var i=1,brace;if(fromProperty&&\":\"==this.lookahead(i+1).type&&(this.lookahead(i+1).space||\"indent\"==this.lookahead(i+2).type))return false;while(\"ident\"==this.lookahead(i).type&&(\"newline\"==this.lookahead(i+1).type||\",\"==this.lookahead(i+1).type))i+=2;while(this.isSelectorToken(i)||\",\"==this.lookahead(i).type){if(\"selector\"==this.lookahead(i).type)return true;if(\"&\"==this.lookahead(i+1).type)return true;if(\".\"==this.lookahead(i).type&&\"ident\"==this.lookahead(i+1).type)return true;if(\"*\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true;if(\":\"==this.lookahead(i).type&&\":\"==this.lookahead(i+1).type)return true;if(\"color\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i-1).type)return true;if(this.looksLikeAttributeSelector(i))return true;if((\"=\"==this.lookahead(i).type||\"function\"==this.lookahead(i).type)&&\"{\"==this.lookahead(i+1).type)return false;if(\":\"==this.lookahead(i).type&&!this.isPseudoSelector(i+1)&&this.lineContains(\".\"))return false;if(\"{\"==this.lookahead(i).type)brace=true;else if(\"}\"==this.lookahead(i).type)brace=false;if(brace&&\":\"==this.lookahead(i).type)return true;if(\"space\"==this.lookahead(i).type&&\"{\"==this.lookahead(i+1).type)return true;if(\":\"==this.lookahead(i++).type&&!this.lookahead(i-1).space&&this.isPseudoSelector(i))return true;if(\"space\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type&&\"{\"==this.lookahead(i+2).type)return true;if(\",\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true}if(\",\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true;if(\"{\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true;if(this.css){if(\";\"==this.lookahead(i).type||\"}\"==this.lookahead(i-1).type)return false}while(!~[\"indent\",\"outdent\",\"newline\",\"for\",\"if\",\";\",\"}\",\"eos\"].indexOf(this.lookahead(i).type))++i;if(\"indent\"==this.lookahead(i).type)return true},looksLikeAttributeSelector:function(n){var type=this.lookahead(n).type;if(\"=\"==type&&this.bracketed)return true;return(\"ident\"==type||\"string\"==type)&&\"]\"==this.lookahead(n+1).type&&(\"newline\"==this.lookahead(n+2).type||this.isSelectorToken(n+2))&&!this.lineContains(\":\")&&!this.lineContains(\"=\")},looksLikeKeyframe:function(){var i=2,type;switch(this.lookahead(i).type){case\"{\":case\"indent\":case\",\":return true;case\"newline\":while(\"unit\"==this.lookahead(++i).type||\"newline\"==this.lookahead(i).type);type=this.lookahead(i).type;return\"indent\"==type||\"{\"==type}},stateAllowsSelector:function(){switch(this.currentState()){case\"root\":case\"atblock\":case\"selector\":case\"conditional\":case\"function\":case\"atrule\":case\"for\":return true}},assignAtblock:function(expr){try{expr.push(this.atblock(expr))}catch(err){this.error(\"invalid right-hand side operand in assignment, got {peek}\")}},statement:function(){var stmt=this.stmt(),state=this.prevState,block,op;if(this.allowPostfix){this.allowPostfix=false;state=\"expression\"}switch(state){case\"assignment\":case\"expression\":case\"function arguments\":while(op=this.accept(\"if\")||this.accept(\"unless\")||this.accept(\"for\")){switch(op.type){case\"if\":case\"unless\":stmt=new nodes.If(this.expression(),stmt);stmt.postfix=true;stmt.negate=\"unless\"==op.type;this.accept(\";\");break;case\"for\":var key,val=this.id().name;if(this.accept(\",\"))key=this.id().name;this.expect(\"in\");var each=new nodes.Each(val,key,this.expression());block=new nodes.Block(this.parent,each);block.push(stmt);each.block=block;stmt=each}}}return stmt},stmt:function(){var type=this.peek().type;switch(type){case\"keyframes\":return this.keyframes();case\"-moz-document\":return this.mozdocument();case\"comment\":case\"selector\":case\"extend\":case\"literal\":case\"charset\":case\"namespace\":case\"require\":case\"extend\":case\"media\":case\"atrule\":case\"ident\":case\"scope\":case\"supports\":case\"unless\":return this[type]();case\"function\":return this.fun();case\"import\":return this.atimport();case\"if\":return this.ifstmt();case\"for\":return this.forin();case\"return\":return this.ret();case\"{\":return this.property();default:if(this.stateAllowsSelector()){switch(type){case\"color\":case\"~\":case\">\":case\"<\":case\":\":case\"&\":case\"&&\":case\"[\":case\".\":case\"/\":return this.selector();case\"..\":if(\"/\"==this.lookahead(2).type)return this.selector();case\"+\":return\"function\"==this.lookahead(2).type?this.functionCall():this.selector();case\"*\":return this.property();case\"unit\":if(this.looksLikeKeyframe())return this.selector();case\"-\":if(\"{\"==this.lookahead(2).type)return this.property()}}var expr=this.expression();if(expr.isEmpty)this.error(\"unexpected {peek}\");return expr}},block:function(node,scope){var delim,stmt,next,block=this.parent=new nodes.Block(this.parent,node);if(false===scope)block.scope=false;this.accept(\"newline\");if(this.accept(\"{\")){this.css++;delim=\"}\";this.skipWhitespace()}else{delim=\"outdent\";this.expect(\"indent\")}while(delim!=this.peek().type){if(this.css){if(this.accept(\"newline\")||this.accept(\"indent\"))continue;stmt=this.statement();this.accept(\";\");this.skipWhitespace()}else{if(this.accept(\"newline\"))continue;next=this.lookahead(2).type;if(\"indent\"==this.peek().type&&~[\"outdent\",\"newline\",\"comment\"].indexOf(next)){this.skip([\"indent\",\"outdent\"]);continue}if(\"eos\"==this.peek().type)return block;stmt=this.statement();this.accept(\";\")}if(!stmt)this.error(\"unexpected token {peek} in block\");block.push(stmt)}if(this.css){this.skipWhitespace();this.expect(\"}\");this.skipSpaces();this.css--}else{this.expect(\"outdent\")}this.parent=block.parent;return block},comment:function(){var node=this.next().val;this.skipSpaces();return node},forin:function(){this.expect(\"for\");var key,val=this.id().name;if(this.accept(\",\"))key=this.id().name;this.expect(\"in\");this.state.push(\"for\");this.cond=true;var each=new nodes.Each(val,key,this.expression());this.cond=false;each.block=this.block(each,false);this.state.pop();return each},ret:function(){this.expect(\"return\");var expr=this.expression();return expr.isEmpty?new nodes.Return:new nodes.Return(expr)},unless:function(){this.expect(\"unless\");this.state.push(\"conditional\");this.cond=true;var node=new nodes.If(this.expression(),true);this.cond=false;node.block=this.block(node,false);this.state.pop();return node},ifstmt:function(){this.expect(\"if\");this.state.push(\"conditional\");this.cond=true;var node=new nodes.If(this.expression()),cond,block;this.cond=false;node.block=this.block(node,false);this.skip([\"newline\",\"comment\"]);while(this.accept(\"else\")){if(this.accept(\"if\")){this.cond=true;cond=this.expression();this.cond=false;block=this.block(node,false);node.elses.push(new nodes.If(cond,block))}else{node.elses.push(this.block(node,false));break}this.skip([\"newline\",\"comment\"])}this.state.pop();return node},atblock:function(node){if(!node)this.expect(\"atblock\");node=new nodes.Atblock;this.state.push(\"atblock\");node.block=this.block(node,false);this.state.pop();return node},atrule:function(){var type=this.expect(\"atrule\").val,node=new nodes.Atrule(type),tok;this.skipSpacesAndComments();node.segments=this.selectorParts();this.skipSpacesAndComments();tok=this.peek().type;if(\"indent\"==tok||\"{\"==tok||\"newline\"==tok&&\"{\"==this.lookahead(2).type){this.state.push(\"atrule\");node.block=this.block(node);this.state.pop()}return node},scope:function(){this.expect(\"scope\");var selector=this.selectorParts().map(function(selector){return selector.val}).join(\"\");this.selectorScope=selector.trim();return nodes.nil},supports:function(){this.expect(\"supports\");var node=new nodes.Supports(this.supportsCondition());this.state.push(\"atrule\");node.block=this.block(node);this.state.pop();return node},supportsCondition:function(){var node=this.supportsNegation()||this.supportsOp();if(!node){this.cond=true;node=this.expression();this.cond=false}return node},supportsNegation:function(){if(this.accept(\"not\")){var node=new nodes.Expression;node.push(new nodes.Literal(\"not\"));node.push(this.supportsFeature());return node}},supportsOp:function(){var feature=this.supportsFeature(),op,expr;if(feature){expr=new nodes.Expression;expr.push(feature);while(op=this.accept(\"&&\")||this.accept(\"||\")){expr.push(new nodes.Literal(\"&&\"==op.val?\"and\":\"or\"));expr.push(this.supportsFeature())}return expr}},supportsFeature:function(){this.skipSpacesAndComments();if(\"(\"==this.peek().type){var la=this.lookahead(2).type;if(\"ident\"==la||\"{\"==la){return this.feature()}else{this.expect(\"(\");var node=new nodes.Expression;node.push(new nodes.Literal(\"(\"));node.push(this.supportsCondition());this.expect(\")\");node.push(new nodes.Literal(\")\"));this.skipSpacesAndComments();return node}}},extend:function(){var tok=this.expect(\"extend\"),selectors=[],sel,node,arr;do{arr=this.selectorParts();if(!arr.length)continue;sel=new nodes.Selector(arr);selectors.push(sel);if(\"!\"!==this.peek().type)continue;tok=this.lookahead(2);if(\"ident\"!==tok.type||\"optional\"!==tok.val.name)continue;this.skip([\"!\",\"ident\"]);sel.optional=true}while(this.accept(\",\"));node=new nodes.Extend(selectors);node.lineno=tok.lineno;node.column=tok.column;return node},media:function(){this.expect(\"media\");this.state.push(\"atrule\");var media=new nodes.Media(this.queries());media.block=this.block(media);this.state.pop();return media},queries:function(){var queries=new nodes.QueryList,skip=[\"comment\",\"newline\",\"space\"];do{this.skip(skip);queries.push(this.query());this.skip(skip)}while(this.accept(\",\"));return queries},query:function(){var query=new nodes.Query,expr,pred,id;if(\"ident\"==this.peek().type&&(\".\"==this.lookahead(2).type||\"[\"==this.lookahead(2).type)){this.cond=true;expr=this.expression();this.cond=false;query.push(new nodes.Feature(expr.nodes));return query}if(pred=this.accept(\"ident\")||this.accept(\"not\")){pred=new nodes.Literal(pred.val.string||pred.val);this.skipSpacesAndComments();if(id=this.accept(\"ident\")){query.type=id.val;query.predicate=pred}else{query.type=pred}this.skipSpacesAndComments();if(!this.accept(\"&&\"))return query}do{query.push(this.feature())}while(this.accept(\"&&\"));return query},feature:function(){this.skipSpacesAndComments();this.expect(\"(\");this.skipSpacesAndComments();var node=new nodes.Feature(this.interpolate());this.skipSpacesAndComments();this.accept(\":\");this.skipSpacesAndComments();this.inProperty=true;node.expr=this.list();this.inProperty=false;this.skipSpacesAndComments();this.expect(\")\");this.skipSpacesAndComments();return node},mozdocument:function(){this.expect(\"-moz-document\");var mozdocument=new nodes.Atrule(\"-moz-document\"),calls=[];do{this.skipSpacesAndComments();calls.push(this.functionCall());this.skipSpacesAndComments()}while(this.accept(\",\"));mozdocument.segments=[new nodes.Literal(calls.join(\", \"))];this.state.push(\"atrule\");mozdocument.block=this.block(mozdocument,false);this.state.pop();return mozdocument},atimport:function(){this.expect(\"import\");this.allowPostfix=true;return new nodes.Import(this.expression(),false)},require:function(){this.expect(\"require\");this.allowPostfix=true;return new nodes.Import(this.expression(),true)},charset:function(){this.expect(\"charset\");var str=this.expect(\"string\").val;this.allowPostfix=true;return new nodes.Charset(str)},namespace:function(){var str,prefix;this.expect(\"namespace\");this.skipSpacesAndComments();if(prefix=this.accept(\"ident\")){prefix=prefix.val}this.skipSpacesAndComments();str=this.accept(\"string\")||this.url();this.allowPostfix=true;return new nodes.Namespace(str,prefix)},keyframes:function(){var tok=this.expect(\"keyframes\"),keyframes;this.skipSpacesAndComments();keyframes=new nodes.Keyframes(this.selectorParts(),tok.val);this.skipSpacesAndComments();this.state.push(\"atrule\");keyframes.block=this.block(keyframes);this.state.pop();return keyframes},literal:function(){return this.expect(\"literal\").val},id:function(){var tok=this.expect(\"ident\");this.accept(\"space\");return tok.val},ident:function(){var i=2,la=this.lookahead(i).type;while(\"space\"==la)la=this.lookahead(++i).type;switch(la){case\"=\":case\"?=\":case\"-=\":case\"+=\":case\"*=\":case\"/=\":case\"%=\":return this.assignment();case\".\":if(\"space\"==this.lookahead(i-1).type)return this.selector();if(this._ident==this.peek())return this.id();while(\"=\"!=this.lookahead(++i).type&&!~[\"[\",\",\",\"newline\",\"indent\",\"eos\"].indexOf(this.lookahead(i).type));if(\"=\"==this.lookahead(i).type){this._ident=this.peek();return this.expression()}else if(this.looksLikeSelector()&&this.stateAllowsSelector()){return this.selector()}case\"[\":if(this._ident==this.peek())return this.id();while(\"]\"!=this.lookahead(i++).type&&\"selector\"!=this.lookahead(i).type&&\"eos\"!=this.lookahead(i).type);if(\"=\"==this.lookahead(i).type){this._ident=this.peek();return this.expression()}else if(this.looksLikeSelector()&&this.stateAllowsSelector()){return this.selector()}case\"-\":case\"+\":case\"/\":case\"*\":case\"%\":case\"**\":case\"&&\":case\"||\":case\">\":case\"<\":case\">=\":case\"<=\":case\"!=\":case\"==\":case\"?\":case\"in\":case\"is a\":case\"is defined\":if(this._ident==this.peek()){return this.id()}else{this._ident=this.peek();switch(this.currentState()){case\"for\":case\"selector\":return this.property();case\"root\":case\"atblock\":case\"atrule\":return\"[\"==la?this.subscript():this.selector();case\"function\":case\"conditional\":return this.looksLikeSelector()?this.selector():this.expression();default:return this.operand?this.id():this.expression()}}default:switch(this.currentState()){case\"root\":return this.selector();case\"for\":case\"selector\":case\"function\":case\"conditional\":case\"atblock\":case\"atrule\":return this.property();default:var id=this.id();if(\"interpolation\"==this.previousState())id.mixin=true;return id}}},interpolate:function(){var node,segs=[],star;star=this.accept(\"*\");if(star)segs.push(new nodes.Literal(\"*\"));while(true){if(this.accept(\"{\")){this.state.push(\"interpolation\");segs.push(this.expression());this.expect(\"}\");this.state.pop()}else if(node=this.accept(\"-\")){segs.push(new nodes.Literal(\"-\"))}else if(node=this.accept(\"ident\")){segs.push(node.val)}else{break}}if(!segs.length)this.expect(\"ident\");return segs},property:function(){if(this.looksLikeSelector(true))return this.selector();var ident=this.interpolate(),prop=new nodes.Property(ident),ret=prop;this.accept(\"space\");if(this.accept(\":\"))this.accept(\"space\");this.state.push(\"property\");this.inProperty=true;prop.expr=this.list();if(prop.expr.isEmpty)ret=ident[0];this.inProperty=false;this.allowPostfix=true;this.state.pop();this.accept(\";\");return ret},selector:function(){var arr,group=new nodes.Group,scope=this.selectorScope,isRoot=\"root\"==this.currentState(),selector;do{this.accept(\"newline\");arr=this.selectorParts();if(isRoot&&scope)arr.unshift(new nodes.Literal(scope+\" \"));if(arr.length){selector=new nodes.Selector(arr);selector.lineno=arr[0].lineno;selector.column=arr[0].column;group.push(selector)}}while(this.accept(\",\")||this.accept(\"newline\"));if(\"selector-parts\"==this.currentState())return group.nodes;this.state.push(\"selector\");group.block=this.block(group);this.state.pop();return group},selectorParts:function(){var tok,arr=[];while(tok=this.selectorToken()){switch(tok.type){case\"{\":this.skipSpaces();var expr=this.expression();this.skipSpaces();this.expect(\"}\");arr.push(expr);break;case this.prefix&&\".\":var literal=new nodes.Literal(tok.val+this.prefix);literal.prefixed=true;arr.push(literal);break;case\"comment\":break;case\"color\":case\"unit\":arr.push(new nodes.Literal(tok.val.raw));break;case\"space\":arr.push(new nodes.Literal(\" \"));break;case\"function\":arr.push(new nodes.Literal(tok.val.name+\"(\"));break;case\"ident\":arr.push(new nodes.Literal(tok.val.name||tok.val.string));break;default:arr.push(new nodes.Literal(tok.val));if(tok.space)arr.push(new nodes.Literal(\" \"))}}return arr},assignment:function(){var op,node,name=this.id().name;if(op=this.accept(\"=\")||this.accept(\"?=\")||this.accept(\"+=\")||this.accept(\"-=\")||this.accept(\"*=\")||this.accept(\"/=\")||this.accept(\"%=\")){this.state.push(\"assignment\");var expr=this.list();if(expr.isEmpty)this.assignAtblock(expr);node=new nodes.Ident(name,expr);this.state.pop();switch(op.type){case\"?=\":var defined=new nodes.BinOp(\"is defined\",node),lookup=new nodes.Ident(name);node=new nodes.Ternary(defined,lookup,node);break;case\"+=\":case\"-=\":case\"*=\":case\"/=\":case\"%=\":node.val=new nodes.BinOp(op.type[0],new nodes.Ident(name),expr);break}}return node},fun:function(){var parens=1,i=2,tok;out:while(tok=this.lookahead(i++)){switch(tok.type){case\"function\":case\"(\":++parens;break;case\")\":if(!--parens)break out;break;case\"eos\":this.error('failed to find closing paren \")\"')}}switch(this.currentState()){case\"expression\":return this.functionCall();default:return this.looksLikeFunctionDefinition(i)?this.functionDefinition():this.expression()}},url:function(){this.expect(\"function\");this.state.push(\"function arguments\");var args=this.args();this.expect(\")\");this.state.pop();return new nodes.Call(\"url\",args)},functionCall:function(){var withBlock=this.accept(\"+\");if(\"url\"==this.peek().val.name)return this.url();var name=this.expect(\"function\").val.name;this.state.push(\"function arguments\");this.parens++;var args=this.args();this.expect(\")\");this.parens--;this.state.pop();var call=new nodes.Call(name,args);if(withBlock){this.state.push(\"function\");call.block=this.block(call);this.state.pop()}return call},functionDefinition:function(){var name=this.expect(\"function\").val.name;this.state.push(\"function params\");this.skipWhitespace();var params=this.params();this.skipWhitespace();this.expect(\")\");this.state.pop();this.state.push(\"function\");var fn=new nodes.Function(name,params);fn.block=this.block(fn);this.state.pop();return new nodes.Ident(name,fn)},params:function(){var tok,node,params=new nodes.Params;while(tok=this.accept(\"ident\")){this.accept(\"space\");params.push(node=tok.val);if(this.accept(\"...\")){node.rest=true}else if(this.accept(\"=\")){node.val=this.expression()}this.skipWhitespace();this.accept(\",\");this.skipWhitespace()}return params},args:function(){var args=new nodes.Arguments,keyword;do{if(\"ident\"==this.peek().type&&\":\"==this.lookahead(2).type){keyword=this.next().val.string;this.expect(\":\");args.map[keyword]=this.expression()}else{args.push(this.expression())}}while(this.accept(\",\"));return args},list:function(){var node=this.expression();while(this.accept(\",\")){if(node.isList){list.push(this.expression())}else{var list=new nodes.Expression(true);list.push(node);list.push(this.expression());node=list}}return node},expression:function(){var node,expr=new nodes.Expression;this.state.push(\"expression\");while(node=this.negation()){if(!node)this.error(\"unexpected token {peek} in expression\");expr.push(node)}this.state.pop();if(expr.nodes.length){expr.lineno=expr.nodes[0].lineno;expr.column=expr.nodes[0].column}return expr},negation:function(){if(this.accept(\"not\")){return new nodes.UnaryOp(\"!\",this.negation())}return this.ternary()},ternary:function(){var node=this.logical();if(this.accept(\"?\")){var trueExpr=this.expression();this.expect(\":\");var falseExpr=this.expression();node=new nodes.Ternary(node,trueExpr,falseExpr)}return node},logical:function(){var op,node=this.typecheck();while(op=this.accept(\"&&\")||this.accept(\"||\")){node=new nodes.BinOp(op.type,node,this.typecheck())}return node},typecheck:function(){var op,node=this.equality();while(op=this.accept(\"is a\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.equality());this.operand=false}return node},equality:function(){var op,node=this.inop();while(op=this.accept(\"==\")||this.accept(\"!=\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.inop());this.operand=false}return node},inop:function(){var node=this.relational();while(this.accept(\"in\")){this.operand=true;if(!node)this.error('illegal unary \"in\", missing left-hand operand');node=new nodes.BinOp(\"in\",node,this.relational());this.operand=false}return node},relational:function(){var op,node=this.range();while(op=this.accept(\">=\")||this.accept(\"<=\")||this.accept(\"<\")||this.accept(\">\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.range());this.operand=false}return node},range:function(){var op,node=this.additive();if(op=this.accept(\"...\")||this.accept(\"..\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.val,node,this.additive());this.operand=false}return node},additive:function(){var op,node=this.multiplicative();while(op=this.accept(\"+\")||this.accept(\"-\")){this.operand=true;node=new nodes.BinOp(op.type,node,this.multiplicative());this.operand=false}return node},multiplicative:function(){var op,node=this.defined();while(op=this.accept(\"**\")||this.accept(\"*\")||this.accept(\"/\")||this.accept(\"%\")){this.operand=true;if(\"/\"==op&&this.inProperty&&!this.parens){this.stash.push(new Token(\"literal\",new nodes.Literal(\"/\")));this.operand=false;return node}else{if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.defined());this.operand=false}}return node},defined:function(){var node=this.unary();if(this.accept(\"is defined\")){if(!node)this.error('illegal unary \"is defined\", missing left-hand operand');node=new nodes.BinOp(\"is defined\",node)}return node},unary:function(){var op,node;if(op=this.accept(\"!\")||this.accept(\"~\")||this.accept(\"+\")||this.accept(\"-\")){this.operand=true;node=this.unary();if(!node)this.error('illegal unary \"'+op+'\"');node=new nodes.UnaryOp(op.type,node);this.operand=false;return node}return this.subscript()},subscript:function(){var node=this.member(),id;while(this.accept(\"[\")){node=new nodes.BinOp(\"[]\",node,this.expression());this.expect(\"]\")}if(this.accept(\"=\")){node.op+=\"=\";node.val=this.list();if(node.val.isEmpty)this.assignAtblock(node.val)}return node},member:function(){var node=this.primary();if(node){while(this.accept(\".\")){var id=new nodes.Ident(this.expect(\"ident\").val.string);node=new nodes.Member(node,id)}this.skipSpaces();if(this.accept(\"=\")){node.val=this.list();if(node.val.isEmpty)this.assignAtblock(node.val)}}return node},object:function(){var obj=new nodes.Object,id,val,comma;this.expect(\"{\");this.skipWhitespace();while(!this.accept(\"}\")){if(this.accept(\"comment\")||this.accept(\"newline\"))continue;if(!comma)this.accept(\",\");id=this.accept(\"ident\")||this.accept(\"string\");if(!id)this.error('expected \"ident\" or \"string\", got {peek}');id=id.val.hash;this.skipSpacesAndComments();this.expect(\":\");val=this.expression();obj.set(id,val);comma=this.accept(\",\");this.skipWhitespace()}return obj},primary:function(){var tok;this.skipSpaces();if(this.accept(\"(\")){++this.parens;var expr=this.expression(),paren=this.expect(\")\");--this.parens;if(this.accept(\"%\"))expr.push(new nodes.Ident(\"%\"));tok=this.peek();if(!paren.space&&\"ident\"==tok.type&&~units.indexOf(tok.val.string)){expr.push(new nodes.Ident(tok.val.string));this.next()}return expr}tok=this.peek();switch(tok.type){case\"null\":case\"unit\":case\"color\":case\"string\":case\"literal\":case\"boolean\":case\"comment\":return this.next().val;case!this.cond&&\"{\":return this.object();case\"atblock\":return this.atblock();case\"atrule\":var id=new nodes.Ident(this.next().val);id.property=true;return id;case\"ident\":return this.ident();case\"function\":return tok.anonymous?this.functionDefinition():this.functionCall()}}}});require.register(\"renderer.js\",function(module,exports,require){var Parser=require(\"./parser\"),Evaluator=require(\"./visitor/evaluator\"),Normalizer=require(\"./visitor/normalizer\"),utils=require(\"./utils\"),nodes=require(\"./nodes\"),join=require(\"./path\").join;module.exports=Renderer;function Renderer(str,options){options=options||{};options.globals=options.globals||{};options.functions=options.functions||{};options.use=options.use||[];options.use=Array.isArray(options.use)?options.use:[options.use];options.imports=[];options.paths=options.paths||[];options.filename=options.filename||\"stylus\";options.Evaluator=options.Evaluator||Evaluator;this.options=options;this.str=str}Renderer.prototype.render=function(fn){var parser=this.parser=new Parser(this.str,this.options);for(var i=0,len=this.options.use.length;i<len;i++){this.use(this.options.use[i])}try{nodes.filename=this.options.filename;var ast=parser.parse();this.evaluator=new this.options.Evaluator(ast,this.options);this.nodes=nodes;this.evaluator.renderer=this;ast=this.evaluator.evaluate();var normalizer=new Normalizer(ast,this.options);ast=normalizer.normalize();var compiler=this.options.sourcemap?new(require(\"./visitor/sourcemapper\"))(ast,this.options):new(require(\"./visitor/compiler\"))(ast,this.options),css=compiler.compile();if(this.options.sourcemap)this.sourcemap=compiler.map.toJSON()}catch(err){var options={};options.input=err.input||this.str;options.filename=err.filename||this.options.filename;\noptions.lineno=err.lineno||parser.lexer.lineno;options.column=err.column||parser.lexer.column;if(!fn)throw utils.formatException(err,options);return fn(utils.formatException(err,options))}if(!fn)return css;fn(null,css)};Renderer.prototype.deps=function(filename){if(filename)this.options.filename=filename;var DepsResolver=require(\"./visitor/deps-resolver\"),parser=new Parser(this.str,this.options);try{nodes.filename=this.options.filename;var ast=parser.parse(),resolver=new DepsResolver(ast,this.options);return resolver.resolve()}catch(err){var options={};options.input=err.input||this.str;options.filename=err.filename||this.options.filename;options.lineno=err.lineno||parser.lexer.lineno;options.column=err.column||parser.lexer.column;throw utils.formatException(err,options)}};Renderer.prototype.set=function(key,val){this.options[key]=val;return this};Renderer.prototype.get=function(key){return this.options[key]};Renderer.prototype.include=function(path){this.options.paths.push(path);return this};Renderer.prototype.use=function(fn){fn.call(this,this);return this};Renderer.prototype.define=function(name,fn,raw){fn=utils.coerce(fn,raw);if(fn.nodeName){this.options.globals[name]=fn;return this}this.options.functions[name]=fn;if(undefined!=raw)fn.raw=raw;return this}});require.register(\"selector-parser.js\",function(module,exports,require){var COMBINATORS=[\">\",\"+\",\"~\"];var SelectorParser=module.exports=function SelectorParser(str,stack,parts){this.str=str;this.stack=stack||[];this.parts=parts||[];this.pos=0;this.level=2;this.nested=true;this.ignore=false};SelectorParser.prototype.skip=function(len){this.str=this.str.substr(len);this.pos+=len};SelectorParser.prototype.skipSpaces=function(){while(\" \"==this.str[0])this.skip(1)};SelectorParser.prototype.advance=function(){return this.root()||this.relative()||this.escaped()||this.parent()||this.partial()||this.char()};SelectorParser.prototype.root=function(){if(!this.pos&&\"/\"==this.str[0]&&\"deep\"!=this.str.slice(1,5)){this.nested=false;this.skip(1)}};SelectorParser.prototype.relative=function(multi){if((!this.pos||multi)&&\"../\"==this.str.slice(0,3)){this.nested=false;this.skip(3);while(this.relative(true))this.level++;if(!this.raw){var ret=this.stack[this.stack.length-this.level];if(ret){return ret}else{this.ignore=true}}}};SelectorParser.prototype.escaped=function(){if(\"\\\\\"==this.str[0]){var char=this.str[1];if(\"&\"==char||\"^\"==char){this.skip(2);return char}}};SelectorParser.prototype.parent=function(){if(\"&\"==this.str[0]){if(!this.pos&&(!this.stack.length||this.raw)){var i=0;while(\" \"==this.str[++i]);if(~COMBINATORS.indexOf(this.str[i])){this.skip(i+1);return}}this.nested=false;this.skip(1);if(!this.raw)return this.stack[this.stack.length-1]}};SelectorParser.prototype.partial=function(){if(\"^\"==this.str[0]&&\"[\"==this.str[1]){this.skip(2);this.skipSpaces();var ret=this.range();this.skipSpaces();if(\"]\"!=this.str[0])return\"^[\";this.nested=false;this.skip(1);if(ret){return ret}else{this.ignore=true}}};SelectorParser.prototype.number=function(){var i=0,ret=\"\";if(\"-\"==this.str[i])ret+=this.str[i++];while(this.str.charCodeAt(i)>=48&&this.str.charCodeAt(i)<=57)ret+=this.str[i++];if(ret){this.skip(i);return Number(ret)}};SelectorParser.prototype.range=function(){var start=this.number(),ret;if(\"..\"==this.str.slice(0,2)){this.skip(2);var end=this.number(),len=this.parts.length;if(start<0)start=len+start-1;if(end<0)end=len+end-1;if(start>end){var tmp=start;start=end;end=tmp}if(end<len-1){ret=this.parts.slice(start,end+1).map(function(part){var selector=new SelectorParser(part,this.stack,this.parts);selector.raw=true;return selector.parse().val.trim()},this).join(\" \")}}else{ret=this.stack[start<0?this.stack.length+start-1:start]}if(ret){return ret}else{this.ignore=true}};SelectorParser.prototype.char=function(){var char=this.str[0];this.skip(1);return char};SelectorParser.prototype.parse=function(){var val=\"\";while(this.str.length){val+=this.advance()||\"\";if(this.ignore){val=\"\";break}}return{val:val.trimRight(),nested:this.nested}}});require.register(\"stack/index.js\",function(module,exports,require){var Stack=module.exports=function Stack(){Array.apply(this,arguments)};Stack.prototype.__proto__=Array.prototype;Stack.prototype.push=function(frame){frame.stack=this;frame.parent=this.currentFrame;return[].push.apply(this,arguments)};Stack.prototype.__defineGetter__(\"currentFrame\",function(){return this[this.length-1]});Stack.prototype.getBlockFrame=function(block){for(var i=0;i<this.length;++i){if(block==this[i].block){return this[i]}}};Stack.prototype.lookup=function(name){var block=this.currentFrame.block,val,ret;do{var frame=this.getBlockFrame(block);if(frame&&(val=frame.lookup(name))){return val}}while(block=block.parent)};Stack.prototype.inspect=function(){return this.reverse().map(function(frame){return frame.inspect()}).join(\"\\n\")};Stack.prototype.toString=function(){var block,node,buf=[],location,len=this.length;while(len--){block=this[len].block;if(node=block.node){location=\"(\"+node.filename+\":\"+(node.lineno+1)+\":\"+node.column+\")\";switch(node.nodeName){case\"function\":buf.push(\"    at \"+node.name+\"() \"+location);break;case\"group\":buf.push('    at \"'+node.nodes[0].val+'\" '+location);break}}}return buf.join(\"\\n\")}});require.register(\"stack/frame.js\",function(module,exports,require){var Scope=require(\"./scope\");var Frame=module.exports=function Frame(block){this._scope=false===block.scope?null:new Scope;this.block=block};Frame.prototype.__defineGetter__(\"scope\",function(){return this._scope||this.parent.scope});Frame.prototype.lookup=function(name){return this.scope.lookup(name)};Frame.prototype.inspect=function(){return\"[Frame \"+(false===this.block.scope?\"scope-less\":this.scope.inspect())+\"]\"}});require.register(\"stack/scope.js\",function(module,exports,require){var Scope=module.exports=function Scope(){this.locals={}};Scope.prototype.add=function(ident){this.locals[ident.name]=ident.val};Scope.prototype.lookup=function(name){return this.locals[name]};Scope.prototype.inspect=function(){var keys=Object.keys(this.locals).map(function(key){return\"@\"+key});return\"[Scope\"+(keys.length?\" \"+keys.join(\", \"):\"\")+\"]\"}});require.register(\"stylus.js\",function(module,exports,require){var Renderer=require(\"./renderer\"),nodes=require(\"./nodes\"),utils=require(\"./utils\");exports=module.exports=render;exports.version=\"0.53.0\";exports.nodes=nodes;exports.functions=require(\"./functions\");exports.utils=require(\"./utils\");exports.Visitor=require(\"./visitor\");exports.Parser=require(\"./parser\");exports.Evaluator=require(\"./visitor/evaluator\");exports.Normalizer=require(\"./visitor/normalizer\");exports.Compiler=require(\"./visitor/compiler\");exports.render=function(str,options,fn){if(\"function\"==typeof options)fn=options,options={};if(bifs)str=bifs+str;return new Renderer(str,options).render(fn)};function render(str,options){if(bifs)str=bifs+str;return new Renderer(str,options)}exports.url=require(\"./functions/url\")});require.register(\"token.js\",function(module,exports,require){var Token=exports=module.exports=function Token(type,val){this.type=type;this.val=val};Token.prototype.inspect=function(){var val=\" \"+this.val;return\"[Token:\"+this.lineno+\":\"+this.column+\" \"+\"\u001b[32m\"+this.type+\"\u001b[0m\"+\"\u001b[33m\"+(this.val?val:\"\")+\"\u001b[0m\"+\"]\"};Token.prototype.toString=function(){return(undefined===this.val?this.type:this.val).toString()}});require.register(\"utils.js\",function(module,exports,require){var nodes=require(\"./nodes\"),join=require(\"./path\").join,isAbsolute=require(\"./path\").isAbsolute;exports.absolute=isAbsolute||function(path){return path.substr(0,2)==\"\\\\\\\\\"||\"/\"===path.charAt(0)||/^[a-z]:[\\\\\\/]/i.test(path)};exports.lookup=function(path,paths,ignore){var lookup,i=paths.length;if(exports.absolute(path)){try{return path}catch(err){}}while(i--){try{lookup=join(paths[i],path);if(ignore==lookup)continue;return lookup}catch(err){}}};exports.find=function(path,paths,ignore){var lookup,found,i=paths.length;if(exports.absolute(path)){if((found=glob.sync(path)).length){return found}}while(i--){lookup=join(paths[i],path);if(ignore==lookup)continue;if((found=glob.sync(lookup)).length){return found}}};exports.lookupIndex=function(name,paths,filename){var found=exports.find(join(name,\"index.styl\"),paths,filename);if(!found){found=exports.find(join(name,basename(name).replace(/\\.styl/i,\"\")+\".styl\"),paths,filename)}if(!found&&!~name.indexOf(\"node_modules\")){found=lookupPackage(join(\"node_modules\",name))}return found;function lookupPackage(dir){var pkg=exports.lookup(join(dir,\"package.json\"),paths,filename);if(!pkg){return/\\.styl$/i.test(dir)?exports.lookupIndex(dir,paths,filename):lookupPackage(dir+\".styl\")}var main=require(relative(__dirname,pkg)).main;if(main){found=exports.find(join(dir,main),paths,filename)}else{found=exports.lookupIndex(dir,paths,filename)}return found}};exports.formatException=function(err,options){var lineno=options.lineno,column=options.column,filename=options.filename,str=options.input,context=options.context||8,context=context/2,lines=(\"\\n\"+str).split(\"\\n\"),start=Math.max(lineno-context,1),end=Math.min(lines.length,lineno+context),pad=end.toString().length;var context=lines.slice(start,end).map(function(line,i){var curr=i+start;return\"   \"+Array(pad-curr.toString().length+1).join(\" \")+curr+\"| \"+line+(curr==lineno?\"\\n\"+Array(curr.toString().length+5+column).join(\"-\")+\"^\":\"\")}).join(\"\\n\");err.message=filename+\":\"+lineno+\":\"+column+\"\\n\"+context+\"\\n\\n\"+err.message+\"\\n\"+(err.stylusStack?err.stylusStack+\"\\n\":\"\");if(err.fromStylus)err.stack=\"Error: \"+err.message;return err};exports.assertType=function(node,type,param){exports.assertPresent(node,param);if(node.nodeName==type)return;var actual=node.nodeName,msg=\"expected \"+(param?'\"'+param+'\" to be a ':\"\")+type+\", but got \"+actual+\":\"+node;throw new Error(\"TypeError: \"+msg)};exports.assertString=function(node,param){exports.assertPresent(node,param);switch(node.nodeName){case\"string\":case\"ident\":case\"literal\":return;default:var actual=node.nodeName,msg=\"expected string, ident or literal, but got \"+actual+\":\"+node;throw new Error(\"TypeError: \"+msg)}};exports.assertColor=function(node,param){exports.assertPresent(node,param);switch(node.nodeName){case\"rgba\":case\"hsla\":return;default:var actual=node.nodeName,msg=\"expected rgba or hsla, but got \"+actual+\":\"+node;throw new Error(\"TypeError: \"+msg)}};exports.assertPresent=function(node,name){if(node)return;if(name)throw new Error('\"'+name+'\" argument required');throw new Error(\"argument missing\")};exports.unwrap=function(expr){if(expr.preserve)return expr;if(\"arguments\"!=expr.nodeName&&\"expression\"!=expr.nodeName)return expr;if(1!=expr.nodes.length)return expr;if(\"arguments\"!=expr.nodes[0].nodeName&&\"expression\"!=expr.nodes[0].nodeName)return expr;return exports.unwrap(expr.nodes[0])};exports.coerce=function(val,raw){switch(typeof val){case\"function\":return val;case\"string\":return new nodes.String(val);case\"boolean\":return new nodes.Boolean(val);case\"number\":return new nodes.Unit(val);default:if(null==val)return nodes.nil;if(Array.isArray(val))return exports.coerceArray(val,raw);if(val.nodeName)return val;return exports.coerceObject(val,raw)}};exports.coerceArray=function(val,raw){var expr=new nodes.Expression;val.forEach(function(val){expr.push(exports.coerce(val,raw))});return expr};exports.coerceObject=function(obj,raw){var node=raw?new nodes.Object:new nodes.Expression,val;for(var key in obj){val=exports.coerce(obj[key],raw);key=new nodes.Ident(key);if(raw){node.set(key,val)}else{node.push(exports.coerceArray([key,val]))}}return node};exports.params=function(fn){return fn.toString().match(/\\(([^)]*)\\)/)[1].split(/ *, */)};exports.merge=function(a,b,deep){for(var k in b){if(deep&&a[k]){var nodeA=exports.unwrap(a[k]).first,nodeB=exports.unwrap(b[k]).first;if(\"object\"==nodeA.nodeName&&\"object\"==nodeB.nodeName){a[k].first.vals=exports.merge(nodeA.vals,nodeB.vals,deep)}else{a[k]=b[k]}}else{a[k]=b[k]}}return a};exports.uniq=function(arr){var obj={},ret=[];for(var i=0,len=arr.length;i<len;++i){if(arr[i]in obj)continue;obj[arr[i]]=true;ret.push(arr[i])}return ret};exports.compileSelectors=function(arr,leaveHidden){var selectors=[],Parser=require(\"./selector-parser\"),indent=this.indent||\"\",buf=[];function parse(selector,buf){var parts=[selector.val],str=new Parser(parts[0],parents,parts).parse().val,parents=[];if(buf.length){for(var i=0,len=buf.length;i<len;++i){parts.push(buf[i]);parents.push(str);child=new Parser(buf[i],parents,parts).parse();if(child.nested){str+=\" \"+child.val}else{str=child.val}}}return str.trim()}function compile(arr,i){if(i){arr[i].forEach(function(selector){if(!leaveHidden&&selector.isPlaceholder)return;if(selector.inherits){buf.unshift(selector.val);compile(arr,i-1);buf.shift()}else{selectors.push(indent+parse(selector,buf))}})}else{arr[0].forEach(function(selector){if(!leaveHidden&&selector.isPlaceholder)return;var str=parse(selector,buf);if(str)selectors.push(indent+str)})}}compile(arr,arr.length-1);return exports.uniq(selectors)};exports.parseString=function(str){var Parser=require(\"./parser\"),parser,ret;try{parser=new Parser(str);parser.state.push(\"expression\");ret=new nodes.Expression;ret.nodes=parser.parse().nodes}catch(e){ret=new nodes.Literal(str)}return ret}});require.register(\"visitor/index.js\",function(module,exports,require){var Visitor=module.exports=function Visitor(root){this.root=root};Visitor.prototype.visit=function(node,fn){var method=\"visit\"+node.constructor.name;if(this[method])return this[method](node);return node}});require.register(\"visitor/compiler.js\",function(module,exports,require){var Visitor=require(\"./index\"),utils=require(\"../utils\");var Compiler=module.exports=function Compiler(root,options){options=options||{};this.compress=options.compress;this.firebug=options.firebug;this.linenos=options.linenos;this.spaces=options[\"indent spaces\"]||2;this.includeCSS=options[\"include css\"];this.indents=1;Visitor.call(this,root);this.stack=[]};Compiler.prototype.__proto__=Visitor.prototype;Compiler.prototype.compile=function(){return this.visit(this.root)};Compiler.prototype.out=function(str,node){return str};Compiler.prototype.__defineGetter__(\"indent\",function(){if(this.compress)return\"\";return new Array(this.indents).join(Array(this.spaces+1).join(\" \"))});Compiler.prototype.needBrackets=function(node){return 1==this.indents||\"atrule\"!=node.nodeName||node.hasOnlyProperties};Compiler.prototype.visitRoot=function(block){this.buf=\"\";for(var i=0,len=block.nodes.length;i<len;++i){var node=block.nodes[i];if(this.linenos||this.firebug)this.debugInfo(node);var ret=this.visit(node);if(ret)this.buf+=this.out(ret+\"\\n\",node)}return this.buf};Compiler.prototype.visitBlock=function(block){var node,separator=this.compress?\"\":\"\\n\",needBrackets;if(block.hasProperties&&!block.lacksRenderedSelectors){needBrackets=this.needBrackets(block.node);if(needBrackets){this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents}for(var i=0,len=block.nodes.length;i<len;++i){this.last=len-1==i;node=block.nodes[i];switch(node.nodeName){case\"null\":case\"expression\":case\"function\":case\"group\":case\"block\":case\"unit\":case\"media\":case\"keyframes\":case\"atrule\":case\"supports\":continue;case!this.compress&&node.inline&&\"comment\":this.buf=this.buf.slice(0,-1);this.buf+=this.out(\" \"+this.visit(node)+\"\\n\",node);break;case\"property\":var ret=this.visit(node)+separator;this.buf+=this.compress?ret:this.out(ret,node);break;default:this.buf+=this.out(this.visit(node)+separator,node)}}if(needBrackets){--this.indents;this.buf+=this.out(this.indent+\"}\"+separator)}}for(var i=0,len=block.nodes.length;i<len;++i){node=block.nodes[i];switch(node.nodeName){case\"group\":case\"block\":case\"keyframes\":if(this.linenos||this.firebug)this.debugInfo(node);this.visit(node);break;case\"media\":case\"import\":case\"atrule\":case\"supports\":this.visit(node);break;case\"comment\":if(!node.suppress){this.buf+=this.out(this.indent+this.visit(node)+\"\\n\",node)}break;case\"charset\":case\"literal\":case\"namespace\":this.buf+=this.out(this.visit(node)+\"\\n\",node);break}}};Compiler.prototype.visitKeyframes=function(node){if(!node.frames)return;var prefix=\"official\"==node.prefix?\"\":\"-\"+node.prefix+\"-\";this.buf+=this.out(\"@\"+prefix+\"keyframes \"+this.visit(node.val)+(this.compress?\"{\":\" {\\n\"),node);this.keyframe=true;++this.indents;this.visit(node.block);--this.indents;this.keyframe=false;this.buf+=this.out(\"}\"+(this.compress?\"\":\"\\n\"))};Compiler.prototype.visitMedia=function(media){var val=media.val;if(!media.hasOutput||!val.nodes.length)return;this.buf+=this.out(\"@media \",media);this.visit(val);this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents;this.visit(media.block);--this.indents;this.buf+=this.out(\"}\"+(this.compress?\"\":\"\\n\"))};Compiler.prototype.visitQueryList=function(queries){for(var i=0,len=queries.nodes.length;i<len;++i){this.visit(queries.nodes[i]);if(len-1!=i)this.buf+=this.out(\",\"+(this.compress?\"\":\" \"))}};Compiler.prototype.visitQuery=function(node){var len=node.nodes.length;if(node.predicate)this.buf+=this.out(node.predicate+\" \");if(node.type)this.buf+=this.out(node.type+(len?\" and \":\"\"));for(var i=0;i<len;++i){this.buf+=this.out(this.visit(node.nodes[i]));if(len-1!=i)this.buf+=this.out(\" and \")}};Compiler.prototype.visitFeature=function(node){if(!node.expr){return node.name}else if(node.expr.isEmpty){return\"(\"+node.name+\")\"}else{return\"(\"+node.name+\":\"+(this.compress?\"\":\" \")+this.visit(node.expr)+\")\"}};Compiler.prototype.visitImport=function(imported){this.buf+=this.out(\"@import \"+this.visit(imported.path)+\";\\n\",imported)};Compiler.prototype.visitAtrule=function(atrule){var newline=this.compress?\"\":\"\\n\";this.buf+=this.out(this.indent+\"@\"+atrule.type,atrule);if(atrule.val)this.buf+=this.out(\" \"+atrule.val.trim());if(atrule.block){if(atrule.hasOnlyProperties){this.visit(atrule.block)}else{this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents;this.visit(atrule.block);--this.indents;this.buf+=this.out(this.indent+\"}\"+newline)}}else{this.buf+=this.out(\";\"+newline)}};Compiler.prototype.visitSupports=function(node){if(!node.hasOutput)return;this.buf+=this.out(this.indent+\"@supports \",node);this.isCondition=true;this.buf+=this.out(this.visit(node.condition));this.isCondition=false;this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents;this.visit(node.block);--this.indents;this.buf+=this.out(this.indent+\"}\"+(this.compress?\"\":\"\\n\"))},Compiler.prototype.visitComment=function(comment){return this.compress?comment.suppress?\"\":comment.str:comment.str};Compiler.prototype.visitFunction=function(fn){return fn.name};Compiler.prototype.visitCharset=function(charset){return\"@charset \"+this.visit(charset.val)+\";\"};Compiler.prototype.visitNamespace=function(namespace){return\"@namespace \"+(namespace.prefix?this.visit(namespace.prefix)+\" \":\"\")+this.visit(namespace.val)+\";\"};Compiler.prototype.visitLiteral=function(lit){var val=lit.val;if(lit.css)val=val.replace(/^  /gm,\"\");return val};Compiler.prototype.visitBoolean=function(bool){return bool.toString()};Compiler.prototype.visitRGBA=function(rgba){return rgba.toString()};Compiler.prototype.visitHSLA=function(hsla){return hsla.rgba.toString()};Compiler.prototype.visitUnit=function(unit){var type=unit.type||\"\",n=unit.val,float=n!=(n|0);if(this.compress){if(\"%\"!=type&&\"s\"!=type&&\"ms\"!=type&&0==n)return\"0\";if(float&&n<1&&n>-1){return n.toString().replace(\"0.\",\".\")+type}}return(float?parseFloat(n.toFixed(15)):n).toString()+type};Compiler.prototype.visitGroup=function(group){var stack=this.keyframe?[]:this.stack,comma=this.compress?\",\":\",\\n\";stack.push(group.nodes);if(group.block.hasProperties){var selectors=utils.compileSelectors.call(this,stack),len=selectors.length;if(len){if(this.keyframe)comma=this.compress?\",\":\", \";for(var i=0;i<len;++i){var selector=selectors[i],last=i==len-1;if(this.keyframe)selector=i?selector.trim():selector;this.buf+=this.out(selector+(last?\"\":comma),group.nodes[i])}}else{group.block.lacksRenderedSelectors=true}}this.visit(group.block);stack.pop()};Compiler.prototype.visitIdent=function(ident){return ident.name};Compiler.prototype.visitString=function(string){return this.isURL?string.val:string.toString()};Compiler.prototype.visitNull=function(node){return\"\"};Compiler.prototype.visitCall=function(call){this.isURL=\"url\"==call.name;var args=call.args.nodes.map(function(arg){return this.visit(arg)},this).join(this.compress?\",\":\", \");if(this.isURL)args='\"'+args+'\"';this.isURL=false;return call.name+\"(\"+args+\")\"};Compiler.prototype.visitExpression=function(expr){var buf=[],self=this,len=expr.nodes.length,nodes=expr.nodes.map(function(node){return self.visit(node)});nodes.forEach(function(node,i){var last=i==len-1;buf.push(node);if(\"/\"==nodes[i+1]||\"/\"==node)return;if(last)return;var space=self.isURL||self.isCondition&&(\")\"==nodes[i+1]||\"(\"==node)?\"\":\" \";buf.push(expr.isList?self.compress?\",\":\", \":space)});return buf.join(\"\")};Compiler.prototype.visitArguments=Compiler.prototype.visitExpression;Compiler.prototype.visitProperty=function(prop){var val=this.visit(prop.expr).trim(),name=prop.name||prop.segments.join(\"\"),arr=[];arr.push(this.out(this.indent),this.out(name+(this.compress?\":\":\": \"),prop),this.out(val,prop.expr),this.out(this.compress?this.last?\"\":\";\":\";\"));return arr.join(\"\")};Compiler.prototype.debugInfo=function(node){var path=node.filename==\"stdin\"?\"stdin\":fs.realpathSync(node.filename),line=(node.nodes&&node.nodes.length?node.nodes[0].lineno:node.lineno)||1;if(this.linenos){this.buf+=\"\\n/* \"+\"line \"+line+\" : \"+path+\" */\\n\"}if(this.firebug){path=\"file\\\\:\\\\/\\\\/\"+path.replace(/([.:/\\\\])/g,function(m){return\"\\\\\"+(m===\"\\\\\"?\"/\":m)});line=\"\\\\00003\"+line;this.buf+=\"\\n@media -stylus-debug-info\"+\"{filename{font-family:\"+path+\"}line{font-family:\"+line+\"}}\\n\"}}});require.register(\"visitor/evaluator.js\",function(module,exports,require){var Visitor=require(\"./index\"),nodes=require(\"../nodes\"),Stack=require(\"../stack\"),Frame=require(\"../stack/frame\"),utils=require(\"../utils\"),bifs=require(\"../functions\"),dirname=require(\"../path\").dirname,colors=require(\"../colors\"),units=require(\"../units\");function cloneNode(node){if(node.block&&node.block.node){node.block.node=node.block.node.clone()}if(node.nodes&&node.nodes.length){node.nodes.map(cloneNode)}return node}function importFile(node,file,literal){var importStack=this.importStack,Parser=require(\"../parser\"),stat;if(node.once){if(this.requireHistory[file])return nodes.nil;this.requireHistory[file]=true;if(literal&&!this.includeCSS){return node}}node.path=file;node.dirname=dirname(file);stat=fs.statSync(file);node.mtime=stat.mtime;this.paths.push(node.dirname);if(~importStack.indexOf(file))throw new Error(\"import loop has been found\");if(this.options._imports)this.options._imports.push(node.clone());importStack.push(file);nodes.filename=file;var str=fs.readFileSync(file,\"utf8\");if(literal){literal=new nodes.Literal(str.replace(/\\r\\n?/g,\"\\n\"));literal.lineno=literal.column=1;if(!this.resolveURL)return literal}var block=new nodes.Block,parser=new Parser(str,utils.merge({root:block},this.options));try{block=parser.parse()}catch(err){var line=parser.lexer.lineno,column=parser.lexer.column;if(this.includeCSS&&this.resolveURL){this.warn(\"ParseError: \"+file+\":\"+line+\":\"+column+\". This file included as-is\");return literal}else{err.filename=file;err.lineno=line;err.column=column;err.input=str;throw err}}block=block.clone(this.currentBlock);block.parent=this.currentBlock;block.scope=false;var ret=this.visit(block);importStack.pop();if(!this.resolveURL||this.resolveURL.nocheck)this.paths.pop();return ret}var Evaluator=module.exports=function Evaluator(root,options){options=options||{};Visitor.call(this,root);var functions=this.functions=options.functions||{};this.stack=new Stack;this.imports=options.imports||[];this.globals=options.globals||{};this.paths=options.paths||[];this.prefix=options.prefix||\"\";this.filename=options.filename;this.includeCSS=options[\"include css\"];this.resolveURL=functions.url&&\"resolver\"==functions.url.name&&functions.url.options;this.paths.push(dirname(options.filename||\".\"));this.stack.push(this.global=new Frame(root));this.warnings=options.warn;this.options=options;this.calling=[];this.importStack=[];this.ret=0;this.requireHistory={}};Evaluator.prototype.__proto__=Visitor.prototype;var visit=Visitor.prototype.visit;Evaluator.prototype.visit=function(node){try{return visit.call(this,node)}catch(err){if(err.filename)throw err;err.lineno=node.lineno;err.column=node.column;err.filename=node.filename;err.stylusStack=this.stack.toString();try{}catch(err){}throw err}};Evaluator.prototype.setup=function(){var root=this.root;var imports=[];this.populateGlobalScope();this.imports.forEach(function(file){var expr=new nodes.Expression;expr.push(new nodes.String(file));imports.push(new nodes.Import(expr))},this);root.nodes=imports.concat(root.nodes)};Evaluator.prototype.populateGlobalScope=function(){var scope=this.global.scope;Object.keys(colors).forEach(function(name){var color=colors[name],rgba=new nodes.RGBA(color[0],color[1],color[2],color[3]),node=new nodes.Ident(name,rgba);rgba.name=name;scope.add(node)});var globals=this.globals;Object.keys(globals).forEach(function(name){scope.add(new nodes.Ident(name,globals[name]))})};Evaluator.prototype.evaluate=function(){this.setup();return this.visit(this.root)};Evaluator.prototype.visitGroup=function(group){group.nodes=group.nodes.map(function(selector){selector.val=this.interpolate(selector);return selector},this);group.block=this.visit(group.block);return group};Evaluator.prototype.visitReturn=function(ret){ret.expr=this.visit(ret.expr);throw ret};Evaluator.prototype.visitMedia=function(media){media.block=this.visit(media.block);media.val=this.visit(media.val);return media};Evaluator.prototype.visitQueryList=function(queries){var val,query;queries.nodes.forEach(this.visit,this);if(1==queries.nodes.length){query=queries.nodes[0];if(val=this.lookup(query.type)){val=val.first.string;if(!val)return queries;var Parser=require(\"../parser\"),parser=new Parser(val,this.options);queries=this.visit(parser.queries())}}return queries};Evaluator.prototype.visitQuery=function(node){node.predicate=this.visit(node.predicate);node.type=this.visit(node.type);node.nodes.forEach(this.visit,this);return node};Evaluator.prototype.visitFeature=function(node){node.name=this.interpolate(node);if(node.expr){this.ret++;node.expr=this.visit(node.expr);this.ret--}return node};Evaluator.prototype.visitObject=function(obj){for(var key in obj.vals){obj.vals[key]=this.visit(obj.vals[key])}return obj};Evaluator.prototype.visitMember=function(node){var left=node.left,right=node.right,obj=this.visit(left).first;if(\"object\"!=obj.nodeName){throw new Error(left.toString()+\" has no property .\"+right)}if(node.val){this.ret++;obj.set(right.name,this.visit(node.val));this.ret--}return obj.get(right.name)};Evaluator.prototype.visitKeyframes=function(keyframes){var val;if(keyframes.fabricated)return keyframes;keyframes.val=this.interpolate(keyframes).trim();if(val=this.lookup(keyframes.val)){keyframes.val=val.first.string||val.first.name}keyframes.block=this.visit(keyframes.block);if(\"official\"!=keyframes.prefix)return keyframes;this.vendors.forEach(function(prefix){if(\"ms\"==prefix)return;var node=keyframes.clone();node.val=keyframes.val;node.prefix=prefix;node.block=keyframes.block;node.fabricated=true;this.currentBlock.push(node)},this);return nodes.nil};Evaluator.prototype.visitFunction=function(fn){var local=this.stack.currentFrame.scope.lookup(fn.name);if(local)this.warn(\"local \"+local.nodeName+' \"'+fn.name+'\" previously defined in this scope');var user=this.functions[fn.name];if(user)this.warn('user-defined function \"'+fn.name+'\" is already defined');var bif=bifs[fn.name];if(bif)this.warn('built-in function \"'+fn.name+'\" is already defined');return fn};Evaluator.prototype.visitEach=function(each){this.ret++;var expr=utils.unwrap(this.visit(each.expr)),len=expr.nodes.length,val=new nodes.Ident(each.val),key=new nodes.Ident(each.key||\"__index__\"),scope=this.currentScope,block=this.currentBlock,vals=[],self=this,body,obj;this.ret--;each.block.scope=false;function visitBody(key,val){scope.add(val);scope.add(key);body=self.visit(each.block.clone());vals=vals.concat(body.nodes)}if(1==len&&\"object\"==expr.nodes[0].nodeName){obj=expr.nodes[0];for(var prop in obj.vals){val.val=new nodes.String(prop);key.val=obj.get(prop);visitBody(key,val)}}else{for(var i=0;i<len;++i){val.val=expr.nodes[i];key.val=new nodes.Unit(i);visitBody(key,val)}}this.mixin(vals,block);return vals[vals.length-1]||nodes.nil};Evaluator.prototype.visitCall=function(call){var fn=this.lookup(call.name),literal,ret;this.ignoreColors=\"url\"==call.name;if(fn&&\"expression\"==fn.nodeName){fn=fn.nodes[0]}if(fn&&\"function\"!=fn.nodeName){fn=this.lookupFunction(call.name)}if(!fn||fn.nodeName!=\"function\"){if(\"calc\"==this.unvendorize(call.name)){literal=call.args.nodes&&call.args.nodes[0];if(literal)ret=new nodes.Literal(call.name+literal)}else{ret=this.literalCall(call)}this.ignoreColors=false;return ret}this.calling.push(call.name);if(this.calling.length>200){throw new RangeError(\"Maximum stylus call stack size exceeded\")}if(\"expression\"==fn.nodeName)fn=fn.first;this.ret++;var args=this.visit(call.args);for(var key in args.map){args.map[key]=this.visit(args.map[key].clone())}this.ret--;if(fn.fn){ret=this.invokeBuiltin(fn.fn,args)}else if(\"function\"==fn.nodeName){if(call.block)call.block=this.visit(call.block);ret=this.invokeFunction(fn,args,call.block)}this.calling.pop();this.ignoreColors=false;return ret};Evaluator.prototype.visitIdent=function(ident){var prop;if(ident.property){if(prop=this.lookupProperty(ident.name)){return this.visit(prop.expr.clone())}return nodes.nil}else if(ident.val.isNull){var val=this.lookup(ident.name);if(val&&ident.mixin)this.mixinNode(val);return val?this.visit(val):ident}else{this.ret++;ident.val=this.visit(ident.val);this.ret--;this.currentScope.add(ident);return ident.val}};Evaluator.prototype.visitBinOp=function(binop){if(\"is defined\"==binop.op)return this.isDefined(binop.left);this.ret++;var op=binop.op,left=this.visit(binop.left),right=\"||\"==op||\"&&\"==op?binop.right:this.visit(binop.right);var val=binop.val?this.visit(binop.val):null;this.ret--;try{return this.visit(left.operate(op,right,val))}catch(err){if(\"CoercionError\"==err.name){switch(op){case\"==\":return nodes.no;case\"!=\":return nodes.yes}}throw err}};Evaluator.prototype.visitUnaryOp=function(unary){var op=unary.op,node=this.visit(unary.expr);if(\"!\"!=op){node=node.first.clone();utils.assertType(node,\"unit\")}switch(op){case\"-\":node.val=-node.val;break;case\"+\":node.val=+node.val;break;case\"~\":node.val=~node.val;break;case\"!\":return node.toBoolean().negate()}return node};Evaluator.prototype.visitTernary=function(ternary){var ok=this.visit(ternary.cond).toBoolean();return ok.isTrue?this.visit(ternary.trueExpr):this.visit(ternary.falseExpr)};Evaluator.prototype.visitExpression=function(expr){for(var i=0,len=expr.nodes.length;i<len;++i){expr.nodes[i]=this.visit(expr.nodes[i])}if(this.castable(expr))expr=this.cast(expr);return expr};Evaluator.prototype.visitArguments=Evaluator.prototype.visitExpression;Evaluator.prototype.visitProperty=function(prop){var name=this.interpolate(prop),fn=this.lookup(name),call=fn&&\"function\"==fn.first.nodeName,literal=~this.calling.indexOf(name),_prop=this.property;if(call&&!literal&&!prop.literal){var args=nodes.Arguments.fromExpression(utils.unwrap(prop.expr.clone()));prop.name=name;this.property=prop;this.ret++;this.property.expr=this.visit(prop.expr);this.ret--;var ret=this.visit(new nodes.Call(name,args));this.property=_prop;return ret}else{this.ret++;prop.name=name;prop.literal=true;this.property=prop;prop.expr=this.visit(prop.expr);this.property=_prop;this.ret--;return prop}};Evaluator.prototype.visitRoot=function(block){if(block!=this.root){block.constructor=nodes.Block;return this.visit(block)}for(var i=0;i<block.nodes.length;++i){block.index=i;block.nodes[i]=this.visit(block.nodes[i])}return block};Evaluator.prototype.visitBlock=function(block){this.stack.push(new Frame(block));\nfor(block.index=0;block.index<block.nodes.length;++block.index){try{block.nodes[block.index]=this.visit(block.nodes[block.index])}catch(err){if(\"return\"==err.nodeName){if(this.ret){this.stack.pop();throw err}else{block.nodes[block.index]=err;break}}else{throw err}}}this.stack.pop();return block};Evaluator.prototype.visitAtblock=function(atblock){atblock.block=this.visit(atblock.block);return atblock};Evaluator.prototype.visitAtrule=function(atrule){atrule.val=this.interpolate(atrule);if(atrule.block)atrule.block=this.visit(atrule.block);return atrule};Evaluator.prototype.visitSupports=function(node){var condition=node.condition,val;this.ret++;node.condition=this.visit(condition);this.ret--;val=condition.first;if(1==condition.nodes.length&&\"string\"==val.nodeName){node.condition=val.string}node.block=this.visit(node.block);return node};Evaluator.prototype.visitIf=function(node){var ret,block=this.currentBlock,negate=node.negate;this.ret++;var ok=this.visit(node.cond).first.toBoolean();this.ret--;node.block.scope=node.block.hasMedia;if(negate){if(ok.isFalse){ret=this.visit(node.block)}}else{if(ok.isTrue){ret=this.visit(node.block)}else if(node.elses.length){var elses=node.elses,len=elses.length,cond;for(var i=0;i<len;++i){if(elses[i].cond){elses[i].block.scope=elses[i].block.hasMedia;this.ret++;cond=this.visit(elses[i].cond).first.toBoolean();this.ret--;if(cond.isTrue){ret=this.visit(elses[i].block);break}}else{elses[i].scope=elses[i].hasMedia;ret=this.visit(elses[i])}}}}if(ret&&!node.postfix&&block.node&&~[\"group\",\"atrule\",\"media\",\"supports\",\"keyframes\"].indexOf(block.node.nodeName)){this.mixin(ret.nodes,block);return nodes.nil}return ret||nodes.nil};Evaluator.prototype.visitExtend=function(extend){var block=this.currentBlock;if(\"group\"!=block.node.nodeName)block=this.closestGroup;extend.selectors.forEach(function(selector){block.node.extends.push({selector:this.interpolate(selector.clone()).trim(),optional:selector.optional,lineno:selector.lineno,column:selector.column})},this);return nodes.nil};Evaluator.prototype.visitImport=function(imported){this.ret++;var path=this.visit(imported.path).first,nodeName=imported.once?\"require\":\"import\",found,literal;this.ret--;if(\"url\"==path.name){if(imported.once)throw new Error(\"You cannot @require a url\");return imported}if(!path.string)throw new Error(\"@\"+nodeName+\" string expected\");var name=path=path.string;if(/(?:url\\s*\\(\\s*)?['\"]?(?:#|(?:https?:)?\\/\\/)/i.test(path)){if(imported.once)throw new Error(\"You cannot @require a url\");return imported}if(/\\.css(?:\"|$)/.test(path)){literal=true;if(!imported.once&&!this.includeCSS){return imported}}if(!literal&&!/\\.styl$/i.test(path))path+=\".styl\";found=utils.find(path,this.paths,this.filename);if(!found){found=utils.lookupIndex(name,this.paths,this.filename)}if(!found)throw new Error(\"failed to locate @\"+nodeName+\" file \"+path);var block=new nodes.Block;for(var i=0,len=found.length;i<len;++i){block.push(importFile.call(this,imported,found[i],literal))}return block};Evaluator.prototype.invokeFunction=function(fn,args,content){var block=new nodes.Block(fn.block.parent);var body=fn.block.clone(block);var mixinBlock=this.stack.currentFrame.block;this.stack.push(new Frame(block));var scope=this.currentScope;if(\"arguments\"!=args.nodeName){var expr=new nodes.Expression;expr.push(args);args=nodes.Arguments.fromExpression(expr)}scope.add(new nodes.Ident(\"arguments\",args));scope.add(new nodes.Ident(\"mixin\",this.ret?nodes.no:new nodes.String(mixinBlock.nodeName)));if(this.property){var prop=this.propertyExpression(this.property,fn.name);scope.add(new nodes.Ident(\"current-property\",prop))}else{scope.add(new nodes.Ident(\"current-property\",nodes.nil))}var expr=new nodes.Expression;for(var i=this.calling.length-1;i--;){expr.push(new nodes.Literal(this.calling[i]))}scope.add(new nodes.Ident(\"called-from\",expr));var i=0,len=args.nodes.length;fn.params.nodes.forEach(function(node){if(node.rest){node.val=new nodes.Expression;for(;i<len;++i)node.val.push(args.nodes[i]);node.val.preserve=true;node.val.isList=args.isList}else{var arg=args.map[node.name]||args.nodes[i++];node=node.clone();if(arg){arg.isEmpty?args.nodes[i-1]=node.val:node.val=arg}else{args.push(node.val)}if(node.val.isNull){throw new Error('argument \"'+node+'\" required for '+fn)}}scope.add(node)});if(content)scope.add(new nodes.Ident(\"block\",content,true));return this.invoke(body,true,fn.filename)};Evaluator.prototype.invokeBuiltin=function(fn,args){if(fn.raw){args=args.nodes}else{args=utils.params(fn).reduce(function(ret,param){var arg=args.map[param]||args.nodes.shift();if(arg){arg=utils.unwrap(arg);var len=arg.nodes.length;if(len>1){for(var i=0;i<len;++i){ret.push(utils.unwrap(arg.nodes[i].first))}}else{ret.push(arg.first)}}return ret},[])}var body=utils.coerce(fn.apply(this,args));var expr=new nodes.Expression;expr.push(body);body=expr;return this.invoke(body)};Evaluator.prototype.invoke=function(body,stack,filename){var self=this,ret;if(filename)this.paths.push(dirname(filename));if(this.ret){ret=this.eval(body.nodes);if(stack)this.stack.pop()}else{body=this.visit(body);if(stack)this.stack.pop();this.mixin(body.nodes,this.currentBlock);ret=nodes.nil}if(filename)this.paths.pop();return ret};Evaluator.prototype.mixin=function(nodes,block){if(!nodes.length)return;var len=block.nodes.length,head=block.nodes.slice(0,block.index),tail=block.nodes.slice(block.index+1,len);this._mixin(nodes,head,block);block.index=0;block.nodes=head.concat(tail)};Evaluator.prototype._mixin=function(items,dest,block){var node,len=items.length;for(var i=0;i<len;++i){switch((node=items[i]).nodeName){case\"return\":return;case\"block\":this._mixin(node.nodes,dest,block);break;case\"media\":var parentNode=node.block.parent.node;if(parentNode&&\"call\"!=parentNode.nodeName){node.block.parent=block}case\"property\":var val=node.expr;if(node.literal&&\"block\"==val.first.name){val=utils.unwrap(val);val.nodes[0]=new nodes.Literal(\"block\")}default:dest.push(node)}}};Evaluator.prototype.mixinNode=function(node){node=this.visit(node.first);switch(node.nodeName){case\"object\":this.mixinObject(node);return nodes.nil;case\"block\":case\"atblock\":this.mixin(node.nodes,this.currentBlock);return nodes.nil}};Evaluator.prototype.mixinObject=function(object){var Parser=require(\"../parser\"),root=this.root,str=\"$block \"+object.toBlock(),parser=new Parser(str,utils.merge({root:block},this.options)),block;try{block=parser.parse()}catch(err){err.filename=this.filename;err.lineno=parser.lexer.lineno;err.column=parser.lexer.column;err.input=str;throw err}block.parent=root;block.scope=false;var ret=this.visit(block),vals=ret.first.nodes;for(var i=0,len=vals.length;i<len;++i){if(vals[i].block){this.mixin(vals[i].block.nodes,this.currentBlock);break}}};Evaluator.prototype.eval=function(vals){if(!vals)return nodes.nil;var len=vals.length,node=nodes.nil;try{for(var i=0;i<len;++i){node=vals[i];switch(node.nodeName){case\"if\":if(\"block\"!=node.block.nodeName){node=this.visit(node);break}case\"each\":case\"block\":node=this.visit(node);if(node.nodes)node=this.eval(node.nodes);break;default:node=this.visit(node)}}}catch(err){if(\"return\"==err.nodeName){return err.expr}else{throw err}}return node};Evaluator.prototype.literalCall=function(call){call.args=this.visit(call.args);return call};Evaluator.prototype.lookupProperty=function(name){var i=this.stack.length,index=this.currentBlock.index,top=i,nodes,block,len,other;while(i--){block=this.stack[i].block;if(!block.node)continue;switch(block.node.nodeName){case\"group\":case\"function\":case\"if\":case\"each\":case\"atrule\":case\"media\":case\"atblock\":case\"call\":nodes=block.nodes;if(i+1==top){while(index--){if(this.property==nodes[index])continue;other=this.interpolate(nodes[index]);if(name==other)return nodes[index].clone()}}else{len=nodes.length;while(len--){if(\"property\"!=nodes[len].nodeName||this.property==nodes[len])continue;other=this.interpolate(nodes[len]);if(name==other)return nodes[len].clone()}}break}}return nodes.nil};Evaluator.prototype.__defineGetter__(\"closestBlock\",function(){var i=this.stack.length,block;while(i--){block=this.stack[i].block;if(block.node){switch(block.node.nodeName){case\"group\":case\"keyframes\":case\"atrule\":case\"atblock\":case\"media\":case\"call\":return block}}}});Evaluator.prototype.__defineGetter__(\"closestGroup\",function(){var i=this.stack.length,block;while(i--){block=this.stack[i].block;if(block.node&&\"group\"==block.node.nodeName){return block}}});Evaluator.prototype.__defineGetter__(\"selectorStack\",function(){var block,stack=[];for(var i=0,len=this.stack.length;i<len;++i){block=this.stack[i].block;if(block.node&&\"group\"==block.node.nodeName){block.node.nodes.forEach(function(selector){if(!selector.val)selector.val=this.interpolate(selector)},this);stack.push(block.node.nodes)}}return stack});Evaluator.prototype.lookup=function(name){var val;if(this.ignoreColors&&name in colors)return;if(val=this.stack.lookup(name)){return utils.unwrap(val)}else{return this.lookupFunction(name)}};Evaluator.prototype.interpolate=function(node){var self=this,isSelector=\"selector\"==node.nodeName;function toString(node){switch(node.nodeName){case\"function\":case\"ident\":return node.name;case\"literal\":case\"string\":if(self.prefix&&!node.prefixed&&!node.val.nodeName){node.val=node.val.replace(/\\./g,\".\"+self.prefix);node.prefixed=true}return node.val;case\"unit\":return\"%\"==node.type?node.val+\"%\":node.val;case\"member\":return toString(self.visit(node));case\"expression\":if(self.calling&&~self.calling.indexOf(\"selector\")&&self._selector)return self._selector;self.ret++;var ret=toString(self.visit(node).first);self.ret--;if(isSelector)self._selector=ret;return ret}}if(node.segments){return node.segments.map(toString).join(\"\")}else{return toString(node)}};Evaluator.prototype.lookupFunction=function(name){var fn=this.functions[name]||bifs[name];if(fn)return new nodes.Function(name,fn)};Evaluator.prototype.isDefined=function(node){if(\"ident\"==node.nodeName){return nodes.Boolean(this.lookup(node.name))}else{throw new Error('invalid \"is defined\" check on non-variable '+node)}};Evaluator.prototype.propertyExpression=function(prop,name){var expr=new nodes.Expression,val=prop.expr.clone();expr.push(new nodes.String(prop.name));function replace(node){if(\"call\"==node.nodeName&&name==node.name){return new nodes.Literal(\"__CALL__\")}if(node.nodes)node.nodes=node.nodes.map(replace);return node}replace(val);expr.push(val);return expr};Evaluator.prototype.cast=function(expr){return new nodes.Unit(expr.first.val,expr.nodes[1].name)};Evaluator.prototype.castable=function(expr){return 2==expr.nodes.length&&\"unit\"==expr.first.nodeName&&~units.indexOf(expr.nodes[1].name)};Evaluator.prototype.warn=function(msg){if(!this.warnings)return;console.warn(\"\u001b[33mWarning:\u001b[0m \"+msg)};Evaluator.prototype.__defineGetter__(\"currentBlock\",function(){return this.stack.currentFrame.block});Evaluator.prototype.__defineGetter__(\"vendors\",function(){return this.lookup(\"vendors\").nodes.map(function(node){return node.string})});Evaluator.prototype.unvendorize=function(prop){for(var i=0,len=this.vendors.length;i<len;i++){if(\"official\"!=this.vendors[i]){var vendor=\"-\"+this.vendors[i]+\"-\";if(~prop.indexOf(vendor))return prop.replace(vendor,\"\")}}return prop};Evaluator.prototype.__defineGetter__(\"currentScope\",function(){return this.stack.currentFrame.scope});Evaluator.prototype.__defineGetter__(\"currentFrame\",function(){return this.stack.currentFrame})});require.register(\"visitor/normalizer.js\",function(module,exports,require){var Visitor=require(\"./index\"),nodes=require(\"../nodes/index\"),utils=require(\"../utils\");var Normalizer=module.exports=function Normalizer(root,options){options=options||{};Visitor.call(this,root);this.hoist=options[\"hoist atrules\"];this.stack=[];this.map={};this.imports=[]};Normalizer.prototype.__proto__=Visitor.prototype;Normalizer.prototype.normalize=function(){var ret=this.visit(this.root);if(this.hoist){if(this.imports.length)ret.nodes=this.imports.concat(ret.nodes);if(this.charset)ret.nodes=[this.charset].concat(ret.nodes)}return ret};Normalizer.prototype.bubble=function(node){var props=[],other=[],self=this;function filterProps(block){block.nodes.forEach(function(node){node=self.visit(node);switch(node.nodeName){case\"property\":props.push(node);break;case\"block\":filterProps(node);break;default:other.push(node)}})}filterProps(node.block);if(props.length){var selector=new nodes.Selector([new nodes.Literal(\"&\")]);selector.lineno=node.lineno;selector.column=node.column;selector.filename=node.filename;selector.val=\"&\";var group=new nodes.Group;group.lineno=node.lineno;group.column=node.column;group.filename=node.filename;var block=new nodes.Block(node.block,group);block.lineno=node.lineno;block.column=node.column;block.filename=node.filename;props.forEach(function(prop){block.push(prop)});group.push(selector);group.block=block;node.block.nodes=[];node.block.push(group);other.forEach(function(n){node.block.push(n)});var group=this.closestGroup(node.block);if(group)node.group=group.clone();node.bubbled=true}};Normalizer.prototype.closestGroup=function(block){var parent=block.parent,node;while(parent&&(node=parent.node)){if(\"group\"==node.nodeName)return node;parent=node.block&&node.block.parent}};Normalizer.prototype.visitRoot=function(block){var ret=new nodes.Root,node;for(var i=0;i<block.nodes.length;++i){node=block.nodes[i];switch(node.nodeName){case\"null\":case\"expression\":case\"function\":case\"unit\":case\"atblock\":continue;default:this.rootIndex=i;ret.push(this.visit(node))}}return ret};Normalizer.prototype.visitProperty=function(prop){this.visit(prop.expr);return prop};Normalizer.prototype.visitExpression=function(expr){expr.nodes=expr.nodes.map(function(node){if(\"block\"==node.nodeName){var literal=new nodes.Literal(\"block\");literal.lineno=expr.lineno;literal.column=expr.column;return literal}return node});return expr};Normalizer.prototype.visitBlock=function(block){var node;if(block.hasProperties){for(var i=0,len=block.nodes.length;i<len;++i){node=block.nodes[i];switch(node.nodeName){case\"null\":case\"expression\":case\"function\":case\"group\":case\"unit\":case\"atblock\":continue;default:block.nodes[i]=this.visit(node)}}}for(var i=0,len=block.nodes.length;i<len;++i){node=block.nodes[i];block.nodes[i]=this.visit(node)}return block};Normalizer.prototype.visitGroup=function(group){var stack=this.stack,map=this.map,parts;group.nodes.forEach(function(selector,i){if(!~selector.val.indexOf(\",\"))return;if(~selector.val.indexOf(\"\\\\,\")){selector.val=selector.val.replace(/\\\\,/g,\",\");return}parts=selector.val.split(\",\");var root=\"/\"==selector.val.charAt(0),part,s;for(var k=0,len=parts.length;k<len;++k){part=parts[k].trim();if(root&&k>0&&!~part.indexOf(\"&\")){part=\"/\"+part}s=new nodes.Selector([new nodes.Literal(part)]);s.val=part;s.block=group.block;group.nodes[i++]=s}});stack.push(group.nodes);var selectors=utils.compileSelectors(stack,true);selectors.forEach(function(selector){map[selector]=map[selector]||[];map[selector].push(group)});this.extend(group,selectors);stack.pop();return group};Normalizer.prototype.visitFunction=function(){return nodes.nil};Normalizer.prototype.visitMedia=function(media){var medias=[],group=this.closestGroup(media.block),parent;function mergeQueries(block){block.nodes.forEach(function(node,i){switch(node.nodeName){case\"media\":node.val=media.val.merge(node.val);medias.push(node);block.nodes[i]=nodes.nil;break;case\"block\":mergeQueries(node);break;default:if(node.block&&node.block.nodes)mergeQueries(node.block)}})}mergeQueries(media.block);this.bubble(media);if(medias.length){medias.forEach(function(node){if(group){group.block.push(node)}else{this.root.nodes.splice(++this.rootIndex,0,node)}node=this.visit(node);parent=node.block.parent;if(node.bubbled&&(!group||\"group\"==parent.node.nodeName)){node.group.block=node.block.nodes[0].block;node.block.nodes[0]=node.group}},this)}return media};Normalizer.prototype.visitSupports=function(node){this.bubble(node);return node};Normalizer.prototype.visitAtrule=function(node){if(node.block)node.block=this.visit(node.block);return node};Normalizer.prototype.visitKeyframes=function(node){var frames=node.block.nodes.filter(function(frame){return frame.block&&frame.block.hasProperties});node.frames=frames.length;return node};Normalizer.prototype.visitImport=function(node){this.imports.push(node);return this.hoist?nodes.nil:node};Normalizer.prototype.visitCharset=function(node){this.charset=node;return this.hoist?nodes.nil:node};Normalizer.prototype.extend=function(group,selectors){var map=this.map,self=this,parent=this.closestGroup(group.block);group.extends.forEach(function(extend){var groups=map[extend.selector];if(!groups){if(extend.optional)return;var err=new Error('Failed to @extend \"'+extend.selector+'\"');err.lineno=extend.lineno;err.column=extend.column;throw err}selectors.forEach(function(selector){var node=new nodes.Selector;node.val=selector;node.inherits=false;groups.forEach(function(group){if(!parent||parent!=group)self.extend(group,selectors);group.push(node)})})});group.block=this.visit(group.block)}});return require(\"stylus\")}();\n",
      "mode": "100644",
      "type": "blob"
    },
    "lib/system-client.coffee": {
      "path": "lib/system-client.coffee",
      "content": "# system-client is what prepares the environment for user apps\n# we hook up the postmaster and proxy messages to the OS\n# we also provide system packages for the application to use like UI\n\ndo ->\n  # NOTE: These required packages get populated from the parent package when building\n  # the runnable app. See util.coffee\n  Postmaster = require \"_SYS_postmaster\"\n  UI = require \"_SYS_ui\"\n\n  style = document.createElement \"style\"\n  style.innerHTML = UI.Style.all\n  document.head.appendChild style\n\n  postmaster = Postmaster()\n\n  applicationProxy = new Proxy\n    ready: ->\n      postmaster.invokeRemote \"childLoaded\"\n  ,\n    get: (target, property, receiver) ->\n      target[property] or\n      ->\n        postmaster.invokeRemote \"application\", property, arguments...\n\n  document.addEventListener \"mousedown\", ->\n    applicationProxy.raiseToTop()\n\n  systemProxy = new Proxy\n    Observable: UI.Observable\n    UI: UI\n  ,\n    get: (target, property, receiver) ->\n      target[property] or\n      ->\n        postmaster.invokeRemote \"system\", property, arguments...\n\n  # TODO: Also interesting would be to proxy observable arguments where we\n  # create the receiver on the opposite end of the membrane and pass messages\n  # back and forth like magic\n\n  window.system = systemProxy\n  window.application = applicationProxy\n  window.postmaster = postmaster\n",
      "mode": "100644",
      "type": "blob"
    },
    "mailchimp.coffee": {
      "path": "mailchimp.coffee",
      "content": "document.head.insertAdjacentHTML \"beforeend\",\"\"\"\r\n  <link href=\"https://cdn-images.mailchimp.com/embedcode/classic-10_7.css\" rel=\"stylesheet\" type=\"text/css\">\r\n  <style type=\"text/css\">\r\n  \t#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }\r\n  </style>\r\n\"\"\"\r\n\r\nmodule.exports =\r\n  show: ->\r\n    div = document.createElement \"div\"\r\n\r\n    div.innerHTML = \"\"\"\r\n      <div id=\"mc_embed_signup\">\r\n      <form action=\"//space.us14.list-manage.com/subscribe/post?u=8946c32e9db504ccc083d3fc7&amp;id=b8b708aea6\" method=\"post\" id=\"mc-embedded-subscribe-form\" name=\"mc-embedded-subscribe-form\" class=\"validate\" target=\"_blank\" novalidate>\r\n          <div id=\"mc_embed_signup_scroll\">\r\n\r\n      <div class=\"mc-field-group\">\r\n      \t<label for=\"mce-EMAIL\">Email Address </label>\r\n      \t<input type=\"email\" value=\"\" name=\"EMAIL\" class=\"required email\" id=\"mce-EMAIL\">\r\n      </div>\r\n      \t<div id=\"mce-responses\" class=\"clear\">\r\n      \t\t<div class=\"response\" id=\"mce-error-response\" style=\"display:none\"></div>\r\n      \t\t<div class=\"response\" id=\"mce-success-response\" style=\"display:none\"></div>\r\n      \t</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->\r\n          <div style=\"position: absolute; left: -5000px;\" aria-hidden=\"true\"><input type=\"text\" name=\"b_8946c32e9db504ccc083d3fc7_b8b708aea6\" tabindex=\"-1\" value=\"\"></div>\r\n          <div class=\"clear\"><input type=\"submit\" value=\"Subscribe\" name=\"subscribe\" id=\"mc-embedded-subscribe\" class=\"button\"></div>\r\n          </div>\r\n      </form>\r\n      </div>\r\n    \"\"\"\r\n\r\n    system.UI.Modal.show div\r\n",
      "mode": "100644",
      "type": "blob"
    },
    "main.coffee": {
      "path": "main.coffee",
      "content": "require(\"analytics\").init(\"UA-3464282-16\")\n\nrequire \"./extensions\"\n\nrequire \"./lib/outbound-clicks\"\nrequire \"./lib/error-reporter\"\n\n# global.Hamlet = require \"./lib/hamlet\"\nglobal.Jadelet = require \"./lib/jadelet.min\"\n\nSystem = require \"./system\"\nglobal.system = System()\nsystem.PACKAGE = PACKAGE # For debugging\n\n{Style} = system.UI\nstyle = document.createElement \"style\"\nstyle.innerHTML = Style.all + \"\\n\" + require(\"./style\")\ndocument.head.appendChild style\n\n# Drag shenanigans\ndocument.addEventListener \"dragstart\", ->\n  document.body.classList.add \"drag-active\"\nendDrag = ->\n  document.body.classList.remove \"drag-active\"\ndocument.addEventListener \"mouseup\", endDrag\ndocument.addEventListener \"dragend\", endDrag\n\n# Desktop\nExplorer = require \"./apps/explorer\"\ndocument.body.appendChild Explorer()\n\nVersionTemplate = require \"./templates/version\"\ndocument.body.appendChild VersionTemplate\n  version: system.version\n\nSiteURLTemplate = require \"./templates/site-url\"\ndocument.body.appendChild SiteURLTemplate()\n\nHomeButton = require \"./presenters/home-button\"\ndocument.body.appendChild HomeButton()\n\nsystem.writeFile \"feedback.exe\", new Blob [\"\"], type: \"application/exe\"\nsystem.writeFile \"My Briefcase\", new Blob [\"\"], type: \"application/briefcase\"\n\nsystem.autoboot()\n# system.dumpModules()\nsystem.initAppSettings()\n\n->\n  system.removeApp(\"Test\")\n\n-> # For testing\n  system.installApp\n    name: \"Test\"\n    src: \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/test2/index.html\"\n    launchAtStartup: true\n    width: 100\n    height: 100\n    icon: \"T\"\n    associations:\n      type: []\n      extension: [\"test\"]\n\nrequire(\"./issues/2017-06\")()\n",
      "mode": "100644",
      "type": "blob"
    },
    "os/file-io.coffee": {
      "path": "os/file-io.coffee",
      "content": "# Handle basic file saving/loading/picking, displaying modals/ui.\n\n# Host must provide the following methods\n#   `loadFile` Take a blob and load it as the application state.\n#   `saveData` Return a promise that will be fulfilled with a blob of the\n#     current application state.\n#   `newFile` Initialize the application to an empty state.\n\nmodule.exports = (I, self) ->\n  {Observable} = system\n  {Modal} = system.UI\n\n  currentPath = Observable \"\"\n  saved = Observable true\n\n  confirmUnsaved = ->\n    return Promise.resolve() if saved()\n\n    new Promise (resolve, reject) ->\n      Modal.confirm \"You will lose unsaved progress, continue?\"\n      .then (result) ->\n        if result\n          resolve()\n        else\n          reject()\n\n  self.extend\n    currentPath: currentPath\n    saved: saved\n    new: ->\n      if saved()\n        currentPath \"\"\n        self.newFile()\n      else\n        confirmUnsaved()\n        .then ->\n          saved true\n          self.newFile()\n\n    open: ->\n      confirmUnsaved()\n      .then  ->\n        # TODO: File browser\n        Modal.prompt \"File Path\", currentPath()\n        .then (newPath) ->\n          if newPath\n            currentPath newPath\n          else\n            throw new Error \"No path given\"\n        .then (path) ->\n          system.readFile path, true\n        .then (file) ->\n          self.loadFile file\n\n    save: ->\n      if currentPath()\n        self.saveData()\n        .then (blob) ->\n          system.writeFile currentPath(), blob, true\n        .then ->\n          saved true\n          currentPath()\n      else\n        self.saveAs()\n\n    saveAs: ->\n      Modal.prompt \"File Path\", currentPath()\n      .then (path) ->\n        if path\n          currentPath path\n          self.save()\n\n  return self\n",
      "mode": "100644",
      "type": "blob"
    },
    "pixie.cson": {
      "path": "pixie.cson",
      "content": "title: \"Whimsy Space - ZineOS v0.420.950a ⌊ALPHA⌉\"\nversion: \"0.420.950a\"\ndescription: \"\"\"\n  When the bombs drop, and it's OS against OS, you're gonna wish you could view source\n\"\"\"\ndependencies:\n  ajax: \"distri/ajax:master\"\n  analytics: \"distri/google-analytics:master\"\n  base64: \"distri/base64:v0.9.2\"\n  bindable: \"distri/bindable:master\"\n  model: \"distri/model:master\"\n  postmaster: \"distri/postmaster:v0.5.3\"\n  ui: \"STRd6/ui:master\"\nremoteDependencies: [\n  \"https://cdnjs.cloudflare.com/ajax/libs/dexie/2.0.0-beta.7/dexie.min.js\"\n  \"https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ace.js\"\n  \"https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ext-language_tools.js\"\n  \"https://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.7.1/coffee-script.min.js\"\n  \"https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js\"\n  \"https://sdk.amazonaws.com/js/aws-sdk-2.7.20.min.js\"\n  \"https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js\"\n]\n",
      "mode": "100644",
      "type": "blob"
    },
    "presenters/achievement-group-progress.coffee": {
      "path": "presenters/achievement-group-progress.coffee",
      "content": "AchievementBadgeTemplate = require \"../templates/achievement-badge\"\nProgressTemplate = require \"../templates/achievement-progress\"\n\nmodule.exports = ({name, achievements}) ->\n  achieved = achievements.filter ({achieved}) ->\n    achieved\n  .length\n\n  total = achievements.length\n  value = achieved / total\n\n  ProgressTemplate\n    name: name\n    achievements: achievements\n    badges: achievements.map (cheevo) ->\n      AchievementBadgeTemplate Object.assign {}, cheevo,\n        class: ->\n          \"achieved\" if cheevo.achieved\n    fraction: \"#{achieved}/#{total}\"\n    value: value.toString()\n",
      "mode": "100644",
      "type": "blob"
    },
    "presenters/home-button.coffee": {
      "path": "presenters/home-button.coffee",
      "content": "AceEditor = require \"../apps/text-editor\"\nAchievementStatus = require \"../apps/achievement-status\"\nChateau = require \"../apps/chateau\"\nContrasaurus = require \"../apps/contrasaurus\"\nDungeonOfSadness = require \"../apps/dungeon-of-sadness\"\nPixiePaint = require \"../apps/pixel\"\nSpreadsheet = require \"../apps/spreadsheet\"\nMyBriefcase = require \"../apps/my-briefcase\"\n\nHomeButtonTemplate = require \"../templates/home-button\"\n\nmodule.exports = ->\n  {Achievement} = system\n  {ContextMenu, Util:{parseMenu}} = system.UI\n\n  launch = (App) ->\n    app = App()\n    system.attachApplication app\n\n  # TODO: Generate menu from list of installed apps!\n\n  contextMenu = ContextMenu\n    items: parseMenu \"\"\"\n      🔨 [A]pplications\n        📝 [A]ce Editor\n        🍷 [C]hateau\n        🎨 [P]ixie Paint\n      🎮 [G]ames\n        🌭 [B]ionic Hotdog\n        🍖 [C]ontrasaurus\n        😭 [D]ungeon Of Sadness\n      📰 [I]ssues\n        1️⃣ [F]irst\n        🏰 [E]nter The Dungeon\n        🏬 [A]TTN: K-Mart Shoppers\n        💃 [D]isco Tech\n        🌻 [A] May Zine\n      ⚙️ [S]ettings\n        📱 [A]ppearance\n        💯 [C]heevos\n      💼 [M]y Briefcase\n      -\n      🔌 S[h]ut Down\n    \"\"\"\n    handlers:\n      aceEditor: ->\n        launch AceEditor\n\n      aMayZine: ->\n        system.launchIssue(\"2017-05\")\n\n      appearance: ->\n        system.UI.Modal.alert \"TODO :)\"\n\n      aTTNKMartShoppers: ->\n        system.launchIssue(\"2017-03\")\n\n      bionicHotdog: ->\n        Promise.resolve\n          src: \"https://danielx.net/grappl3r/\"\n          width: 960\n          height: 540\n          iconEmoji: \"🌭\"\n          title: \"Bionic Hotdog\"\n        .then system.iframeApp\n        .then system.attachApplication\n\n      chateau: ->\n        launch Chateau\n\n      cheevos: ->\n        launch AchievementStatus\n\n      contrasaurus: ->\n        launch Contrasaurus\n\n      discoTech: ->\n        system.launchIssue(\"2017-04\")\n\n      dungeonOfSadness: ->\n        launch DungeonOfSadness\n\n      enterTheDungeon: ->\n        system.launchIssue(\"2017-02\")\n\n      \"1First\": ->\n        system.launchIssue(\"2016-12\")\n\n      myBriefcase: ->\n        launch MyBriefcase\n\n      pixiePaint: ->\n        launch PixiePaint\n\n      shutDown: ->\n        Achievement.unlock \"Shut Down\"\n        system.UI.Modal.alert \"You'll never shut us down! ZineOS 5ever!\"\n\n  updateStyle = (contextMenu) ->\n    height = element.getBoundingClientRect().height\n\n    contextMenu.element.style.fontSize = \"1.5rem\"\n    contextMenu.element.style.lineHeight = \"1.5\"\n    contextMenu.element.style.bottom = \"#{height}px\"\n    contextMenu.element.style.textAlign = \"left\"\n\n  element = HomeButtonTemplate\n    click: ->\n      contextMenu.display\n        inElement: document.body\n\n      updateStyle(contextMenu)\n\n  return element\n",
      "mode": "100644",
      "type": "blob"
    },
    "social/comment-form.jadelet": {
      "path": "social/comment-form.jadelet",
      "content": "form\n  h1 Comment\n  label\n    h3 Author\n    input(name=\"author\" value=\"Anon\")\n  label\n    h3 Body\n    textarea(name=\"body\")\n  input(type=\"hidden\" name=\"area\" value=@area)\n  button Submit\n",
      "mode": "100644",
      "type": "blob"
    },
    "social/comments.jadelet": {
      "path": "social/comments.jadelet",
      "content": "comments\n  - @forEach (comment) ->\n    comment\n      div= comment.body\n      .author= comment.author\n",
      "mode": "100644",
      "type": "blob"
    },
    "social/social.coffee": {
      "path": "social/social.coffee",
      "content": "CommentFormTemplate = require \"../social/comment-form\"\nCommentsTemplate = require \"../social/comments\"\n\nAjax = require \"ajax\"\najax = Ajax()\n\n# Includer must provide self.area() method that dictates what the comments attach to\nmodule.exports = (I, self) ->\n  {Modal} = system.UI\n\n  self.extend\n    comment: ->\n      Modal.form CommentFormTemplate\n        area: self.area()\n      .then (data) ->\n        ajax\n          url: \"https://whimsy-space.glitch.me/comments\"\n          data: JSON.stringify(data)\n          headers:\n            \"Content-Type\": \"application/json\"\n          method: \"POST\"\n      .then ->\n        self.viewComments()\n\n    viewComments: ->\n      ajax.getJSON \"https://whimsy-space.glitch.me/comments/#{self.area()}\"\n      .then (data) ->\n        data = data.reverse()\n\n        if data.length is 0\n          data = [{\n            body: \"no comments\"\n            author: \"mgmt\"\n          }]\n\n        Modal.show CommentsTemplate data\n\n    like: ->\n      system.Achievement.unlock \"Do you 'like' like me?\"\n      window.open \"https://www.facebook.com/whimsyspace/\"\n    subscribe: ->\n      require(\"../mailchimp\").show()\n\nmodule.exports.menuText = \"\"\"\nS[o]cial Media\n  [V]iew Comments\n  [C]omment\n  [L]ike\n  [S]ubscribe\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/around-the-world.coffee": {
      "path": "stories/around-the-world.coffee",
      "content": "module.exports = \"\"\"\n# Around the World in 20 Years and a Weekend\n\nThe history of human progress is rife with us entering things. [Tombs](https://en.wikipedia.org/wiki/Raiders_of_the_Lost_Ark), [dragons](https://en.wikipedia.org/wiki/Enter_the_Dragon), [voids](https://en.wikipedia.org/wiki/Enter_the_Void), even [gungeons](http://dodgeroll.com/gungeon/).\n\n\nBut have you ever stopped to think about what fuels this endless urge to ingress? Rather fearlessly, I decided to find out.\n\n![sensuous nights](https://frog-feels.s3.amazonaws.com/2016-52/391848cb-afa1-4149-b2be-054d6d86b540.png)\n\nIt's now 20 years later. I've waded through the jungles of the Amazon, skied the slopes of Norway, swam the Ganges, and braved long lines. I've lost a lot too. The years have aged me dramatically - I'm a hot mess. And I lost my phone a month ago, so my friends and family are dead to me now.\n\nHere's what I've learned on my journey,\n\n![lederhosen leroy](https://frog-feels.s3.amazonaws.com/2016-30/57b1f586-4f32-4cd5-8aea-d1a7c9400964.png)\n\nThe Freudian says we want to go in things for obvious sex reasons. Freudian? More like ‘Fraud’-ian, right? Har har.\n\n![horse confessional](https://frog-feels.s3.amazonaws.com/2016-27/75889dde-ba0c-434e-b5dd-1edda7daa97e.png)\n\nMy Peyote spirit animal is a horse. Under the desert sky he whispers in my ear that what we really want is to enter the stable of the mind. I'm not so sure though. I don't even really like normal earthly stables.\n\n![soup boy](https://frog-feels.s3.amazonaws.com/2016-32/821e8ec3-e55d-4388-8cdd-6da58d902924.png)\n\nAfter the peyote trip, things get a little fuzzy. I stumbled into a place. It was either a diner, a drive-in, or a dive. There I met TV food guy Guy Fieri. Between mouthfuls of cheese and enthusiasm, he proclaimed that we enter so that we may exit.\n\n“We’re all searching for something that’s everything we imagine it to be.”\n\n...\n\nIf I'm honest, this odyssey only really took a weekend. After that I didn't really feel like going back to work, so I just hung out for a while.\n\n![you are great](https://frog-feels.s3.amazonaws.com/2016-50/2d44fdcd-05b9-4a92-a954-ec1235ee7b1e.png)\n\n\n[🐸 cool art made by cool people at [Frog Feels](http://frogfeels.com)]\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/blue-light-special.coffee": {
      "path": "stories/blue-light-special.coffee",
      "content": "module.exports = \"\"\"\nBlue Light Special\n\n“You know, I really want some cookies.” Elo said. She sat on a cushion on top of a tarp spread on the ground in front of their small campfire and whittled a piece of wood, periodically tossing the shavings into the fire. The warm glow bathed her deft fingers, tired face, and honey-colored hair with a soft light, and faintly illuminated the oak trees around them in the pressing darkness.\n\n“We can break camp tomorrow, move on, and see what we can find on the way,” Jib replied, as he munched some popcorn and scratched his dark beard. He scooted his log seat closer to the fire and buttoned his shearling jacket to keep out the fine mist rolling in among the trees.\n\n“I don’t want to break camp,” Elo protested. “I like it here. We should stay a while. I just want to have some cookies.” She looked around their camp: at Jib on his stump; at Poli beside her on the tarp, seated on her own cushion; at their reliable and well-used tent; at the horses draped with their blankets; at the clean dishes drying fireside. This was a good place. She rubbed her ever-growing abdomen. The tiny person ensconced within dragged a heel over her insides in response.\n\n“Okay, we won’t break camp, then. We can just go to town tomorrow. We need some other supplies anyway.” Jib raised his lanky body to pass the popcorn to Poli, who took the enameled bowl and placed it between her and Elo.\n\nPoli offered the popcorn to Elo. “Here, have some popcorn. That will help take your mind off the craving.”\n\nElo knitted her brows. “No, it won’t. It’s not the same and you know it.”\n\n“Yeah, okay. I know. It’s not. But it’s what we have,” Poli smiled gently, hoping to diffuse the situation.\n\n“Why can’t you just go get some now? We didn’t camp that far from town, and it’s not that late,” Elo pleaded.\n\n“Because it’s going to rain soon, and because I’m tired, and because we decide things together, not based on whim,” Jib retorted grumpily.\n\n“Pleeeeeease! I really, really want them. I’m tired too and my back hurts from hauling this baby around and I just want to have some cookies. Is that too much to ask?” Elo burst into tears.\n\n“Elo, please don’t cry.” Poli’s red curls bounced as she snapped her head up to glare at Jib. She enfolded Elo in a hug, and Elo sobbed harder on the petite woman’s shoulder.\n\n“Poli, come on,” Jib sighed. “Get Elo settled in the tent and you and I will go tonight. Let’s get moving so we’re not caught in too much rain on the way back.”\n\n**\n\nGabe sat on a cold concrete bench at a cold, round, concrete table, eating cold pizza under a murky and unforgiving sky in which clouds entirely obscured the stars, and in which mist threatened to give way to outright rain. He reflected miserably that of all the ways to eat pizza, this was probably the second-worst. The worst would be back in the break room with the other Kmart employees, where they would have excited yet hushed conversations that did not include him, the night manager.\n\nThe table he was sitting at had recently had a fiberglass umbrella to provide meager protection against the elements. Last week, however, seven drunk teenagers had removed it to use as a boat in a very large puddle at the back of the parking lot and it had not been seen since. The sky began to spit at him, and he thought, “At least the sky is doing what they’re all thinking.”\n\nGabe looked up the nearly deserted road and noticed two large figures with an odd gait. They resolved into a tall, bearded man and a petite, redheaded woman, each on horseback, emerging from the mist and entering the Kmart parking lot. Amused, Gabe wondered whether the pair might tie their horses up to the bike racks, or find a parking space near a lamp post and hitch them there, or tether them to a tree.\n\nThe man and woman did none of these things. They simply rode the horses through the automatic doors and into the Kmart. Gabe took a moment to process this. He started to get up, looked at his phone, noticed ten minutes remained of his break, and sat back down.\n\n**\n\nPoli dismounted inside the doors and hitched up a shopping cart to her horse. She nimbly saddled up again, and she and Jib then began perusing the aisles of the Kmart and checking the items off their list.\n\n“Sir? Miss? Can I help you?” an employee demanded tersely, body language suggesting the only help would be toward an exit.\n\n“Yes, thank you. We are looking for cookies such as would satisfy a pregnancy craving,” Jib replied. He placed some batteries in their cart.\n\n“Cookies? Aisle 12A,” the employee responded automatically, then shook her head.  “The horses. You can’t have them in here. You’ll have to take them outside.” The employee was joined by two others, all of them looking simultaneously stern and bewildered.\n\nThey reached the aisle’s endcap. “Ooh, look, nut mixes are on sale,” Poli grinned.\n\n“Go ahead and get a few,” Jib called to her as he rode ahead to select some prenatal vitamins and toothpaste.\n\n“Miss, please. The two of you need to take the horses outside,” the employee wheedled.  As if to respond, Poli’s horse lifted its tail and dropped a steaming load near the employee’s boot. The employee leapt back, dismayed.\n\n“Oh, no, I’m afraid that won’t be possible. These are our service animals,” Poli chirped sweetly.\n\nThe employees huddled together. “Where’s Gabe?” they worried. They barked into walkie-talkies to Gabe to come over here RIGHT NOW and received no response.\n\nPoli caught up with Jib and together they loaded dry beans and rice into the cart. Suddenly, a voice spoke, as if from the heavens, and a flashing blue light punctuated the announcement:\n\n“Attention, Kmart shoppers! Blue light special on Aisle 12A. Tedwich Sandwich Cookies, buy two, get one free!”\n\n“We have to get those for Elo. I bet they’ll be perfect!” Poli shouted to Jib, and she urged her horse forward. Jib rode after her, followed by the three ineffectual employees, and an ever-growing crowd of onlookers.\n\nAisle 12A displayed an alarming variety of cookies, snack cakes, and other treats, and Poli and Jib were, for the first time, ill at ease in the Kmart. A small girl with braids and cutoff jeans approached them.\n\n“Here you go,” she smiled shyly, handing up a box. \n\n“Thank you,” Jib smiled back. He tore into the box and passed a handful of the Tedwich cookies to Poli. They sampled the miniature bear-shaped cinnamon cookies sandwiching a vanilla cream filling. They were, indeed, exactly what Elo would love.\n\n“Can you help us load our cart with every box there is?” Poli asked.\n\n“Not every box. I want to have three for myself,” the girl quickly replied.\n\n“Done.”\n\nWith all but three boxes of Tedwich cookies in their cart, the only thing left was to find some ice cream to go with them. This expedition caused no small amount of chaos in the freezer case aisle when a small, yappy dog in a handbag spooked the horses, which in turn sent the crowd scattering in all directions. Fortunately, it also resulted in Jib’s horse being perfectly positioned in front of a case containing pint after pint of ice cream. They selected one of chocolate and one of vanilla, and Jib and Poli rode to the checkout.\n\nPoli pulled a small wooden box from her canvas messenger bag and handed it down to the cashier. “This is a very rare and ancient turtle, carved from an unknown precious stone to bring the bearer untold riches. It is more than enough payment for these goods in our cart.”\n\nPoli and Jib rode out of the store, cart still in tow, as Gabe came back in. The two riders disappeared into the night.\n\nThe employees surrounded him. Gabe said nothing. He strolled through the store, surveying the relative lack of damage, the confused shoppers, and the piles of manure, and he grinned as he reached for his walkie-talkie.\n\n“Cleanup on Aisles 6, 7, 10, and 12. Better get a shovel.”\n\n**\n\nElo drifted to sleep that night, completely content, filled with cookies and ice cream. She dreamed of a girl with braids and cutoff jeans, holding boxes and boxes of Tedwich cookies stacked higher than she was tall. She flew above the girl as a deep blue light bathed them both.\n\n“What is your name?” Elo asked.\n\n“Theodosia,” the girl answered. The girl flew up to meet Elo and they soared effortlessly through the ceiling and out into the mist.\n\nThree months later, in the middle of another rainy night, Elo gave birth to a baby girl. The child was dusted with cinnamon freckles and looked up at Elo with the bluest eyes she had ever seen. She named the girl Theodosia.\n\n\"\"\"",
      "mode": "100644",
      "type": "blob"
    },
    "stories/crescent.coffee": {
      "path": "stories/crescent.coffee",
      "content": "module.exports = \"\"\"\n“Look, Mom, I made a moon!”\nShe holds aloft a crescent bitten from cereal,\nand I feel a tug on my memory:\nnot the usual familiarity\nof the Earth’s twirling, ever-changing little sister\nbut something deeper, and more intimate,\nlike a great truth,\na resonance of great importance,\nhad been uncovered within my mind as I slept,\nand was lost upon waking.\nAnd then she ate the moon.\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/dungeon-dog.coffee": {
      "path": "stories/dungeon-dog.coffee",
      "content": "module.exports = \"\"\"\nDungeon Crawl with Cliffford!\n\nOne sunny day, Cliffford the big rad dog was playing at the park with his friends U-Bone and Cloe. They chased each other through the playground, around the play structures, and through the sand. Children squealed with delight to see Cliffford jump right over the swing set in his excitement. “He’s so big! He can jump over things! Heehee!” they giggled. THUMP! went Cliffford’s paws as he landed on the grassy field, and Cloe and U-Bone followed right behind.\n\nThe dogs dashed through a soccer game, U-Bone stopping to bite at the ball, and Cleo weaving her way through at least four players’ legs. They emerged on the other side of the field at the northernmost edge of the park, where the well-kept field gave way to a little meadow, and then the woods.\n\nCliffford flopped down in a shady spot, and Cloe and U-Bone stood panting next to him. Cool breezes blew in from the ocean, rippling the leaves on the trees and the long meadow-grass.\n\n“What do you guys want to do now?” Cliffford asked. “I could really go for a nap.”\n“Yeah, a nap sounds good,” U-Bone replied, snuggling up beside him.\n“We could nap, but what about going back and trying to get that Frisbee over there?” Cloe asked.\n“Mmphuhuhmph,” U-Bone answered, already half-asleep.\n“All right, fine,” Cloe huffed. Cliffford began to doze as well, so Cloe meandered away, sniffing around the meadow.\n\n“Cliffford? U-BONE! WAAAAAAAKE UP!” Cliffford and U-Bone bolted awake, jumping to their feet.\n“HAHAHAHA! Did I scare you?” Cloe yipped, bouncing around in circles around her two friends as excitement practically dripped off her.\n“What’s up, Cloe?” U-Bone asked.\n“I found something neat. Come with me!”\n\nWithout looking behind her to see if the others were coming, Cloe took off at a run down a path that Cliffford and U-Bone hadn’t seen until now. The path wound through the woods, the trees getting taller and closer together the further along they went. The terrain became rockier, and a few times they dodged around large boulders as they continued forward.\n\nAround a bend in the path, Cloe came into view, her tail wagging wildly. She stood in front of a large outcropping with a dark, conveniently Cliffford-sized opening in its face.\n\n“This place gives me the willies,” U-Bone said, looking around. He noticed crumbling rock around the entrance, which on closer inspection, he realized were carvings of some kind of dog-dragon looking menacingly into his eyes. U-Bone decided not to inspect it further. It was definitely a dungeon.\n\n“So? Come on, guys, what do you think? Want to go inside?” Cloe asked.\n“You know, I’d really rather just go back and see if we can score any free snacks from the picnic blankets,” U-Bone muttered, looking uncomfortable.\n“Yeah, I’m not even sure I’ll fit in there,” Cliffford said.\n“Uh, Cliffford, did you see the part up there in the paragraph before last where it said the entrance is conveniently Cliffford-sized? Do you remember the last story where you fit into the double doors of a shopping mall? You can’t worm your way out of this.” Cloe looked smug. “I’m sure there are all kinds of interesting things to eat in there anyway, U-Bone.”\n“Oh, all right,” Cliffford and U-Bone sighed. “Let’s enter the dungeon.”\n“Fuck* yeah!” Cloe shouted, and ran inside.\n\n*If you’re reading this to young children for some reason, have fun substituting the word of your choice. May we suggest fizzle? Forward? Finagle? Forsooth? Just say it with all the energy of a dog hopped up on self-righteousness and you’ll be fine.\n\nCliffford did, indeed, fit inside the entrance, as well as the tunnel just inside. There were plenty of smells wafting around, and his head whipped from side to side trying to take them all in. In doing so, he failed to look at the ground ahead, and he tripped.\n\n“Look, a bone!” Clifford said happily as he scrambled up off the floor. Things were beginning to look up. Cliffford picked it up and gnawed around on it as they trekked deeper into the dungeon.\n\nU-Bone noticed some orangish clingy stuff close to the bottom of the cave wall. He sniffed it. “Slime mold? Don’t mind if I do.” He nibbled a little, and then scarfed the rest down in just a few bites. Not bad. He feels invigorated!\n\n“Oh, wow, another one!” Cliffford shouted around the bone in his mouth as he stopped to pick up a second bone. “And another! This dungeon is turning out to be pretty great.”\n\n“I told you!” Cloe grinned. She bounded down the tunnel ahead of the other two. “Come on, there’s a staircase that’s leading down!”\n\nThe three dogs descended the stairs into near-blackness. No longer lit by the daylight streaming in from the entrance, the dungeon was distinctly murkier. Something brushed past U-Bone’s ear and he snapped at it.\n\n“I found a torch!” Cloe said. “I wonder if there’s any way to light it. We’d better take it with us. She grabbed the torch in her mouth and crept into the gloom.\n\nThe trio inched forward, sniffing and listening before moving along the path. Eventually, the darkness lifted a little bit, and they approached a second, lit torch set into a sconce in the wall. Even Cloe felt better once she lit their torch, which now illuminated a small circle around them.\n\nSomething else glinted in the darkness just beyond them. Cloe moved closer and the dogs saw a beautifully crafted, lightweight sword lying on the dusty floor. “This one’s all yours, U-Bone,” Cliffford said through his mouthful of bones. U-Bone gingerly took the sword and swung it around a few times. Cliffford and Cloe saw his apprehension turn to excitement as U-Bone growled, advanced on a spiderweb, and dispatched it.\n\nU-Bone stumbled upon a sheath and baldric for the sword a short distance away, and strapped them on. BOSS! A few turns of the path later, and the dogs found another staircase down. Come on, it’s a dungeon crawl. Of course they found another staircase!\n\nThe dogs explored further and deeper into the dungeon. Cliffford’s mouth was crammed as full as possible with bones, and he looked sadly at each one he had to leave behind as they pressed on.\n\n“Humuhlauhsunrrmmmuh,” said the big rad dog, furrowing his brows.\n“Hmm?” asked Cloe, through the side of her mouth around the torch.\n“Mmmmahhhhh!” U-Bone hollered as he turned a bat into a meat icon that dropped a large leather satchel and a helmet that fit no one.\n\nCliffford pawed the satchel with his foot, turning it over. It flopped open. There was nothing inside, so he started to put his bones in his bag. He was delighted to find every single one fit, and then some. “Huzzzah! A bag of holding!” he shouted, and raced forward to find more.\n\nInstead, Cliffford found a kobold corpse. He sniffed it, hesitated, sniffed again, shrugged, and dug in. “Any good?” U-Bone asked, sheathing his sword. “Ugh, no, this corpse is definitely tainted,” Clifford said, not lifting his head from his meal. U-Bone sniffed the corpse and took a bite. “Yeah, man, ugh, that’s rank. Don’t eat those guys.”\n\nThe dogs began to feel thirsty from all their exertions, and conveniently the next level had some water! They descended the stairs to find themselves standing in front of an expanse of shimmering deep blue-violet, a gorgeous underground lake.\n\n“It’s beautiful!” Cloe sighed. She bent down to drink, and U-Bone followed suit. Cliffford bent over, too, and as he drank, his stomach began to twist. “Uh, guys?” Cliffford said. “HUUUGGGGGGHHHHHHHHHH,” he retched, and vomited into the lake. He lay down in the mud on the shore.\n\nU-Bone noticed a sign nearby. “Lake of Eternal Cleanliness,” he read.\n“Dude, not anymore. HAH!” Cloe barked.\n\nJust then, they heard a shout ahead of them. A small, crotchety dog-dragon-hermit thing emerged from a hovel at the edge of the lake.\n\n“THIS LAKE HAS BEEN PRISTINE FOR NINE HUNDRED THIRTY SEVEN YEARS!” shouted the angry lake-keeper, shaking one fist wildly and wielding a Staff of Glowing Menace in the other. Cloe backed up, and U-Bone got his sword ready, but Cliffford still lay in the mud, groaning.\n\nJust then, Cliffford happened to twist his head at just the right angle to notice a small vial of something pink resting in the mud by his ear. He quaffed this (come on, Cliffford, stop ingesting all these questionable things!) and instantly felt not only invigorated, but also amplified! Cliffford barked an ear-poppingly loud enchanted bark, which repelled the lake-keeper and sent him splashing into the Lake of Recent Uncleanliness, and the three friends hauled ass* (*apples?) further down into the dungeon.\n\nBy the time the dogs felt like they could slow down, they had descended what felt like (and was) the umpteenth flight of stairs. They came out in front of a small, narrow opening. Cloe held the torch while U-Bone scouted inside, and he noticed that the path was twistier and turnier than the rest of the dungeon had been.\n\n“I think it’s a labyrinth,” he said, as the two smaller dogs emerged from the entrance. “But Cliffford, I don’t think you’re going to fit.”\n\n“I’m going to look around and see if there’s any way around,” Cloe said, and trotted off. She came back a few moments later with a rolled-up piece of paper.\n\n“Hey guys, what’s this?” she said, dropping it in front of the others.\n“It’s some kind of scroll,” U-Bone said, nosing at it.\n“Is that like some kind of newspaper?” she asked. “I love newspapers! I like to go out really early in the morning right after they’re delivered, slide them out of their plastic sleeve, and shaaaaaaaaaake them so hard that they get all shredded up! It’s so funny!” Cloe giggled. “I’m going to go for it. I think this scroll is going to be pretty satisfying too.”\n\nCloe whipped her head back and forth, and the scroll unfurled, revealing the text GRRMOC UHLPROOT in old-timey writing, and she stopped. “Grrmoc uhlproot?” she asked, and instantly, Cliffford fell to the ground. Yeah, the scroll was totally cursed.\n\nA moment later, Cliffford was back up again, only now he was the size of a normal dog. Yup!\n\nThis was a very useful development for our plot, because they heard shouts from the top of the stairs. The angry lake-keeper’s scratchy toenails clicked on the stone treads as he skittered down toward them.\n\nThe dogs wasted no time, and all three dove right into the entrance to the labyrinth. They tried their best to stay together, but Clifford, unused to being tiny, lagged behind. He felt weak, and needed food badly.\n\nThe other dogs called encouragingly behind them for Cliffford to hurry the fuck* (*fart!) up, but he stopped short when he saw some meat lying in a corner. It was another kobold corpse. His brain said to him, “Hey, wait a second, Cliffford,” but then he discovered he’d already begun to eat it.\n\nOh yeah, this one’s tainted too.\n\nThe dogs all managed to find their way to the center of the labyrinth in enough time to marvel at the treasure there: the Squeaky Toy of Canidae. A lovely, fuzzy, stuffed squirrel with a magical squeaker that never, ever breaks, and that is also enchanted with legendary but vague special powers.\n\nTheir marvel was cut short by the angry lake-keeper, who barreled into the center of the labyrinth behind them, hollering. Cliffford turned to face the lake-keeper, and felt a familiar twist in his stomach as he did so.\n\n“HGGGGGRRRRRRRPH!” he grunted, spewing vomit all over the lake-keeper. It sizzled as it hit the lake-keeper, dealing quite a bit of damage. It also broke a curse on the lake-keeper, and from his crusty, smelly robes emerged Moc.\n\n“What is going on? I’ve been in this godforsaken cave for the last five and a half days* (*937 dog-hours!). The whole time I’ve been having repeated nightmares that I’m some sort of disgusting hermit encamped by a lake.” He shook himself, and droplets of vomit spattered the labyrinth walls.\n\n“And you, Cliffford, your vomit seems to be a recurring feature in my nightmares as well. Can we please get out of here?” Moc huffed, as he caught a whiff of the tainted, partially digested kobold corpse clinging to his fur.\n\n“Hey, guys, I think Moc’s curse isn’t the only one that’s broken!!” Cliffford shouted, as he began to grow and grow. The rapid growth broke down the walls of the labyrinth, revealing a clear path to the exit.\n\nCliffford stuffed the Squeaky Toy of Canidae into his bag of holding, and all the other dogs hopped on his back and held on for dear life as Cliffford sprinted out of the dungeon and back into the sunshine of the park.\n\nAfter rolling around in the grass to get the last of the spiderwebs and vomit off themselves, the dogs went back to Cliffford’s doghouse, where they all feasted on the bones from Cliffford’s bag of holding and took turns with the Squeaky Toy of Canidae.\n\nThe friends all agreed that it was the best dungeon crawl ever!\n\nTHE END!!\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/izzy.coffee": {
      "path": "stories/izzy.coffee",
      "content": "module.exports = \"\"\"\n“Izzy, your grandma is here!” Izzy jumped up from where she was seated on the classroom floor chatting with her friends during after-school care, and she ran to her grandmother to give her a huge hug.\n\n“Have a good weekend,” her teacher said as Izzy grabbed her backpack.\n“You too!” Izzy called, as she ran for the parking lot with Grandma close behind. She nearly flew through the school gate.\n\n“Wait for me before you cross the street!” Grandma shouted to Izzy.\n“Sorry,” Izzy replied as Grandma caught up to her.\n\nThey crossed over to where Grandpa was leaning against their 1973 El Camino. He swung Izzy up and spun her around.\n\n“Did you have a good day, kiddo?”\n“Yeah! I finished The BFG and I got to draw my favorite part as a poster and share it with the class,” Izzy said proudly.\n“Sounds great. Did you try to draw in the style of Quentin Blake, or did you use your own style?” Grandpa asked.\n“Well, I tried pretty hard to draw like Quentin Blake, but it’s hard to draw like other artists. I didn’t like how it looked so I started over by just reading the description again and imagining it in my head. I’ll show you next week when I bring it home.”\n\nIzzy lowered her backpack into a wooden orange crate in the truck bed of the El Camino. Her navy-blue violin case, a small amplifier, and a black bag already sat in the crate. The crate nestled in between a variety of potted plants which took up the remaining space in the bed. Izzy plucked a few ripe cherry tomatoes and some snow peas from their respective vines, which twined around cages in a large planter close to the cab’s rear window. She ran her fingers through the thyme and mint spilling out of smaller planters closer to the tailgate and breathed in, relishing the pungent and spicy smells. She loved her grandparents’ mobile garden.\n\nShe munched her snack as she climbed into the front seat of the El Camino and slid in next to Grandma, who sat in the driver’s seat. Grandpa placed three garment bags on Izzy’s lap, and then slid in beside her, sandwiching Izzy in between her grandparents. \n\n“Be careful not to get any tomato juice on the garment bags,” Grandpa cautioned.\n“I know. I’ll be careful.” Izzy replied.\n“All right. Sorry it’s such a tight fit today!” Grandpa smiled at Izzy. “Are you excited?”\n“Yeah! I can’t wait until we get to the boardwalk! Everyone is going to love our show!”\n“Well, then!” Grandma exclaimed. “Let’s go!”\n\nThe El Camino’s engine roared to life and Grandma maneuvered the car onto the road. With both windows down, the breeze ruffled everyone’s hair, and as they neared their destination, the fresh scent of the ocean wafted in, filling Izzy’s nostrils with the salty, damp aroma. The plants in the back swayed gently back and forth in time with the rhythm of the car’s motion, and their planters were so tightly arranged that nothing slid around. \n\nGrandma pulled into a perfect parking space close to the boardwalk at the beachfront parking lot. Grandpa carried the garment bags; Izzy carried her backpack and violin, and Grandma carried the black bag and the amplifier.\n\n“Nice car!” a voice called to them. They turned to see a young man and woman wearing wetsuits and loading surfboards into the back of their SUV.\n“Thanks!” Grandpa called back. The two surfers smiled at them. Izzy glowed. She loved the way her grandparents brought joy everywhere they went.\n\nThe sun was beginning to set over the ocean, creating an air of magic. Izzy and her grandparents walked the short distance to their pre-chosen destination: a bench that overlooked the water, adjoining a large, wide sidewalk upon which Friday night foot traffic was beginning to accumulate.\n\nA nearby planter contained palm trees and succulents, as well as a small electrical outlet on one side. Grandma pulled an orange extension cord from her black bag, and plugged it in. She carefully duct-taped the cord to the ground for safety as she ran the cord up to the bench. Izzy plugged her amplifier in the extension cord and began setting up her equipment.\n\n“I’m going to go get changed,” said Grandpa to Grandma, taking his garment bag and walking in the direction of the restrooms. As Izzy began tuning her violin a few minutes later, Grandpa appeared wearing a leisure suit that had a complicated design made of conductive fabric circles and lines stitched together in that turned his costume into a drum pad, which connected wirelessly with the amplifier.\n\nThe equipment setup complete, Grandpa began do a final check of his suit while Izzy and Grandma took their turn to change as well. A short time later, they emerged, resplendent in their own costumes.\n\nGrandma wore a long-sleeved, tight-fitting silver dress that had fiber optic filaments running vertically along her body and dangling beyond the bottom of the dress. She had not yet switched on the battery pack, and the dress appeared at first to be rather unassuming. However, the headdress she was wearing was quite the opposite. Nestled in Grandma’s big hairdo was a variety of feathers, delicately coiled wire shapes, and more fiber optics that skimmed the top of her head before shooting up like the crest of a rainforest bird. Dramatic, dark eyeliner, silver eye shadow, and silver platform shoes completed the look.\n\nThe simple cut of Izzy’s dress accentuated the beautiful movement of the fabric. A fitted bodice gave way to a flared skirt. She twirled, and the purple and blue dip-dyed fabric swirled in response around her knees. Opting to keep her costume simple for ease of playing her violin, it had no electronics. The bodice was adorned with sequins she had painstakingly glued in an intricate pattern, which, like a disco ball, would reflect the lights from the small footlight set up next to her. In Izzy’s hair was a small feather and fiber optic fascinator, like Grandma’s but on a smaller scale.\n\nIzzy did a quick, final sound check. “Ready?” she asked. \n“Let’s do it!” grinned Grandma and Grandpa.\n\nMonths of effort coalesced into one moment as the sun finally dipped below the horizon, sending the boardwalk into twilight. Grandma and Grandpa switched on their battery packs, and Grandma’s dress lit up. Izzy switched on her footlight, nodded to Grandma and Grandpa, and began to play.\n\nInspired by her hero Zoë Keating, Izzy began to loop snippets of her violin with her loop pedal. She built sound after sound up to a fast-paced, catchy, danceable beat, while Grandpa and Grandma began to dance. Grandma’s fiber optics began to pulse with the rhythm of Izzy’s music and Grandpa’s drum pad leisure suit. They whirled and spun, and even Izzy swayed and swirled with the music as she played.\n\nA crowd began to form, cheering on the pop-up discotheque. They clapped in time to the music, delighted every time Grandma’s skirt sent pinpricks of light racing around her knees, and murmured in excitement at the intricate movements Grandpa made to keep the drums thumping. As the song ended, the crowd exploded with whoops and shouts, and several people made donations into Izzy’s violin case. The family took a bow, and launched into another song, causing the crowd to cheer yet again.\n\nLike any moment that has been anticipated for so long, it seemed to last but the blink of an eye. When the last song ended, the crowd drifted away on the final, lingering notes from Izzy’s violin. As Grandma and Grandpa started to pack up, Izzy took a dime out of the violin case, her favorite coin because it was the smallest, and darted to the fountain down the boardwalk. She pitched the coin into the dark water that reflected the stars.\n\n“What did you wish for?” Grandpa asked as Izzy returned.\n“Not telling,” Izzy replied.\n\nShe slipped her small hand into Grandpa’s, and the other into Grandma’s, and they walked back to the El Camino.\n\"\"\"",
      "mode": "100644",
      "type": "blob"
    },
    "stories/marigold.coffee": {
      "path": "stories/marigold.coffee",
      "content": "module.exports = \"\"\"\nThe shutters of a third-story window of the manor house flew open, and a small girl leaned out, hurling a rope to the ground below. She lugged a chair over to the window, and stood on it. She grasped the rope in both hands, and began slowly descending the pitted grey stone walls of her home. Evenly spaced knots helped her tiny hands keep hold of the thick, scratchy rope as she leaned her slender frame away for balance.\n\nIn the garden below, the girl brushed rope fibers from her hands on her leggings and smoothed out her tunic. A gust of wind whipped her black hair about her face, and she wrapped her cloak closer about her body and pulled its hood over her head.\n\nThe waxing crescent moon, partially obscured by clouds, gave little light, but the girl needed no lantern. She blinked her golden eyes rapidly a few times, letting her cat-like pupils widen enough to collect the scant light, and took in her surroundings in shades of grey. She marched off into the darkness of the nearby woods, hidden under the cover of darkness.\n\nThe girl found her favorite deer trail through the forest, almost invisible to anyone else. It wound around the ancient oak trees before descending along a sandy bank to the edge of a softly flowing river. Downstream, the rapids became rough, but here, where rocks were few and the ground was mostly level, the water pooled and was perfect for swimming.\n\nDespite the chill of the evening, the girl removed her boots and garments and folded them neatly, placing them on a flat rock several feet from the edge of the river. She stood expectantly, letting the water lap at her toes.\n\nShe looked up as a swirling cloud emerged from a hollow tree and collected above her head. She whistled a haunting little tune and the cloud parted, wrapping itself around her body as she stepped into the water. She waded waist-deep into the water as the nanoswarm enveloped her in scaly, flexible skin from her torso all the way down her legs, ending in a tail with long fins. Opening her mouth, she inhaled some of the nanoswarm to allow her to breathe underwater, before her body slipped entirely under the rippling surface. \n\nThe girl splashed her tail and a peal of light, uninhibited laughter echoed off the rocks as she resurfaced. She swam off into the night.\n\n***\n\n“Lady Marigold?” A young woman, shivering in the predawn air, gently shook the girl’s shoulder to rouse her. The girl, Marigold, blinked her eyes and looked to find her lady’s maid standing over her with a look of concern. Marigold lay on the sandy shore where she had fallen asleep hours before.\n\n“Hm? Oh, no. I’m so sorry, Raina! I didn’t mean to fall asleep!” she said, brushing sand from her face as she sat up. She was still wrapped in her nanoswarm, so she whistled to them again, and they lifted away from her body and back into their hiding place in the tree. Raina retrieved the neatly folded clothing and helped her lady dress quickly.\n\n“My lady, if you must escape the house at night, please return in a timely manner. Surely you can program your nanoswarm to remind you to come home?”\n“I can, but it is awkward to swim to shore with legs if the nanoswarm leaves me when I am not yet ready. I much prefer the tail.”\n\nRaina huffed in exasperation and said nothing further. She tamed Marigold’s long hair in a quick series of braids, which she wound around the girl’s head and pinned into place.\n\nMarigold turned to leave, but Raina said, “Your eyes, Lady Marigold.” Marigold paused, closed her eyes, and opened them again. Gone were the cat’s eyes, replaced by dark brown eyes with the usual round pupils one would expect to see in a girl five years of age.\n\nRaina followed her lady up the bank and back into the forest. They returned to the manor house quickly and quietly. Raina, feeling that scaling the walls of the house was undignified, had already wound Marigold’s rope back up and closed the shutters. Instead, the two of them tiptoed through the kitchen. The cook, singing loudly to herself, kneaded the day’s bread and did not hear their entrance.\n\nBack in Marigold’s rooms, Raina started a fire. “I am not cold,” Marigold protested. “The nanoswarm helps regulate my body temperature.”\n“Very well, but I have no such protection and I, too, have also been out in the cold this morning.” Raina continued building the fire until it roared in the fireplace.\n\nMarigold disappeared into her library, a fortress of shelves she had arranged in a corner of the room adjacent to the fireplace. Books of all shapes and sizes and subjects, borrowed from the big library downstairs, whispered to her their secrets of ancient wars and mythology, poetry and architecture. Soft cushions stacked on a rug served as her seat, and Marigold resumed reading A Brief History of Nanoculture.\n\nBreakfast arrived on a tray, which Raina placed next to Marigold on the floor. The girl held the book in one hand, and ate her toast and jam and drank her tea with the other, her eyes never leaving the pages.\n\nA knock at the door yielded a sealed note, which, though it was addressed to Raina, was delivered to Marigold. The girl looked over the note, scowled, and snapped the book shut, mentally noting the page number.\n\n“My uncle has summoned me,” Marigold said to Raina, who nodded in response. “I do wish that man would write to me directly.” She read the note aloud, rolling her eyes: “‘Send the Lady Marigold to me at half-past nine and ensure the child wears something befitting her station.’ He knows I can read. Why does he torment me thus?”\n\n“Your uncle is a good man,” Raina soothed, “He has many responsibilities, and has better things to occupy his time than chastising you for coming to an audience with him dressed for a day out in the woods.”\n“Formal clothing is pointless. My appearance is arbitrary. I am five, and therefore invisible anyway. I prefer being able to move freely.”\n\nMarigold flounced to a small adjoining room where her clothing was stored, and sullenly pulled a long dress from a drawer. Light, soft grey fabric draped over her head as she put the garment on. Long, tight-fitting sleeves with inlaid lace covered her arms, and the hem of the dress, which brushed the tops of her toes, featured more of the same lace. Over the dress, she put on a long, intricately embroidered vest, and Raina helped her cinch her waist with a belt the width of her hand, encrusted with beads made of semiprecious stones. Marigold slipped her feet into soft, ghillie-style shoes made of fine leather that laced up her legs.\n\nThey sat at Marigold’s dressing table and Raina brushed Marigold’s hair before smoothing it into a full, low roll at the back of her head, pinning smaller braids around it, and placing a gold hair comb into the top of the roll. Raina carefully adjusted the small curls around Marigold’s face, and turned the girl to face her.\n\n“You look lovely,” Raina smiled.\n“I still prefer the tunic and leggings, but thank you.”\n\nMarigold exited her rooms, followed by Raina. They descended the staircase at the end of the hall, and proceeded to the library, where Marigold’s uncle usually received her. Raina knocked, and entered.\n\n“Lady Marigold Lavande, Duchess of Frisa.” Raina announced her lady as she slowly inclined her head, a sign of respect for the child’s uncle and guardian, Lord Therus Osmarinus, a duke in his own right of the neighboring county of Astera.\n\nMarigold swept past Raina, stopping before her uncle and inclining her head to him. He returned the gesture of respect and motioned to a chair near the table upon which his correspondence was spread before him. Raina left the room, and Marigold sat.\n\n“Good morning, Marigold.” Her uncle’s green eyes were kind, but she could see bags under them. He probably had not slept much the previous evening. He sat at the table opposite her.\n\n“Good morning, Uncle.” From her perch on the chair, she could just see the letters he had been reading. She strained her eyes to see the details. She noted the seal of the Ruling Council affixed to several of the letters, and the swooping signatures of several different people. She also noted a map of the country he had pulled up on a tablet, with a variety of location markers scattered near the coast.\n\n“What is the map for, Uncle?” Marigold asked.\n\nHer uncle ran his fingers through his short, brown hair, speckled through with grey. He sighed. “There is some unrest along the coast. We have been summoned to the Palace of the Ruling Council for a meeting.”\n“We?” Marigold raised her eyebrows. “We are never summoned. You are summoned, and I remain here and you act on my behalf.” She began to feel agitated. She liked her home, and leaving it always made her feel uneasy.\n“In general, yes, but the Ruling Council specifically requested your presence this time.” Her uncle gestured toward the fireplace where a man and a woman stood, watching them.\n\nHe introduced them as Lord and Lady Sicale, and explained that he must accompany them now to the Palace, and that Marigold would follow along as soon as possible. Marigold gathered that the summons had been delivered in person, and must be quite delicate and urgent.\n\n“I leave with Lord and Lady Sicale within the hour. I have already sent instructions to Raina to begin packing your things. I shall see you soon.”\n\nHe dismissed her with a nod of his head, seeming to want to say more, but refraining. Marigold went back to her rooms.\n\n***\n\nThat evening, Marigold lay awake in bed. The day’s flurry of activity, rather than tiring her out, had set her brain tingling. Raina and the other household staff had seen to the packing of her clothing, books to study, and other personal effects. She had been left to her own devices to pack a small bag full of whatever she wished to take personally, which consisted largely of the books she was reading for pleasure, a sketchbook, some colored inks, and a variety of colored and graphite pencils. She had nearly everything, but one thing remained she wanted to take.\n\nShe rolled over and over, pondering, before finally sitting bolt upright, coming to a decision. Flickering her eyes to golden cat-eyes, she slipped out of bed and put on her tunic and leggings, boots and cloak. She took a tiny glass vial from her dressing table. It fit in the palm of her hand. The vial had a narrow mouth and neck, with a very small silicone stopper in it, and a bulbous base. Delicate filigree metalwork around the neck sported a loop through which she threaded a fine silver chain. She put the chain around her neck and hid it under her tunic.\n\nAs Marigold had done the previous night, she flung open the window, and let herself down silently with the rope. She flew over the deer trail to her secluded riverside swimming spot, where she whistled a slightly different nanotune than the night before. The swarm came out of its hiding place in the hollow tree. Instead of swirling around her and transforming her lower body into a sleek, aquatic creature, the nanoswarm poured into the vial around her neck, which she held aloft.\n\nMarigold replaced the stopper in the vial and hurried back to her room. The implications of bringing the nanoswarm to the Palace could be disastrous. Aside from her own swarm, nanoswarms had not been seen in hundreds of years. There were rumors of wild swarms, but no official reports existed, much like the mythical creatures she enjoyed reading about in her books.\n\nMarigold’s nanoswarm had been with her for as long as she could remember. It was her secret, shared only with Raina. She could not leave her swarm for more than a few days without missing them terribly, and based on the amount Raina and the others had packed, this trip would be much longer than a few days.\n\nComforted by the swarm’s nearness, but still terrified at the prospect of her visit to the Palace, Marigold fell into an uneasy sleep.\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/mystery-smell.coffee": {
      "path": "stories/mystery-smell.coffee",
      "content": "module.exports = \"\"\"\nThe Mystery Smell\n\n“I’ve got one!” Cloe shouted. Cliffford, the big rad dog, and his friends U-Bone, Cloe, Moc, Cassy, and Bub were playing their favorite game – Mystery Smell.\n\n“It’s smoky and garlicky and meaty,” said Cloe, “and it’s coming from a backyard!” The other dogs trotted down the street, sniffing everywhere until they found the source of the smell.\n\n“It’s a backyard barbecue!” called U-Bone from across the street. “I smell carne asada!”\n“You got it!” Cloe answered.\n\n“My turn!” said Cliffford as he caught a whiff of something on the breeze. “It’s strong, almost but not quite like mint, and it’s coming from up high.”\n\n“Hmmm,” thought the others. They passed through a park at the end of the street, and the others found the smell right away. “Eucalyptus trees!” Moc declared triumphantly, looking up into the tall trees that grew around the perimeter of the park.\n\nCassy’s nose picked up the trail of a jogger, and the dogs gleefully bounded along, following it until it ended at a house a few blocks away.\n\n“I smell something citrusy!” U-Bone barked, and his friends sniffed the air. They found a neighbor picking lemons off a tree in their front yard.\n\n“GUYS!” shouted Bub. “I have one, and it’s amazing!”\n\n“What is it like?” Cliffford wondered, and the others waited expectantly.\n\n“Well, it’s...you know...sort of...something...with a hint of...I can’t explain it.” Poor Bub was just a puppy and didn’t know the names of all the tantalizing smells in the neighborhood.\n\nThe other dogs sniffed their noses in all directions, hoping to help Bub name the smell he had found. Suddenly, they heard a “yip!” and a scratching of claws and the dogs turned to see Bub bounding away down the street.\n\n“Bub!” shouted Cliffford. Bub kept on running. The big rad dog sighed. “Bub is such a little puppy, but he always gets into BIG trouble. We’d better go after him.”\n\nCliffford, U-Bone, Cloe, Moc, and Cassy took off after Bub. They practically flew over the sidewalk! They reached the end of the block to see Bub’s tail disappear around the corner. They rounded the corner themselves and stopped short.\n\n“What is that huge building?” U-Bone asked. The dogs stared together at the building, which was situated in the middle of a very large, very busy parking lot.\n\n“It’s a shopping mall!” Cloe shouted. “Miss Dollar takes me there sometimes. People go there and look at things, and sometimes they take the things out in bags.”\n“Bub just went inside, guys. We’d better go in after him,” Moc said. The dogs quickly but carefully crossed the street, navigated the cars circling for parking spots, and made their way to the double doors of the BIZWELL MALL.\n\nThe mall had two floors, so the dogs split up. U-Bone and Cloe dashed for the escalators and each took one side of the top floor. Moc and Cassy stayed downstairs and each took a side. Cliffford went down the middle, with his feet on the first floor and his nose up in the second!\n\nAll five dogs dodged strollers and shopping bags, kiosks and benches, as they continued in pursuit of Bub.\n\nBub, meanwhile, was having a fantastic time. He had no idea what this huge building was, but the smells were tantalizing! He found a place with all kinds of different food, from curries to noodles to pizza to tacos, labeled Food Court. He picked up the smell of freshly baked waffle cones, and chocolate chip ice cream as he ran by a kiosk, and paused only briefly to lick the remains of a child’s dropped cone.\n\nBub passed a storefront selling candy, and savored the whiffs of peppermint candy canes and caramels and chocolates coming from the entrance. He scampered by a store loaded with candles, body lotions and sprays, all with fruity and floral fragrances.\n\n“Shoes!” squealed Bub, as he skittered past a store with hundreds of pairs of brand-new sneakers lining the walls. Bub was tempted to dive headfirst into the store selling leather handbags and wallets and belts and jackets, and chew on everything in sight, but he thought better of it. Besides, all the smells he smelled in this wondrous building were familiar. None of them were the new and enticing scent he was trying to find.\n\nPassing a coffee-and-tea kiosk and inhaling the aroma of the freshly ground beans and steaming cups of tea, Bub found himself at the other end of Bizwell Mall. He had nowhere to go but straight into the anchor store at the end, dodging displays as he kept sniffing. The scent was getting stronger – he must be almost there!\n\nWearily, the other dogs approached the anchor store as well, just in time to see Bub running headlong into it. They summoned the last of their energy, marveling at Bub’s stamina, and ran through the store themselves.\n\n“Well, I think we’ve lost him,” Cliffford huffed to his friends. “I don’t see him anywhere, and we’re here at the exit.”\n\n“Wait!” Cassy shouted. “Isn’t that Bub outside?”\n\nThe dogs burst out the doors and into the cool air, and there was Bub, happily rolling around on the ground.\n\n“I found it, guys!!” Bub called, as he flopped on his back once more and wriggled in the source of his scent: pine needles, fallen from hundreds of freshly cut Christmas trees, filling up a large portion of the parking lot outside the store.\nThe other dogs agreed that Christmas trees did smell very, very good. Bub had not caused any damage, only a merry chase, so they were all quite relieved. They all meandered through the tree lot, sniffing and looking.\n\nCliffford decided that he wanted to get a tree for his doghouse, and picked the biggest, tallest tree he could find. It was taller than he was! The proprietor of the Christmas tree lot wrapped it up for him with rope, making two straps that Cliffford could wear like a backpack. Bub proudly jumped up on Cliffford’s head as they headed for home, with the other dogs close behind.\n\nEmma was waiting back at Cliffford’s doghouse, hoping to read him a story, and she gaped as the dogs entered the doghouse. She laughed when she saw what they had with them, and said, “I think we’re going to need more decorations than what we have in the garage!”\n\nIn the end, it took two trips back to the mall, a hundred strands of lights, and a thousand ornaments to decorate the huge tree. The dogs gave Bub the honor of plugging it in, and they all agreed it was the best Christmas tree ever.\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/provision.coffee": {
      "path": "stories/provision.coffee",
      "content": "module.exports = \"\"\"\nOne hundred or so years from now, when I\ndie, my descendants come across this\nrich text file while going through the\ndrawers and the suitcases in my husband\nand I's house under the pretense of\ncleaning. They will try to understand\nwho we were and if we ever were more\nthan just parents. They will have\nproblems with technology that has yet to\nbe invented; they will have kids and\nlovers that I will never meet.\n\nMy husband will die twenty or so years\nbefore me. He will fall asleep at Sam's\nClub and refuse to wake up. A\nbadly-shaken mid-level Sam's Club\nfranchise manager with kind eyes and a\npolo T-shirt and exactly one earring\nwill knock on my door and deliver the\nnews. I will feel weak and, 18 hours\nlater, I will cry.\n\nI want you to know how ordinary I was. I\nwanted to be one person and then I ended\nup being someone else. Cumulatively I\nthought I had serious fantasies about\nmarrying three different people and,\nafter college, I ended up marrying the\nsecond. I was part of a dozen thousand\nwho fled to Canada during the dark\nyears. My grocer patiently taught me how\nto say 100 words in a French-Canadian\naccent and gave me the courage to eat\nugly vegetables. I could have traveled\nmore and been happy. I could have not\ntraveled more and been happy.\n\nThe worst part about traveling is all\nthe advertisements for foreign brands.\nWalking home at night under the\nspotlights of billboards with which you\ncannot empathize is a piercing kind of\nloneliness. The best part about\ntraveling is meeting all the other\nexpats in your city, who each is tacitly\na member of a busy and tired club.\n\nMy parents were Armenian mathematicians.\nThey left their country, which gave me\nthe courage to leave mine. They were\nconstantly worried about me and, to\ndistract themselves, they bought and\nflipped real estate. The first time you\nbuy a house it seems impossible that\neach room will fill with the right\nfurniture and the each wall will have\nthe right artwork. The second time is\ntwice as easy; and the third is twice\nthat. They met one hundred or so\ndifferent people that way, which I think\nsomehow made my relationship with them\nbetter or at least easier. Toward the\nend they will play gin with their\nneighbors in the morning and watch\nArmenian television in the afternoon, on\na small satellite modem that only\nArmenians know where to buy. They forgot\nEnglish first, then walking, then\nbreathing. Acting on this information, I\nwill try to die much faster.\n\nThe early 2010s will be remembered\nfondly as a simpler time, and\nadditionally I want to add they were my\nfavorite years. The late 2040s were good\ntoo, as were the 2060s. It will become\ndifficult to separate the objective\nquality of a time period from how much\nof a burden my body becomes. Every year\nI will buy clothes that looked like all\nthe clothes I owned fifteen years ago\nuntil, one day, I throw everything out\nthat isn't white and blue. I will die in\na white blouse and blue shorts. In death\nI will stop looking cute and start\nlooking serene.\n\nThough I know some facts about the\nfuture I have a great deal of questions.\nWhat are the food trends now? Are there\nany new bands that sound like the old\nbands I liked? Do radiators still break\nduring the coldest week?\n\nMy husband and I ran into each other in\nthree different cities. The first two\ntimes we recognized in each other an\nunderstanding that the timing was off.\nThe third time we fucked in a friend's\ncloset, groping each other like we were\nyounger, beneath layers of woolen duvets\nthat we by accident pulled down. It\nseemed tawdry and sticky at the time and\nnow it's just a sentence.\n\nInto our lives we carved out space for\neach other. We put up load-bearing\nbeams. We added good thick curtains and\na little OLED display that read the\namount of humidity in the air. We agreed\nto never make the other person sleep on\nthe couch, as we wanted ours to be\nfilled with the flatulence of our\nfriends. We threw the best parties. We\nwere an unstoppable hosting machine. We\nfigured out that a party becomes the\nmemory of a party. It happens one or two\ndays after the party, when the\nconversation and the discoveries curdle\ninto something distant and bittersweet.\n\nThe city will build a subway station\nnear us in 2031 after years of private\nfunding into subterranean\ninfrastructure. The money will come from\ntech moguls looking to survive zombies\nand/or climate change, but a subway\nstation is a subway station. One late\nnight, as we step off the train on our\nway home, we will walk past a woman\nwearing a bright striped parka. I will\nturn my head to get a second look and\nshe will not be there. I will crook my\nhead to see behind the poles until my\nneck hurts, and still I will see no one.\nI will turn to my husband, who sees my\nface, and we will walk home with his\nhead lying on my shoulder and his hand\nlying on my chest so that my\ninexplicably racing heartbeat will bang\nand shudder against his hand like a\nhurricane's wind against the shutters of\na house where nobody has ever lived.\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "stories/residue.coffee": {
      "path": "stories/residue.coffee",
      "content": "module.exports = \"\"\"\n\\u200b                                 RESIDUE\n                                 =======\n\nJules, my friend, used to take her new\ncar to Viretta Park. After a workday\nfilled with tickets and meetings, she\nsometimes drove the five miles to this\none-block wide, one-block tall park at\nthe northeast coast of the city where\npeople prospered. There, tourists via\nUbers and Lyfts came to see the Kurt\nCobain bench. But Jules would arrive at\nthe park and drive past. She would not\nstop. She would not get out. You cannot\nsee the bench from the road. It was\nusually dark after work. She told no one\nabout these trips until years later.\n\nJules, our protagonist, (as far as she\ncould figure) had no conscious logic for\nher actions. Without it the story\nrefused to hang together. It was a\nsequence of events united by space and\ntime but lacking guts hearts or brains.\nIt was a propulsion without a\npropellant. It defied narrative\nstructure and, without it, lacked\nrhythm. Jules, being a capable\nself-aware adult, knew she was acting\nout of an impulse but it seemed to her\nthat the situation warranted impulse.\nAnd, at that time and at the time this\nwas written, gas was cheap. I can safely\nsay also that she was not sad; she was\nnot one of those people who indulged in\nthe habit of moping about events beyond\ntheir control. Some people are just\nstrong this way.\n\nIn my presence Jules narrated the story\nwith the blank point of view of an\nomniscient witness. There was a lull in\nthe conversation, this story was told,\nand then we moved on. She wore a thin\njacket and a wry frown and we were high,\nmore high than usual. I, after giving it\nsome consideration, had a grocery list\nof questions. Why Kurt Cobain; why\ndidn't you tell me earlier; and did you\ndo it to feel an impossible, cosmic\nconnection to something bigger than\nyourself, a feeling for which I cannot\ndo justice but can tell you that, for\nme, is close to the sensation of an\negg's cracking against the chest\ncavity's outer wall. But from looking at\nher I knew then, just as she had always\nknown, it was not as if there were\nanswers and she were ignorant of them.\nThere just were no answers. At the time\nthese events I am writing about took\nplace, she was stuck in a temporary city\nat a temporary time of her life. In my\ncountry, where you work for years and\nyears in search of permanent residence\nstatus and where adults values\nfriendship but few pursue them, it seems\nharder than other places to let out\nthese prickly stories. I imagine people\nall around me have them, though – yarn\nwound and knotted by fingers\nabsentmindedly rubbing the threads\ntogether.\n\nAfter eighteen months, Jules packed up\nall her furniture and moved away. She\ndrove all the way through America.\n\"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "style.styl": {
      "path": "style.styl",
      "content": "body\n  color: rgba(0, 0, 0, 0.87)\n  overflow: hidden\n\nh1\n  line-height: 1.25em\n  margin: 0\n\nul\n  list-style-type: square\n  padding-left: 1.25em\n\nuser-select(s)\n  user-select: s\n  -moz-user-select: s\n  -webkit-user-select: s\n  -ms-user-select: s\n\ncomments, comment\n  display: block\n  padding: 1em\n\ncomment\n  border: 1px solid black\n  margin-bottom: 1em\n\n  &:last-child\n    margin-bottom: 0\n\n  > .author\n    color: gray\n    font-size: 0.75em\n    text-align: right\n\n    &::before\n      content: \"-\"\n\nmenu\n  font-size: 1rem\n\nbody.drag-active iframe\n  pointer-events: none\n\nbody > button.home\n  background-color: rgba(255, 255, 255, 0.5)\n  bottom: 0\n  color: rgba(0, 0, 0, 0.87)\n  font-size: 2rem\n  left: 0\n  padding-right: 0.3em\n  position: absolute\n  transition-duration: 0.125s\n  transition-property: background-color, color\n  z-index: 1\n\n  &:hover\n    background-color: rgba(255, 255, 255, 0.75)\n\n  &:active\n    color: rgba(255, 255, 255, 1.0)\n\nexplorer\n  display: block\n  height: 100%\n  padding: 0.5em\n  user-select: none\n  width: 100%\n  z-index: 1\n\n  body > &\n    background-image: url(https://i.imgur.com/hKOGoex.jpg)\n    background-size: cover\n\n  > file, > folder\n    display: inline-block\n    padding: 0.5em\n\n    > icon\n      display: block\n      height: 32px\n      margin: auto\n      width: 32px\n\n  > file > icon\n    background-image: url(\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3d3dwAAAAj///////////////cAAAAI///////////////3AAAACP///////3d///d39wAAAAj/zMzM//mZ//+Zn/cAAAAI////////l///+X/3AAAACP/MzMzM//l3d3l/9wAAAAj/////////mZmZf/cAAAAI/8zMzMzM//l/+X/3AAAACP//////////l/l/9wAAAAj/zMzMzMzM//l5f/cAAAAI////////////mX/3AAAACP/MzMzMzMzM//n/9wAAAAj///////////////cAAAAI/8zMzMzMzMzMzP/3AAAACP//////////////9wAAAAj/zMzMzMzMzMzM//cAAAAI///////////////3AAAACP8AAAAA/8zMzMz/9wAAAAj/iZD/8P////////cAAAAI/4AAAAD/zMzMzP/3AAAACP+P8Luw////////9wAAAAj/gAC7sP/MzMzM//cAAAAI/4/wu7D////////3AAAACP+P8Luw/////4AAAAAAAAj/j/AAAP////+P94AAAAAI/4/wzMD/////j3gAAAAACP+IiIiA/////4eAAAAAAAj///////////+IAAAAAAAI////////////gAAAAAAACIiIiIiIiIiIiIAAAAAA4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAP4AAAH+AAAD/gAAB/4AAA/+AAAf8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAACHd3d3d3cAAI//////9wAAj8z5//n3AACP//+ZmfcAAI/MzPn59wAAj////5n3AACPzMzM+fcAAI//////9wAAjwAPzMz3AACPmY////cAAI/Pj8zM9wAAj8+P//AAAACPiI//9/gAAI/////3gAAAiIiIiIgAAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIAHAACADwAAgB8AAA==\")\n\n  > file[type=\"application/briefcase\"] > icon\n    background-image: url(\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACIiIiIiIiIiIiIiIiIiIAAj3d3d3d3d3d3d3d3d3eIAI93d39/f39/f39/f393iICPd3d4eHh4eHh4eHh4d4iAj3d3d3d3d3d3d3d3d3eIgI93d3d//////////3d3iICPd3d/8AAAAAAAAAD/d4iAj3mXeIAAAAAAAAAAiHeIgI95l3iAAAAAAAAAAIh3iICPd3d3eIiIiIiIiIh3d4iAj3d3d3d3d3d3d3d3d3eIgI//////////////////iIAId3d3d3d3d3d3d3d3d3iAAId3d3d3d3d3d3d3d3d3gAAIiIiIiIiIiIiIiIiIiIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////gAAABwAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAADAAAAA4AAAAf////////////////////////////////////////////////////////////////////8oAAAAEAAAACAAAAABAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI+IiIiIiIgAj3d3d3d3eICPd3////d4gI938AAAD3iAj5eAAAAIeICPd3d3d3d4gI////////iACHd3d3d3d4AAiIiIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP//AACAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAADAAQAA//8AAP//AAD//wAA//8AAA==\")\n\n  > file[type^=\"text/\"] > icon\n    background-image: url(\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3dwcAAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA/////////3BwAAAI//////////////9wcAAACP8AAAD/////////cHAAAAj//////////////3BwAAAI//////////////9wcAAACP8AAAAAAAAAAAD/cHAAAAj//////////////3BwAAAI/wAAAAAAAAAAAP9wcAAACP//////////////cHAAAAj/AAAAAAAAAAAA/3BwAAAI//////////////9wcAAACP8AAAAAAAAAAAD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP8AAAD/////////cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA/////////3BwAAAI//////////////9wcAAACP8AAAD////w8AD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAjw/w/w/w/w/w/w/4BwAAAI8P8P8P8P8P8P8P+AcAAAAI+I+I+I+I+I+I+I+AAAAAAAAAAAAAAAAAAAAAAAAA8AAAH+AAAA/AAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAH4AAAD/JJJL8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAh3d3d3d3AACP//////cAAI//////9wAAj/AAAA/3AACP//////cAAI/wAAAP9wAAj//////3AACP8AAAD/cAAI//////9wAAj/AA8A/3AACP//////cAAI//////9wAAjw8PDw8PAAAA+Pj4+PAAAAAAAAAAAAAAgA8AAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAACADwAA1V8AAA==\")\n\n  > file[type=\"application/javascript\"] > icon\n    background-image: url(\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3dwcAAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA////AAD//3BwAAAI////////AwsDAP9wcAAACP8AAAD//zu7uzD/cHAAAAj///////M7MDsAD3BwAAAI///////zuwgLsw9wcAAACP8AAAAAAzswOwAPcHAAAAj///////87u7sw/3BwAAAI/wAAAAAAMwsDAP9wcAAACP////////8zM///cHAAAAj/AAAAAAAAAAAA/3BwAAAI//////////////9wcAAACP8AAAAAAAAAAAD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP8AAAD/////////cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA/////////3BwAAAI//////////////9wcAAACP8AAAD////w8AD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAjw/w/w/w/w/w/w/4BwAAAI8P8P8P8P8P8P8P+AcAAAAI+I+I+I+I+I+I+I+AAAAAAAAAAAAAAAAAAAAAAAAA8AAAH+AAAA/AAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAH4AAAD/JJJL8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAACHd3d3d3cAAI//////9wAAj///Aw/3AACP8Ac7MPcAAI//87Cz9wAAj/AHOzD3AACP//9zf/cAAI/wAAAP9wAAj//////3AACP8ADwD/cAAI//////9wAAj//////3AACPDw8PDw8AAAD4+Pj48AAAAAAAAAAAAAwAcAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAADABwAA6q8AAA==\")\n\n  > file[path$=\"💾\"] > icon\n    background-image: url(\"http://www.myiconfinder.com/uploads/iconsets/256-256-517c80793c96fa23c342ae1a5560ddf6.png\")\n    background-size: cover\n    image-rendering: pixelated\n\n  > folder > icon\n    background-image: url(\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDMzMzMzMzMzMzMzMzMzMwj7e3t7e3t7e3t7e3t7e3MI97e3t7e3t7e3t7e3t7ezCPt7e3t7e3t7e3t7e3t7cwj3t7e3t7e3t7e3t7e3t7MI+3t7e3t7e3t7e3t7e3tzCPe3t7e3t7e3t7e3t7e3swj7e3t7e3t7e3t7e3t7e3MI97e3t7e3t7e3t7e3t7ezCPt7e3t7e3t7e3t7e3t7cwj3t7e3t7e3t7e3t7e3t7MI+3t7e3t7e3t7e3t7e3tzCPe3t7e3t7e3t7e3t7e3swj7e3t7e3t7e3t7e3t7e3MI97e3t7e3t7e3t7e3t7ezCPt7e3t7e3t7e3t7e3t7cwj3t7e3t7e3t7e3t7e3t7MI+3t7e3t7e3t7e3t7e3tzCPe3t7e3t7e3t7e3t7e3swj7e3t7e3t7e3t7e3t7e3MI///////////////////wCHd3d3d3d3d4iIiIiIiIgACPt7e3t7e3gAAAAAAAAAAACPt7e3t7eAAAAAAAAAAAAACP/////4AAAAAAAAAAAAAACIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////gAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAP//wAH//+AD///wB/////////////8oAAAAEAAAACAAAAABAAQAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiIiIiIgAj7e3t7e3uACPe3t7e3t4AI+3t7e3t7gAj3t7e3t7eACPt7e3t7e4AI97e3t7e3gAj7e3t7e3uACP///////4AIe3t7eIiIgACHt7eAAAAAAAiIiAAAAAAAAAAAAAAAAA//8AAP//AACAAQCgAAHOAAABzgAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAMAAID/AADB/wAA//8AAA==\")\n\n#modal > container\n  padding: 1em\n\nchateau\n  width: 100%\n  height: 100%\n  position: relative\n\n  > word-area\n    display: block\n    pointer-events: none\n    position: absolute\n    width: 100%\n    height: 100%\n\n    > words\n      border: 1px solid black\n      border-radius: 4px\n      background-color: white\n      padding: 0.5em\n      position: absolute\n      display: inline-block\n\n  > canvas\n    display: block\n    width: 100%\n    height: 100%\n    position: absolute\n\n  > form\n    position: absolute\n    bottom: 0\n\n  window > viewport > &\n    margin: initial\n\nwindow > viewport > audio\n  width: 100%\n\n@keyframes display-achievement\n  0%\n    bottom: -128px\n  5%\n    bottom: 2em\n  95%\n    bottom: 2em\n  100%\n    bottom: -128px\n\n@keyframes slide-left\n  0%\n    left: 100%\n  25%\n    left: 0\n  50%\n    left: -100%\n  100%\n    left: -100%\n\nachievement\n  color: white\n  background-color: blue\n  border-radius: 32px\n  bottom: -128px\n  box-shadow: 2px 2px 10px black\n  display: block\n  height: 64px\n  left: 0\n  margin: auto\n  overflow: hidden\n  padding: 8px\n  position: absolute\n  right: 0\n  width: 300px\n  z-index: 9000\n\n  &:after\n    animation: slide-left 3s linear 0.75s infinite\n    content: \"\"\n    background: linear-gradient(\n      50deg,\n      rgba(255, 255, 255, 0) 0%,\n      rgba(255, 255, 255, 0) 40%,\n      rgba(255, 255, 255, 0.95) 50%,\n      rgba(255, 255, 255, 0) 75%,\n      rgba(255, 255, 255, 0) 100%\n    )\n    height: 100%\n    position: absolute\n    top: 0\n    left: 100%\n    width: 100%\n\n  &.display\n    animation: display-achievement 6s\n\n  > h2\n    font-size: 1.25em\n    margin: 0\n\n  > p\n    margin-top: 8px\n    margin-bottom: 8px\n\n  > icon\n    background-color: white\n    border-radius: 32px\n    color: blue\n    display: inline-block\n    float: left\n    font-size: 35px\n    font-family: \"Apple Color Emoji\",\"Segoe UI Emoji\",\"NotoColorEmoji\",\"Segoe UI Symbol\",\"Android Emoji\",\"EmojiSymbols\"\n    height: 48px\n    line-height: 48px\n    margin-right: 8px\n    text-align: center\n    width: 48px\n\nachievement-badges\n  display: block\n\nachievement-progress\n  display: block\n\n  > h2\n    margin-bottom: 4px\n\nachievement-badge\n  background-color: white\n  border: 1px solid gray\n  color: gray\n  display: inline-block\n  font-size: 35px\n  font-family: \"Apple Color Emoji\",\"Segoe UI Emoji\",\"NotoColorEmoji\",\"Segoe UI Symbol\",\"Android Emoji\",\"EmojiSymbols\"\n  height: 48px\n  line-height: 48px\n  margin-right: 8px\n  margin-top: 8px\n  text-align: center\n  width: 48px\n\n  &.achieved\n    border: 1px solid blue\n    color: blue\n\nversion, site-url\n  color: white\n  display: block\n  font-size: 20px\n  font-weight: bold\n  pointer-events: none\n  position: absolute\n  right: 1rem\n  text-shadow: 2px 2px 4px black\n  z-index: 1\n\nversion\n  bottom: 1rem\n\nsite-url\n  bottom: 3rem\n",
      "mode": "100644",
      "type": "blob"
    },
    "system.coffee": {
      "path": "system.coffee",
      "content": "{endsWith, fileSeparator, normalizePath, readTree} = require \"./util\"\n\n# DexieDB Containing our FS\nDexieFSDB = (dbName='fs') ->\n  db = new Dexie dbName\n\n  db.version(1).stores\n  \tfiles: 'path, blob, size, type, createdAt, updatedAt'\n\n  return db\n\nDexieFS = require \"./lib/dexie-fs\"\nMountFS = require \"./lib/mount-fs\"\n\nuniq = (array) ->\n  Array.from new Set array\n\nAjax = require \"ajax\"\nModel = require \"model\"\nAchievement = require \"./system/achievement\"\nAssociations = require \"./system/associations\"\nSystemModule = require \"./system/module\"\nTemplate = require \"./system/template\"\nUI = require \"ui\"\n\nmodule.exports = (dbName='zine-os') ->\n  self = Model()\n\n  fs = MountFS()\n  fs.mount \"/\", DexieFS(DexieFSDB(dbName))\n\n  self.include(Achievement, Associations, SystemModule, Template)\n\n  {title} = require \"./pixie\"\n  [..., version] = title.split('-')\n\n  self.extend\n    ajax: Ajax()\n    fs: fs\n\n    version: -> version\n\n    require: require\n    stylus: require \"./lib/stylus.min\"\n\n    moveFile: (oldPath, newPath) ->\n      oldPath = normalizePath oldPath\n      newPath = normalizePath newPath\n\n      return Promise.resolve() if oldPath is newPath\n\n      self.copyFile(oldPath, newPath)\n      .then ->\n        self.deleteFile(oldPath)\n\n    copyFile: (oldPath, newPath) ->\n      return Promise.resolve() if oldPath is newPath\n\n      self.readFile(oldPath)\n      .then (blob) ->\n        self.writeFile(newPath, blob)\n\n    moveFileSelection: (selectionData, destinationPath) ->\n      Promise.resolve()\n      .then ->\n        {sourcePath, files} = selectionData\n        if sourcePath is destinationPath\n          return\n        else\n          Promise.all files.map ({relativePath}) ->\n            if relativePath.match(/\\/$/)\n              # Folder\n              self.readTree(\"#{sourcePath}#{relativePath}\")\n              .then (files) ->\n                Promise.all files.map (file) ->\n                  targetPath = file.path.replace(sourcePath, destinationPath)\n                  self.moveFile(file.path, targetPath)\n            else\n              self.moveFile(\"#{sourcePath}#{relativePath}\", \"#{destinationPath}#{relativePath}\")\n\n    readFile: (path, userEvent) ->\n      if userEvent\n        self.Achievement.unlock \"Load a file\"\n\n      path = normalizePath \"/#{path}\"\n      fs.read(path)\n\n    readTree: (directoryPath) ->\n      readTree(fs, directoryPath)\n\n    writeFile: (path, blob, userEvent) ->\n      if userEvent\n        self.Achievement.unlock \"Save a file\"\n\n      path = normalizePath \"/#{path}\"\n      fs.write path, blob\n\n    deleteFile: (path) ->\n      path = normalizePath \"/#{path}\"\n      fs.delete(path)\n\n    updateFile: (path, changes) ->\n      path = normalizePath \"/#{path}\"\n      fs.update(path, changes)\n\n    urlForPath: (path) ->\n      fs.read(path)\n      .then URL.createObjectURL\n\n    launchIssue: (date) ->\n      require(\"./issues/#{date}\")()\n\n    # TODO: Move this into some kind of system utils\n    installModulePrompt: ->\n      UI.Modal.prompt(\"url\", \"https://danielx.net/editor/master.json\")\n      .then (url) ->\n        throw new Error \"No url given\" unless url\n\n        baseName = url.replace(/^https:\\/\\/(.*)/, \"$1\")\n        .replace(/(\\.json)?$/, \"💾\")\n\n        pathPrompt = UI.Modal.prompt \"path\", \"/lib/#{baseName}\"\n        .then (path) ->\n          throw new Error \"No path given\" unless path\n          path\n\n        blobRequest = fetch url\n        .then (result) ->\n          result.blob()\n\n        Promise.all([blobRequest, pathPrompt])\n        .then ([path, blob]) ->\n          self.writeFile(path, blob)\n\n    installModule: (url, path) ->\n      path ?= url.replace(/^https:\\/\\/(.*)/, \"/lib/$1\")\n      .replace(/(\\.json)?$/, \"💾\")\n\n      fetch url\n      .then (result) ->\n        result.blob()\n      .then (blob) ->\n        self.writeFile(path, blob)\n\n    # NOTE: These are experimental commands to run code\n    execJS: (path) ->\n      self.readFile(path)\n      .then (file) ->\n        file.readAsText()\n      .then (programText) ->\n        Function(programText)()\n\n    Observable: UI.Observable\n    UI: UI\n\n    dumpModules: ->\n      src = PACKAGE.source\n      Object.keys(src).forEach (path) ->\n        file = src[path]\n        blob = new Blob [file.content]\n        self.writeFile(\"System/#{path}\", blob)\n\n    dumpPackage: ->\n      self.writeFile(\"System 💾\", JSON.toBlob(PACKAGE))\n\n    _appData: null\n\n    launchAppByAppData: (datum, path) ->\n      {name, icon, width, height, src} = datum\n\n      app = self.iframeApp\n        title: name\n        emojiIcon: icon\n        width: width\n        height: height\n        src: src\n      \n      if path\n        self.readFile path\n        .then (blob) ->\n          app.loadFile(blob, path)\n\n      self.attachApplication app\n\n    launchAppByName: (name, path) ->\n      [datum] = self._appData.filter (datum) ->\n        datum.name is name\n\n      if datum\n        self.launchAppByAppData(datum, path)\n\n    initAppSettings: ->\n      self.readFile(\"System/apps.json\")\n      .then (blob) ->\n        if blob\n          blob.readAsJSON()\n        else\n          []\n      .then (data) ->\n        self._appData = data\n\n        data.forEach (datum) ->\n          self.installAppHandler(datum)\n\n          if datum.launchAtStartup\n            launchAppByAppData(datum)\n\n    removeApp: (name, noPersist) ->\n      self._appData = (self._appData or []).filter (datum) ->\n        if datum.name != name\n          true\n        else\n          # Remove handler\n          self.removeHandler(datum.handler)\n          return false\n\n      self.writeFile \"System/apps.json\", JSON.toBlob(self._appData) unless noPersist\n\n    installApp: (appData) ->\n      console.log \"install\", appData\n      # Only one app per name\n      self.removeApp(appData.name, true)\n\n      self._appData = self._appData.concat [appData]\n\n      self.installAppHandler(appData)\n\n      self.writeFile \"System/apps.json\", JSON.toBlob(self._appData)\n\n    installAppHandler: (datum) ->\n      {name, associations} = datum\n\n      associations = [].concat(associations or [])\n\n      datum.handler =\n        name: name\n        filter: ({path}) ->\n          associations.some (association) ->\n            endsWith path, association\n        fn: (file) ->\n          self.launchAppByName name, file?.path\n\n      self.registerHandler datum.handler\n\n\n  invokeBefore UI.Modal, \"hide\", ->\n    self.Achievement.unlock \"Dismiss modal\"\n\n  return self\n\ninvokeBefore = (receiver, method, fn) ->\n  oldFn = receiver[method]\n\n  receiver[method] = ->\n    fn()\n    oldFn.apply(receiver, arguments)\n",
      "mode": "100644",
      "type": "blob"
    },
    "system/achievement.coffee": {
      "path": "system/achievement.coffee",
      "content": "Achievement = require \"../lib/achievement\"\n\n{Observable} = UI = require \"ui\"\n\n{emptyElement} = require \"../util\"\n\n# TODO: Track unlocks, save/restore achievements\n# TODO: Only display once\n# TODO: View achievement progress grouped by area\n\nachievementData = [{\n  text: \"Issue 1\"\n  icon: \"📰\"\n  group: \"Issue 1\"\n  description: \"View Issue 1\"\n}, {\n  text: \"Cover-2-cover\"\n  icon: \"📗\"\n  group: \"Issue 1\"\n  description: \"Read the entire issue\"\n}, {\n  text: \"No rush\"\n  icon: \"⏳\"\n  group: \"Issue 1\"\n  description: \"Patience is a virtue\"\n}, {\n  text: \"Issue 2\"\n  icon: \"📰\"\n  group: \"Issue 2\"\n  description: \"View Issue 2\"\n}, {\n  text: \"Lol wut\"\n  icon: \"😂\"\n  group: \"Issue 2\"\n  description: \"Did you know Windows Vista had a magazine?\"\n}, {\n  text: \"Cover-2-cover 2: 2 cover 2 furious\"\n  icon: \"📗\"\n  group: \"Issue 2\"\n  description: \"Read the entire issue\"\n}, {\n  text: \"Feeling the frog\"\n  icon: \"🐸\"\n  group: \"Issue 2\"\n  description: \"Visit frogfeels.com\"\n}, {\n  text: \"The dungeon is in our heart\"\n  icon: \"😭\"\n  group: \"Issue 2\"\n  description: \"Played dungeon of sadness\"\n}, {\n  text: \"Issue 3\"\n  icon: \"📰\"\n  group: \"Issue 3\"\n  description: \"View Issue 3\"\n}, {\n  text: \"Cover-2-cover 3: Tokyo Drift\"\n  icon: \"📗\"\n  group: \"Issue 3\"\n  description: \"Read the entire issue\"\n}, {\n  text: \"Blue light special\"\n  icon: \"🈹\"\n  group: \"Issue 3\"\n  description: \"Read 'Blue Light Special'\"\n}, {\n  text: \"Issue 4\"\n  icon: \"📰\"\n  group: \"Issue 4\"\n  description: \"View Issue 4\"\n}, {\n  text: \"Cover-2-cover 4: Fast & Furious\"\n  icon: \"📗\"\n  group: \"Issue 4\"\n  description: \"Read the entire issue\"\n}, {\n  text: \"Izzy\"\n  icon: \"🈹\"\n  group: \"Issue 4\"\n  description: \"Read 'Izzy'\"\n}, {\n  text: \"Residue\"\n  icon: \"🈹\"\n  group: \"Issue 4\"\n  description: \"Read 'Residue'\"\n}, {\n  text: \"Issue 5\"\n  icon: \"📰\"\n  group: \"Issue 5\"\n  description: \"View Issue 5\"\n}, {\n  text: \"Issue 6\"\n  icon: \"🐝\"\n  group: \"Issue 6\"\n  description: \"View Issue 6\"\n}, {\n  text: \"Bee afraid\"\n  icon: \"🐝\"\n  group: \"Issue 6\"\n  description: \"Learn the truth about 'Bee Movie'\"\n}, {\n  text: \"Tree story\"\n  icon: \"🐝\"\n  group: \"Issue 6\"\n  description: \"Read Tree\"\n}, { # Apps\n  text: \"Notepad.exe\"\n  icon: \"📝\"\n  group: \"App\"\n  description: \"Launch a text editor\"\n}, {\n  text: \"Pump up the jam\"\n  icon: \"🎶\"\n  group: \"App\"\n  description: \"Launch audio application\"\n}, {\n  text: \"Microsoft Access 97\"\n  icon: \"🔞\"\n  group: \"App\"\n  description: \"Launch a spreadsheet application\"\n}, {\n  text: \"Look at that\"\n  icon: \"🖼️\"\n  group: \"App\"\n  description: \"Open the image viewer\"\n}, {\n  text: \"Pixel perfect\"\n  icon: \"◼️️\"\n  group: \"App\"\n  description: \"Open the pixel editor\"\n}, {\n  text: \"Check yo' self\"\n  icon: \"😉\"\n  group: \"App\"\n  description: \"Check your achievement status\"\n}, {\n  text: \"Oh no, my files!\"\n  icon: \"💼\"\n  group: \"App\"\n  description: \"Opened 'My Briefcase'\"\n}, { # OS\n  text: \"Save a file\"\n  icon: \"💾\"\n  group: \"OS\"\n  description: \"Write to the file system\"\n}, {\n  text: \"Load a file\"\n  icon: \"💽\"\n  group: \"OS\"\n  description: \"Read from the file system\"\n}, {\n  text: \"Execute code\"\n  icon: \"🖥️\"\n  group: \"OS\"\n  description: \"Some people like to live dangerously\"\n}, {\n  text: \"Dismiss modal\"\n  icon: \"💃\"\n  group: \"OS\"\n  description: \"Dismiss a modal without even reading it\"\n}, {\n  text: \"I AM ERROR\"\n  icon: \"🐛\"\n  group: \"OS\"\n  description: \"Encountered a JavaScript error\"\n}, {\n  text: \"Shut Down\"\n  icon: \"🔌\"\n  group: \"OS\"\n  description: \"ZineOS cannot be stopped\"\n}, { # Social\n  text: \"Do you 'like' like me?\"\n  icon: \"💕\"\n  group: \"Social\"\n  description: \"Have fine taste\"\n}, {\n  text: \"We value your input\"\n  icon: \"📩\"\n  group: \"Social\"\n  description: \"View feedback form\"\n}, { # Chateau\n  text: \"Enter the Chateau\"\n  icon: \"🏡\"\n  group: \"Chateau\"\n  description: \"Enter the Chateau\"\n}, {\n  text: \"Puttin' on the Ritz\"\n  icon: \"🐭\"\n  group: \"Chateau\"\n  description: \"Upload custom avatar\"\n}, {\n  text: \"Paint the town red\"\n  icon: \"🌆\"\n  group: \"Chateau\"\n  description: \"Upload a custom background\"\n}, {\n  text: \"Poutine on the Ritz\"\n  icon: \"🍘\"\n  group: \"Chateau\"\n  description: \"Put poutine on a Ritz cracker\"\n}, {\n  text: \"It's in the cloud\"\n  icon: \"☁️️\"\n  group: \"Chateau\"\n  description: \"Upload a file\"\n}, {\n  text: \"Rawr\"\n  icon: \"🐉\"\n  group: \"Contrasaurus\"\n  description: \"Played Contrasaurus\"\n}]\n\nrestore = ->\n  storedCheevos = []\n\n  try\n    storedCheevos = JSON.parse localStorage.cheevos\n\n  storedAchieved = {}\n  storedCheevos.forEach ({achieved, text}) ->\n    storedAchieved[text] = achieved\n\n  achievementData.forEach (cheevo) ->\n    {text} = cheevo\n\n    if storedAchieved[text]\n      cheevo.achieved = true\n\npersist = ->\n  localStorage.cheevos = JSON.stringify(achievementData)\n\nAchievementProgressPresenter = require \"../presenters/achievement-group-progress\"\n\ngroupBy = (xs, key) ->\n  xs.reduce (rv, x) ->\n    (rv[x[key]] ?= []).push(x)\n\n    rv\n  , {}\n\nmodule.exports = (I, self) ->\n  restore()\n\n  Object.assign self,\n    Achievement:\n      groupData: Observable {}\n      unlock: (name) ->\n        opts = achievementData.find ({text}) ->\n          text is name\n\n        if opts and !opts.achieved\n          opts.achieved = true\n\n          persist()\n          updateStatus()\n          Achievement.display opts\n      progressView: ->\n        content = document.createElement \"content\"\n\n        Observable ->\n          data = self.Achievement.groupData()\n\n          elements = Object.keys(data).map (group) ->\n            AchievementProgressPresenter\n              name: group\n              achievements: data[group]\n\n          emptyElement content\n          elements.forEach (element) ->\n            content.appendChild(element)\n\n        return content\n\n  updateStatus = ->\n    self.Achievement.groupData groupBy(achievementData, \"group\")\n  updateStatus()\n\n  return self\n",
      "mode": "100644",
      "type": "blob"
    },
    "system/associations.coffee": {
      "path": "system/associations.coffee",
      "content": "AppDrop = require \"../lib/app-drop\"\n\n# TODO: Move handlers out\nAudioBro = require \"../apps/audio-bro\"\nFilter = require \"../apps/filter\"\nNotepad = require \"../apps/notepad\"\nCodeEditor = require \"../apps/text-editor\"\nExplorer = require \"../apps/explorer\"\nSpreadsheet = require \"../apps/spreadsheet\"\nPixelEditor = require \"../apps/pixel\"\nMarkdown = require \"../apps/markdown\"\nDSad = require \"../apps/dungeon-of-sadness\"\nMyBriefcase = require \"../apps/my-briefcase\"\n\nPkgFS = require \"../lib/pkg-fs\"\n\n{extensionFor} = require \"../util\"\n\nopenWith = (App) ->\n  (file) ->\n    app = App()\n\n    if file\n      {path} = file\n      system.readFile path\n      .then (blob) ->\n        app.loadFile(blob, path)\n\n    system.attachApplication(app)\n\nmodule.exports = (I, self) ->\n  # Handlers use type and contents path info to do the right thing\n  # The first handler that matches is the default handler, the rest are available\n  # from context menu\n  handlers = [{\n    name: \"Markdown\" # TODO: This renders html now too, so may need a broader name\n    filter: (file) ->\n      file.path.match(/\\.md$/) or\n      file.path.match(/\\.html$/)\n    fn: openWith(Markdown) # TODO: This can be a pointer to a system package\n  }, {\n    name: \"Run\"\n    filter: (file) ->\n      file.type is \"application/javascript\" or\n      file.path.match(/\\.js$/) or\n      file.path.match(/\\.coffee$/)\n    fn: (file) ->\n      self.executeInIFrame(file.path)\n  }, {\n    name: \"Exec\"\n    filter: (file) ->\n      file.type is \"application/javascript\" or\n      file.path.match(/\\.js$/) or\n      file.path.match(/\\.coffee$/)\n    fn: (file) ->\n      self.execute(file.path)\n  }, {\n    name: \"Explore\"\n    filter: (file) ->\n      file.path.match(/💾$/) or\n      file.path.match(/\\.json$/)\n    fn: (file) ->\n      system.readFile(file.path)\n      .then (blob) ->\n        blob.readAsJSON()\n      .then (pkg) ->\n        mountPath = file.path + \"/\"\n        fs = PkgFS(pkg, file.path)\n        system.fs.mount mountPath, fs\n\n        # TODO: Can we make the explorer less specialized here?\n        element = Explorer\n          path: mountPath\n        windowView = system.UI.Window\n          title: mountPath\n          content: element\n          menuBar: null\n          width: 640\n          height: 480\n          iconEmoji: \"📂\"\n\n        document.body.appendChild windowView.element\n  }, {\n    name: \"Ace Editor\"\n    filter: (file) ->\n      file.path.match(/\\.coffee$/) or\n      file.path.match(/\\.cson$/) or\n      file.path.match(/\\.html$/) or\n      file.path.match(/\\.jadelet$/) or\n      file.path.match(/\\.js$/) or\n      file.path.match(/\\.json$/) or\n      file.path.match(/\\.md$/) or\n      file.path.match(/\\.styl$/)\n    fn: openWith(CodeEditor) # TODO: This can be a pointer to a system package\n  }, {\n    name: \"Run\"\n    filter: (file) ->\n      file.path.match(/💾$/)\n    fn: (file) ->\n      # TODO: Rename?\n      system.execPathWithFile file.path, null\n  }, {\n    name: \"Publish\"\n    filter: (file) ->\n      file.path.match(/💾$/)\n    fn: (file) ->\n      system.readFile file.path\n      .then (blob) ->\n        blob.readAsJSON()\n      .then (pkg) ->\n        system.UI.Modal.prompt \"Path\", \"/My Briefcase/public/somefolder\"\n        .then (path) ->\n          blob = new Blob [system.htmlForPackage(pkg)],\n            type: \"text/html; charset=utf-8\"\n          system.writeFile(path + \"/index.html\", blob)\n  }, {\n    name: \"Run Link\"\n    filter: (file) ->\n      file.path.match(/🔗$|\\.link$/)\n    fn: (file) ->\n      # TODO: Rename?\n      system.execPathWithFile file.path, null\n  }, {\n    name: \"Edit Link\"\n    filter: (file) ->\n      file.path.match(/🔗$|\\.link$/)\n    fn: openWith(CodeEditor)\n  }, {\n    name: \"Sys Exec\"\n    filter: (file) ->\n      return false # TODO: Enable with super mode :P\n      file.type is \"application/javascript\" or\n      file.path.match(/\\.js$/) or\n      file.path.match(/\\.coffee$/)\n    fn: (file) ->\n      self.execute(file.path)\n  }, {\n    name: \"Notepad\"\n    filter: (file) ->\n      file.type.match(/^text\\//) or\n      file.type.match(/^application\\/javascript/)\n    fn: openWith(Notepad)\n  }, {\n    name: \"Spreadsheet\"\n    filter: (file) ->\n      # TODO: This actually only handles JSON arrays\n      file.type.match(/^application\\/json/)\n    fn: openWith(Spreadsheet)\n  }, {\n    name: \"Image Viewer\"\n    filter: (file) ->\n      file.type.match /^image\\//\n    fn: openWith(Filter)\n  }, {\n    name: \"Pixel Editor\"\n    filter: (file) ->\n      file.type.match /^image\\//\n    fn: openWith(PixelEditor)\n  }, {\n    name: \"PDF Viewer\"\n    filter: (file) ->\n      file.path.match /\\.pdf$/\n    fn: (file) ->\n      file.blob.getURL()\n      .then (url) ->\n        app = system.iframeApp\n          src: url\n          title: file.path\n        system.attachApplication app\n  }, {\n    name: \"Audio Bro\"\n    filter: (file) ->\n      file.type.match /^audio\\//\n    fn: openWith(AudioBro)\n  }, {\n    name: \"dsad.exe\"\n    filter: (file) ->\n      file.path.match /dsad\\.exe$/\n    fn: ->\n      app = DSad()\n      system.attachApplication app\n  }, {\n    name: \"zine1.exe\"\n    filter: (file) ->\n      file.path.match /zine1\\.exe$/\n    fn: ->\n      require(\"../issues/2016-12\")()\n  }, {\n    name: \"zine2.exe\"\n    filter: (file) ->\n      file.path.match /zine2\\.exe$/\n    fn: ->\n      require(\"../issues/2017-02\")()\n  }, {\n    name: \"zine3.exe\"\n    filter: (file) ->\n      file.path.match /zine3\\.exe$/\n    fn: ->\n      require(\"../issues/2017-03\")()\n  }, {\n    name: \"zine4.exe\"\n    filter: (file) ->\n      file.path.match /zine4\\.exe$/\n    fn: ->\n      require(\"../issues/2017-04\")()\n  }, {\n    name: \"feedback.exe\"\n    filter: (file) ->\n      file.path.match /feedback\\.exe$/\n    fn: ->\n      require(\"../feedback\")()\n  }, {\n    name: \"My Briefcase\"\n    filter: ({path}) ->\n      path.match /My Briefcase$/\n    fn: ->\n      app = MyBriefcase()\n      system.attachApplication app\n  }]\n\n  # Open JSON arrays in spreadsheet\n  # Open text in notepad\n  handle = (file) ->\n    handler = handlers.find ({filter}) ->\n      filter(file)\n\n    if handler\n      handler.fn(file)\n    else\n      throw new Error \"No handler for files of type #{file.type}\"\n\n  mimes =\n    html: \"text/html\"\n    js: \"application/javascript\"\n    json: \"application/json\"\n    md: \"text/markdown\"\n\n  Object.assign self,\n    iframeApp: require \"../lib/iframe-app\"\n\n    # Open a file\n    # TODO: Pass arguments\n    # TODO: Drop files on an app to open them in that app\n    open: (file) ->\n      handle(file)\n\n    openPath: (path) ->\n      self.readFile path\n      .then self.open\n\n    # Return a list of all handlers that can be used for this file\n    openersFor: (file) ->\n      handlers.filter (handler) ->\n        handler.filter(file)\n\n    # Add a handler to the list of handlers, position zero is highest priority\n    # position -1 is lowest priority.\n    registerHandler: (handler, position=0) ->\n      handlers.splice(position, 0, handler)\n\n    removeHandler: (handler) ->\n      position = handlers.indexOf(handler)\n      if position >= 0\n        handlers.splice(position, 1)\n        return handler\n\n      return\n\n    handlers: ->\n      handlers.slice()\n\n    # The final step in launching an application in the OS\n    # This wires up event streams, drop events, adds the app to the list\n    # of running applications, and attaches the app's element to the DOM\n    attachApplication: (app, options={}) ->\n      # Bind Drop events\n      AppDrop(app)\n\n      # TODO: Bind to app event streams\n\n      # TODO: Add to list of apps\n\n      document.body.appendChild app.element\n\n    pathAsApp: (path) ->\n      if path.match(/💾$/)\n        system.readFile path\n        .then (blob) ->\n          blob.readAsJSON()\n        .then (pkg) ->\n          return ->\n            self.executePackageInIFrame(pkg)\n      else if path.match(/🔗$|\\.link$/)\n        system.readFile path\n        .then (blob) ->\n          blob.readAsText()\n        .then system.evalCSON\n        .then (data) ->\n          return ->\n            system.iframeApp data\n      else if path.match(/\\.js$|\\.coffee$/)\n        self.packageProgram(path)\n        .then (pkg) ->\n          return ->\n            self.executePackageInIFrame pkg\n      else\n        Promise.reject new Error \"Could not launch #{path}\"\n\n    execPathWithFile: (path, file) ->\n      self.pathAsApp(path)\n      .then (App) ->\n        openWith(App)(file)\n\n    mimeTypeFor: (path) ->\n      mimes[extensionFor(path)] or \"text/plain\"\n\n  return self\n",
      "mode": "100644",
      "type": "blob"
    },
    "system/module.coffee": {
      "path": "system/module.coffee",
      "content": "# Handles loading and launching files from the fs\n#\n# Depends on having self.readFile defined\n\nIFrameApp = require \"../lib/iframe-app\"\n\n{\n  absolutizePath\n  evalCSON\n  fileSeparator\n  normalizePath\n  isAbsolutePath\n  isRelativePath\n  htmlForPackage\n} = require \"../util\"\n\nJadelet = require \"../lib/jadelet.min\"\n\nmodule.exports = (I, self) ->\n  ###\n  Load a module from a file in the file system.\n\n  Additional properties such as a reference to the global object and some metadata\n  are exposed.\n\n  Returns a promise that is fulfilled when the module assigns its exports, or\n  rejected on error.\n\n  Caches modules so mutual includes don't get re-run per include root.\n\n  Circular includes will never reslove\n  # TODO: Fail early on circular includes, challenging because of async\n\n  # Currently can require\n  # js, coffee, jadelet, json, cson\n\n  # Requiring other file types returns a Blob\n\n  ###\n\n  findDependencies = (sourceProgram) ->\n    requireMatcher = /[^.]require\\(['\"]([^'\"]+)['\"]\\)/g\n    results = []\n    count = 0\n\n    loop\n      match = requireMatcher.exec sourceProgram\n\n      if match\n        results.push match[1]\n      else\n        break\n\n      # Circuit breaker for safety\n      count += 1\n      if count > 256\n        break\n\n    return results\n\n  # Wrap program in async include wrapper\n  # Replaces references to require('something') with local variables in an async wrapper function\n  rewriteRequires = (program) ->\n    id = 0\n    namePrefix = \"__req\"\n    requires = {}\n\n    # rewrite requires like `require('cool-module')` or `require('./relative-path')`\n    # don't rewrite one that belong to another object `something.require('somepath')`\n    # don't rewrite dynamic ones like `require(someVar)`\n    rewrittenProgram = program.replace /[^.]require\\(['\"]([^'\"]+)['\"]\\)/g, (match, key) ->\n      if requires[key]\n        tmpVar = requires[key]\n      else\n        tmpVar = \"#{namePrefix}#{id}\"\n        id += 1\n        requires[key] = tmpVar\n\n      return tmpVar\n\n    tmpVars = Object.keys(requires).map (name) ->\n      requires[name]\n\n    requirePaths = Object.keys(requires)\n    requirePaths = requirePaths\n\n    \"\"\"\n      return system.vivifyPrograms(#{JSON.stringify(requirePaths)})\n      .then(function(__reqResults) {\n      (function(#{tmpVars.join(', ')}){\n      #{rewrittenProgram}\n      }).apply(this, __reqResults);\n      });\n    \"\"\"\n\n  loadModule = (content, path, state) ->\n    new Promise (resolve, reject) ->\n      program = annotateSourceURL(rewriteRequires(content), path)\n      dirname = path.split(fileSeparator)[0...-1].join(fileSeparator) or fileSeparator\n\n      module =\n        path: dirname\n\n      # Use a defineProperty setter on module.exports to trigger when the module\n      # successfully exports because it can all be async madness.\n      exports = {}\n      Object.defineProperty module, \"exports\",\n        get: ->\n          exports\n        set: (newValue) ->\n          exports = newValue\n          # Trigger complete\n          resolve(module)\n\n      # Apply relative path wrapper for system.vivifyPrograms\n      localSystem = Object.assign {}, self,\n        vivifyPrograms: (moduleIdentifiers) ->\n          absoluteIdentifiers = moduleIdentifiers.map (identifier) ->\n            if isAbsolutePath(identifier)\n              absolutizePath \"/\", identifier\n            else if isRelativePath(identifier)\n              absolutizePath dirname, identifier\n            else\n              identifier\n\n          self.vivifyPrograms absoluteIdentifiers, state\n      # TODO: Also make working directory relative paths for readFile and writeFile\n\n      context =\n        system: localSystem\n        global: global\n        module: module\n        exports: module.exports\n        __filename: path\n        __dirname: dirname\n\n      args = Object.keys(context)\n      values = args.map (name) -> context[name]\n\n      Promise.resolve()\n      .then ->\n        Function(args..., program).apply(module, values)\n      .catch reject\n\n      # Scan for a module.exports to see if it is the kind of\n      # module that exports things vs just plain side effects code\n      # This can return false positives if it just matches the string and isn't\n      # really exporting, regex is not a parser, yolo, etc.\n      hasExports = program.match /module\\.exports/\n\n      # Just resolve next tick if we're not specifically exporting\n      # can be fun with race conditions, but just export your biz, yo!\n      if !hasExports\n        setTimeout ->\n          resolve(module)\n        , 0\n\n  Object.assign self,\n    autoboot: ->\n      self.fs.list \"/System/Boot/\"\n      .then (files) ->\n        bootablePaths = files.filter ({blob}) ->\n          blob?\n        .map ({path}) ->\n          path\n\n        self.vivifyPrograms(bootablePaths)\n\n    # A simpler, dumber, packager that reads a pixie.cson, then\n    # just packages every file recursively down in the directories\n    createPackageFromPixie: (pixiePath) ->\n      basePath = pixiePath.match(/^.*\\//)?[0] or \"\"\n      pkg =\n        distribution: {}\n\n      self.loadProgram(pixiePath).then (config) ->\n        pkg.config = config\n      .then ->\n        self.readTree(basePath)\n      .then (files) ->\n        Promise.all files.map ({path, blob}) ->\n          (if blob instanceof Blob\n            self.compileFile(blob)\n          else\n            self.readFile(path)\n            .then(self.compileFile)\n          )\n          .then (result) ->\n            [path, result]\n        .then (results) ->\n          results.forEach ([path, result]) ->\n            pkgPath = path.replace(basePath, \"\").replace(/\\.[^.]*$/, \"\")\n\n            if typeof result is \"string\"\n              pkg.distribution[pkgPath] =\n                content: result\n            else\n              console.warn \"Can't package files like #{path} yet\"\n\n          return pkg\n\n    # This is kind of the opposite approach of the vivifyPrograms, here we want\n    # to load everything statically and put it in a package that can be run by\n    # `require`.\n    packageProgram: (absolutePath, state={}) ->\n      state.cache = {}\n      state.pkg = {}\n\n      basePath = absolutePath.match(/^.*\\//)?[0] or \"\"\n      state.basePath = basePath\n\n      # Strip out base path and final suffix\n      # NOTE: .coffee.md type files won't like this\n      state.pkgPath = (path) ->\n        path.replace(state.basePath, \"\").replace(/\\.[^.]*$/, \"\")\n      pkgPath = state.pkgPath(absolutePath)\n\n      {pkg} = state\n      pkg.distribution ?= {}\n\n      unless state.loadConfigPromise\n        configPath = absolutizePath basePath, \"pixie.cson\"\n        state.loadConfigPromise = self.loadProgram(configPath).then (configSource) ->\n          module = {}\n          Function(\"module\", configSource)(module)\n          module.exports\n        .then (config) ->\n          entryPoint = config.entryPoint\n          (if entryPoint\n            path = absolutizePath(basePath, entryPoint)\n            self.loadProgramIntoPackage(path, state)\n          else\n            Promise.resolve()\n          ).then ->\n            debugger\n            pkg.remoteDependencies = config.remoteDependencies\n            pkg.config = config\n        .catch (e) ->\n          if e.message.match /File not found/i\n            pkg.config = {}\n          else\n            throw e\n\n      self.loadProgramIntoPackage(absolutePath, state)\n      .then ->\n        state.loadConfigPromise\n      .then ->\n        pkg.remoteDependencies = pkg.config.remoteDependencies\n        if pkg.config.entryPoint\n          pkg.entryPoint = pkg.config.entryPoint\n        else\n          pkg.entryPoint ?= pkgPath\n\n        return pkg\n\n    # Internal helper to load a program and its dependencies into the pkg\n    # in the state\n    # TODO: Loading deps like this doesn't work at all if require is used\n    # from browserified js sources :(\n    loadProgramIntoPackage: (absolutePath, state) ->\n      {basePath, pkg} = state\n      pkgPath = state.pkgPath(absolutePath)\n      relativeRoot = absolutePath.replace(/\\/[^/]*$/, \"\")\n\n      state.cache[absolutePath] ?= self.loadProgram(absolutePath)\n      .then (sourceProgram) ->\n        if typeof sourceProgram is \"string\"\n          # NOTE: Things will fail if we require ../../ above our\n          # initial directory.\n          # TODO: Detect and throw if requiring relative or absolute paths above\n          # or outside of our base path\n\n          # Add to package\n          pkg.distribution[pkgPath] =\n            content: sourceProgram\n\n          # Pull in dependencies\n          depPaths = findDependencies(sourceProgram)\n          Promise.all depPaths.map (depPath) ->\n            Promise.resolve().then ->\n              if isRelativePath depPath\n                path = absolutizePath(relativeRoot, depPath)\n                self.loadProgramIntoPackage path, state\n              else if isAbsolutePath depPath\n                throw new Error \"Absolute paths not supported yet\"\n              else\n                # package path\n                depPkg = PACKAGE.dependencies[depPath]\n                if depPkg\n                  pkg.dependencies ?= {}\n                  pkg.dependencies[depPath] = depPkg\n                else\n                  # TODO: Load from remote?\n                  throw new Error \"Package '#{depPath}' not found\"\n        else\n          throw new Error \"TODO: Can't package files like #{absolutePath} yet\"\n\n    # still experimenting with the API\n    # Async 'require' in the vein of require.js\n    # it's horrible but seems necessary\n\n    # This is an internal API and isn't recommended for general use\n    # The state determines an include root and should be the same for a single\n    # app or process\n    vivifyPrograms: (absolutePaths, state={}) ->\n      state.cache ?= {}\n\n      Promise.all absolutePaths.map (absolutePath) ->\n        state.cache[absolutePath] ?= self.loadProgram(absolutePath)\n        .then (sourceProgram) ->\n          # loadProgram returns an object in the case of JSON because it has no\n          # dependencies and doesn't need an require re-writing\n          # Having this special case lets us take a short cut without having to\n          # Parse/unparse json extra.\n          # This may be handy for other binary assets like images, etc. as well\n          if typeof sourceProgram is \"string\"\n            loadModule sourceProgram, absolutePath, state\n          else\n            exports: sourceProgram\n        .then (module) ->\n          module.exports\n\n    loadProgram: (path, basePath=\"/\") ->\n      self.readForRequire path, basePath\n      .then self.compileFile\n\n    compileFile: (file) ->\n      # system modules are loaded as functions/objects right now, so just return them\n      unless file instanceof Blob\n        return file\n\n      [compiler] = compilers.filter ({filter}) ->\n        filter file\n\n      if compiler\n        compiler.fn(file)\n      else\n        # Return the blob itself if we didn't find any compilers\n        return file\n\n    # May want to reconsider this name\n    loadModule: (args...) ->\n      self.Achievement.unlock \"Execute code\"\n      loadModule(args...)\n\n    # Execute in the context of the system itself\n    spawn: (args...) ->\n      loadModule(args...)\n      .then ({exports}) ->\n        if typeof exports is \"function\" and exports.length is 0\n          result = exports()\n\n          if result.element\n            document.body.appendChild result.element\n\n    execute: (absolutePath) ->\n      self.vivifyPrograms [absolutePath]\n      .then ([{exports}])->\n        if typeof exports is \"function\" and exports.length is 0\n          result = exports()\n\n          if result.element\n            document.body.appendChild result.element\n\n    executeInIFrame: (absolutePath) ->\n      self.packageProgram(absolutePath)\n      .then (pkg) ->\n        self.executePackageInIFrame pkg\n\n    # Execute a package in the context of an iframe\n    executePackageInIFrame: (pkg) ->\n      app = IFrameApp\n        pkg: pkg\n        title: pkg.config?.title\n        packageOptions:\n          script: \"\"\"\n            var ZINEOS = #{JSON.stringify system.version()};\n            #{PACKAGE.distribution[\"lib/system-client\"].content};\n          \"\"\"\n        sandbox: \"allow-scripts allow-forms\"\n\n      document.body.appendChild app.element\n\n      return app\n\n    # Handle requiring with or without explicit extension\n    #     require \"a\"\n    # First check:\n    #     a\n    #     a.coffee\n    #     a.coffee.md\n    #     a.litcoffee\n    #     a.jadelet\n    #     a.js\n    readForRequire: (path, basePath) ->\n      # Hack to load 'system' modules\n      isModule = !path.match(/^.?.?\\//)\n      if isModule\n        return Promise.resolve()\n        .then ->\n          require path\n\n      absolutePath = absolutizePath(basePath, path)\n\n      suffixes = [\"\", \".coffee\", \".coffee.md\", \".litcoffee\", \".jadelet\", \".js\", \".styl\"]\n\n      p = suffixes.reduce (promise, suffix) ->\n        promise.then (file) ->\n          return file if file\n          filePath = \"#{absolutePath}#{suffix}\"\n          self.readFile(filePath)\n          .catch -> # If read fails try next read\n      , Promise.resolve()\n\n      p.then (file) ->\n        unless file\n          tries = suffixes.map (suffix) ->\n            \"#{absolutePath}#{suffix}\"\n          throw new Error \"File not found at path: #{absolutePath}. Tried #{tries}\"\n\n        return file\n\n    htmlForPackage: htmlForPackage\n\n    evalCSON: evalCSON\n\n# Compile files based on type to JS program source\n# These compilers return a string of JS source code that assigns a\n# result to module.exports\ncompilers = [{\n  filter: ({path}) ->\n    path.match /\\.js$/\n  fn: (blob) ->\n    blob.readAsText()\n}, {\n  filter: ({path}) ->\n    path.match(/\\.coffee.md$/) or\n    path.match(/\\.litcoffee$/)\n  fn: (blob) ->\n    blob.readAsText()\n    .then (coffeeSource) ->\n      CoffeeScript.compile coffeeSource, bare: true, literate: true\n}, {\n  filter: ({path}) ->\n    path.match /\\.coffee$/\n  fn: (blob) ->\n    blob.readAsText()\n    .then (coffeeSource) ->\n      CoffeeScript.compile coffeeSource, bare: true\n}, {\n  filter: ({path}) ->\n    path.match /\\.jadelet$/\n  fn: (blob) ->\n    blob.readAsText()\n    .then (jadeletSource) ->\n      Jadelet.compile jadeletSource,\n        compiler: CoffeeScript\n        mode: \"jade\"\n        runtime: \"require('_SYS_jadelet')\"\n}, {\n  filter: ({path}) ->\n    path.match /\\.styl$/\n  fn: (blob) ->\n    blob.readAsText()\n    .then (source) ->\n      system.stylus(source).render()\n    .then stringifyExport\n}, {\n  filter: ({path}) ->\n    path.match /\\.json$/\n  fn: (blob) ->\n    blob.readAsJSON()\n    .then stringifyExport\n}, {\n  filter: ({path}) ->\n    path.match /\\.cson$/\n  fn: (blob) ->\n    debugger\n    blob.readAsText()\n    .then evalCSON\n    .then stringifyExport\n}, {\n  filter: ({path}) ->\n    path.match /\\.te?xt$/\n  fn: (blob) ->\n    blob.readAsText()\n    .then stringifyExport\n}]\n\nstringifyExport = (data) ->\n  \"module.exports = #{JSON.stringify(data)}\"\n\nannotateSourceURL = (program, path) ->\n  \"\"\"\n    #{program}\n    //# sourceURL=#{path}\n  \"\"\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "system/template.coffee": {
      "path": "system/template.coffee",
      "content": "# Compile a template from source text\n\nmodule.exports = (I, self) ->\n  self.extend\n    compileTemplate: (source) ->\n      templateSource = Jadelet.compile source,\n        compiler: CoffeeScript\n        runtime: \"Jadelet\" # TODO: Avoid the use of this global\n        exports: false\n\n      Function(\"return \" + templateSource)()\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/achievement-badge.jadelet": {
      "path": "templates/achievement-badge.jadelet",
      "content": "achievement-badge(title=@description @class)\n  = @icon\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/achievement-progress.jadelet": {
      "path": "templates/achievement-progress.jadelet",
      "content": "achievement-progress\n  h2= @name\n  progress(@value)\n  span= @fraction\n  achievement-badges= @badges\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/achievement.jadelet": {
      "path": "templates/achievement.jadelet",
      "content": "achievement\n  icon= @icon\n  h2= @title\n  p= @text\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/chateau.jadelet": {
      "path": "templates/chateau.jadelet",
      "content": "chateau\n  = @canvas\n  word-area\n    = @words\n  form(@submit)\n    input\n    button Speak\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/file.jadelet": {
      "path": "templates/file.jadelet",
      "content": "file(draggable=\"true\" @dragstart @dblclick @contextmenu @path @type)\n  icon\n  label= @displayName\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/folder.jadelet": {
      "path": "templates/folder.jadelet",
      "content": "folder(draggable=\"true\" @dragstart @dblclick @contextmenu @path)\n  icon\n  label= @displayName\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/home-button.jadelet": {
      "path": "templates/home-button.jadelet",
      "content": "button.home(@click) 🏡 Start\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/input.jadelet": {
      "path": "templates/input.jadelet",
      "content": "input(@value @type @min @max @checked)\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/site-url.jadelet": {
      "path": "templates/site-url.jadelet",
      "content": "site-url https://whimsy.space\n",
      "mode": "100644",
      "type": "blob"
    },
    "templates/version.jadelet": {
      "path": "templates/version.jadelet",
      "content": "version\n  span= @version\n",
      "mode": "100644",
      "type": "blob"
    },
    "test/system/module.coffee": {
      "path": "test/system/module.coffee",
      "content": "require \"../../extensions\"\nModel = require \"model\"\nAssociations = require \"../../system/associations\"\nSystemModule = require \"../../system/module\"\n\nglobal.Hamlet = require \"../../lib/hamlet\"\n\nmocha.setup\n  globals: ['amazon']\n\nmakeSystemFS = (files) ->\n  model = Model()\n  model.include SystemModule, Associations\n\n  Object.assign model,\n    readFile: (path) ->\n      Promise.resolve()\n      .then ->\n        content = files[path]\n\n        throw new Error \"File not found: #{path}\" unless content?\n\n        blob = new Blob [content]\n        blob.path = path\n\n        return blob\n\n  return model\n\ndescribe \"System Module\", ->\n  it \"should vivifyPrograms in files asynchronously\", ->\n    model = makeSystemFS\n      \"/test.js\": \"\"\"\n        module.exports = 'yo';\n      \"\"\"\n      \"/root.js\": \"\"\"\n        var test = require('./test.js');\n        var test2 = require(\"./folder/nested.js\");\n        module.exports = test + \" 2 rad \" + test2;\n      \"\"\"\n      \"/folder/nested.js\": \"\"\"\n        module.exports = \"hella\";\n      \"\"\"\n      \"/wat.js\": \"\"\"\n        module.exports = \"wat\";\n      \"\"\"\n      \"/rand.js\": \"\"\"\n        module.exports = Math.random();\n      \"\"\"\n\n    model.vivifyPrograms([\"/root.js\", \"/wat.js\", \"/rand.js\", \"/rand.js\"])\n    .then ([root, wat, r1, r2]) ->\n      console.log root, wat, r1, r2\n      assert.equal r1, r2\n      assert.equal root, 'yo 2 rad hella'\n\n  it \"should throw an error when requiring a file that doesn't exist\", (done) ->\n    #@timeout 250\n\n    model = makeSystemFS\n      \"/a.js\": \"\"\"\n        module.exports = require(\"./b.js\")\n      \"\"\"\n\n    model.vivifyPrograms([\"/a.js\"])\n    .catch (e) ->\n      done()\n\n  it \"should throw an error when requiring a file that throws an error\", (done) ->\n    @timeout 250\n\n    model = makeSystemFS\n      \"/a.js\": \"\"\"\n        throw new Error(\"I am error\")\n      \"\"\"\n\n    model.vivifyPrograms([\"/a.js\"])\n    .catch (e) ->\n      done()\n\n  it \"should require valid json\", ->\n    @timeout 250\n\n    model = makeSystemFS\n      \"/a.json\": \"\"\"\n        {\n          \"yolo\": \"wat\"\n        }\n      \"\"\"\n\n    model.vivifyPrograms([\"/a.json\"])\n    .then ([json]) ->\n      assert.equal json.yolo, \"wat\"\n\n  it \"should throw an error when requiring invalid json\", (done) ->\n    @timeout 250\n\n    model = makeSystemFS\n      \"/a.json\": \"\"\"\n        yolo: 'wat'\n      \"\"\"\n\n    model.vivifyPrograms([\"/a.json\"])\n    .catch (e) ->\n      done()\n\n  it \"should wait forever when resolving circular requires\", (done) ->\n    model = makeSystemFS\n      \"/a.js\": \"\"\"\n        module.exports = require(\"./b.js\")\n      \"\"\"\n      \"/b.js\": \"\"\"\n        module.exports = require(\"./a.js\")\n      \"\"\"\n\n    model.vivifyPrograms([\"/a.js\"])\n    .then ([a]) ->\n      # Never get here\n      assert false\n\n    setTimeout ->\n      done()\n    , 100\n\n  it \"should work even if the file doesn't assign to module.exports\", ->\n    model = makeSystemFS\n      \"/wat.js\": \"\"\"\n        exports.yolo = \"wat\";\n      \"\"\"\n\n    model.vivifyPrograms [\"/wat.js\"]\n    .then ([wat]) ->\n      assert.equal wat.yolo, \"wat\"\n\n  it \"should work with relative paths in subfolders\", ->\n    model = makeSystemFS\n      \"/main.js\": \"\"\"\n        module.exports = require(\"./folder/a.js\");\n      \"\"\"\n      \"/folder/a.js\": \"\"\"\n        module.exports = require(\"./b.js\");\n      \"\"\"\n      \"/folder/b.js\": \"\"\"\n        module.exports = \"b\";\n      \"\"\"\n\n    model.vivifyPrograms [\"/main.js\"]\n    .then ([main]) ->\n      assert.equal main, \"b\"\n\n  it \"should work with absolute paths in subfolders\", ->\n    model = makeSystemFS\n      \"/main.js\": \"\"\"\n        module.exports = require(\"./folder/a.js\");\n      \"\"\"\n      \"/folder/a.js\": \"\"\"\n        module.exports = require(\"/b.js\");\n      \"\"\"\n      \"/b.js\": \"\"\"\n        module.exports = \"b\";\n      \"\"\"\n\n    model.vivifyPrograms [\"/main.js\"]\n    .then ([main]) ->\n      assert.equal main, \"b\"\n\n  it \"should require .jadelet sources\", ->\n    model = makeSystemFS\n      \"/main.coffee\": \"\"\"\n        template = require \"./button.jadelet\"\n\n        module.exports =\n          buttonTemplate: template\n      \"\"\"\n      \"/button.jadelet\": \"\"\"\n        button(@click)= @text\n      \"\"\"\n\n    model.vivifyPrograms [\"/main.coffee\"]\n    .then ([main]) ->\n      assert typeof main.buttonTemplate is \"function\"\n",
      "mode": "100644",
      "type": "blob"
    },
    "util.coffee": {
      "path": "util.coffee",
      "content": "fileSeparator = \"/\"\n\nnormalizePath = (path) ->\n  path.replace(/\\/+/g, fileSeparator) # /// -> /\n  .replace(/\\/[^/]*\\/\\.\\./g, \"\") # /base/something/.. -> /base\n  .replace(/\\/\\.\\//g, fileSeparator) # /base/. -> /base\n\n# NOTE: Allows paths like '../..' to go above the base path\nabsolutizePath = (base, relativePath) ->\n  normalizePath \"/#{base}/#{relativePath}\"\n\nmakeScript = (src) ->\n  \"<script src=#{JSON.stringify(src)}><\\/script>\"\n\ndependencyScripts = (remoteDependencies=[]) ->\n  remoteDependencies.map(makeScript).join(\"\\n\")\n\nmetaTag = (name, content) ->\n  \"<meta name=#{JSON.stringify(name)} content=#{JSON.stringify(content)}>\"\n\nhtmlForPackage = (pkg, opts={}) ->\n  {script} = opts\n  script ?= \"\"\n\n  metas = [\n    '<meta charset=\"utf-8\">'\n  ]\n\n  {config, progenitor} = pkg\n  config ?= {}\n\n  {title, description} = config\n\n  if title\n    metas.push \"<title>#{title}</title>\"\n\n  if description\n    metas.push metaTag \"description\", description.replace(\"\\n\", \" \")\n\n  url = pkg.progenitor?.url\n  if url\n    metas.push \"<link rel=\\\"Progenitor\\\" href=#{JSON.stringify(url)}>\"\n\n  # Add postmaster dependency so package can talk with parent window\n  # The packages are added with the _SYS_ prefix to reduce collisions\n  pkg.dependencies ?= {}\n  pkg.dependencies._SYS_postmaster ?= PACKAGE.dependencies.postmaster\n  pkg.dependencies._SYS_ui ?= PACKAGE.dependencies.ui\n\n  code = \"\"\"\n    #{script};\n    require('./#{pkg.entryPoint}');\n  \"\"\"\n\n  \"\"\"\n    <!DOCTYPE html>\n    <html>\n      <head>\n        #{metas.join(\"\\n    \")}\n        #{dependencyScripts(pkg.remoteDependencies)}\n      </head>\n      <body>\n        <script>\n          #{require.packageWrapper(pkg, code)}\n        <\\/script>\n      </body>\n    </html>\n  \"\"\"\n\nextensionFor = (path) ->\n  result = path.match /\\.([^.]+)$/\n\n  if result\n    result[1]\n\nreadTree = (fs, directoryPath) ->\n  fs.list(directoryPath)\n  .then (files) ->\n    Promise.all files.map (file) ->\n      if file.folder\n        readTree(fs, file.path)\n      else\n        file\n  .then (filesAndFolderFiles) ->\n    filesAndFolderFiles.reduce (a, b) ->\n      a.concat(b)\n    , []\n\nmodule.exports = Util =\n  emptyElement: (element) ->\n    while element.lastChild\n      element.removeChild element.lastChild\n\n  extensionFor: extensionFor\n\n  fileSeparator: fileSeparator\n  htmlForPackage: htmlForPackage\n  normalizePath: normalizePath\n  absolutizePath: absolutizePath\n\n  isAbsolutePath: (path) ->\n    path.match /^\\//\n\n  isRelativePath: (path) ->\n    path.match /^.?.\\//\n\n  parentElementOfType: (tagname, element) ->\n    tagname = tagname.toLowerCase()\n\n    if element.nodeName.toLowerCase() is tagname\n      return element\n\n    while element = element.parentNode\n      if element.nodeName.toLowerCase() is tagname\n        return element\n\n  # Convert node style errbacks to promise style\n  pinvoke: (object, method, params...) ->\n    new Promise (resolve, reject) ->\n      object[method] params..., (err, result) ->\n        if err\n          reject err\n          return\n\n        resolve result\n\n  startsWith: (str, prefix) ->\n    str.lastIndexOf(prefix, 0) is 0\n\n  endsWith: (str, suffix) ->\n    str.indexOf(suffix, str.length - suffix.length) != -1\n\n  evalCSON: (coffeeSource) ->\n    Promise.resolve()\n    .then ->\n      CoffeeScript.compile(coffeeSource, bare: true)\n    .then (jsCode) ->\n      # TODO: Security, lol\n      Function(\"return \" + jsCode)()\n\n  generalType: (type=\"\") ->\n    type.replace(/^application\\/|\\/.*$/, \"\").replace(/;.*$/, \"\")\n\n  readTree: readTree\n\n  ###\n  Get the first file from a drop event. Does nothing if the event has had\n  defaultPrevented. Calls preventDefault if we handle the drop.\n\n  We also handle the special case of dragging and dropping files from the system\n  explorer.\n\n  Returns a promise that is fulfilled with the file.\n  ###\n  fileFromDropEvent: (e) ->\n    return if e.defaultPrevented\n\n    fileSelectionData = e.dataTransfer.getData(\"zineos/file-selection\")\n    if fileSelectionData\n      e.preventDefault()\n      data = JSON.parse fileSelectionData\n\n      selectedFile = data.files[0]\n      return system.readFile(selectedFile.path)\n\n    files = e.dataTransfer.files\n    if files.length\n      e.preventDefault()\n      return Promise.resolve(files[0])\n\n    return Promise.resolve()\n",
      "mode": "100644",
      "type": "blob"
    }
  },
  "distribution": {
    "apps/achievement-status": {
      "path": "apps/achievement-status",
      "content": "(function() {\n  module.exports = function() {\n    var Achievement, UI, Window, cheevoElement, windowView;\n    Achievement = system.Achievement, UI = system.UI;\n    Window = UI.Window;\n    cheevoElement = Achievement.progressView();\n    cheevoElement.style.width = \"100%\";\n    cheevoElement.style.padding = \"1em\";\n    Achievement.unlock(\"Check yo' self\");\n    return windowView = Window({\n      title: \"Cheevos\",\n      content: cheevoElement,\n      width: 640,\n      height: 480\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/audio-bro": {
      "path": "apps/audio-bro",
      "content": "(function() {\n  var FileIO, Model;\n\n  FileIO = require(\"../os/file-io\");\n\n  Model = require(\"model\");\n\n  module.exports = function() {\n    var Achievement, ContextMenu, MenuBar, Modal, Observable, Progress, Window, audio, filePath, handlers, menuBar, parseMenu, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Observable = _ref.Observable, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    Achievement = system.Achievement;\n    Achievement.unlock(\"Pump up the jam\");\n    audio = document.createElement('audio');\n    audio.controls = true;\n    audio.autoplay = true;\n    filePath = Observable();\n    handlers = Model().include(FileIO).extend({\n      loadFile: function(blob) {\n        filePath(blob.path);\n        return audio.src = URL.createObjectURL(blob);\n      },\n      exit: function() {\n        return windowView.element.remove();\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [O]pen\\n  -\\n  E[x]it\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: function() {\n        var path;\n        if (path = filePath()) {\n          return \"Audio Bro - \" + path;\n        } else {\n          return \"Audio Bro\";\n        }\n      },\n      content: audio,\n      menuBar: menuBar.element,\n      width: 308,\n      height: 80,\n      iconEmoji: \"🎶\"\n    });\n    windowView.loadFile = handlers.loadFile;\n    return windowView;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/chateau": {
      "path": "apps/chateau",
      "content": "(function() {\n  var IFrameApp;\n\n  IFrameApp = require(\"../lib/iframe-app\");\n\n  module.exports = function() {\n    var Achievement, app;\n    Achievement = system.Achievement;\n    app = IFrameApp({\n      src: \"https://danielx.net/chateau/\",\n      width: 960,\n      height: 540,\n      title: \"Chateau\",\n      iconEmoji: \"🍷\"\n    });\n    app.on(\"event\", function(name) {\n      switch (name) {\n        case \"login\":\n          return Achievement.unlock(\"Enter the Chateau\");\n        case \"custom-avatar\":\n          return Achievement.unlock(\"Puttin' on the Ritz\");\n        case \"custom-background\":\n          return Achievement.unlock(\"Paint the town red\");\n        case \"file-upload\":\n          return Achievement.unlock(\"It's in the cloud\");\n      }\n    });\n    return app;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/contrasaurus": {
      "path": "apps/contrasaurus",
      "content": "(function() {\n  module.exports = function() {\n    var Achievement, app, iframeApp;\n    Achievement = system.Achievement, iframeApp = system.iframeApp;\n    app = iframeApp({\n      src: \"https://contrasaur.us/\",\n      width: 960,\n      height: 540,\n      title: \"Contrasaurus: Defender of the American Dream\"\n    });\n    Achievement.unlock(\"Rawr\");\n    app.on(\"event\", function(name) {\n      switch (name) {\n        case \"win\":\n          return Achievement.unlock(\"A winner is you\");\n      }\n    });\n    return app;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/dungeon-of-sadness": {
      "path": "apps/dungeon-of-sadness",
      "content": "(function() {\n  module.exports = function() {\n    var Achievement, app, iframeApp;\n    Achievement = system.Achievement, iframeApp = system.iframeApp;\n    app = iframeApp({\n      title: \"Dungeon of Sadness\",\n      src: \"https://danielx.net/ld33/\",\n      width: 648,\n      height: 507\n    });\n    Achievement.unlock(\"The dungeon is in our heart\");\n    return app;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/explorer": {
      "path": "apps/explorer",
      "content": "(function() {\n  var Drop, Explorer, FileTemplate, FolderTemplate, emptyElement, extractPath;\n\n  Drop = require(\"../lib/drop\");\n\n  FileTemplate = require(\"../templates/file\");\n\n  FolderTemplate = require(\"../templates/folder\");\n\n  emptyElement = require(\"../util\").emptyElement;\n\n  extractPath = function(element) {\n    var path;\n    while (element) {\n      path = element.getAttribute(\"path\");\n      if (path) {\n        return path;\n      }\n      element = element.parentElement;\n    }\n  };\n\n  module.exports = Explorer = function(options) {\n    var ContextMenu, MenuBar, Modal, Progress, Window, addWindow, contextMenuFor, contextMenuForFolder, explorer, explorerContextMenu, parseMenu, path, update, _ref, _ref1;\n    if (options == null) {\n      options = {};\n    }\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    path = options.path;\n    if (path == null) {\n      path = '/';\n    }\n    explorer = document.createElement(\"explorer\");\n    explorer.setAttribute(\"path\", path);\n    Drop(explorer, function(e) {\n      var data, file, fileSelectionData, files, folderTarget, selectedFile, targetPath;\n      if (e.defaultPrevented) {\n        return;\n      }\n      targetPath = extractPath(e.target) || path;\n      folderTarget = targetPath.match(/\\/$/);\n      fileSelectionData = e.dataTransfer.getData(\"zineos/file-selection\");\n      if (fileSelectionData) {\n        data = JSON.parse(fileSelectionData);\n        if (folderTarget) {\n          system.moveFileSelection(data, targetPath);\n        } else {\n          selectedFile = data.files[0];\n          console.log(\"Open in app \" + targetPath + \" <- \" + selectedFile);\n          system.readFile(selectedFile.path).then(function(file) {\n            return system.execPathWithFile(targetPath, file);\n          });\n        }\n        e.preventDefault();\n        return;\n      }\n      files = e.dataTransfer.files;\n      if (files.length) {\n        e.preventDefault();\n        if (folderTarget) {\n          return files.forEach(function(file) {\n            var newPath;\n            newPath = targetPath + file.name;\n            return system.writeFile(newPath, file, true);\n          });\n        } else {\n          file = files[0];\n          return system.execPathWithFile(targetPath, file);\n        }\n      }\n    });\n    explorerContextMenu = ContextMenu({\n      items: parseMenu(\"[N]ew File\"),\n      handlers: {\n        newFile: function() {\n          return Modal.prompt(\"Filename\", \"\" + path + \"newfile.txt\").then(function(newFilePath) {\n            if (newFilePath) {\n              return system.writeFile(newFilePath, new Blob([], {\n                type: \"text/plain\"\n              }));\n            }\n          });\n        }\n      }\n    });\n    explorer.oncontextmenu = function(e) {\n      if (e.defaultPrevented) {\n        return;\n      }\n      e.preventDefault();\n      return explorerContextMenu.display({\n        inElement: document.body,\n        x: e.pageX,\n        y: e.pageY\n      });\n    };\n    contextMenuFor = function(file, e) {\n      var contextMenu, contextMenuHandlers, openWithMenu, openerOptions, openers;\n      if (e.defaultPrevented) {\n        return;\n      }\n      e.preventDefault();\n      contextMenuHandlers = {\n        open: function() {\n          return system.open(file);\n        },\n        cut: function() {},\n        copy: function() {},\n        \"delete\": function() {\n          return system.deleteFile(file.path);\n        },\n        rename: function() {\n          return Modal.prompt(\"Filename\", file.path).then(function(newPath) {\n            if (newPath) {\n              return system.moveFile(file.path, newPath);\n            }\n          });\n        },\n        properties: function() {\n          var pre;\n          pre = document.createElement(\"pre\");\n          pre.textContent = JSON.stringify(file, null, 2);\n          pre.style = \"padding: 1rem\";\n          return Modal.show(pre);\n        },\n        editMIMEType: function() {\n          return Modal.prompt(\"MIME Type\", file.type).then(function(newType) {\n            if (newType) {\n              return system.updateFile(file.path, {\n                type: newType\n              }).then(console.log);\n            }\n          });\n        }\n      };\n      openers = system.openersFor(file);\n      openerOptions = openers.map(function(_arg, i) {\n        var fn, handlerName, name;\n        name = _arg.name, fn = _arg.fn;\n        handlerName = \"opener\" + i;\n        contextMenuHandlers[handlerName] = function() {\n          return fn(file);\n        };\n        return \"  \" + name + \" -> \" + handlerName;\n      }).join(\"\\n\");\n      openWithMenu = \"\";\n      if (openers.length > 0) {\n        openWithMenu = \"Open With\\n\" + openerOptions;\n      }\n      contextMenu = ContextMenu({\n        items: parseMenu(\"Open\\n\" + openWithMenu + \"\\n-\\nCut\\nCopy\\n-\\nDelete\\nRename\\n-\\nEdit MIME Type\\nProperties\"),\n        handlers: contextMenuHandlers\n      });\n      return contextMenu.display({\n        inElement: document.body,\n        x: e.pageX,\n        y: e.pageY\n      });\n    };\n    contextMenuForFolder = function(folder, e) {\n      var contextMenu;\n      if (e.defaultPrevented) {\n        return;\n      }\n      e.preventDefault();\n      contextMenu = ContextMenu({\n        items: parseMenu(\"Open\\n-\\nCut\\nCopy\\n-\\nDelete\\nRename\\n-\\nProperties\"),\n        handlers: {\n          open: function() {\n            return addWindow(folder.path);\n          },\n          \"delete\": function() {\n            return system.readTree(folder.path).then(function(results) {\n              return Promise.all(results.map(function(result) {\n                return system.deleteFile(result.path);\n              }));\n            });\n          },\n          rename: function() {\n            return Modal.prompt(\"Name\", folder.path).then(function(newName) {\n              if (!newName) {\n                return;\n              }\n              newName = newName.replace(/\\/*$/, \"/\");\n              return system.readTree(folder.path).then(function(files) {\n                return Promise.all(files.map(function(file) {\n                  var newPath;\n                  newPath = file.path.replace(folder.path, newName);\n                  return system.moveFile(file.path, newPath);\n                }));\n              });\n            });\n          },\n          properties: function() {}\n        }\n      });\n      return contextMenu.display({\n        inElement: document.body,\n        x: e.pageX,\n        y: e.pageY\n      });\n    };\n    update = function() {\n      return system.fs.list(path).then(function(files) {\n        var addedFolders;\n        emptyElement(explorer);\n        addedFolders = {};\n        files.forEach(function(file) {\n          var fileElement, folderPath;\n          if (file.relativePath.match(/\\/$/)) {\n            folderPath = file.relativePath;\n            addedFolders[folderPath] = true;\n            return;\n          }\n          Object.assign(file, {\n            displayName: file.relativePath,\n            dblclick: function() {\n              return system.open(file);\n            },\n            contextmenu: function(e) {\n              return contextMenuFor(file, e);\n            },\n            dragstart: function(e) {\n              return e.dataTransfer.setData(\"zineos/file-selection\", JSON.stringify({\n                sourcePath: path,\n                files: [file]\n              }));\n            }\n          });\n          fileElement = FileTemplate(file);\n          if (file.type.match(/^image\\//)) {\n            file.blob.getURL().then(function(url) {\n              var icon;\n              icon = fileElement.querySelector('icon');\n              icon.style.backgroundImage = \"url(\" + url + \")\";\n              icon.style.backgroundSize = \"100%\";\n              return icon.style.backgroundPosition = \"50%\";\n            });\n          }\n          return explorer.appendChild(fileElement);\n        });\n        return Object.keys(addedFolders).reverse().forEach(function(folderName) {\n          var folder, folderElement;\n          folder = {\n            path: \"\" + path + folderName,\n            relativePath: folderName,\n            displayName: folderName.replace(/\\/$/, \"\"),\n            contextmenu: function(e) {\n              return contextMenuForFolder(folder, e);\n            },\n            dblclick: function() {\n              return addWindow(folder.path);\n            },\n            dragstart: function(e) {\n              return e.dataTransfer.setData(\"zineos/file-selection\", JSON.stringify({\n                sourcePath: folder.path.slice(0, folder.path.length - folder.relativePath.length),\n                files: [folder]\n              }));\n            }\n          };\n          folderElement = FolderTemplate(folder);\n          return explorer.insertBefore(folderElement, explorer.firstChild);\n        });\n      });\n    };\n    update();\n    system.fs.on(\"write\", function(path) {\n      return update();\n    });\n    system.fs.on(\"delete\", function(path) {\n      return update();\n    });\n    system.fs.on(\"update\", function(path) {\n      return update();\n    });\n    addWindow = function(path) {\n      var element, windowView;\n      element = Explorer({\n        path: path\n      });\n      windowView = Window({\n        title: path,\n        content: element,\n        menuBar: null,\n        width: 640,\n        height: 480,\n        iconEmoji: \"📂\"\n      });\n      return document.body.appendChild(windowView.element);\n    };\n    return explorer;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/filter": {
      "path": "apps/filter",
      "content": "(function() {\n  var FileIO, Model;\n\n  FileIO = require(\"../os/file-io\");\n\n  Model = require(\"model\");\n\n  module.exports = function() {\n    var ContextMenu, MenuBar, Modal, Progress, Window, canvas, context, handlers, menuBar, modalForm, parseMenu, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    system.Achievement.unlock(\"Look at that\");\n    canvas = document.createElement('canvas');\n    context = canvas.getContext('2d');\n    modalForm = system.compileTemplate(\"form\\n  label\\n    h2 Width\\n    input(name=\\\"width\\\")\\n  label\\n    h2 Height\\n    input(name=\\\"height\\\")\");\n    handlers = Model().include(FileIO).extend({\n      loadFile: function(blob) {\n        return Image.fromBlob(blob).then(function(img) {\n          canvas.width = img.width;\n          canvas.height = img.height;\n          return context.drawImage(img, 0, 0);\n        });\n      },\n      saveData: function() {\n        return new Promise(function(resolve) {\n          return canvas.toBlob(resolve);\n        });\n      },\n      exit: function() {\n        return windowView.element.remove();\n      },\n      crop: function() {\n        return Modal.form(modalForm()).then(console.log);\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [O]pen\\n  [S]ave\\n  Save [A]s\\n  -\\n  E[x]it\\n[E]dit\\n  [C]rop\\n  [F]ilter\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: \"Spectacle Image Viewer\",\n      content: canvas,\n      menuBar: menuBar.element,\n      width: 640,\n      height: 480\n    });\n    windowView.loadFile = handlers.loadFile;\n    return windowView;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/markdown": {
      "path": "apps/markdown",
      "content": "(function() {\n  var FileIO, Model, absolutizePath, isRelative;\n\n  FileIO = require(\"../os/file-io\");\n\n  Model = require(\"model\");\n\n  absolutizePath = require(\"../util\").absolutizePath;\n\n  isRelative = function(url) {\n    return url.match(/^\\.\\.?\\//);\n  };\n\n  module.exports = function() {\n    var ContextMenu, MenuBar, Modal, Progress, Window, baseDir, container, handlers, menuBar, navigateToPath, navigationStack, parseMenu, rewriteURL, rewriteURLs, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    container = document.createElement('container');\n    container.style.padding = \"1rem\";\n    container.style.userSelect = \"initial\";\n    baseDir = \"\";\n    navigationStack = [];\n    navigateToPath = function(path) {\n      return system.readFile(path).then(function(blob) {\n        return handlers.loadFile(blob, path);\n      });\n    };\n    rewriteURL = function(url) {\n      return Promise.resolve().then(function() {\n        var targetPath;\n        if (isRelative(url)) {\n          targetPath = absolutizePath(baseDir, url);\n          return system.urlForPath(targetPath);\n        } else if (url.match(/^\\//)) {\n          targetPath = absolutizePath(\"\", url);\n          return system.urlForPath(targetPath);\n        } else {\n          return url;\n        }\n      });\n    };\n    rewriteURLs = function(container) {\n      return container.querySelectorAll(\"img\").forEach(function(img) {\n        var url;\n        url = img.getAttribute(\"src\");\n        if (url) {\n          return rewriteURL(url).then(function(url) {\n            return img.src = url;\n          });\n        }\n      });\n    };\n    handlers = Model().include(FileIO).extend({\n      loadFile: function(blob, path) {\n        navigationStack.push(path);\n        baseDir = path.replace(/\\/[^/]*$/, \"\");\n        return blob.readAsText().then(function(textContent) {\n          if (path.match(/\\.html$/)) {\n            container.innerHTML = textContent;\n          } else {\n            container.innerHTML = marked(textContent);\n          }\n          return rewriteURLs(container);\n        });\n      },\n      saveData: function() {},\n      exit: function() {\n        return windowView.element.remove();\n      }\n    });\n    container.addEventListener(\"click\", function(e) {\n      var anchor, path, url;\n      anchor = e.path.filter(function(element) {\n        return element.nodeName === \"A\";\n      })[0];\n      if (anchor) {\n        url = anchor.getAttribute(\"href\");\n        if (isRelative(url)) {\n          e.preventDefault();\n          path = absolutizePath(baseDir, url);\n          return navigateToPath(path);\n        }\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [O]pen\\n  -\\n  E[x]it\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: \"Markdown\",\n      content: container,\n      menuBar: menuBar.element,\n      width: 720,\n      height: 480\n    });\n    windowView.element.setAttribute(\"tabindex\", -1);\n    windowView.element.addEventListener(\"keydown\", function(e) {\n      var key, lastPath;\n      key = e.key;\n      if (key === \"Backspace\") {\n        e.preventDefault();\n        if (navigationStack.length > 1) {\n          navigationStack.pop();\n          lastPath = navigationStack.pop();\n          return navigateToPath(lastPath);\n        }\n      }\n    });\n    windowView.loadFile = handlers.loadFile;\n    return windowView;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/my-briefcase": {
      "path": "apps/my-briefcase",
      "content": "\n/*\nUse the madness that is Amazon Cognito to support a 'My Briefcase' functionality.\n\nThis depends on having the AWS library available:\n- https://sdk.amazonaws.com/js/aws-sdk-2.2.42.min.js\n\nThis is where you can put the files that you want to access from the cloud.\n\nThey'll live in the whimsy-fs bucket under the path to your aws user id.\n\nThe subdomain -> s3 proxy will have a map from simple names to the crazy ids.\n\nThe proxy will serve the /public folder in your 'briefcase'. You can put your\nblog or apps or whatever there. The rest currently isn't 'private', but maybe\nit should be. We can set the access control when uploading.\n\nIdeally the briefcase will be browsable like the local FS and you'll be able to\nrun files from it, load them in applications, save files there, and drag n drop\nbetween them.\n */\n\n(function() {\n  var Explorer, FileTemplate, FolderTemplate, S3FS, bindAlgoliaIndex, emptyElement, extensionFor, generalType, pinvoke, queryUserInfo, readTree, _ref;\n\n  Explorer = require(\"./explorer\");\n\n  FileTemplate = require(\"../templates/file\");\n\n  FolderTemplate = require(\"../templates/folder\");\n\n  S3FS = require(\"../lib/s3-fs\");\n\n  _ref = require(\"../util\"), emptyElement = _ref.emptyElement, extensionFor = _ref.extensionFor, generalType = _ref.generalType, pinvoke = _ref.pinvoke, readTree = _ref.readTree;\n\n  window.onAmazonLoginReady = function() {\n    return amazon.Login.setClientId('amzn1.application-oa2-client.29b275f9076a406c90a66b025fab96bf');\n  };\n\n  (function(d) {\n    var a, r;\n    r = d.createElement('div');\n    r.id = \"amazon-root\";\n    d.body.appendChild(r);\n    a = d.createElement('script');\n    a.type = 'text/javascript';\n    a.async = true;\n    a.id = 'amazon-login-sdk';\n    a.src = 'https://api-cdn.amazon.com/sdk/login1.js';\n    return r.appendChild(a);\n  })(document);\n\n  module.exports = function() {\n    var LoadedTemplate, LoginTemplate, Observable, Window, content, logins, receivedCredentials, windowView, _ref1;\n    _ref1 = system.UI, Observable = _ref1.Observable, Window = _ref1.Window;\n    system.Achievement.unlock(\"Oh no, my files!\");\n    LoginTemplate = system.compileTemplate(\"span(style=\\\"text-align: center; padding: 0 2em;\\\")\\n  h1 My Briefcase\\n  p= @description\\n  a#LoginWithAmazon(@click)\\n    img(border=\\\"0\\\" alt=\\\"Login with Amazon\\\" src=\\\"https://images-na.ssl-images-amazon.com/images/G/01/lwa/btnLWA_gold_156x32.png\\\" width=\\\"156\\\" height=\\\"32\\\")\");\n    LoadedTemplate = system.compileTemplate(\"section\\n  h1 Connected!\\n  p Loading files...\");\n    content = Observable(null);\n    receivedCredentials = function() {\n      var bucket, fs, id, infoBlob, uuidToken;\n      console.log(AWS.config.credentials);\n      id = AWS.config.credentials.identityId;\n      content(LoadedTemplate());\n      bucket = new AWS.S3({\n        params: {\n          Bucket: \"whimsy-fs\"\n        }\n      });\n      fs = S3FS(id, bucket);\n      bindAlgoliaIndex(id, fs);\n      uuidToken = id.split(\":\")[1];\n      system.fs.mount(\"/My Briefcase/\", fs);\n      infoBlob = new Blob([\"Welcome to Your Cloud Briefcase\\n===============================\\n\\nStore your files in a magical cloud that floats between computers.\\n\\nFiles stored in `My Briefcase/public` are available to anyone on the\\ninternet. (Technically so are all the files in your cloud briefcase...\\nSecurity: Coming Soon™)\\n\\nBut the ones in /public are easily accessible, like when computing was fun\\nagain. [Check this out](https://\" + uuidToken + \".whimsy.space/info.md)\\nand see what I mean.\\n\\nYou can get your own cool and non-ugly subdomain if you contact me (the\\ncreator of this computing system). Just send me your id and the short\\nname you'd prefer. DM me in the friendsofjack slack or something.\"], {\n        type: \"text/markdown; charset=utf-8\"\n      });\n      system.writeFile(\"/My Briefcase/public/info.md\", infoBlob);\n      system.writeFile(\"/My Briefcase/public/.keep\", new Blob([]));\n      return content(Explorer({\n        path: \"/My Briefcase/\"\n      }));\n    };\n    AWS.config.update({\n      region: 'us-east-1'\n    });\n    try {\n      logins = JSON.parse(localStorage.WHIMSY_FS_AWS_LOGIN);\n    } catch (_error) {}\n    AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n      IdentityPoolId: 'us-east-1:4fe22da5-bb5e-4a78-a260-74ae0a140bf9',\n      Logins: logins\n    });\n    if (logins) {\n      pinvoke(AWS.config.credentials, \"get\").then(receivedCredentials)[\"catch\"](function(e) {\n        if (e.message !== \"Invalid login token.\") {\n          return console.warn(e, e.message);\n        }\n      });\n    }\n    content(LoginTemplate({\n      description: function() {\n        return \"Maintain access to your files across different machines. Publish\\neffortlessly to the internet. Your briefcase holds all of your hopes\\nand dreams in a magical cloud that is available anywhere there is an\\ninternet connection. 💼\";\n      },\n      click: function() {\n        var options;\n        options = {\n          scope: 'profile'\n        };\n        return amazon.Login.authorize(options, function(resp) {\n          var creds, token;\n          if (!resp.error) {\n            console.log(resp);\n            token = resp.access_token;\n            creds = AWS.config.credentials;\n            logins = {\n              'www.amazon.com': token\n            };\n            localStorage.WHIMSY_FS_AWS_LOGIN = JSON.stringify(logins);\n            creds.params.Logins = logins;\n            creds.expired = true;\n            queryUserInfo(token);\n            return pinvoke(AWS.config.credentials, \"get\").then(receivedCredentials);\n          }\n        });\n      }\n    }));\n    windowView = Window({\n      title: \"My Briefcase\",\n      width: 640,\n      height: 480,\n      content: content,\n      iconEmoji: \"💼\"\n    });\n    return windowView;\n  };\n\n  queryUserInfo = function(token) {\n    return fetch(\"https://api.amazon.com/user/profile\", {\n      headers: {\n        Authorization: \"bearer \" + token,\n        Accept: \"application/json\"\n      }\n    }).then(function(response) {\n      return response.json();\n    }).then(function(json) {\n      return console.log(json);\n    })[\"catch\"](function(e) {\n      return console.error(e);\n    });\n  };\n\n  bindAlgoliaIndex = function(id, fs) {\n    var ALGOLIA_SECRET, client, index, indexableContent, isPublic, matchesContentType, performIndex;\n    ALGOLIA_SECRET = localStorage.ALGOLIA_SECRET;\n    if (!ALGOLIA_SECRET) {\n      console.warn(\"No Algolia key present, 'My Briefcase' will not be indexed.\");\n      return;\n    }\n    console.log(\"Initializing Algolia indexing of 'My Briefcase'\");\n    client = algoliasearch(\"QM41V7R53B\", ALGOLIA_SECRET);\n    index = client.initIndex('My Briefcase');\n    matchesContentType = function(type) {\n      return type.match(/text|javascript/);\n    };\n    isPublic = function(path) {\n      return path.match(/^\\/public\\//);\n    };\n    indexableContent = function(blob) {\n      if (matchesContentType(blob.type)) {\n        return blob.readAsText();\n      } else {\n        return Promise.resolve();\n      }\n    };\n    performIndex = function(path, blob) {\n      var contentType, type;\n      if (!isPublic(path)) {\n        return;\n      }\n      console.log(\"Indexing:\", path);\n      contentType = blob.type;\n      type = generalType(contentType);\n      return indexableContent(blob).then(function(content) {\n        return new Promise(function(resolve, reject) {\n          return index.addObjects([\n            {\n              objectID: id + path,\n              path: path,\n              extension: extensionFor(path),\n              content: content != null ? content.slice(0, 8192) : void 0,\n              contentType: contentType,\n              type: type,\n              size: blob.size\n            }\n          ], function(err, content) {\n            if (err) {\n              return reject(err);\n            }\n            return resolve(content);\n          });\n        });\n      });\n    };\n    fs.on(\"write\", function(path) {\n      console.log(\"Write: \" + path);\n      return fs.read(path).then(function(blob) {\n        return performIndex(path, blob);\n      });\n    });\n    fs.on(\"delete\", function(path) {\n      return new Promise(function(resolve, reject) {\n        return index.deleteObject(id + path, function(err) {\n          if (err) {\n            return reject(err);\n          }\n          return resolve();\n        });\n      });\n    });\n    global.reindexBriefcase = function() {\n      return readTree(fs, \"/public\").then(function(files) {\n        var RETRY, handleError, processFile, queue, work;\n        console.log(\"All Bfiles\", files);\n        queue = files;\n        RETRY = {};\n        processFile = function(file) {\n          var path;\n          path = file.path;\n          return fs.read(path).then(function(blob) {\n            return performIndex(path, blob);\n          })[\"catch\"](function(e) {\n            return handleError(e, file);\n          }).then(function(result) {\n            if (result === RETRY) {\n              return processFile(file);\n            } else {\n              return result;\n            }\n          });\n        };\n        handleError = function(e, file) {\n          console.error(e);\n          if (file.retries == null) {\n            file.retries = 3;\n          }\n          if (file.retries <= 0) {\n            throw e;\n          } else {\n            file.retries -= 1;\n            return RETRY;\n          }\n        };\n        work = function() {\n          var file;\n          file = files.shift();\n          if (file) {\n            return processFile(file).then(function() {\n              return work();\n            });\n          }\n        };\n        work();\n        work();\n        work();\n        return work();\n      });\n    };\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/notepad": {
      "path": "apps/notepad",
      "content": "(function() {\n  var FileIO, Model;\n\n  FileIO = require(\"../os/file-io\");\n\n  Model = require(\"model\");\n\n  module.exports = function() {\n    var ContextMenu, MenuBar, Modal, Progress, TODO, Window, exec, handlers, initialValue, menuBar, parseMenu, textarea, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    system.Achievement.unlock(\"Notepad.exe\");\n    exec = function(cmd) {\n      return function() {\n        textarea.focus();\n        return document.execCommand(cmd);\n      };\n    };\n    TODO = function() {\n      return console.log(\"TODO\");\n    };\n    textarea = document.createElement(\"textarea\");\n    textarea.spellcheck = false;\n    initialValue = \"\";\n    textarea.addEventListener(\"input\", function() {\n      return handlers.saved(textarea.value === initialValue);\n    });\n    handlers = Model().include(FileIO).extend({\n      loadFile: function(blob, path) {\n        return blob.readAsText().then(function(text) {\n          handlers.currentPath(path);\n          initialValue = text;\n          return textarea.value = initialValue;\n        });\n      },\n      newFile: function() {\n        initialValue = \"\";\n        return textarea.value = initialValue;\n      },\n      saveData: function() {\n        var data;\n        data = new Blob([textarea.value], {\n          type: \"text/plain\"\n        });\n        return Promise.resolve(data);\n      },\n      pageSetup: TODO,\n      print: TODO,\n      exit: function() {\n        return windowView.element.remove();\n      },\n      undo: exec(\"undo\"),\n      redo: exec(\"redo\"),\n      cut: exec(\"cut\"),\n      copy: exec(\"copy\"),\n      paste: exec(\"paste\"),\n      \"delete\": exec(\"delete\"),\n      find: TODO,\n      findNext: TODO,\n      replace: TODO,\n      goTo: TODO,\n      selectAll: function() {\n        return textarea.select();\n      },\n      timeDate: function() {\n        var dateText;\n        textarea.focus();\n        dateText = (new Date).toString().split(\" \").slice(0, -4).join(\" \");\n        return document.execCommand(\"insertText\", false, dateText);\n      },\n      wordWrap: TODO,\n      font: function() {\n        return Modal.prompt(\"Font\", textarea.style.fontFamily || \"monospace\").then(function(font) {\n          if (font) {\n            return textarea.style.fontFamily = font;\n          }\n        });\n      },\n      statusBar: TODO,\n      viewHelp: TODO,\n      aboutNotepad: TODO\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [N]ew\\n  [O]pen\\n  [S]ave\\n  Save [A]s\\n  -\\n  Page Set[u]p\\n  [P]rint\\n  -\\n  E[x]it\\n[E]dit\\n  [U]ndo\\n  Redo\\n  -\\n  Cu[t]\\n  [C]opy\\n  [P]aste\\n  De[l]ete\\n  -\\n  [F]ind\\n  Find [N]ext\\n  [R]eplace\\n  [G]o To\\n  -\\n  Select [A]ll\\n  Time/[D]ate\\nF[o]rmat\\n  [W]ord Wrap\\n  [F]ont...\\n[V]iew\\n  [S]tatus Bar\\n[H]elp\\n  View [H]elp\\n  -\\n  [A]bout Notepad\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: function() {\n        var path, savedIndicator;\n        path = handlers.currentPath();\n        if (handlers.saved()) {\n          savedIndicator = \"\";\n        } else {\n          savedIndicator = \"*\";\n        }\n        if (path) {\n          path = \" - \" + path;\n        }\n        return \"Notepad.exe\" + path + savedIndicator;\n      },\n      content: textarea,\n      menuBar: menuBar.element,\n      width: 640,\n      height: 480\n    });\n    windowView.element.setAttribute(\"tabindex\", \"-1\");\n    windowView.element.addEventListener(\"keydown\", function(e) {\n      var ctrl, key;\n      ctrl = e.ctrlKey, key = e.key;\n      if (ctrl) {\n        switch (key) {\n          case \"s\":\n            e.preventDefault();\n            return handlers.save();\n          case \"o\":\n            e.preventDefault();\n            return handlers.open();\n        }\n      }\n    });\n    windowView.loadFile = handlers.loadFile;\n    return windowView;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/pixel": {
      "path": "apps/pixel",
      "content": "(function() {\n  var FileIO, IFrameApp, Model;\n\n  IFrameApp = require(\"../lib/iframe-app\");\n\n  FileIO = require(\"../os/file-io\");\n\n  Model = require(\"model\");\n\n  module.exports = function() {\n    var MenuBar, Modal, Observable, app, handlers, menuBar, parseMenu, _ref, _ref1;\n    _ref = system.UI, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Observable = _ref.Observable, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu);\n    handlers = Model().include(FileIO).extend({\n      loadFile: function(blob) {\n        return app.send(\"loadFile\", blob);\n      },\n      newFile: function() {},\n      saveData: function() {\n        return app.send(\"getBlob\");\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [N]ew\\n  [O]pen\\n  [S]ave\\n  Save [A]s\\n  -\\n  E[x]it\\n[H]elp\\n  View [H]elp\\n  -\\n  [A]bout\"),\n      handlers: handlers\n    });\n    app = IFrameApp({\n      title: Observable(\"Pixie Paint\"),\n      src: \"https://danielx.net/pixel-editor/\",\n      menuBar: menuBar,\n      handlers: handlers,\n      width: 640,\n      height: 480\n    });\n    app.handlers = handlers;\n    app.loadFile = handlers.loadFile;\n    system.Achievement.unlock(\"Pixel perfect\");\n    return app;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/spreadsheet": {
      "path": "apps/spreadsheet",
      "content": "(function() {\n  var FileIO, Model,\n    __slice = [].slice;\n\n  FileIO = require(\"../os/file-io\");\n\n  Model = require(\"model\");\n\n  module.exports = function() {\n    var ContextMenu, InputTemplate, MenuBar, Modal, Observable, Progress, RowElement, RowModel, Table, Window, element, handlers, headers, menuBar, models, parseMenu, sourceData, tableView, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Observable = _ref.Observable, Progress = _ref.Progress, Table = _ref.Table, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    system.Achievement.unlock(\"Microsoft Access 97\");\n    sourceData = [];\n    headers = [\"id\", \"name\", \"color\"];\n    RowModel = function(datum) {\n      var _ref2;\n      return (_ref2 = Model(datum)).attrObservable.apply(_ref2, headers);\n    };\n    models = sourceData.map(RowModel);\n    InputTemplate = require(\"../templates/input\");\n    RowElement = function(datum) {\n      var tr, types;\n      tr = document.createElement(\"tr\");\n      types = [\"number\", \"text\", \"color\"];\n      headers.forEach(function(key, i) {\n        var td;\n        td = document.createElement(\"td\");\n        td.appendChild(InputTemplate({\n          value: datum[key],\n          type: types[i]\n        }));\n        return tr.appendChild(td);\n      });\n      return tr;\n    };\n    element = (tableView = Table({\n      data: models,\n      RowElement: RowElement,\n      headers: headers\n    })).element;\n    handlers = Model().include(FileIO).extend({\n      loadFile: function(blob) {\n        return blob.readAsJSON().then(function(json) {\n          console.log(json);\n          if (!Array.isArray(json)) {\n            throw new Error(\"Data must be an array\");\n          }\n          sourceData = json;\n          models.splice.apply(models, [0, models.length].concat(__slice.call(sourceData.map(RowModel))));\n          return tableView.render();\n        });\n      },\n      newFile: function() {},\n      saveData: function() {\n        return Promise.resolve(new Blob([JSON.stringify(sourceData)], {\n          type: \"application/json\"\n        }));\n      },\n      about: function() {\n        return Modal.alert(\"Spreadsheet v0.0.1 by Daniel X Moore\");\n      },\n      insertRow: function() {\n        var datum;\n        datum = {\n          id: 0,\n          name: \"new\",\n          color: \"#FF00FF\"\n        };\n        sourceData.push(datum);\n        models.push(RowModel(datum));\n        return tableView.render();\n      },\n      exit: function() {\n        return windowView.element.remove();\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [N]ew\\n  [O]pen\\n  [S]ave\\n  Save [A]s\\n  -\\n  E[x]it\\nInsert\\n  Row -> insertRow\\nHelp\\n  About\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: \"MS Access 97 [DEMO VERSION]\",\n      content: element,\n      menuBar: menuBar.element,\n      width: 640,\n      height: 480\n    });\n    windowView.loadFile = handlers.loadFile;\n    return windowView;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/story-reader": {
      "path": "apps/story-reader",
      "content": "(function() {\n  module.exports = function(opts) {\n    var div, height, text, title, width;\n    title = opts.title, width = opts.width, height = opts.height, text = opts.text;\n    if (width == null) {\n      width = 380;\n    }\n    if (height == null) {\n      height = 480;\n    }\n    div = document.createElement(\"div\");\n    div.textContent = text;\n    div.style.padding = \"1em\";\n    div.style.whiteSpace = \"pre-wrap\";\n    div.style.textAlign = \"justify\";\n    return system.UI.Window({\n      title: title,\n      content: div,\n      width: width,\n      height: height\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "apps/text-editor": {
      "path": "apps/text-editor",
      "content": "(function() {\n  var FileIO, Model, extensionFor;\n\n  Model = require(\"model\");\n\n  FileIO = require(\"../os/file-io\");\n\n  ace.require(\"ace/ext/language_tools\");\n\n  extensionFor = require(\"../util\").extensionFor;\n\n  module.exports = function() {\n    var ContextMenu, MenuBar, Modal, Observable, Progress, Table, Window, aceEditor, aceElement, aceWrap, handlers, initSession, menuBar, mimeTypeFor, mode, modes, parseMenu, session, setModeFor, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Observable = _ref.Observable, Progress = _ref.Progress, Table = _ref.Table, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    system.Achievement.unlock(\"Notepad.exe\");\n    aceWrap = document.createElement(\"div\");\n    aceWrap.style.width = aceWrap.style.height = \"100%\";\n    aceElement = document.createElement(\"div\");\n    aceElement.style.width = aceElement.style.height = \"100%\";\n    aceWrap.appendChild(aceElement);\n    aceEditor = ace.edit(aceElement);\n    aceEditor.$blockScrolling = Infinity;\n    aceEditor.setOptions({\n      fontSize: \"16px\",\n      enableBasicAutocompletion: true,\n      enableLiveAutocompletion: true,\n      highlightActiveLine: true\n    });\n    session = aceEditor.getSession();\n    session.setUseSoftTabs(true);\n    session.setTabSize(2);\n    mode = \"coffee\";\n    session.setMode(\"ace/mode/\" + mode);\n    global.aceEditor = aceEditor;\n    modes = {\n      cson: \"coffeescript\",\n      jadelet: \"jade\",\n      js: \"javascript\",\n      md: \"markdown\",\n      styl: \"stylus\"\n    };\n    mimeTypeFor = function(path) {\n      var type;\n      type = system.mimeTypeFor(path);\n      return \"\" + type + \"; charset=utf-8\";\n    };\n    setModeFor = function(path) {\n      var extension;\n      extension = extensionFor(path);\n      mode = modes[extension] || extension;\n      return session.setMode(\"ace/mode/\" + mode);\n    };\n    initSession = function(file, path) {\n      return file.readAsText().then(function(content) {\n        if (path) {\n          handlers.currentPath(path);\n          setModeFor(path);\n        }\n        session.setValue(content);\n        return handlers.saved(true);\n      });\n    };\n    session.on(\"change\", function() {\n      return handlers.saved(false);\n    });\n    handlers = Model().include(FileIO).extend({\n      loadFile: initSession,\n      newFile: function() {\n        return session.setValue(\"\");\n      },\n      saveData: function() {\n        var data;\n        data = new Blob([session.getValue()], {\n          type: mimeTypeFor(handlers.currentPath())\n        });\n        return Promise.resolve(data);\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[F]ile\\n  [N]ew\\n  [O]pen\\n  [S]ave\\n  Save [A]s\\n  -\\n  E[x]it\\n[H]elp\\n  View [H]elp\\n  -\\n  [A]bout\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: function() {\n        var path, savedIndicator;\n        path = handlers.currentPath();\n        if (handlers.saved()) {\n          savedIndicator = \"\";\n        } else {\n          savedIndicator = \"*\";\n        }\n        if (path) {\n          path = \" - \" + path;\n        }\n        return \"Ace\" + path + savedIndicator;\n      },\n      content: aceWrap,\n      menuBar: menuBar.element,\n      width: 640,\n      height: 480\n    });\n    windowView.loadFile = initSession;\n    windowView.on(\"resize\", function() {\n      return aceEditor.resize();\n    });\n    windowView.element.setAttribute(\"tabindex\", \"-1\");\n    windowView.element.addEventListener(\"keydown\", function(e) {\n      var ctrl, key;\n      ctrl = e.ctrlKey, key = e.key;\n      if (ctrl) {\n        switch (key) {\n          case \"s\":\n            e.preventDefault();\n            return handlers.save();\n          case \"o\":\n            e.preventDefault();\n            return handlers.open();\n        }\n      }\n    });\n    return windowView;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "extensions": {
      "path": "extensions",
      "content": "(function() {\n  var _base,\n    __slice = [].slice,\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\n  PACKAGE.dependencies[\"_SYS_jadelet\"] = {\n    entryPoint: \"main\",\n    distribution: {\n      main: PACKAGE.distribution[\"lib/jadelet.min\"]\n    }\n  };\n\n  if (JSON.toBlob == null) {\n    JSON.toBlob = function(object) {\n      return new Blob([JSON.stringify(object)], {\n        type: \"application/json; charset=utf-8\"\n      });\n    };\n  }\n\n  Blob.prototype.readAsText = function() {\n    var file;\n    file = this;\n    return new Promise(function(resolve, reject) {\n      var reader;\n      reader = new FileReader;\n      reader.onload = function() {\n        return resolve(reader.result);\n      };\n      reader.onerror = reject;\n      return reader.readAsText(file);\n    });\n  };\n\n  Blob.prototype.getURL = function() {\n    return Promise.resolve(URL.createObjectURL(this));\n  };\n\n  Blob.prototype.readAsJSON = function() {\n    return this.readAsText().then(JSON.parse);\n  };\n\n  Blob.prototype.readAsDataURL = function() {\n    var file;\n    file = this;\n    return new Promise(function(resolve, reject) {\n      var reader;\n      reader = new FileReader;\n      reader.onload = function() {\n        return resolve(reader.result);\n      };\n      reader.onerror = reject;\n      return reader.readAsDataURL(file);\n    });\n  };\n\n  Image.fromBlob = function(blob) {\n    return blob.getURL().then(function(url) {\n      return new Promise(function(resolve, reject) {\n        var img;\n        img = new Image;\n        img.onload = function() {\n          return resolve(img);\n        };\n        img.onerror = reject;\n        return img.src = url;\n      });\n    });\n  };\n\n  if ((_base = FileList.prototype).forEach == null) {\n    _base.forEach = function() {\n      var args;\n      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n      return Array.prototype.forEach.apply(this, args);\n    };\n  }\n\n  if (__indexOf.call(Event.prototype, \"path\") < 0) {\n    Object.defineProperty(Event.prototype, \"path\", {\n      get: function() {\n        var currentElem, path;\n        path = [];\n        currentElem = this.target;\n        while (currentElem) {\n          path.push(currentElem);\n          currentElem = currentElem.parentElement;\n        }\n        if (path.indexOf(window) === -1 && path.indexOf(document) === -1) {\n          path.push(document);\n        }\n        if (path.indexOf(window) === -1) {\n          path.push(window);\n        }\n        return path;\n      }\n    });\n  }\n\n}).call(this);\n",
      "type": "blob"
    },
    "feedback": {
      "path": "feedback",
      "content": "(function() {\n  module.exports = function() {\n    var Window, iframe, windowView;\n    iframe = document.createElement(\"iframe\");\n    iframe.src = \"https://docs.google.com/forms/d/e/1FAIpQLSfAK8ZYmMd4-XsDqyTK4soYGWApGD9R33nReuqwG-TxjXaGFg/viewform?embedded=true\";\n    Window = system.UI.Window;\n    windowView = Window({\n      title: \"Whimsy Space Feedback\",\n      content: iframe,\n      menuBar: null,\n      width: 600,\n      height: 500\n    });\n    system.Achievement.unlock(\"We value your input\");\n    return document.body.appendChild(windowView.element);\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "issues/2016-12": {
      "path": "issues/2016-12",
      "content": "(function() {\n  var Ajax, CommentFormTemplate, CommentsTemplate, Notepad, ajax, issueTag;\n\n  Notepad = require(\"../apps/notepad\");\n\n  CommentFormTemplate = require(\"../social/comment-form\");\n\n  CommentsTemplate = require(\"../social/comments\");\n\n  Ajax = require(\"ajax\");\n\n  ajax = Ajax();\n\n  issueTag = \"2016-12\";\n\n  module.exports = function() {\n    var ContextMenu, MenuBar, Modal, Progress, Window, handlers, img, menuBar, parseMenu, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    system.Achievement.unlock(\"Issue 1\");\n    img = document.createElement(\"img\");\n    img.src = \"https://68.media.tumblr.com/6a141d69564a29ac7d4071df5d519808/tumblr_o0rbb4TA1k1urr1ryo1_500.gif\";\n    handlers = {\n      waitAroundForABit: function() {\n        var initialMessage, intervalId, progressView;\n        initialMessage = \"Waiting\";\n        progressView = Progress({\n          value: 0,\n          max: 2,\n          message: initialMessage\n        });\n        Modal.show(progressView.element, {\n          cancellable: false\n        });\n        return intervalId = setInterval(function() {\n          var ellipses, ellipsesCount, newValue, _i, _results;\n          newValue = progressView.value() + 1 / 60;\n          ellipsesCount = Math.floor(newValue * 4) % 4;\n          ellipses = (function() {\n            _results = [];\n            for (var _i = 0; 0 <= ellipsesCount ? _i < ellipsesCount : _i > ellipsesCount; 0 <= ellipsesCount ? _i++ : _i--){ _results.push(_i); }\n            return _results;\n          }).apply(this).map(function() {\n            return \".\";\n          }).join(\"\");\n          progressView.value(newValue);\n          progressView.message(initialMessage + ellipses);\n          if (newValue > 2) {\n            system.Achievement.unlock(\"No rush\");\n            clearInterval(intervalId);\n            return Modal.hide();\n          }\n        }, 15);\n      },\n      comment: function() {\n        return Modal.form(CommentFormTemplate({\n          area: issueTag\n        })).then(function(data) {\n          return ajax({\n            url: \"https://whimsy-space.glitch.me/comments\",\n            data: JSON.stringify(data),\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            method: \"POST\"\n          });\n        }).then(function() {\n          return handlers.viewComments();\n        });\n      },\n      viewComments: function() {\n        return ajax.getJSON(\"https://whimsy-space.glitch.me/comments/\" + issueTag).then(function(data) {\n          data = data.reverse();\n          if (data.length === 0) {\n            data = [\n              {\n                body: \"no comments\",\n                author: \"mgmt\"\n              }\n            ];\n          }\n          return Modal.show(CommentsTemplate(data));\n        });\n      },\n      like: function() {\n        return Modal.alert(\"I like you too, but we don't have a facebook or anything yet :)\");\n      },\n      subscribe: function() {\n        return require(\"../mailchimp\").show();\n      },\n      notepadexe: function() {\n        var app;\n        app = Notepad();\n        return document.body.appendChild(app.element);\n      },\n      mSAccess97: function() {\n        var app;\n        app = Spreadsheet();\n        return document.body.appendChild(app.element);\n      },\n      mysterySmell: function() {\n        var div, storyWindow;\n        system.Achievement.unlock(\"Cover-2-cover\");\n        div = document.createElement(\"div\");\n        div.textContent = require(\"../stories/mystery-smell\");\n        div.style.padding = \"1em\";\n        div.style.whiteSpace = \"pre-wrap\";\n        div.style.textAlign = \"justify\";\n        storyWindow = Window({\n          title: \"Mystery Smell\",\n          content: div,\n          width: 380,\n          height: 480\n        });\n        return document.body.appendChild(storyWindow.element);\n      }\n    };\n    menuBar = MenuBar({\n      items: parseMenu(\"[H]ello\\n  [W]ait Around For A Bit\\n[A]pps\\n  [N]otepad.exe\\n[S]tories\\n  [M]ystery Smell\\nS[o]cial Media\\n  [V]iew Comments\\n  [C]omment\\n  [L]ike\\n  [S]ubscribe\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: \"ZineOS Volume 1 | Issue 1 | December 2016\",\n      content: img,\n      menuBar: menuBar.element,\n      width: 508,\n      height: 604\n    });\n    return document.body.appendChild(windowView.element);\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "issues/2017-02": {
      "path": "issues/2017-02",
      "content": "(function() {\n  var Achievement, Chateau, Model, PixiePaint, Social, Spreadsheet, TextEditor, emptyElement, parentElementOfType, _ref;\n\n  Achievement = require(\"../lib/achievement\");\n\n  Model = require(\"model\");\n\n  Chateau = require(\"../apps/chateau\");\n\n  PixiePaint = require(\"../apps/pixel\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  TextEditor = require(\"../apps/text-editor\");\n\n  Social = require(\"../social/social\");\n\n  _ref = require(\"../util\"), parentElementOfType = _ref.parentElementOfType, emptyElement = _ref.emptyElement;\n\n  module.exports = function() {\n    var ContextMenu, MenuBar, Modal, Progress, Window, container, currentPage, displayPage, handlers, menuBar, nextPage, pages, parseMenu, visited, windowView, _ref1, _ref2;\n    _ref1 = system.UI, ContextMenu = _ref1.ContextMenu, MenuBar = _ref1.MenuBar, Modal = _ref1.Modal, Progress = _ref1.Progress, (_ref2 = _ref1.Util, parseMenu = _ref2.parseMenu), Window = _ref1.Window;\n    container = document.createElement(\"container\");\n    system.Achievement.unlock(\"Issue 2\");\n    system.writeFile(\"issue-2/around.md\", new Blob([require(\"../stories/around-the-world\")], {\n      type: \"text/markdown\"\n    }));\n    system.writeFile(\"issue-2/provision.txt\", new Blob([require(\"../stories/provision\")], {\n      type: \"text/plain\"\n    }));\n    system.writeFile(\"issue-2/dungeon-dog.txt\", new Blob([require(\"../stories/dungeon-dog\")], {\n      type: \"text/plain\"\n    }));\n    system.writeFile(\"issue-2/dsad.exe\", new Blob([\"\"], {\n      type: \"application/exe\"\n    }));\n    pages = {\n      front: \"a(href=\\\"#vista\\\")\\n  img(src=\\\"https://s-media-cache-ak0.pinimg.com/originals/a3/ba/56/a3ba56cef667d14b54023cd624d4e070.jpg\\\")\",\n      vista: \"a(href=\\\"#table\\\")\\n  img(width=640 height=\\\"auto\\\" src=\\\"https://books.google.com/books/content?id=2cgDAAAAMBAJ&rview=1&pg=PA10&img=1&zoom=3&hl=en&sig=ACfU3U3477L46r0KxSQusJrQ6w9qxIQ70w&w=1280\\\")\",\n      table: \"div(style=\\\"padding: 1em;\\\")\\n  h1 Table of Contents\\n  ul\\n    li\\n      a(href=\\\"#front\\\") Cover\\n    li\\n      a(href=\\\"#vista\\\") Excerpt from Windows Vista Magazine\\n    li\\n      a(href=\\\"#table\\\") Table of Contents\\n    li\\n      a(href=\\\"#random\\\") Random Thoughts\\n    li\\n      a(href=\\\"#cheevos\\\") Cheevos\\n    li\\n      a(href=\\\"#contributors\\\") Contributors\",\n      random: \"div(style=\\\"padding: 1em;\\\")\\n  h1 Random Thoughts\\n  p Don't you hate it when you're cooking something and you look at the stove clock and think it's 3:75 and you're late for your appointment but it was just the temperature and also 3:75 isn't even a real time?\\n  p I suggest you bone up a bit on torts before the next attempt at the bar exam.\\n  p Does anyone remember thepalace.com avatar based chat and virtual worlds?\\n  p Those spreadsheets you like are going back in style.\",\n      cheevos: \"div(style=\\\"padding: 1em;\\\")\\n  h1 Cheevos\\n\\n  p No matter if you guy/girl or whatever, Cheevos impress people. It's almost like saying 'Well, I got tons of Cheevos. There are tons of people online that are interested and respect me.\\\"\\n\\n  p You might be thinking 'Oh that's complete BS, I personally don't care about Cheevos when dating'. And yeah, you are probably telling the truth, but it's in your sub-concious.  Sort of like how girls always like the bad guy, but never admit it.\\n\\n  p Braggin about your Cheevos sometimes makes you look conceited, but that's a good thing.  It like how celebraties look conceited because they're rolling VIP into clubs and you're stuck in line.\\n\\n  p 'Brewer' asks 'What happens if you're cheevo talking at a bar, club or party and someone says they have more cheevos that you?'\\n\\n  p Well, hopefully they are just hating and are lying. First look up their score with your cellphone, make sure you have a page bookmarked where you can check. If you catch them in a lie, you look even better. If they are telling the truth and have more Cheevos than you, leave. Nothing else you can do. Buy the person a drink and leave, unless you're willing to look 2nd best. If you brought a date, odds are she's going to be impressed with the higher gamer score and ditch you. Get out as soon as you can and go to some other party.\\n\\n  p\\n    a(href=\\\"http://cheevos.com\\\") Learn more about cheevos from Bboy360 at cheevos.com\\n\",\n      contributors: \"div(style=\\\"padding: 1em;\\\")\\n  h1 Contributors\\n  ul\\n    li Daniel X\\n    li Lan\\n    li pketh\\n    li Mayor\\n    li and you!\\n\\n  p\\n    a(href=\\\"#table\\\") Return to table of contents\"\n    };\n    Object.keys(pages).forEach(function(pageName) {\n      var value;\n      value = pages[pageName];\n      return pages[pageName] = system.compileTemplate(value)({});\n    });\n    pages.cheevos.appendChild(system.Achievement.progressView());\n    handlers = Model().include(Social).extend({\n      area: function() {\n        return \"2017-01\";\n      },\n      mSAccess97: function() {\n        var app;\n        app = Spreadsheet(system);\n        return document.body.appendChild(app.element);\n      },\n      textEditor: function() {\n        var app;\n        app = TextEditor(system);\n        return document.body.appendChild(app.element);\n      },\n      pixiePaint: function() {\n        var app;\n        app = PixiePaint(system);\n        return document.body.appendChild(app.element);\n      },\n      chateau: function() {\n        var app;\n        app = Chateau(system);\n        return document.body.appendChild(app.element);\n      },\n      credits: function() {\n        return displayPage(\"contributors\");\n      },\n      tableofContents: function() {\n        return displayPage(\"table\");\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[A]pps\\n  [T]ext Editor\\n  [P]ixie Paint\\n\" + Social.menuText + \"\\nH[e]lp\\n  [T]able of Contents\\n  [C]redits\"),\n      handlers: handlers\n    });\n    windowView = Window({\n      title: \"ZineOS Volume 1 | Issue 2 | ENTER THE DUNGEON | February 2017\",\n      content: container,\n      menuBar: menuBar.element,\n      width: 1228,\n      height: 936,\n      x: 32,\n      y: 32\n    });\n    windowView.element.addEventListener(\"click\", function(e) {\n      var anchor, next, page;\n      anchor = parentElementOfType(\"a\", e.target);\n      if (anchor) {\n        next = anchor.getAttribute('href');\n        if (next.match(/^\\#/)) {\n          e.preventDefault();\n          page = next.substr(1);\n          return displayPage(page);\n        }\n      }\n    });\n    currentPage = \"front\";\n    visited = {};\n    displayPage = function(page) {\n      if (!page) {\n        return;\n      }\n      visited[page] = true;\n      if (Object.keys(visited).length === Object.keys(pages).length) {\n        system.Achievement.unlock(\"Cover-2-cover 2: 2 cover 2 furious\");\n      }\n      if (page === \"vista\") {\n        system.Achievement.unlock(\"Lol wut\");\n      }\n      if (page === \"cheevos\") {\n        system.Achievement.unlock(\"Check yo' self\");\n      }\n      emptyElement(container);\n      container.appendChild(pages[page]);\n      return currentPage = page;\n    };\n    displayPage(currentPage);\n    nextPage = function(n) {\n      var nextIndex, pageKeys;\n      if (n == null) {\n        n = 1;\n      }\n      pageKeys = Object.keys(pages);\n      nextIndex = pageKeys.indexOf(currentPage) + n;\n      return pageKeys[nextIndex];\n    };\n    windowView.element.addEventListener(\"keydown\", function(e) {\n      switch (e.key) {\n        case \"Enter\":\n        case \"ArrowRight\":\n        case \" \":\n          return displayPage(nextPage());\n        case \"ArrowLeft\":\n          return displayPage(nextPage(-1));\n      }\n    });\n    document.body.appendChild(windowView.element);\n    windowView.element.tabIndex = 0;\n    return windowView.element.focus();\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "issues/2017-03": {
      "path": "issues/2017-03",
      "content": "(function() {\n  var Chateau, Contrasaurus, Model, PixiePaint, Social, Spreadsheet, StoryWindow, TextEditor, emptyElement, parentElementOfType, _ref;\n\n  Model = require(\"model\");\n\n  Chateau = require(\"../apps/chateau\");\n\n  Contrasaurus = require(\"../apps/contrasaurus\");\n\n  PixiePaint = require(\"../apps/pixel\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  TextEditor = require(\"../apps/text-editor\");\n\n  Social = require(\"../social/social\");\n\n  _ref = require(\"../util\"), parentElementOfType = _ref.parentElementOfType, emptyElement = _ref.emptyElement;\n\n  module.exports = function() {\n    var Achievement, ContextMenu, MenuBar, Modal, Progress, Window, handlers, kmartGif, menuBar, parseMenu, visit, visitedAreas, windowView, _ref1, _ref2;\n    _ref1 = system.UI, ContextMenu = _ref1.ContextMenu, MenuBar = _ref1.MenuBar, Modal = _ref1.Modal, Progress = _ref1.Progress, (_ref2 = _ref1.Util, parseMenu = _ref2.parseMenu), Window = _ref1.Window;\n    Achievement = system.Achievement;\n    visitedAreas = {\n      blue: false,\n      csaur: false,\n      chateau: false,\n      cheevo: false,\n      evan: false\n    };\n    visit = function(area) {\n      var visitedAll;\n      visitedAreas[area] = true;\n      visitedAll = Object.keys(visitedAreas).every(function(key) {\n        return visitedAreas[key];\n      });\n      if (visitedAll) {\n        return Achievement.unlock(\"Cover-2-cover 3: Tokyo Drift\");\n      }\n    };\n    system.writeFile(\"issue-3/blue-light-special.txt\", new Blob([require(\"../stories/blue-light-special\")], {\n      type: \"text/plain\"\n    }));\n    system.Achievement.unlock(\"Issue 3\");\n    handlers = Model().include(Social).extend({\n      area: function() {\n        return \"2017-03\";\n      },\n      mSAccess97: function() {\n        var app;\n        app = Spreadsheet(system);\n        return document.body.appendChild(app.element);\n      },\n      chateau: function() {\n        var app;\n        visit(\"chateau\");\n        app = Chateau(system);\n        return document.body.appendChild(app.element);\n      },\n      contrasaurus: function() {\n        visit(\"csaur\");\n        return document.body.appendChild(Contrasaurus().element);\n      },\n      achievementStatus: function() {\n        var cheevoElement, windowView;\n        visit(\"cheevo\");\n        cheevoElement = system.Achievement.progressView();\n        cheevoElement.style.width = \"100%\";\n        cheevoElement.style.padding = \"1em\";\n        system.Achievement.unlock(\"Check yo' self\");\n        windowView = Window({\n          title: \"Cheevos\",\n          content: cheevoElement,\n          width: 640,\n          height: 480\n        });\n        return document.body.appendChild(windowView.element);\n      },\n      evanAndMore: function() {\n        var element, img, url;\n        visit(\"evan\");\n        url = \"https://s3.amazonaws.com/whimsyspace-databucket-1g3p6d9lcl6x1/danielx/IMG_9794.JPG\";\n        img = document.createElement(\"img\");\n        img.src = url;\n        element = system.UI.Window({\n          title: \"Evan And More\",\n          content: img,\n          width: 600,\n          height: 480\n        }).element;\n        return document.body.appendChild(element);\n      },\n      blueLightSpecial: function() {\n        var storyWindow;\n        Achievement.unlock(\"Blue light special\");\n        visit(\"blue\");\n        storyWindow = StoryWindow(\"Blue Light Special\", require(\"../stories/blue-light-special\"));\n        return document.body.appendChild(storyWindow.element);\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[A]pps\\n  [C]hateau\\n  Contra[s]aurus\\n[S]tories\\n  [B]lue Light Special\\n  [E]van And More\\n\" + Social.menuText + \"\\n[H]elp\\n  [A]chievement Status\"),\n      handlers: handlers\n    });\n    kmartGif = document.createElement(\"img\");\n    kmartGif.src = \"http://media.boingboing.net/wp-content/uploads/2015/07/m66DBJ.gif\";\n    kmartGif.style = \"width: 100%; height: 100%\";\n    windowView = Window({\n      title: \"ZineOS Volume 1 | Issue 3 | ATTN: K-Mart Shoppers | March 2017\",\n      content: kmartGif,\n      menuBar: menuBar.element,\n      width: 800,\n      height: 600,\n      x: 32,\n      y: 32\n    });\n    return document.body.appendChild(windowView.element);\n  };\n\n  StoryWindow = function(title, text) {\n    var div;\n    div = document.createElement(\"div\");\n    div.textContent = text;\n    div.style.padding = \"1em\";\n    div.style.whiteSpace = \"pre-wrap\";\n    div.style.textAlign = \"justify\";\n    return system.UI.Window({\n      title: title,\n      content: div,\n      width: 380,\n      height: 480\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "issues/2017-04": {
      "path": "issues/2017-04",
      "content": "(function() {\n  var Chateau, Contrasaurus, Model, MyBriefcase, PixiePaint, Social, Spreadsheet, StoryWindow, TextEditor, emptyElement, parentElementOfType, writeIfNotPresent, _ref;\n\n  Model = require(\"model\");\n\n  Chateau = require(\"../apps/chateau\");\n\n  Contrasaurus = require(\"../apps/contrasaurus\");\n\n  PixiePaint = require(\"../apps/pixel\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  TextEditor = require(\"../apps/text-editor\");\n\n  MyBriefcase = require(\"../apps/my-briefcase\");\n\n  Social = require(\"../social/social\");\n\n  _ref = require(\"../util\"), parentElementOfType = _ref.parentElementOfType, emptyElement = _ref.emptyElement;\n\n  writeIfNotPresent = function(destination, sourceURL) {\n    return system.readFile(destination).then(function(file) {\n      if (!file) {\n        throw new Error(\"File not found\");\n      }\n      return file;\n    })[\"catch\"](function() {\n      return ajax({\n        url: sourceURL,\n        responseType: \"blob\"\n      }).then(function(blob) {\n        return system.writeFile(destination, blob);\n      });\n    });\n  };\n\n  module.exports = function() {\n    var Achievement, ContextMenu, MenuBar, Modal, Progress, Window, ajax, content, downloadBikes, handlers, img, menuBar, parseMenu, visit, visitedAreas, windowView, _ref1, _ref2;\n    _ref1 = system.UI, ContextMenu = _ref1.ContextMenu, MenuBar = _ref1.MenuBar, Modal = _ref1.Modal, Progress = _ref1.Progress, (_ref2 = _ref1.Util, parseMenu = _ref2.parseMenu), Window = _ref1.Window;\n    Achievement = system.Achievement, ajax = system.ajax;\n    visitedAreas = {\n      bikes: false,\n      izzy: false,\n      residue: false,\n      chateau: false,\n      cheevo: false,\n      briefcase: false,\n      podcast: false\n    };\n    visit = function(area) {\n      var visitedAll;\n      visitedAreas[area] = true;\n      visitedAll = Object.keys(visitedAreas).every(function(key) {\n        return visitedAreas[key];\n      });\n      if (visitedAll) {\n        return Achievement.unlock(\"Cover-2-cover 4: Fast & Furious\");\n      }\n    };\n    system.writeFile(\"issue-4/izzy.txt\", new Blob([require(\"../stories/izzy\")], {\n      type: \"text/plain\"\n    }));\n    system.writeFile(\"issue-4/residue.txt\", new Blob([require(\"../stories/residue\")], {\n      type: \"text/plain\"\n    }));\n    downloadBikes = function() {\n      return [\"and-yet-they-rode-bikes.md\", \"infog.png\", \"lanes.png\", \"totally-a.html\"].forEach(function(path) {\n        var filePath;\n        filePath = \"issue-4/bikes/\" + path;\n        return writeIfNotPresent(filePath, \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/bikes/\" + path);\n      });\n    };\n    downloadBikes();\n    writeIfNotPresent(\"issue-4/Funkytown.mp3\", \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/music/Funkytown.mp3\").then(function() {\n      return system.openPath(\"issue-4/Funkytown.mp3\");\n    });\n    writeIfNotPresent(\"issue-4/zinecast1.mp3\", \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/podcasts/zinecast1.mp3\");\n    system.Achievement.unlock(\"Issue 4\");\n    handlers = Model().include(Social).extend({\n      area: function() {\n        return \"2017-04\";\n      },\n      zinecast1: function() {\n        visit(\"podcast\");\n        return system.readFile(\"issue-4/zinecast1.mp3\").then(system.open);\n      },\n      bikes: function() {\n        visit(\"bikes\");\n        return system.readFile(\"issue-4/bikes/and-yet-they-rode-bikes.md\").then(system.open);\n      },\n      chateau: function() {\n        var app;\n        visit(\"chateau\");\n        app = Chateau(system);\n        return document.body.appendChild(app.element);\n      },\n      achievementStatus: function() {\n        var cheevoElement, windowView;\n        visit(\"cheevo\");\n        cheevoElement = system.Achievement.progressView();\n        cheevoElement.style.width = \"100%\";\n        cheevoElement.style.padding = \"1em\";\n        system.Achievement.unlock(\"Check yo' self\");\n        windowView = Window({\n          title: \"Cheevos\",\n          content: cheevoElement,\n          width: 640,\n          height: 480\n        });\n        return document.body.appendChild(windowView.element);\n      },\n      myBriefcase: function() {\n        var app;\n        visit(\"briefcase\");\n        app = MyBriefcase();\n        return document.body.appendChild(app.element);\n      },\n      izzy: function() {\n        var storyWindow;\n        Achievement.unlock(\"Izzy\");\n        visit(\"izzy\");\n        storyWindow = StoryWindow(\"Izzy\", require(\"../stories/izzy\"));\n        return document.body.appendChild(storyWindow.element);\n      },\n      residue: function() {\n        var storyWindow;\n        Achievement.unlock(\"Residue\");\n        visit(\"residue\");\n        storyWindow = StoryWindow(\"Residue\", require(\"../stories/residue\"));\n        return document.body.appendChild(storyWindow.element);\n      },\n      funkytown8bitRemix: function() {\n        return system.readFile(\"issue-4/Funkytown.mp3\").then(system.open);\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[A]pps\\n  [C]hateau\\n  My [B]riefcase\\n[M]usic\\n  [F]unkytown (8-bit Remix)\\n  [Z]inecast 1\\n[S]tories\\n  [B]ikes\\n  [I]zzy\\n  [R]esidue\\n\" + Social.menuText + \"\\n[H]elp\\n  [A]chievement Status\"),\n      handlers: handlers\n    });\n    content = document.createElement(\"content\");\n    content.style = \"width: 100%; height: 100%\";\n    img = document.createElement(\"img\");\n    img.src = \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/images/708e9398a4b4bea08d7c61ff7a0f863f.gif\";\n    img.style = \"width: 100%; height: 100%\";\n    windowView = Window({\n      title: \"ZineOS Volume 1 | Issue 4 | DISCO TECH | April 2017\",\n      content: img,\n      menuBar: menuBar.element,\n      width: 480,\n      height: 600,\n      x: 64,\n      y: 64\n    });\n    windowView.element.querySelector('viewport').style.overflow = \"initial\";\n    return document.body.appendChild(windowView.element);\n  };\n\n  StoryWindow = function(title, text) {\n    var div;\n    div = document.createElement(\"div\");\n    div.textContent = text;\n    div.style.padding = \"1em\";\n    div.style.whiteSpace = \"pre-wrap\";\n    div.style.textAlign = \"justify\";\n    return system.UI.Window({\n      title: title,\n      content: div,\n      width: 380,\n      height: 480\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "issues/2017-05": {
      "path": "issues/2017-05",
      "content": "(function() {\n  var AchievementStatus, Chateau, Contrasaurus, Model, MyBriefcase, PixiePaint, Social, Spreadsheet, StoryReader, TextEditor;\n\n  Model = require(\"model\");\n\n  AchievementStatus = require(\"../apps/achievement-status\");\n\n  Chateau = require(\"../apps/chateau\");\n\n  Contrasaurus = require(\"../apps/contrasaurus\");\n\n  PixiePaint = require(\"../apps/pixel\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  TextEditor = require(\"../apps/text-editor\");\n\n  MyBriefcase = require(\"../apps/my-briefcase\");\n\n  StoryReader = require(\"../apps/story-reader\");\n\n  Social = require(\"../social/social\");\n\n  module.exports = function() {\n    var Achievement, ContextMenu, MenuBar, Modal, Progress, Window, ajax, ggPath, handlers, img, menuBar, parseMenu, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    Achievement = system.Achievement, ajax = system.ajax;\n    ggPath = \"issue-5/gleep-glorp.m4a\";\n    system.readFile(ggPath).then(function(file) {\n      if (!file) {\n        throw new Error(\"File not found\");\n      }\n    })[\"catch\"](function() {\n      return ajax({\n        url: \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/hao/gleep-glorp.m4a\",\n        responseType: \"blob\"\n      }).then(function(blob) {\n        return system.writeFile(ggPath, blob);\n      });\n    });\n    handlers = Model().include(Social).extend({\n      area: function() {\n        return \"2017-05\";\n      },\n      achievementStatus: function() {\n        return system.launchApp(AchievementStatus);\n      },\n      chateau: function() {\n        return system.launchApp(Chateau);\n      },\n      crescent: function() {\n        var app;\n        app = StoryReader({\n          text: require(\"../stories/crescent\"),\n          title: \"Crescent\"\n        });\n        return document.body.appendChild(app.element);\n      },\n      gleepGlorp: function() {\n        return system.openPath(ggPath);\n      },\n      marigold: function() {\n        var app;\n        app = StoryReader({\n          text: require(\"../stories/marigold\"),\n          title: \"Marigold\"\n        });\n        return document.body.appendChild(app.element);\n      },\n      myBriefcase: function() {\n        return system.launchApp(MyBriefcase);\n      },\n      pixiePaint: function() {\n        return system.launchApp(PixiePaint);\n      },\n      textEditor: function() {\n        return system.launchApp(TextEditor);\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[A]pps\\n  [C]hateau\\n  My [B]riefcase\\n  [P]ixie Paint\\n  [T]ext Editor\\n[C]ontent\\n  [C]rescent\\n  [G]leep Glorp\\n  [M]arigold\\n\" + Social.menuText + \"\\n[H]elp\\n  [A]chievement Status\"),\n      handlers: handlers\n    });\n    img = document.createElement(\"img\");\n    img.src = \"https://i.imgur.com/hKOGoex.jpg\";\n    img.style = \"width: 100%; height: 100%\";\n    windowView = Window({\n      title: \"ZineOS Volume 1 | Issue 5 | A May Zine | May 2017\",\n      content: img,\n      menuBar: menuBar.element,\n      width: 640,\n      height: 360,\n      x: 64,\n      y: 64\n    });\n    windowView.element.querySelector('viewport').style.overflow = \"initial\";\n    return document.body.appendChild(windowView.element);\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "issues/2017-06": {
      "path": "issues/2017-06",
      "content": "(function() {\n  var AchievementStatus, Chateau, Contrasaurus, Model, MyBriefcase, PixiePaint, Social, Spreadsheet, StoryReader, TextEditor, fetchContent;\n\n  Model = require(\"model\");\n\n  AchievementStatus = require(\"../apps/achievement-status\");\n\n  Chateau = require(\"../apps/chateau\");\n\n  Contrasaurus = require(\"../apps/contrasaurus\");\n\n  PixiePaint = require(\"../apps/pixel\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  TextEditor = require(\"../apps/text-editor\");\n\n  MyBriefcase = require(\"../apps/my-briefcase\");\n\n  StoryReader = require(\"../apps/story-reader\");\n\n  Social = require(\"../social/social\");\n\n  fetchContent = function(targetFile, sourcePath) {\n    var targetPath;\n    if (sourcePath == null) {\n      sourcePath = targetFile;\n    }\n    targetPath = \"/issue-6/\" + targetFile;\n    return system.readFile(targetPath).then(function(file) {\n      if (!file) {\n        throw new Error(\"File not found\");\n      }\n    })[\"catch\"](function() {\n      return system.ajax({\n        url: \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/\" + sourcePath,\n        responseType: \"blob\"\n      }).then(function(blob) {\n        return system.writeFile(targetPath, blob);\n      });\n    });\n  };\n\n  module.exports = function() {\n    var Achievement, ContextMenu, MenuBar, Modal, Progress, Window, ajax, handlers, img, launch, menuBar, parseMenu, windowView, _ref, _ref1;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Progress = _ref.Progress, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Window = _ref.Window;\n    Achievement = system.Achievement, ajax = system.ajax;\n    fetchContent(\"bee.md\");\n    fetchContent(\"tree.md\");\n    system.Achievement.unlock(\"Issue 6\");\n    launch = function(App) {\n      return system.attachApplication(App());\n    };\n    handlers = Model().include(Social).extend({\n      area: function() {\n        return \"2017-06\";\n      },\n      bee: function() {\n        system.Achievement.unlock(\"Bee afraid\");\n        return system.openPath(\"/issue-6/bee.md\");\n      },\n      tree: function() {\n        system.Achievement.unlock(\"Tree story\");\n        return system.openPath(\"/issue-6/tree.md\");\n      },\n      achievementStatus: function() {\n        return launch(AchievementStatus);\n      },\n      chateau: function() {\n        return launch(Chateau);\n      },\n      crescent: function() {\n        var app;\n        app = StoryReader({\n          text: require(\"../stories/crescent\"),\n          title: \"Crescent\"\n        });\n        return document.body.appendChild(app.element);\n      },\n      marigold: function() {\n        var app;\n        app = StoryReader({\n          text: require(\"../stories/marigold\"),\n          title: \"Marigold\"\n        });\n        return document.body.appendChild(app.element);\n      },\n      myBriefcase: function() {\n        return launch(MyBriefcase);\n      },\n      pixiePaint: function() {\n        return launch(PixiePaint);\n      },\n      textEditor: function() {\n        return launch(TextEditor);\n      }\n    });\n    menuBar = MenuBar({\n      items: parseMenu(\"[A]pps\\n  [C]hateau\\n  My [B]riefcase\\n  [P]ixie Paint\\n  [T]ext Editor\\n[C]ontent\\n  [B]ee\\n  [T]ree\\n\" + Social.menuText + \"\\n[H]elp\\n  [A]chievement Status\"),\n      handlers: handlers\n    });\n    img = document.createElement(\"img\");\n    img.src = \"https://forgettheprotocol.com/wp-content/uploads/2017/04/09-bee-movie.w536.h357.2x.jpg\";\n    img.style = \"width: 100%; height: 100%\";\n    windowView = Window({\n      title: \"WhimsySpace Volume 1 | Episode 6 | Summertime Radness | June 2017\",\n      content: img,\n      iconEmoji: \"🐝\",\n      menuBar: menuBar.element,\n      width: 536 + 8,\n      height: 357 + 46,\n      x: 64,\n      y: 64\n    });\n    windowView.element.querySelector('viewport').style.overflow = \"initial\";\n    return document.body.appendChild(windowView.element);\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/achievement": {
      "path": "lib/achievement",
      "content": "(function() {\n  var Achievement, AchievementTemplate, audioPath, displaying, pending, playSound;\n\n  AchievementTemplate = require(\"../templates/achievement\");\n\n  pending = [];\n\n  displaying = false;\n\n  audioPath = \"https://cdn.gomix.com/294e834f-223f-4792-9323-5b1fa8d0402b/unlock2.mp3\";\n\n  playSound = function() {\n    var audio;\n    audio = new Audio(audioPath);\n    audio.autoplay = true;\n    return audio;\n  };\n\n  module.exports = Achievement = {\n    display: function(options) {\n      var achievementElement;\n      if (options == null) {\n        options = {};\n      }\n      if (displaying) {\n        return pending.push(options);\n      }\n      if (options.title == null) {\n        options.title = \"Achievement Unlocked\";\n      }\n      achievementElement = AchievementTemplate(options);\n      document.body.appendChild(achievementElement);\n      achievementElement.classList.add(\"display\");\n      achievementElement.appendChild(playSound());\n      displaying = true;\n      achievementElement.addEventListener(\"animationend\", function(e) {\n        achievementElement.remove();\n        displaying = false;\n        if (pending.length) {\n          return Achievement.display(pending.shift());\n        }\n      }, false);\n      return achievementElement;\n    }\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/app-drop": {
      "path": "lib/app-drop",
      "content": "(function() {\n  var Drop, fileFromDropEvent;\n\n  Drop = require(\"./drop\");\n\n  fileFromDropEvent = require(\"../util\").fileFromDropEvent;\n\n  module.exports = function(app) {\n    var element;\n    element = app.element;\n    return Drop(element, function(e) {\n      var handlers;\n      handlers = app.handlers;\n      return fileFromDropEvent(e).then(function(file) {\n        var path;\n        if (file) {\n          path = file.path;\n          return handlers.loadFile(file).then(function() {\n            if (path) {\n              return handlers.currentPath(path);\n            } else {\n              return handlers.currentPath(null);\n            }\n          });\n        } else {\n          return handlers.currentPath(null);\n        }\n      });\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/dexie-fs": {
      "path": "lib/dexie-fs",
      "content": "(function() {\n  var Bindable, FolderEntry, Model;\n\n  Bindable = require(\"bindable\");\n\n  Model = require(\"model\");\n\n  FolderEntry = function(path, prefix) {\n    return {\n      folder: true,\n      path: prefix + path,\n      relativePath: path\n    };\n  };\n\n  module.exports = function(db) {\n    var Files, notify, self;\n    Files = db.files;\n    notify = function(eventType, path) {\n      return function(result) {\n        self.trigger(eventType, path);\n        return result;\n      };\n    };\n    return self = Model().include(Bindable).extend({\n      read: function(path) {\n        return Files.get(path).then(function(result) {\n          return result != null ? result.blob : void 0;\n        }).then(notify(\"read\", path));\n      },\n      write: function(path, blob) {\n        var now;\n        now = +(new Date);\n        return Files.put({\n          path: path,\n          blob: blob,\n          size: blob.size,\n          type: blob.type,\n          createdAt: now,\n          updatedAt: now\n        }).then(notify(\"write\", path));\n      },\n      \"delete\": function(path) {\n        return Files[\"delete\"](path).then(notify(\"delete\", path));\n      },\n      list: function(dir) {\n        return Files.where(\"path\").startsWith(dir).toArray().then(function(files) {\n          var folderPaths, folders;\n          folderPaths = {};\n          files = files.filter(function(file) {\n            var folderPath;\n            file.relativePath = file.path.replace(dir, \"\");\n            if (file.relativePath.match(/\\//)) {\n              folderPath = file.relativePath.replace(/\\/.*$/, \"/\");\n              folderPaths[folderPath] = true;\n            } else {\n              return file;\n            }\n          });\n          folders = Object.keys(folderPaths).map(function(folderPath) {\n            return FolderEntry(folderPath, dir);\n          });\n          return folders.concat(files);\n        });\n      }\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/drop": {
      "path": "lib/drop",
      "content": "(function() {\n  module.exports = function(element, handler) {\n    var cancel;\n    cancel = function(e) {\n      e.preventDefault();\n      return false;\n    };\n    element.addEventListener(\"dragover\", cancel);\n    element.addEventListener(\"dragenter\", cancel);\n    return element.addEventListener(\"drop\", function(e) {\n      return handler(e);\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/error-reporter": {
      "path": "lib/error-reporter",
      "content": "(function() {\n  window.addEventListener(\"error\", function(e) {\n    return system.Achievement.unlock(\"I AM ERROR\");\n  });\n\n  window.addEventListener(\"unhandledrejection\", function(e) {\n    return system.Achievement.unlock(\"I AM ERROR\");\n  });\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/hamlet": {
      "path": "lib/hamlet",
      "content": "(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Hamlet = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var Hamlet, compile;\n\n  Hamlet = require(\"./runtime\");\n\n  compile = require(\"hamlet-compiler\").compile;\n\n  Hamlet.compile = compile;\n\n  module.exports = Hamlet;\n\n}).call(this);\n\n},{\"./runtime\":2,\"hamlet-compiler\":5}],2:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  \"use strict\";\n  var Observable, Runtime, bindEvent, bindObservable, bufferTo, classes, createElement, empty, eventNames, get, id, isEvent, isFragment, makeElement, observeAttribute, observeAttributes, observeContent, specialBindings, valueBind, valueIndexOf;\n\n  Observable = require(\"o_0\");\n\n  eventNames = \"abort\\nblur\\nchange\\nclick\\ncontextmenu\\ndblclick\\ndrag\\ndragend\\ndragenter\\ndragexit\\ndragleave\\ndragover\\ndragstart\\ndrop\\nerror\\nfocus\\ninput\\nkeydown\\nkeypress\\nkeyup\\nload\\nmousedown\\nmousemove\\nmouseout\\nmouseover\\nmouseup\\nreset\\nresize\\nscroll\\nselect\\nsubmit\\ntouchcancel\\ntouchend\\ntouchenter\\ntouchleave\\ntouchmove\\ntouchstart\\nunload\".split(\"\\n\");\n\n  isEvent = function(name) {\n    return eventNames.indexOf(name) !== -1;\n  };\n\n  isFragment = function(node) {\n    return (node != null ? node.nodeType : void 0) === 11;\n  };\n\n  valueBind = function(element, value, context) {\n    Observable(function() {\n      var update;\n      value = Observable(value, context);\n      switch (element.nodeName) {\n        case \"SELECT\":\n          element.oninput = element.onchange = function() {\n            var optionValue, _ref, _value;\n            _ref = this.children[this.selectedIndex], optionValue = _ref.value, _value = _ref._value;\n            return value(_value || optionValue);\n          };\n          update = function(newValue) {\n            var options;\n            element._value = newValue;\n            if ((options = element._options)) {\n              if (newValue.value != null) {\n                return element.value = (typeof newValue.value === \"function\" ? newValue.value() : void 0) || newValue.value;\n              } else {\n                return element.selectedIndex = valueIndexOf(options, newValue);\n              }\n            } else {\n              return element.value = newValue;\n            }\n          };\n          return bindObservable(element, value, context, update);\n        default:\n          element.oninput = element.onchange = function() {\n            return value(element.value);\n          };\n          if (typeof element.attachEvent === \"function\") {\n            element.attachEvent(\"onkeydown\", function() {\n              return setTimeout(function() {\n                return value(element.value);\n              }, 0);\n            });\n          }\n          return bindObservable(element, value, context, function(newValue) {\n            if (element.value !== newValue) {\n              return element.value = newValue;\n            }\n          });\n      }\n    });\n  };\n\n  specialBindings = {\n    INPUT: {\n      checked: function(element, value, context) {\n        element.onchange = function() {\n          return typeof value === \"function\" ? value(element.checked) : void 0;\n        };\n        return bindObservable(element, value, context, function(newValue) {\n          return element.checked = newValue;\n        });\n      }\n    },\n    SELECT: {\n      options: function(element, values, context) {\n        var updateValues;\n        values = Observable(values, context);\n        updateValues = function(values) {\n          empty(element);\n          element._options = values;\n          return values.map(function(value, index) {\n            var option, optionName, optionValue;\n            option = createElement(\"option\");\n            option._value = value;\n            if (typeof value === \"object\") {\n              optionValue = (value != null ? value.value : void 0) || index;\n            } else {\n              optionValue = value.toString();\n            }\n            bindObservable(option, optionValue, value, function(newValue) {\n              return option.value = newValue;\n            });\n            optionName = (value != null ? value.name : void 0) || value;\n            bindObservable(option, optionName, value, function(newValue) {\n              return option.textContent = option.innerText = newValue;\n            });\n            element.appendChild(option);\n            if (value === element._value) {\n              element.selectedIndex = index;\n            }\n            return option;\n          });\n        };\n        return bindObservable(element, values, context, updateValues);\n      }\n    }\n  };\n\n  observeAttribute = function(element, context, name, value) {\n    var binding, nodeName, _ref;\n    nodeName = element.nodeName;\n    if (name === \"value\") {\n      valueBind(element, value);\n    } else if (binding = (_ref = specialBindings[nodeName]) != null ? _ref[name] : void 0) {\n      binding(element, value, context);\n    } else if (name.match(/^on/) && isEvent(name.substr(2))) {\n      bindEvent(element, name, value, context);\n    } else if (isEvent(name)) {\n      bindEvent(element, \"on\" + name, value, context);\n    } else {\n      bindObservable(element, value, context, function(newValue) {\n        if ((newValue != null) && newValue !== false) {\n          return element.setAttribute(name, newValue);\n        } else {\n          return element.removeAttribute(name);\n        }\n      });\n    }\n    return element;\n  };\n\n  observeAttributes = function(element, context, attributes) {\n    return Object.keys(attributes).forEach(function(name) {\n      var value;\n      value = attributes[name];\n      return observeAttribute(element, context, name, value);\n    });\n  };\n\n  bindObservable = function(element, value, context, update) {\n    var observable, observe, unobserve;\n    observable = Observable(value, context);\n    observe = function() {\n      observable.observe(update);\n      return update(observable());\n    };\n    unobserve = function() {\n      return observable.stopObserving(update);\n    };\n    observe();\n    return element;\n  };\n\n  bindEvent = function(element, name, fn, context) {\n    return element[name] = function() {\n      return fn.apply(context, arguments);\n    };\n  };\n\n  id = function(element, context, sources) {\n    var lastId, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(newId) {\n      return element.id = newId;\n    };\n    lastId = function() {\n      return value.last();\n    };\n    return bindObservable(element, lastId, context, update);\n  };\n\n  classes = function(element, context, sources) {\n    var classNames, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(classNames) {\n      return element.className = classNames;\n    };\n    classNames = function() {\n      return value.join(\" \");\n    };\n    return bindObservable(element, classNames, context, update);\n  };\n\n  createElement = function(name) {\n    return document.createElement(name);\n  };\n\n  observeContent = function(element, context, contentFn) {\n    var append, contents, update;\n    contents = [];\n    contentFn.call(context, {\n      buffer: bufferTo(context, contents),\n      element: makeElement\n    });\n    append = function(item) {\n      if (item == null) {\n\n      } else if (typeof item === \"string\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"number\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"boolean\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item.each === \"function\") {\n        return item.each(append);\n      } else if (typeof item.forEach === \"function\") {\n        return item.forEach(append);\n      } else {\n        return element.appendChild(item);\n      }\n    };\n    update = function(contents) {\n      empty(element);\n      return contents.forEach(append);\n    };\n    return update(contents);\n  };\n\n  bufferTo = function(context, collection) {\n    return function(content) {\n      if (typeof content === 'function') {\n        content = Observable(content, context);\n      }\n      collection.push(content);\n      return content;\n    };\n  };\n\n  makeElement = function(name, context, attributes, fn) {\n    var element;\n    if (attributes == null) {\n      attributes = {};\n    }\n    element = createElement(name);\n    Observable(function() {\n      if (attributes.id != null) {\n        id(element, context, attributes.id);\n        return delete attributes.id;\n      }\n    });\n    Observable(function() {\n      if (attributes[\"class\"] != null) {\n        classes(element, context, attributes[\"class\"]);\n        return delete attributes[\"class\"];\n      }\n    });\n    Observable(function() {\n      return observeAttributes(element, context, attributes);\n    }, context);\n    if (element.nodeName !== \"SELECT\") {\n      Observable(function() {\n        return observeContent(element, context, fn);\n      }, context);\n    }\n    return element;\n  };\n\n  Runtime = function(context) {\n    var self;\n    self = {\n      buffer: function(content) {\n        if (self.root) {\n          throw \"Cannot have multiple root elements\";\n        }\n        return self.root = content;\n      },\n      element: makeElement,\n      filter: function(name, content) {}\n    };\n    return self;\n  };\n\n  Runtime.VERSION = require(\"../package.json\").version;\n\n  Runtime.Observable = Observable;\n\n  module.exports = Runtime;\n\n  empty = function(node) {\n    var child, _results;\n    _results = [];\n    while (child = node.firstChild) {\n      _results.push(node.removeChild(child));\n    }\n    return _results;\n  };\n\n  valueIndexOf = function(options, value) {\n    if (typeof value === \"object\") {\n      return options.indexOf(value);\n    } else {\n      return options.map(function(option) {\n        return option.toString();\n      }).indexOf(value.toString());\n    }\n  };\n\n  get = function(x) {\n    if (typeof x === 'function') {\n      return x();\n    } else {\n      return x;\n    }\n  };\n\n}).call(this);\n\n},{\"../package.json\":13,\"o_0\":10}],3:[function(require,module,exports){\n\n},{}],4:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var ROOT_NAME, indentText, util;\n\n  indentText = function(text, indent) {\n    if (indent == null) {\n      indent = \"  \";\n    }\n    return indent + text.replace(/\\n/g, \"\\n\" + indent);\n  };\n\n  ROOT_NAME = \"__root\";\n\n  util = {\n    indent: indentText,\n    filters: {\n      verbatim: function(content, compiler) {\n        return compiler.buffer('\"\"\"' + content.replace(/(#|\")/g, \"\\\\$1\") + '\"\"\"');\n      },\n      plain: function(content, compiler) {\n        return compiler.buffer(JSON.stringify(content));\n      },\n      coffeescript: function(content, compiler) {\n        return [content];\n      },\n      javascript: function(content, compiler) {\n        return [\"`\", compiler.indent(content), \"`\"];\n      }\n    },\n    element: function(tag, attributes, contents) {\n      var lines;\n      if (attributes == null) {\n        attributes = [];\n      }\n      if (contents == null) {\n        contents = [];\n      }\n      return lines = [\"\" + ROOT_NAME + \".buffer \" + ROOT_NAME + \".element \" + (JSON.stringify(tag)) + \", this, {\" + (attributes.join('\\n')) + \"}, (\" + ROOT_NAME + \") ->\", indentText(contents.join(\"\\n\")), \"  return\"];\n    },\n    buffer: function(value) {\n      return [\"\" + ROOT_NAME + \".buffer \" + value];\n    },\n    attributes: function(node) {\n      var attributeLines, attributes, classes, id, ids, idsAndClasses;\n      id = node.id, classes = node.classes, attributes = node.attributes;\n      if (id) {\n        ids = [JSON.stringify(id)];\n      } else {\n        ids = [];\n      }\n      classes = (classes || []).map(JSON.stringify);\n      if (attributes) {\n        attributes = attributes.filter(function(_arg) {\n          var name, value;\n          name = _arg.name, value = _arg.value;\n          if (name === \"class\") {\n            classes.push(value);\n            return false;\n          } else if (name === \"id\") {\n            ids.push(value);\n            return false;\n          } else {\n            return true;\n          }\n        });\n      } else {\n        attributes = [];\n      }\n      idsAndClasses = [];\n      if (ids.length) {\n        idsAndClasses.push(\"id: [\" + (ids.join(', ')) + \"]\");\n      }\n      if (classes.length) {\n        idsAndClasses.push(\"class: [\" + (classes.join(', ')) + \"]\");\n      }\n      attributeLines = attributes.map(function(_arg) {\n        var name, value;\n        name = _arg.name, value = _arg.value;\n        name = JSON.stringify(name);\n        return \"\" + name + \": \" + value;\n      });\n      return idsAndClasses.concat(attributeLines);\n    },\n    render: function(node) {\n      var filter, tag, text;\n      tag = node.tag, filter = node.filter, text = node.text;\n      if (tag) {\n        return this.tag(node);\n      } else if (filter) {\n        return this.filter(node);\n      } else {\n        return this.contents(node);\n      }\n    },\n    filter: function(node) {\n      var filter, filterName;\n      filterName = node.filter;\n      if (filter = this.filters[filterName]) {\n        return [].concat.apply([], this.filters[filterName](node.content, this));\n      } else {\n        return [\"\" + ROOT_NAME + \".filter(\" + (JSON.stringify(filterName)) + \", \" + (JSON.stringify(node.content)) + \")\"];\n      }\n    },\n    contents: function(node) {\n      var bufferedCode, childContent, children, contents, indent, text, unbufferedCode;\n      children = node.children, bufferedCode = node.bufferedCode, unbufferedCode = node.unbufferedCode, text = node.text;\n      if (unbufferedCode) {\n        indent = true;\n        contents = [unbufferedCode];\n      } else if (bufferedCode) {\n        contents = this.buffer(bufferedCode);\n      } else if (text) {\n        contents = this.buffer(JSON.stringify(text));\n      } else if (node.tag) {\n        contents = [];\n      } else if (node.comment) {\n        return [];\n      } else {\n        contents = [];\n        console.warn(\"No content for node:\", node);\n      }\n      if (children) {\n        childContent = this.renderNodes(children);\n        if (indent) {\n          childContent = this.indent(childContent.join(\"\\n\"));\n        }\n        contents = contents.concat(childContent);\n      }\n      return contents;\n    },\n    renderNodes: function(nodes) {\n      return [].concat.apply([], nodes.map(this.render, this));\n    },\n    tag: function(node) {\n      var tag;\n      tag = node.tag;\n      return this.element(tag, this.attributes(node), this.contents(node));\n    }\n  };\n\n  exports.compile = function(parseTree, _arg) {\n    var compiler, exports, items, options, program, programSource, runtime, source, _ref;\n    _ref = _arg != null ? _arg : {}, compiler = _ref.compiler, runtime = _ref.runtime, exports = _ref.exports;\n    if (runtime == null) {\n      runtime = \"require\" + \"(\\\"hamlet-runtime\\\")\";\n    }\n    if (exports == null) {\n      exports = \"module.exports\";\n    }\n    items = util.renderNodes(parseTree);\n    if (exports) {\n      exports = \"\" + exports + \" = \";\n    } else {\n      exports = \"\";\n    }\n    source = \"\" + exports + \"(data) ->\\n  \\\"use strict\\\"\\n  (->\\n    \" + ROOT_NAME + \" = \" + runtime + \"(this)\\n\\n\" + (util.indent(items.join(\"\\n\"), \"    \")) + \"\\n    return \" + ROOT_NAME + \".root\\n  ).call(data)\";\n    options = {\n      bare: true\n    };\n    programSource = source;\n    program = compiler.compile(programSource, options);\n    return program;\n  };\n\n}).call(this);\n\n},{}],5:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var compile, parser;\n\n  compile = require(\"./compiler\").compile;\n\n  parser = require(\"hamlet-parser\");\n\n  module.exports = {\n    compile: function(input, options) {\n      if (options == null) {\n        options = {};\n      }\n      if (typeof input === \"string\") {\n        input = parser.parse(input, options.mode);\n      }\n      return compile(input, options);\n    }\n  };\n\n}).call(this);\n\n},{\"./compiler\":4,\"hamlet-parser\":8}],6:[function(require,module,exports){\n/* generated by jison-lex 0.2.1 */\nvar haml_lexer = (function(){\nvar lexer = {\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input) {\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len - 1);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function (match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex() {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin(condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState() {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules() {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState(n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState(condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"moduleName\":\"haml_lexer\"},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\n\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:return 'SEPARATOR';\nbreak;\ncase 1:this.popState(); return 'RIGHT_PARENTHESIS';\nbreak;\ncase 2:return 'ATTRIBUTE';\nbreak;\ncase 3:this.begin('value'); return 'EQUAL';\nbreak;\ncase 4:return 'AT_ATTRIBUTE';\nbreak;\ncase 5:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 6:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 7:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 8:yy.indent = 0; this.popState(); return 'NEWLINE';\nbreak;\ncase 9:return 'FILTER_LINE';\nbreak;\ncase 10:yy.indent = 0; return 'NEWLINE';\nbreak;\ncase 11:yy.indent += 1; if(yy.indent > yy.filterIndent){this.begin('filter'); }; return 'INDENT';\nbreak;\ncase 12:this.begin(\"parentheses_attributes\"); return 'LEFT_PARENTHESIS';\nbreak;\ncase 13:yy_.yytext = yy_.yytext.substring(1); return 'COMMENT';\nbreak;\ncase 14:yy.filterIndent = yy.indent; yy_.yytext = yy_.yytext.substring(1); return 'FILTER';\nbreak;\ncase 15:yy_.yytext = yy_.yytext.substring(1); return 'ID';\nbreak;\ncase 16:yy_.yytext = yy_.yytext.substring(1); return 'CLASS';\nbreak;\ncase 17:yy_.yytext = yy_.yytext.substring(1); return 'TAG';\nbreak;\ncase 18:yy_.yytext = yy_.yytext.substring(1).trim(); return 'BUFFERED_CODE';\nbreak;\ncase 19:yy_.yytext = yy_.yytext.substring(1).trim(); return 'UNBUFFERED_CODE';\nbreak;\ncase 20:yy_.yytext = yy_.yytext.trim(); return 'TEXT';\nbreak;\n}\n},\nrules: [/^(?:[ \\t]+)/,/^(?:\\))/,/^(?:([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:=)/,/^(?:@([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:\"(\\\\.|[^\\\\\"])*\")/,/^(?:'(\\\\.|[^\\\\'])*')/,/^(?:[^ \\t\\)]*)/,/^(?:(\\n|$))/,/^(?:[^\\n]*)/,/^(?:\\s*(\\n|$))/,/^(?:(  |\\\\t))/,/^(?:\\()/,/^(?:\\/.*)/,/^(?::([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:#((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:\\.((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:%((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:=.*)/,/^(?:-.*)/,/^(?:.*)/],\nconditions: {\"filter\":{\"rules\":[8,9],\"inclusive\":false},\"value\":{\"rules\":[5,6,7],\"inclusive\":false},\"parentheses_attributes\":{\"rules\":[0,1,2,3,4],\"inclusive\":false},\"INITIAL\":{\"rules\":[10,11,12,13,14,15,16,17,18,19,20],\"inclusive\":true}}\n};\nreturn lexer;\n})();module.exports = haml_lexer;\n\n},{}],7:[function(require,module,exports){\n/* generated by jison-lex 0.2.1 */\nvar jade_lexer = (function(){\nvar lexer = {\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input) {\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len - 1);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function (match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex() {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin(condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState() {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules() {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState(n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState(condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {\"moduleName\":\"jade_lexer\"},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\n\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:return 'SEPARATOR';\nbreak;\ncase 1:this.popState(); return 'RIGHT_PARENTHESIS';\nbreak;\ncase 2:return 'ATTRIBUTE';\nbreak;\ncase 3:this.begin('value'); return 'EQUAL';\nbreak;\ncase 4:return 'AT_ATTRIBUTE';\nbreak;\ncase 5:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 6:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 7:this.popState(); return 'ATTRIBUTE_VALUE';\nbreak;\ncase 8:yy.indent = 0; this.popState(); return 'NEWLINE';\nbreak;\ncase 9:return 'FILTER_LINE';\nbreak;\ncase 10:yy.indent = 0; return 'NEWLINE';\nbreak;\ncase 11:yy.indent += 1; if(yy.indent > yy.filterIndent){this.begin('filter'); }; return 'INDENT';\nbreak;\ncase 12:this.begin(\"parentheses_attributes\"); return 'LEFT_PARENTHESIS';\nbreak;\ncase 13:yy_.yytext = yy_.yytext.substring(2); return 'COMMENT';\nbreak;\ncase 14:yy.filterIndent = yy.indent; yy_.yytext = yy_.yytext.substring(1); return 'FILTER';\nbreak;\ncase 15:yy_.yytext = yy_.yytext.substring(1); return 'ID';\nbreak;\ncase 16:yy_.yytext = yy_.yytext.substring(1); return 'CLASS';\nbreak;\ncase 17:return 'TAG';\nbreak;\ncase 18:yy_.yytext = yy_.yytext.substring(1).trim(); return 'BUFFERED_CODE';\nbreak;\ncase 19:yy_.yytext = yy_.yytext.substring(1).trim(); return 'UNBUFFERED_CODE';\nbreak;\ncase 20:yy_.yytext = yy_.yytext.trim(); return 'TEXT';\nbreak;\n}\n},\nrules: [/^(?:[ \\t]+)/,/^(?:\\))/,/^(?:([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:=)/,/^(?:@([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:\"(\\\\.|[^\\\\\"])*\")/,/^(?:'(\\\\.|[^\\\\'])*')/,/^(?:[^ \\t\\)]*)/,/^(?:(\\n|$))/,/^(?:[^\\n]*)/,/^(?:\\s*(\\n|$))/,/^(?:(  |\\\\t))/,/^(?:\\()/,/^(?:\\/\\/.*)/,/^(?::([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:#((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:\\.((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:=.*)/,/^(?:-.*)/,/^(?:.*)/],\nconditions: {\"filter\":{\"rules\":[8,9],\"inclusive\":false},\"value\":{\"rules\":[5,6,7],\"inclusive\":false},\"parentheses_attributes\":{\"rules\":[0,1,2,3,4],\"inclusive\":false},\"INITIAL\":{\"rules\":[10,11,12,13,14,15,16,17,18,19,20],\"inclusive\":true}}\n};\nreturn lexer;\n})();module.exports = jade_lexer;\n\n},{}],8:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var extend, lexers, oldParse, parser,\n    __slice = [].slice;\n\n  parser = require(\"./parser\").parser;\n\n  lexers = {\n    haml: require(\"./haml_lexer\"),\n    jade: require(\"./jade_lexer\")\n  };\n\n  extend = function() {\n    var name, source, sources, target, _i, _len;\n    target = arguments[0], sources = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n    for (_i = 0, _len = sources.length; _i < _len; _i++) {\n      source = sources[_i];\n      for (name in source) {\n        target[name] = source[name];\n      }\n    }\n    return target;\n  };\n\n  oldParse = parser.parse;\n\n  extend(parser, {\n    parse: function(input, mode) {\n      if (mode == null) {\n        mode = \"haml\";\n      }\n      parser.lexer = lexers[mode];\n      extend(parser.yy, {\n        indent: 0,\n        nodePath: [\n          {\n            children: []\n          }\n        ],\n        filterIndent: void 0\n      });\n      return oldParse.call(parser, input);\n    }\n  });\n\n  extend(parser.yy, {\n    extend: extend,\n    newline: function() {\n      var lastNode;\n      lastNode = this.nodePath[this.nodePath.length - 1];\n      if (lastNode.filter) {\n        return this.appendFilterContent(lastNode, \"\");\n      }\n    },\n    lastParent: function(indentation) {\n      var parent;\n      while (!(parent = this.nodePath[indentation])) {\n        indentation -= 1;\n      }\n      return parent;\n    },\n    append: function(node, indentation) {\n      var index, lastNode, parent;\n      if (indentation == null) {\n        indentation = 0;\n      }\n      if (node.filterLine) {\n        lastNode = this.nodePath[this.nodePath.length - 1];\n        this.appendFilterContent(lastNode, node.filterLine);\n        return;\n      }\n      parent = this.lastParent(indentation);\n      this.appendChild(parent, node);\n      index = indentation + 1;\n      this.nodePath[index] = node;\n      this.nodePath.length = index + 1;\n      return node;\n    },\n    appendChild: function(parent, child) {\n      if (!child.filter) {\n        this.filterIndent = void 0;\n        this.lexer.popState();\n      }\n      parent.children || (parent.children = []);\n      return parent.children.push(child);\n    },\n    appendFilterContent: function(filter, content) {\n      filter.content || (filter.content = \"\");\n      return filter.content += \"\" + content + \"\\n\";\n    }\n  });\n\n  module.exports = parser;\n\n}).call(this);\n\n},{\"./haml_lexer\":6,\"./jade_lexer\":7,\"./parser\":9}],9:[function(require,module,exports){\n(function (process){\n/* parser generated by jison 0.4.6 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar parser = {trace: function trace() { },\nyy: {},\nsymbols_: {\"error\":2,\"root\":3,\"lines\":4,\"line\":5,\"indentation\":6,\"indentationLevel\":7,\"INDENT\":8,\"lineMain\":9,\"end\":10,\"tag\":11,\"rest\":12,\"COMMENT\":13,\"FILTER\":14,\"FILTER_LINE\":15,\"NEWLINE\":16,\"name\":17,\"tagComponents\":18,\"attributes\":19,\"idComponent\":20,\"classComponents\":21,\"ID\":22,\"CLASS\":23,\"LEFT_PARENTHESIS\":24,\"attributePairs\":25,\"RIGHT_PARENTHESIS\":26,\"SEPARATOR\":27,\"attributePair\":28,\"ATTRIBUTE\":29,\"EQUAL\":30,\"ATTRIBUTE_VALUE\":31,\"AT_ATTRIBUTE\":32,\"TAG\":33,\"BUFFERED_CODE\":34,\"UNBUFFERED_CODE\":35,\"TEXT\":36,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",8:\"INDENT\",13:\"COMMENT\",14:\"FILTER\",15:\"FILTER_LINE\",16:\"NEWLINE\",22:\"ID\",23:\"CLASS\",24:\"LEFT_PARENTHESIS\",26:\"RIGHT_PARENTHESIS\",27:\"SEPARATOR\",29:\"ATTRIBUTE\",30:\"EQUAL\",31:\"ATTRIBUTE_VALUE\",32:\"AT_ATTRIBUTE\",33:\"TAG\",34:\"BUFFERED_CODE\",35:\"UNBUFFERED_CODE\",36:\"TEXT\"},\nproductions_: [0,[3,1],[4,2],[4,1],[6,0],[6,1],[7,2],[7,1],[5,3],[5,1],[9,2],[9,1],[9,1],[9,1],[9,1],[9,1],[10,1],[11,2],[11,2],[11,1],[11,1],[18,3],[18,2],[18,2],[18,2],[18,1],[18,1],[20,1],[21,2],[21,1],[19,3],[25,3],[25,1],[28,3],[28,1],[17,1],[12,1],[12,1],[12,1]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:return this.$ = yy.nodePath[0].children;\nbreak;\ncase 2:this.$ = $$[$0-1];\nbreak;\ncase 3:this.$ = $$[$0];\nbreak;\ncase 4:this.$ = 0;\nbreak;\ncase 5:this.$ = $$[$0];\nbreak;\ncase 6:this.$ = $$[$0-1] + 1;\nbreak;\ncase 7:this.$ = 1;\nbreak;\ncase 8:this.$ = yy.append($$[$0-1], $$[$0-2]);\nbreak;\ncase 9:this.$ = (function () {\n        if ($$[$0].newline) {\n          return yy.newline();\n        }\n      }());\nbreak;\ncase 10:this.$ = yy.extend($$[$0-1], $$[$0]);\nbreak;\ncase 11:this.$ = $$[$0];\nbreak;\ncase 12:this.$ = $$[$0];\nbreak;\ncase 13:this.$ = {\n          comment: $$[$0]\n        };\nbreak;\ncase 14:this.$ = {\n          filter: $$[$0]\n        };\nbreak;\ncase 15:this.$ = {\n          filterLine: $$[$0]\n        };\nbreak;\ncase 16:this.$ = {\n          newline: true\n        };\nbreak;\ncase 17:this.$ = (function () {\n        $$[$0].tag = $$[$0-1];\n        return $$[$0];\n      }());\nbreak;\ncase 18:this.$ = {\n          tag: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 19:this.$ = {\n          tag: $$[$0]\n        };\nbreak;\ncase 20:this.$ = yy.extend($$[$0], {\n          tag: \"div\"\n        });\nbreak;\ncase 21:this.$ = {\n          id: $$[$0-2],\n          classes: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 22:this.$ = {\n          id: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 23:this.$ = {\n          classes: $$[$0-1],\n          attributes: $$[$0]\n        };\nbreak;\ncase 24:this.$ = {\n          id: $$[$0-1],\n          classes: $$[$0]\n        };\nbreak;\ncase 25:this.$ = {\n          id: $$[$0]\n        };\nbreak;\ncase 26:this.$ = {\n          classes: $$[$0]\n        };\nbreak;\ncase 27:this.$ = $$[$0];\nbreak;\ncase 28:this.$ = $$[$0-1].concat($$[$0]);\nbreak;\ncase 29:this.$ = [$$[$0]];\nbreak;\ncase 30:this.$ = $$[$0-1];\nbreak;\ncase 31:this.$ = $$[$0-2].concat($$[$0]);\nbreak;\ncase 32:this.$ = [$$[$0]];\nbreak;\ncase 33:this.$ = {\n          name: $$[$0-2],\n          value: $$[$0]\n        };\nbreak;\ncase 34:this.$ = {\n          name: $$[$0].substring(1),\n          value: $$[$0]\n        };\nbreak;\ncase 35:this.$ = $$[$0];\nbreak;\ncase 36:this.$ = {\n          bufferedCode: $$[$0]\n        };\nbreak;\ncase 37:this.$ = {\n          unbufferedCode: $$[$0]\n        };\nbreak;\ncase 38:this.$ = {\n          text: $$[$0] + \"\\n\"\n        };\nbreak;\n}\n},\ntable: [{3:1,4:2,5:3,6:4,7:6,8:[1,8],10:5,13:[2,4],14:[2,4],15:[2,4],16:[1,7],22:[2,4],23:[2,4],33:[2,4],34:[2,4],35:[2,4],36:[2,4]},{1:[3]},{1:[2,1],5:9,6:4,7:6,8:[1,8],10:5,13:[2,4],14:[2,4],15:[2,4],16:[1,7],22:[2,4],23:[2,4],33:[2,4],34:[2,4],35:[2,4],36:[2,4]},{1:[2,3],8:[2,3],13:[2,3],14:[2,3],15:[2,3],16:[2,3],22:[2,3],23:[2,3],33:[2,3],34:[2,3],35:[2,3],36:[2,3]},{9:10,11:11,12:12,13:[1,13],14:[1,14],15:[1,15],17:16,18:17,20:22,21:23,22:[1,24],23:[1,25],33:[1,21],34:[1,18],35:[1,19],36:[1,20]},{1:[2,9],8:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[2,9],22:[2,9],23:[2,9],33:[2,9],34:[2,9],35:[2,9],36:[2,9]},{8:[1,26],13:[2,5],14:[2,5],15:[2,5],22:[2,5],23:[2,5],33:[2,5],34:[2,5],35:[2,5],36:[2,5]},{1:[2,16],8:[2,16],13:[2,16],14:[2,16],15:[2,16],16:[2,16],22:[2,16],23:[2,16],33:[2,16],34:[2,16],35:[2,16],36:[2,16]},{8:[2,7],13:[2,7],14:[2,7],15:[2,7],22:[2,7],23:[2,7],33:[2,7],34:[2,7],35:[2,7],36:[2,7]},{1:[2,2],8:[2,2],13:[2,2],14:[2,2],15:[2,2],16:[2,2],22:[2,2],23:[2,2],33:[2,2],34:[2,2],35:[2,2],36:[2,2]},{10:27,16:[1,7]},{12:28,16:[2,11],34:[1,18],35:[1,19],36:[1,20]},{16:[2,12]},{16:[2,13]},{16:[2,14]},{16:[2,15]},{16:[2,19],18:29,19:30,20:22,21:23,22:[1,24],23:[1,25],24:[1,31],34:[2,19],35:[2,19],36:[2,19]},{16:[2,20],34:[2,20],35:[2,20],36:[2,20]},{16:[2,36]},{16:[2,37]},{16:[2,38]},{16:[2,35],22:[2,35],23:[2,35],24:[2,35],34:[2,35],35:[2,35],36:[2,35]},{16:[2,25],19:33,21:32,23:[1,25],24:[1,31],34:[2,25],35:[2,25],36:[2,25]},{16:[2,26],19:34,23:[1,35],24:[1,31],34:[2,26],35:[2,26],36:[2,26]},{16:[2,27],23:[2,27],24:[2,27],34:[2,27],35:[2,27],36:[2,27]},{16:[2,29],23:[2,29],24:[2,29],34:[2,29],35:[2,29],36:[2,29]},{8:[2,6],13:[2,6],14:[2,6],15:[2,6],22:[2,6],23:[2,6],33:[2,6],34:[2,6],35:[2,6],36:[2,6]},{1:[2,8],8:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[2,8],22:[2,8],23:[2,8],33:[2,8],34:[2,8],35:[2,8],36:[2,8]},{16:[2,10]},{16:[2,17],34:[2,17],35:[2,17],36:[2,17]},{16:[2,18],34:[2,18],35:[2,18],36:[2,18]},{25:36,28:37,29:[1,38],32:[1,39]},{16:[2,24],19:40,23:[1,35],24:[1,31],34:[2,24],35:[2,24],36:[2,24]},{16:[2,22],34:[2,22],35:[2,22],36:[2,22]},{16:[2,23],34:[2,23],35:[2,23],36:[2,23]},{16:[2,28],23:[2,28],24:[2,28],34:[2,28],35:[2,28],36:[2,28]},{26:[1,41],27:[1,42]},{26:[2,32],27:[2,32]},{30:[1,43]},{26:[2,34],27:[2,34]},{16:[2,21],34:[2,21],35:[2,21],36:[2,21]},{16:[2,30],34:[2,30],35:[2,30],36:[2,30]},{28:44,29:[1,38],32:[1,39]},{31:[1,45]},{26:[2,31],27:[2,31]},{26:[2,33],27:[2,33]}],\ndefaultActions: {12:[2,12],13:[2,13],14:[2,14],15:[2,15],18:[2,36],19:[2,37],20:[2,38],28:[2,10]},\nparseError: function parseError(str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        throw new Error(str);\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    this.lexer.setInput(input);\n    this.lexer.yy = this.yy;\n    this.yy.lexer = this.lexer;\n    this.yy.parser = this;\n    if (typeof this.lexer.yylloc == 'undefined') {\n        this.lexer.yylloc = {};\n    }\n    var yyloc = this.lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = this.lexer.options && this.lexer.options.ranges;\n    if (typeof this.yy.parseError === 'function') {\n        this.parseError = this.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n    function lex() {\n        var token;\n        token = self.lexer.lex() || EOF;\n        if (typeof token !== 'number') {\n            token = self.symbols_[token] || token;\n        }\n        return token;\n    }\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n                    if (typeof action === 'undefined' || !action.length || !action[0]) {\n                var errStr = '';\n                expected = [];\n                for (p in table[state]) {\n                    if (this.terminals_[p] && p > TERROR) {\n                        expected.push('\\'' + this.terminals_[p] + '\\'');\n                    }\n                }\n                if (this.lexer.showPosition) {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + this.lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n                } else {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n                }\n                this.parseError(errStr, {\n                    text: this.lexer.match,\n                    token: this.terminals_[symbol] || symbol,\n                    line: this.lexer.yylineno,\n                    loc: yyloc,\n                    expected: expected\n                });\n            }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(this.lexer.yytext);\n            lstack.push(this.lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = this.lexer.yyleng;\n                yytext = this.lexer.yytext;\n                yylineno = this.lexer.yylineno;\n                yyloc = this.lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.call(yyval, yytext, yyleng, yylineno, this.yy, action[1], vstack, lstack);\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\nundefined\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\n\nif (typeof require !== 'undefined' && typeof exports !== 'undefined') {\nexports.parser = parser;\nexports.Parser = parser.Parser;\nexports.parse = function () { return parser.parse.apply(parser, arguments); };\nexports.main = function commonjsMain(args) {\n    if (!args[1]) {\n        console.log('Usage: '+args[0]+' FILE');\n        process.exit(1);\n    }\n    var source = require('fs').readFileSync(require('path').normalize(args[1]), \"utf8\");\n    return exports.parser.parse(source);\n};\nif (typeof module !== 'undefined' && require.main === module) {\n  exports.main(process.argv.slice(1));\n}\n}\n}).call(this,require('_process'))\n},{\"_process\":12,\"fs\":3,\"path\":11}],10:[function(require,module,exports){\n(function (global){\n// Generated by CoffeeScript 1.8.0\n(function() {\n  var Observable, PROXY_LENGTH, computeDependencies, copy, extend, flatten, get, last, magicDependency, remove, splat, tryCallWithFinallyPop,\n    __slice = [].slice;\n\n  module.exports = Observable = function(value, context) {\n    var changed, fn, listeners, notify, notifyReturning, self;\n    if (typeof (value != null ? value.observe : void 0) === \"function\") {\n      return value;\n    }\n    listeners = [];\n    notify = function(newValue) {\n      return copy(listeners).forEach(function(listener) {\n        return listener(newValue);\n      });\n    };\n    if (typeof value === 'function') {\n      fn = value;\n      self = function() {\n        magicDependency(self);\n        return value;\n      };\n      changed = function() {\n        value = computeDependencies(self, fn, changed, context);\n        return notify(value);\n      };\n      changed();\n    } else {\n      self = function(newValue) {\n        if (arguments.length > 0) {\n          if (value !== newValue) {\n            value = newValue;\n            notify(newValue);\n          }\n        } else {\n          magicDependency(self);\n        }\n        return value;\n      };\n    }\n    self.each = function(callback) {\n      magicDependency(self);\n      if (value != null) {\n        [value].forEach(function(item) {\n          return callback.call(item, item);\n        });\n      }\n      return self;\n    };\n    if (Array.isArray(value)) {\n      [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"reduce\", \"reduceRight\", \"slice\", \"some\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          magicDependency(self);\n          return value[method].apply(value, args);\n        };\n      });\n      [\"pop\", \"push\", \"reverse\", \"shift\", \"splice\", \"sort\", \"unshift\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          return notifyReturning(value[method].apply(value, args));\n        };\n      });\n      if (PROXY_LENGTH) {\n        Object.defineProperty(self, 'length', {\n          get: function() {\n            magicDependency(self);\n            return value.length;\n          },\n          set: function(length) {\n            value.length = length;\n            return notifyReturning(value.length);\n          }\n        });\n      }\n      notifyReturning = function(returnValue) {\n        notify(value);\n        return returnValue;\n      };\n      extend(self, {\n        each: function(callback) {\n          self.forEach(function(item, index) {\n            return callback.call(item, item, index, self);\n          });\n          return self;\n        },\n        remove: function(object) {\n          var index;\n          index = value.indexOf(object);\n          if (index >= 0) {\n            return notifyReturning(value.splice(index, 1)[0]);\n          }\n        },\n        get: function(index) {\n          magicDependency(self);\n          return value[index];\n        },\n        first: function() {\n          magicDependency(self);\n          return value[0];\n        },\n        last: function() {\n          magicDependency(self);\n          return value[value.length - 1];\n        },\n        size: function() {\n          magicDependency(self);\n          return value.length;\n        }\n      });\n    }\n    extend(self, {\n      listeners: listeners,\n      observe: function(listener) {\n        return listeners.push(listener);\n      },\n      stopObserving: function(fn) {\n        return remove(listeners, fn);\n      },\n      toggle: function() {\n        return self(!value);\n      },\n      increment: function(n) {\n        return self(value + n);\n      },\n      decrement: function(n) {\n        return self(value - n);\n      },\n      toString: function() {\n        return \"Observable(\" + value + \")\";\n      }\n    });\n    return self;\n  };\n\n  Observable.concat = function() {\n    var arg, args, collection, i, o, _i, _len;\n    args = new Array(arguments.length);\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      arg = arguments[i];\n      args[i] = arguments[i];\n    }\n    collection = Observable(args);\n    o = Observable(function() {\n      return flatten(collection.map(splat));\n    });\n    o.push = collection.push;\n    return o;\n  };\n\n  extend = function(target) {\n    var i, name, source, _i, _len;\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      source = arguments[i];\n      if (i > 0) {\n        for (name in source) {\n          target[name] = source[name];\n        }\n      }\n    }\n    return target;\n  };\n\n  global.OBSERVABLE_ROOT_HACK = [];\n\n  magicDependency = function(self) {\n    var observerSet;\n    observerSet = last(global.OBSERVABLE_ROOT_HACK);\n    if (observerSet) {\n      return observerSet.add(self);\n    }\n  };\n\n  tryCallWithFinallyPop = function(fn, context) {\n    try {\n      return fn.call(context);\n    } finally {\n      global.OBSERVABLE_ROOT_HACK.pop();\n    }\n  };\n\n  computeDependencies = function(self, fn, update, context) {\n    var deps, value, _ref;\n    deps = new Set;\n    global.OBSERVABLE_ROOT_HACK.push(deps);\n    value = tryCallWithFinallyPop(fn, context);\n    if ((_ref = self._deps) != null) {\n      _ref.forEach(function(observable) {\n        return observable.stopObserving(update);\n      });\n    }\n    self._deps = deps;\n    deps.forEach(function(observable) {\n      return observable.observe(update);\n    });\n    return value;\n  };\n\n  try {\n    Object.defineProperty((function() {}), 'length', {\n      get: function() {},\n      set: function() {}\n    });\n    PROXY_LENGTH = true;\n  } catch (_error) {\n    PROXY_LENGTH = false;\n  }\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n  copy = function(array) {\n    return array.concat([]);\n  };\n\n  get = function(arg) {\n    if (typeof arg === \"function\") {\n      return arg();\n    } else {\n      return arg;\n    }\n  };\n\n  splat = function(item) {\n    var result, results;\n    results = [];\n    if (item == null) {\n      return results;\n    }\n    if (typeof item.forEach === \"function\") {\n      item.forEach(function(i) {\n        return results.push(i);\n      });\n    } else {\n      result = get(item);\n      if (result != null) {\n        results.push(result);\n      }\n    }\n    return results;\n  };\n\n  last = function(array) {\n    return array[array.length - 1];\n  };\n\n  flatten = function(array) {\n    return array.reduce(function(a, b) {\n      return a.concat(b);\n    }, []);\n  };\n\n}).call(this);\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],11:[function(require,module,exports){\n(function (process){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n};\n\n\nexports.basename = function(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\n\nexports.extname = function(path) {\n  return splitPath(path)[3];\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n\n}).call(this,require('_process'))\n},{\"_process\":12}],12:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],13:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"hamlet.coffee\",\n  \"version\": \"0.7.6\",\n  \"description\": \"Truly amazing templating!\",\n  \"devDependencies\": {\n    \"browserify\": \"^12.0.1\",\n    \"coffee-script\": \"~1.7.1\",\n    \"jsdom\": \"^7.2.0\",\n    \"mocha\": \"^2.3.3\"\n  },\n  \"dependencies\": {\n    \"hamlet-compiler\": \"0.7.0\",\n    \"o_0\": \"0.3.8\"\n  },\n  \"homepage\": \"hamlet.coffee\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/dr-coffee-labs/hamlet.git\"\n  },\n  \"scripts\": {\n    \"prepublish\": \"script/prepublish\",\n    \"test\": \"script/test\"\n  },\n  \"files\": [\n    \"dist/\"\n  ],\n  \"main\": \"dist/runtime.js\"\n}\n\n},{}]},{},[1])(1)\n});\n",
      "type": "blob"
    },
    "lib/iframe-app": {
      "path": "lib/iframe-app",
      "content": "\n/*\nIFrameApp loads an app in an iframe and returns a UI window that the system can\nuse to interact with it.\n\nThe apps can be sandboxed by passing in the sandbox option.\n\nApps can be loaded from a json package or from a source url.\n\nApps are communicated with via `postMessage`\n\nThe iframed app is responsible for sending the `ready` message when it is in a\nstate that can respond to messages from the OS.\n */\n\n(function() {\n  var Drop, FileIO, Model, Postmaster, version,\n    __slice = [].slice;\n\n  Model = require(\"model\");\n\n  Postmaster = require(\"postmaster\");\n\n  Drop = require(\"./drop\");\n\n  FileIO = require(\"../os/file-io\");\n\n  version = require(\"../pixie\").version;\n\n  module.exports = function(opts) {\n    var Window, acceptClient, application, blob, frame, handlers, height, html, iconEmoji, loaded, loadedPromise, menuBar, packageOptions, pkg, postmaster, resolveLoaded, sandbox, src, title, width;\n    if (opts == null) {\n      opts = {};\n    }\n    Window = system.UI.Window;\n    height = opts.height, menuBar = opts.menuBar, src = opts.src, handlers = opts.handlers, title = opts.title, width = opts.width, sandbox = opts.sandbox, pkg = opts.pkg, packageOptions = opts.packageOptions, iconEmoji = opts.iconEmoji;\n    frame = document.createElement(\"iframe\");\n    if (sandbox) {\n      frame.setAttribute(\"sandbox\", sandbox);\n    }\n    if (src) {\n      frame.src = src;\n    } else if (pkg) {\n      html = system.htmlForPackage(pkg, packageOptions);\n      blob = new Blob([html], {\n        type: \"text/html; charset=utf-8\"\n      });\n      frame.src = URL.createObjectURL(blob);\n    }\n    resolveLoaded = null;\n    loadedPromise = new Promise(function(resolve) {\n      return resolveLoaded = resolve;\n    });\n    loaded = false;\n    setTimeout(function() {\n      if (!loaded) {\n        return console.warn(\"Child never loaded\");\n      }\n    }, 5000);\n    postmaster = Postmaster();\n    acceptClient = function() {\n      resolveLoaded();\n      loaded = true;\n      return {\n        ZineOS: {\n          version: version,\n          env: {},\n          args: {}\n        }\n      };\n    };\n    Object.assign(postmaster, {\n      remoteTarget: function() {\n        return frame.contentWindow;\n      },\n      ready: function(clientData) {\n        console.info(clientData);\n        return acceptClient();\n      },\n      childLoaded: function() {\n        console.log(\"child loaded\");\n        return acceptClient();\n      },\n      event: function() {\n        application.trigger.apply(application, [\"event\"].concat(__slice.call(arguments)));\n      },\n      application: function() {\n        var args, method;\n        method = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n        return application[method].apply(application, args);\n      },\n      system: function() {\n        var args, method;\n        method = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n        return system[method].apply(system, args);\n      }\n    });\n    if (handlers == null) {\n      handlers = Model().include(FileIO).extend({\n        loadFile: function(blob) {\n          return loadedPromise.then(function() {\n            return postmaster.invokeRemote(\"loadFile\", blob)[\"catch\"](function(e) {\n              return console.error(\"invokeRemote 'loadFile' failed\", e);\n            });\n          });\n        }\n      });\n    }\n    application = Window({\n      title: title,\n      content: frame,\n      menuBar: menuBar != null ? menuBar.element : void 0,\n      width: width,\n      height: height,\n      iconEmoji: iconEmoji\n    });\n    Object.assign(application, {\n      exit: function() {\n        setTimeout(function() {\n          return application.element.remove();\n        }, 0);\n      },\n      handlers: handlers,\n      loadFile: handlers.loadFile,\n      send: function() {\n        var args;\n        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        return loadedPromise.then(function() {\n          return postmaster.invokeRemote.apply(postmaster, args);\n        });\n      }\n    });\n    return application;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/jadelet.min": {
      "path": "lib/jadelet.min",
      "content": "!function(t){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{(\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this).Jadelet=t()}}(function(){return function t(e,n,i){function r(o,c){if(!n[o]){if(!e[o]){var a=\"function\"==typeof require&&require;if(!c&&a)return a(o,!0);if(s)return s(o,!0);var u=new Error(\"Cannot find module '\"+o+\"'\");throw u.code=\"MODULE_NOT_FOUND\",u}var l=n[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return r(n||t)},l,l.exports,t,e,n,i)}return n[o].exports}for(var s=\"function\"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){(function(){var n,i,r,s;r=t(\"./parser/main\"),e.exports=function(t,e){return null==e&&(e={}),\"string\"==typeof t&&(t=r.parse(t)),n(t,e)},s={indent:i=function(t,e){return null==e&&(e=\"  \"),e+t.replace(/\\n/g,\"\\n\"+e)},filters:{verbatim:function(t,e){return e.buffer('\"\"\"'+t.replace(/(#|\")/g,\"\\\\$1\")+'\"\"\"')},plain:function(t,e){return e.buffer(JSON.stringify(t))},coffeescript:function(t,e){return[t]},javascript:function(t,e){return[\"`\",e.indent(t),\"`\"]}},element:function(t,e,n){return null==e&&(e=[]),null==n&&(n=[]),[\"__root.buffer __root.element \"+JSON.stringify(t)+\", this, {\"+e.join(\"\\n\")+\"}, (__root) ->\",i(n.join(\"\\n\")),\"  return\"]},buffer:function(t){return[\"__root.buffer \"+t]},attributes:function(t){var e,n,i,r,s,o,c;return r=t.id,i=t.classes,n=t.attributes,s=r?[JSON.stringify(r)]:[],i=(i||[]).map(JSON.stringify),c=[],n=n?n.filter(function(t){var e,n;if(e=t.name,n=t.value,\"class\"===e)i.push(n);else if(\"id\"===e)s.push(n);else{if(\"style\"!==e)return!0;c.push(n)}}):[],o=[],s.length&&o.push(\"id: [\"+s.join(\", \")+\"]\"),i.length&&o.push(\"class: [\"+i.join(\", \")+\"]\"),c.length&&o.push(\"style: [\"+c.join(\", \")+\"]\"),e=n.map(function(t){var e,n;return e=t.name,n=t.value,(e=JSON.stringify(e))+\": \"+n}),o.concat(e)},render:function(t){var e,n;return n=t.tag,e=t.filter,t.text,n?this.tag(t):e?this.filter(t):this.contents(t)},filter:function(t){var e;return e=t.filter,this.filters[e]?[].concat.apply([],this.filters[e](t.content,this)):[\"__root.filter(\"+JSON.stringify(e)+\", \"+JSON.stringify(t.content)+\")\"]},contents:function(t){var e,n,i,r,s,o,c;if(i=t.children,e=t.bufferedCode,c=t.unbufferedCode,o=t.text,c)s=!0,r=[c];else if(e)r=this.buffer(e);else if(o)r=this.buffer(JSON.stringify(o));else if(t.tag)r=[];else{if(t.comment)return[];r=[],console.warn(\"No content for node:\",t)}return i&&(n=this.renderNodes(i),s&&(n=this.indent(n.join(\"\\n\"))),r=r.concat(n)),r},renderNodes:function(t){return[].concat.apply([],t.map(this.render,this))},tag:function(t){var e;return e=t.tag,this.element(e,this.attributes(t),this.contents(t))}},n=function(t,e){var n,i,r,o,c,a,u,l;return l=null!=e?e:{},n=l.compiler,a=l.runtime,i=l.exports,null==a&&(a='require(\"jadelet\")'),null==i&&(i=\"module.exports\"),r=s.renderNodes(t),i?i+=\" = \":i=\"\",u=i+'(data) ->\\n  \"use strict\"\\n  (->\\n    __root = '+a+\"(this)\\n\"+s.indent(r.join(\"\\n\"),\"    \")+\"\\n    return __root.root\\n  ).call(data)\",o={bare:!0},c=u,n.compile(c,o)}}).call(this)},{\"./parser/main\":4}],2:[function(t,e,n){(function(){var n;(n=t(\"./runtime\")).compile=t(\"./compiler\"),e.exports=n}).call(this)},{\"./compiler\":1,\"./runtime\":6}],3:[function(t,e,n){var i=function(){return{EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match=\"\",this.conditionStack=[\"INITIAL\"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\\r\\n?|\\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\\r\\n?|\\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var i=this.match.split(/(?:\\r\\n?|\\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?\"...\":\"\")+t.substr(-20).replace(/\\n/g,\"\")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?\"...\":\"\")).replace(/\\n/g,\"\")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join(\"-\");return t+this.upcomingInput()+\"\\n\"+e+\"^\"},test_match:function(t,e){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(i=t[0].match(/(?:\\r\\n?|\\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\\r?\\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in r)this[s]=r[s];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i;this._more||(this.yytext=\"\",this.match=\"\");for(var r=this._currentRules(),s=0;s<r.length;s++)if((n=this._input.match(this.rules[r[s]]))&&(!e||n[0].length>e[0].length)){if(e=n,i=s,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,r[s])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,r[i]))&&t:\"\"===this._input?this.EOF:this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". Unrecognized text.\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:\"INITIAL\"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{moduleName:\"lexer\"},performAction:function(t,e,n,i){switch(n){case 0:return\"SEPARATOR\";case 1:return this.popState(),\"RIGHT_PARENTHESIS\";case 2:return\"ATTRIBUTE\";case 3:return this.begin(\"value\"),\"EQUAL\";case 4:return\"AT_ATTRIBUTE\";case 5:case 6:case 7:return this.popState(),\"ATTRIBUTE_VALUE\";case 8:return t.indent=0,this.popState(),\"NEWLINE\";case 9:return\"FILTER_LINE\";case 10:return t.indent=0,\"NEWLINE\";case 11:return t.indent+=1,t.indent>t.filterIndent&&this.begin(\"filter\"),\"INDENT\";case 12:return this.begin(\"parentheses_attributes\"),\"LEFT_PARENTHESIS\";case 13:return e.yytext=e.yytext.substring(2),\"COMMENT\";case 14:return t.filterIndent=t.indent,e.yytext=e.yytext.substring(1),\"FILTER\";case 15:return e.yytext=e.yytext.substring(1),\"ID\";case 16:return e.yytext=e.yytext.substring(1),\"CLASS\";case 17:return\"TAG\";case 18:return e.yytext=e.yytext.substring(1).trim(),\"BUFFERED_CODE\";case 19:return e.yytext=e.yytext.substring(1).trim(),\"UNBUFFERED_CODE\";case 20:return e.yytext=e.yytext.trim(),\"TEXT\"}},rules:[/^(?:[ \\t]+)/,/^(?:\\))/,/^(?:([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:=)/,/^(?:@([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:\"(\\\\.|[^\\\\\"])*\")/,/^(?:'(\\\\.|[^\\\\'])*')/,/^(?:[^ \\t\\)]*)/,/^(?:(\\n|$))/,/^(?:[^\\n]*)/,/^(?:\\s*(\\n|$))/,/^(?:(  |\\\\t))/,/^(?:\\()/,/^(?:\\/\\/.*)/,/^(?::([_a-zA-Z][-_a-zA-Z0-9]*))/,/^(?:#((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:\\.((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:((:|[A-Z]|_|[a-z])((:|[A-Z]|_|[a-z])|-|[0-9])*(?!-)))/,/^(?:=.*)/,/^(?:-.*)/,/^(?:.*)/],conditions:{filter:{rules:[8,9],inclusive:!1},value:{rules:[5,6,7],inclusive:!1},parentheses_attributes:{rules:[0,1,2,3,4],inclusive:!1},INITIAL:{rules:[10,11,12,13,14,15,16,17,18,19,20],inclusive:!0}}}}();e.exports=i},{}],4:[function(t,e,n){(function(){var n,i,r,s;n=Object.assign,i=t(\"./lexer\"),s=t(\"./parser\").parser,r=s.parse,n(s,{parse:function(t){return s.lexer=i,n(s.yy,{indent:0,nodePath:[{children:[]}],filterIndent:void 0}),r.call(s,t)}}),n(s.yy,{extend:n,newline:function(){var t;if((t=this.nodePath[this.nodePath.length-1]).filter)return this.appendFilterContent(t,\"\")},lastParent:function(t){for(var e;!(e=this.nodePath[t]);)t-=1;return e},append:function(t,e){var n,i,r;return null==e&&(e=0),t.filterLine?(i=this.nodePath[this.nodePath.length-1],void this.appendFilterContent(i,t.filterLine)):(r=this.lastParent(e),this.appendChild(r,t),n=e+1,this.nodePath[n]=t,this.nodePath.length=n+1,t)},appendChild:function(t,e){return e.filter||(this.filterIndent=void 0,this.lexer.popState()),t.children||(t.children=[]),t.children.push(e)},appendFilterContent:function(t,e){return t.content||(t.content=\"\"),t.content+=e+\"\\n\"}}),e.exports=s}).call(this)},{\"./lexer\":3,\"./parser\":5}],5:[function(t,e,n){(function(i){var r=function(){function t(){this.yy={}}var e=function(t,e,n,i){for(n=n||{},i=t.length;i--;n[t[i]]=e);return n},n=[13,14,15,22,23,33,34,35,36],i=[2,4],r=[1,8],s=[1,7],o=[1,8,13,14,15,16,22,23,33,34,35,36],c=[1,24],a=[1,25],u=[1,18],l=[1,19],h=[1,20],f=[8,13,14,15,22,23,33,34,35,36],p=[16,34,35,36],y=[1,31],d=[1,35],g=[16,23,24,34,35,36],m=[1,38],v=[1,39],_=[26,27],b={trace:function(){},yy:{},symbols_:{error:2,root:3,lines:4,line:5,indentation:6,indentationLevel:7,INDENT:8,lineMain:9,end:10,tag:11,rest:12,COMMENT:13,FILTER:14,FILTER_LINE:15,NEWLINE:16,name:17,tagComponents:18,attributes:19,idComponent:20,classComponents:21,ID:22,CLASS:23,LEFT_PARENTHESIS:24,attributePairs:25,RIGHT_PARENTHESIS:26,SEPARATOR:27,attributePair:28,ATTRIBUTE:29,EQUAL:30,ATTRIBUTE_VALUE:31,AT_ATTRIBUTE:32,TAG:33,BUFFERED_CODE:34,UNBUFFERED_CODE:35,TEXT:36,$accept:0,$end:1},terminals_:{2:\"error\",8:\"INDENT\",13:\"COMMENT\",14:\"FILTER\",15:\"FILTER_LINE\",16:\"NEWLINE\",22:\"ID\",23:\"CLASS\",24:\"LEFT_PARENTHESIS\",26:\"RIGHT_PARENTHESIS\",27:\"SEPARATOR\",29:\"ATTRIBUTE\",30:\"EQUAL\",31:\"ATTRIBUTE_VALUE\",32:\"AT_ATTRIBUTE\",33:\"TAG\",34:\"BUFFERED_CODE\",35:\"UNBUFFERED_CODE\",36:\"TEXT\"},productions_:[0,[3,1],[4,2],[4,1],[6,0],[6,1],[7,2],[7,1],[5,3],[5,1],[9,2],[9,1],[9,1],[9,1],[9,1],[9,1],[10,1],[11,2],[11,2],[11,1],[11,1],[18,3],[18,2],[18,2],[18,2],[18,1],[18,1],[20,1],[21,2],[21,1],[19,3],[25,3],[25,1],[28,3],[28,1],[17,1],[12,1],[12,1],[12,1]],performAction:function(t,e,n,i,r,s,o){var c=s.length-1;switch(r){case 1:return this.$=i.nodePath[0].children;case 2:case 30:this.$=s[c-1];break;case 3:case 5:case 11:case 12:case 27:case 35:this.$=s[c];break;case 4:this.$=0;break;case 6:this.$=s[c-1]+1;break;case 7:this.$=1;break;case 8:this.$=i.append(s[c-1],s[c-2]);break;case 9:this.$=function(){if(s[c].newline)return i.newline()}();break;case 10:this.$=i.extend(s[c-1],s[c]);break;case 13:this.$={comment:s[c]};break;case 14:this.$={filter:s[c]};break;case 15:this.$={filterLine:s[c]};break;case 16:this.$={newline:!0};break;case 17:this.$=function(){return s[c].tag=s[c-1],s[c]}();break;case 18:this.$={tag:s[c-1],attributes:s[c]};break;case 19:this.$={tag:s[c]};break;case 20:this.$=i.extend(s[c],{tag:\"div\"});break;case 21:this.$={id:s[c-2],classes:s[c-1],attributes:s[c]};break;case 22:this.$={id:s[c-1],attributes:s[c]};break;case 23:this.$={classes:s[c-1],attributes:s[c]};break;case 24:this.$={id:s[c-1],classes:s[c]};break;case 25:this.$={id:s[c]};break;case 26:this.$={classes:s[c]};break;case 28:this.$=s[c-1].concat(s[c]);break;case 29:case 32:this.$=[s[c]];break;case 31:this.$=s[c-2].concat(s[c]);break;case 33:this.$={name:s[c-2],value:s[c]};break;case 34:this.$={name:s[c].substring(1),value:s[c]};break;case 36:this.$={bufferedCode:s[c]};break;case 37:this.$={unbufferedCode:s[c]};break;case 38:this.$={text:s[c]+\"\\n\"}}},table:[e(n,i,{3:1,4:2,5:3,6:4,10:5,7:6,8:r,16:s}),{1:[3]},e(n,i,{6:4,10:5,7:6,5:9,1:[2,1],8:r,16:s}),e(o,[2,3]),{9:10,11:11,12:12,13:[1,13],14:[1,14],15:[1,15],17:16,18:17,20:22,21:23,22:c,23:a,33:[1,21],34:u,35:l,36:h},e(o,[2,9]),e(n,[2,5],{8:[1,26]}),e(o,[2,16]),e(f,[2,7]),e(o,[2,2]),{10:27,16:s},{12:28,16:[2,11],34:u,35:l,36:h},{16:[2,12]},{16:[2,13]},{16:[2,14]},{16:[2,15]},e(p,[2,19],{20:22,21:23,18:29,19:30,22:c,23:a,24:y}),e(p,[2,20]),{16:[2,36]},{16:[2,37]},{16:[2,38]},e([16,22,23,24,34,35,36],[2,35]),e(p,[2,25],{21:32,19:33,23:a,24:y}),e(p,[2,26],{19:34,23:d,24:y}),e(g,[2,27]),e(g,[2,29]),e(f,[2,6]),e(o,[2,8]),{16:[2,10]},e(p,[2,17]),e(p,[2,18]),{25:36,28:37,29:m,32:v},e(p,[2,24],{19:40,23:d,24:y}),e(p,[2,22]),e(p,[2,23]),e(g,[2,28]),{26:[1,41],27:[1,42]},e(_,[2,32]),{30:[1,43]},e(_,[2,34]),e(p,[2,21]),e(p,[2,30]),{28:44,29:m,32:v},{31:[1,45]},e(_,[2,31]),e(_,[2,33])],defaultActions:{12:[2,12],13:[2,13],14:[2,14],15:[2,15],18:[2,36],19:[2,37],20:[2,38],28:[2,10]},parseError:function(t,e){function n(t,e){this.message=t,this.hash=e}if(!e.recoverable)throw n.prototype=Error,new n(t,e);this.trace(t)},parse:function(t){var e=this,n=[0],i=[null],r=[],s=this.table,o=\"\",c=0,a=0,u=0,l=r.slice.call(arguments,1),h=Object.create(this.lexer),f={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(f.yy[p]=this.yy[p]);h.setInput(t,f.yy),f.yy.lexer=h,f.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var y=h.yylloc;r.push(y);var d=h.options&&h.options.ranges;\"function\"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,m,v,_,b,E,T,x,k,A=function(){var t;return\"number\"!=typeof(t=h.lex()||1)&&(t=e.symbols_[t]||t),t},S={};;){if(v=n[n.length-1],this.defaultActions[v]?_=this.defaultActions[v]:(null!==g&&void 0!==g||(g=A()),_=s[v]&&s[v][g]),void 0===_||!_.length||!_[0]){var I=\"\";k=[];for(E in s[v])this.terminals_[E]&&E>2&&k.push(\"'\"+this.terminals_[E]+\"'\");I=h.showPosition?\"Parse error on line \"+(c+1)+\":\\n\"+h.showPosition()+\"\\nExpecting \"+k.join(\", \")+\", got '\"+(this.terminals_[g]||g)+\"'\":\"Parse error on line \"+(c+1)+\": Unexpected \"+(1==g?\"end of input\":\"'\"+(this.terminals_[g]||g)+\"'\"),this.parseError(I,{text:h.match,token:this.terminals_[g]||g,line:h.yylineno,loc:y,expected:k})}if(_[0]instanceof Array&&_.length>1)throw new Error(\"Parse Error: multiple actions possible at state: \"+v+\", token: \"+g);switch(_[0]){case 1:n.push(g),i.push(h.yytext),r.push(h.yylloc),n.push(_[1]),g=null,m?(g=m,m=null):(a=h.yyleng,o=h.yytext,c=h.yylineno,y=h.yylloc,u>0&&u--);break;case 2:if(T=this.productions_[_[1]][1],S.$=i[i.length-T],S._$={first_line:r[r.length-(T||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(T||1)].first_column,last_column:r[r.length-1].last_column},d&&(S._$.range=[r[r.length-(T||1)].range[0],r[r.length-1].range[1]]),void 0!==(b=this.performAction.apply(S,[o,a,c,f.yy,_[1],i,r].concat(l))))return b;T&&(n=n.slice(0,-1*T*2),i=i.slice(0,-1*T),r=r.slice(0,-1*T)),n.push(this.productions_[_[1]][0]),i.push(S.$),r.push(S._$),x=s[n[n.length-2]][n[n.length-1]],n.push(x);break;case 3:return!0}}return!0}};return t.prototype=b,b.Parser=t,new t}();void 0!==t&&void 0!==n&&(n.parser=r,n.Parser=r.Parser,n.parse=function(){return r.parse.apply(r,arguments)},n.main=function(e){e[1]||(console.log(\"Usage: \"+e[0]+\" FILE\"),i.exit(1));var r=t(\"fs\").readFileSync(t(\"path\").normalize(e[1]),\"utf8\");return n.parser.parse(r)},void 0!==e&&t.main===e&&n.main(i.argv.slice(1)))}).call(this,t(\"_process\"))},{_process:10,fs:7,path:9}],6:[function(t,e,n){(function(){\"use strict\";var n,i,r,s,o,c,a,u,l,h,f,p,y,d,g,m,v,_,b,E,T,x,k,A,S;n=t(\"o_0\"),l=new WeakMap,h=new WeakMap,T=function(t){var e;e=h.get(t)||0,h.set(t,e+1)},E=function(t){var e;e=h.get(t)||0,--e>0?h.set(t,e):(h.delete(t),u(t))},u=function(t){var e,n;null!=(e=t.children)&&Array.prototype.forEach.call(e,u),null!=(n=l.get(t))&&n.forEach(function(e){e(),l.delete(t)})},r=function(t,e){var n;(n=l.get(t))?n.push(e):l.set(t,[e])},p=/^on(touch|animation|transition)(start|iteration|move|end|cancel)$/,d=function(t,e){return t.match(p)||t in e},A=function(t,e,n){switch(t.nodeName){case\"SELECT\":t.oninput=t.onchange=function(){var t,n,i;t=(n=this.children[this.selectedIndex]).value,i=n._value,\"function\"==typeof e&&e(i||t)},o(t,e,n,function(e){var n;t._value=e,(n=t._options)?null!=e.value?t.value=(\"function\"==typeof e.value?e.value():void 0)||e.value:t.selectedIndex=S(n,e):t.value=e});break;default:t.oninput=t.onchange=function(){\"function\"==typeof e&&e(t.value)},o(t,e,n,function(e){t.value!==e&&(t.value=e)})}},x={INPUT:{checked:function(t,e,n){return t.onchange=function(){\"function\"==typeof e&&e(t.checked)},o(t,e,n,function(e){t.checked=e})}},SELECT:{options:function(t,e,n){o(t,e,n,function(e){f(t),t._options=e,e.map(function(e,n){var i,r,s;return i=a(\"option\"),i._value=e,s=g(e)?(null!=e?e.value:void 0)||n:e.toString(),o(i,s,e,function(t){i.value=t}),r=(null!=e?e.name:void 0)||e,o(i,r,e,function(t){i.textContent=t}),t.appendChild(i),e===t._value&&(t.selectedIndex=n),i})})}}},v=function(t,e,n,i){var r,c,a;c=t.nodeName,\"value\"===n?A(t,i):(r=null!=(a=x[c])?a[n]:void 0)?r(t,i,e):n.match(/^on/)&&d(n,t)?s(t,n.substr(2),i,e):d(\"on\"+n,t)?s(t,n,i,e):o(t,i,e,function(e){null!=e&&!1!==e?t.setAttribute(n,e):t.removeAttribute(n)})},_=function(t,e,n){c(t,e,n,\"id\",function(e){var n;n=e[e.length-1],t.id=n}),c(t,e,n,\"class\",function(e){t.className=e.join(\" \")}),c(t,e,n,\"style\",function(e){t.style=\"\",e.forEach(function(e){return g(e)?Object.assign(t.style,e):t.style=e})}),Object.keys(n).forEach(function(i){v(t,e,i,n[i])})},o=function(t,e,i,s){var o;o=n(function(){s(y(e,i))}),r(t,o.releaseDependencies)},s=function(t,e,n,i){\"function\"==typeof n&&t.addEventListener(e,n.bind(i))},c=function(t,e,n,i,r){var s;null!=(s=n[i])&&(delete n[i],o(t,function(){return k(s,e)},e,r))},b=function(t,e,n){var r;r=function(e){null==e||(\"function\"==typeof e.forEach?e.forEach(r):e instanceof Node?(T(e),t.appendChild(e)):t.appendChild(document.createTextNode(e)))},o(t,function(){var t;return t=[],n.call(e,{buffer:function(n){t.push(y(n,e))},element:m,filter:function(t,n){return i.filters[t].call(e,n,this)}}),t},e,function(e){f(t),e.forEach(r)})},m=function(t,e,n,i){var r;return r=a(t),_(r,e,n),\"SELECT\"!==r.nodeName&&b(r,e,i),r},(i=function(t){var e;return e={buffer:function(t){if(e.root)throw new Error(\"Cannot have multiple root elements\");e.root=t},element:m,filter:function(e,n){return i.filters[e].call(t,n,this)}}}).Observable=n,i._elementCleaners=l,i._dispose=u,i.retain=T,i.release=E,i.filters={},e.exports=i,a=function(t){return document.createElement(t)},f=function(t){for(var e;e=t.firstChild;)t.removeChild(e),E(e)},g=function(t){return\"object\"==typeof t},S=function(t,e){return g(e)?t.indexOf(e):t.map(function(t){return t.toString()}).indexOf(e.toString())},k=function(t,e){return t.map(function(t){return y(t,e)}).reduce(function(t,e){return t.concat(y(e))},[]).filter(function(t){return null!=t})},y=function(t,e){return\"function\"==typeof t?t.call(e):t}}).call(this)},{o_0:8}],7:[function(t,e,n){},{}],8:[function(t,e,n){(function(t){(function(){\"use strict\";var n,i,r,s,o,c,a,u,l=[].slice;e.exports=function(t,e){var s,h,f,p,y;return\"function\"==typeof(null!=t?t.observe:void 0)?t:(f=[],p=function(t){return i(f).forEach(function(e){return e(t)})},\"function\"==typeof t?(h=t,(y=function(){return o(y),t}).releaseDependencies=function(){var t;return null!=(t=y._observableDependencies)?t.forEach(function(t){return t.stopObserving(s)}):void 0},(s=function(){var n;return n=new Set,t=u(n,h,e),y.releaseDependencies(),y._observableDependencies=n,n.forEach(function(t){return t.observe(s)}),p(t)})()):(y=function(e){return arguments.length>0?t!==e&&(t=e,p(e)):o(y),t}).releaseDependencies=c,Array.isArray(t)&&([\"concat\",\"every\",\"filter\",\"forEach\",\"indexOf\",\"join\",\"lastIndexOf\",\"map\",\"reduce\",\"reduceRight\",\"slice\",\"some\"].forEach(function(e){return y[e]=function(){var n;return n=1<=arguments.length?l.call(arguments,0):[],o(y),t[e].apply(t,n)}}),[\"pop\",\"push\",\"reverse\",\"shift\",\"splice\",\"sort\",\"unshift\"].forEach(function(e){return y[e]=function(){var n,i;return n=1<=arguments.length?l.call(arguments,0):[],i=t[e].apply(t,n),p(t),i}}),n&&Object.defineProperty(y,\"length\",{get:function(){return o(y),t.length},set:function(e){var n;return n=t.length=e,p(t),n}}),r(y,{remove:function(e){var n,i;if((n=t.indexOf(e))>=0)return i=t.splice(n,1)[0],p(t),i},get:function(e){return o(y),t[e]},first:function(){return o(y),t[0]},last:function(){return o(y),t[t.length-1]},size:function(){return o(y),t.length}})),r(y,{listeners:f,observe:function(t){return f.push(t)},stopObserving:function(t){return a(f,t)},toggle:function(){return y(!t)},increment:function(e){return null==e&&(e=1),y(t+e)},decrement:function(e){return null==e&&(e=1),y(t-e)},toString:function(){return\"Observable(\"+t+\")\"}}),y)},r=Object.assign,t.OBSERVABLE_ROOT_HACK=[],o=function(e){var n;if(n=s(t.OBSERVABLE_ROOT_HACK))return n.add(e)},u=function(e,n,i){t.OBSERVABLE_ROOT_HACK.push(e);try{return n.call(i)}finally{t.OBSERVABLE_ROOT_HACK.pop()}},a=function(t,e){var n;if((n=t.indexOf(e))>=0)return t.splice(n,1)[0]},i=function(t){return t.concat([])},s=function(t){return t[t.length-1]},c=function(){};try{Object.defineProperty(function(){},\"length\",{get:c,set:c}),n=!0}catch(t){n=!1}}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],9:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];\".\"===r?t.splice(i,1):\"..\"===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift(\"..\");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var r=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/,s=function(t){return r.exec(t).slice(1)};n.resolve=function(){for(var n=\"\",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:t.cwd();if(\"string\"!=typeof o)throw new TypeError(\"Arguments to path.resolve must be strings\");o&&(n=o+\"/\"+n,r=\"/\"===o.charAt(0))}return n=e(i(n.split(\"/\"),function(t){return!!t}),!r).join(\"/\"),(r?\"/\":\"\")+n||\".\"},n.normalize=function(t){var r=n.isAbsolute(t),s=\"/\"===o(t,-1);return(t=e(i(t.split(\"/\"),function(t){return!!t}),!r).join(\"/\"))||r||(t=\".\"),t&&s&&(t+=\"/\"),(r?\"/\":\"\")+t},n.isAbsolute=function(t){return\"/\"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(i(t,function(t,e){if(\"string\"!=typeof t)throw new TypeError(\"Arguments to path.join must be strings\");return t}).join(\"/\"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&\"\"===t[e];e++);for(var n=t.length-1;n>=0&&\"\"===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var r=i(t.split(\"/\")),s=i(e.split(\"/\")),o=Math.min(r.length,s.length),c=o,a=0;a<o;a++)if(r[a]!==s[a]){c=a;break}for(var u=[],a=c;a<r.length;a++)u.push(\"..\");return(u=u.concat(s.slice(c))).join(\"/\")},n.sep=\"/\",n.delimiter=\":\",n.dirname=function(t){var e=s(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):\".\"},n.basename=function(t,e){var n=s(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return s(t)[3]};var o=\"b\"===\"ab\".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,t(\"_process\"))},{_process:10}],10:[function(t,e,n){function i(){throw new Error(\"setTimeout has not been defined\")}function r(){throw new Error(\"clearTimeout has not been defined\")}function s(t){if(h===setTimeout)return setTimeout(t,0);if((h===i||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function c(){g&&y&&(g=!1,y.length?d=y.concat(d):m=-1,d.length&&a())}function a(){if(!g){var t=s(c);g=!0;for(var e=d.length;e;){for(y=d,d=[];++m<e;)y&&y[m].run();m=-1,e=d.length}y=null,g=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var h,f,p=e.exports={};!function(){try{h=\"function\"==typeof setTimeout?setTimeout:i}catch(t){h=i}try{f=\"function\"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var y,d=[],g=!1,m=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),1!==d.length||g||s(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title=\"browser\",p.browser=!0,p.env={},p.argv=[],p.version=\"\",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(t){throw new Error(\"process.binding is not supported\")},p.cwd=function(){return\"/\"},p.chdir=function(t){throw new Error(\"process.chdir is not supported\")},p.umask=function(){return 0}},{}]},{},[2])(2)});\n",
      "type": "blob"
    },
    "lib/mount-fs": {
      "path": "lib/mount-fs",
      "content": "(function() {\n  var Bindable, Model, startsWith,\n    __slice = [].slice;\n\n  startsWith = require(\"../util\").startsWith;\n\n  Bindable = require(\"bindable\");\n\n  Model = require(\"model\");\n\n  module.exports = function(I) {\n    var bindSubsystemEvent, findMountPathFor, longestToShortest, mountPaths, mounts, proxyToMount, self;\n    mounts = {};\n    mountPaths = [];\n    longestToShortest = function(a, b) {\n      return b.length - a.length;\n    };\n    findMountPathFor = function(path) {\n      var mountPath;\n      mountPath = mountPaths.filter(function(p) {\n        return startsWith(path, p);\n      })[0];\n      return mountPath;\n    };\n    proxyToMount = function(method) {\n      return function() {\n        var mount, mountPath, params, path, subsystemPath;\n        path = arguments[0], params = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n        mountPath = findMountPathFor(path);\n        if (mountPath) {\n          mount = mounts[mountPath];\n        } else {\n          throw new Error(\"No mounted filesystem for \" + path);\n        }\n        subsystemPath = path.replace(mountPath, \"/\");\n        if (method === \"list\") {\n          return mount[method].apply(mount, [subsystemPath].concat(__slice.call(params))).then(function(entries) {\n            entries.forEach(function(entry) {\n              return entry.path = entry.path.replace(\"/\", mountPath);\n            });\n            return entries;\n          });\n        } else if (method === \"read\") {\n          return mount[method].apply(mount, [subsystemPath].concat(__slice.call(params))).then(function(blob) {\n            if (blob) {\n              blob.path = path;\n              return blob;\n            }\n          });\n        } else {\n          return mount[method].apply(mount, [subsystemPath].concat(__slice.call(params)));\n        }\n      };\n    };\n    bindSubsystemEvent = function(folderPath, subsystem, eventName) {\n      return subsystem.on(eventName, function(path) {\n        return self.trigger(eventName, path.replace(\"/\", folderPath));\n      });\n    };\n    self = Model().include(Bindable).extend({\n      read: proxyToMount(\"read\"),\n      write: proxyToMount(\"write\"),\n      \"delete\": proxyToMount(\"delete\"),\n      list: proxyToMount(\"list\"),\n      mount: function(folderPath, subsystem) {\n        mounts[folderPath] = subsystem;\n        mountPaths.push(folderPath);\n        mountPaths.sort(longestToShortest);\n        bindSubsystemEvent(folderPath, subsystem, \"write\");\n        bindSubsystemEvent(folderPath, subsystem, \"update\");\n        bindSubsystemEvent(folderPath, subsystem, \"delete\");\n        return self;\n      }\n    });\n    return self;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/outbound-clicks": {
      "path": "lib/outbound-clicks",
      "content": "(function() {\n  var parentElementOfType;\n\n  parentElementOfType = require(\"../util\").parentElementOfType;\n\n  document.addEventListener(\"click\", function(e) {\n    var anchor, href;\n    anchor = parentElementOfType(\"a\", e.target);\n    if (anchor) {\n      href = anchor.getAttribute('href');\n      if (href != null ? href.match(/^http/) : void 0) {\n        e.preventDefault();\n        if (href.match(/frogfeels\\.com/)) {\n          system.Achievement.unlock(\"Feeling the frog\");\n        }\n        return window.open(href);\n      }\n    }\n  });\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/pkg-fs": {
      "path": "lib/pkg-fs",
      "content": "(function() {\n  var Bindable, FolderEntry, Model, distributionPath, sourcePath;\n\n  Bindable = require(\"bindable\");\n\n  Model = require(\"model\");\n\n  FolderEntry = function(path, prefix) {\n    return {\n      folder: true,\n      path: prefix + path,\n      relativePath: path\n    };\n  };\n\n  sourcePath = function(path) {\n    return path.replace(/^\\//, \"\");\n  };\n\n  distributionPath = function(path) {\n    return path.replace(/\\..*$/, \"\");\n  };\n\n  module.exports = function(pkg, persistencePath) {\n    var compileAndWrite, notify, persist, self;\n    notify = function(eventType, path) {\n      return function(result) {\n        self.trigger(eventType, path);\n        return result;\n      };\n    };\n    persist = function() {\n      var pkgBlob;\n      pkgBlob = new Blob([JSON.stringify(pkg)], {\n        type: \"application/json; charset=utf8\"\n      });\n      return system.writeFile(persistencePath, pkgBlob);\n    };\n    compileAndWrite = function(path, blob) {\n      var writeCompiled, writeSource;\n      writeSource = blob.readAsText().then(function(text) {\n        var srcPath;\n        srcPath = sourcePath(path);\n        return pkg.source[srcPath] = {\n          content: text,\n          type: blob.type || \"\",\n          path: srcPath\n        };\n      });\n      blob.path = path;\n      writeCompiled = system.compileFile(blob).then(function(compiledSource) {\n        if (typeof compiledSource === \"string\") {\n          return pkg.distribution[distributionPath(sourcePath(path))] = {\n            content: compiledSource\n          };\n        } else {\n          return console.warn(\"Can't package files like \" + path + \" yet\", compiledSource);\n        }\n      });\n      return Promise.all([writeSource, writeCompiled]).then(persist);\n    };\n    return self = Model().include(Bindable).extend({\n      read: function(path) {\n        var blob, content, type, _ref;\n        _ref = pkg.source[sourcePath(path)], content = _ref.content, type = _ref.type;\n        if (type == null) {\n          type = \"\";\n        }\n        blob = new Blob([content], {\n          type: type\n        });\n        return Promise.resolve(blob).then(notify(\"read\", path));\n      },\n      write: function(path, blob) {\n        return compileAndWrite(path, blob).then(notify(\"write\", path));\n      },\n      \"delete\": function(path) {\n        return Promise.resolve().then(function() {\n          return delete pkg.source[sourcePath(path)];\n        }).then(notify(\"delete\", path));\n      },\n      list: function(dir) {\n        var sourceDir;\n        sourceDir = sourcePath(dir);\n        return Promise.resolve().then(function() {\n          return Object.keys(pkg.source).filter(function(path) {\n            return path.indexOf(sourceDir) === 0;\n          }).map(function(path) {\n            return {\n              path: \"/\" + path,\n              relativePath: path.replace(sourceDir, \"\"),\n              type: pkg.source[path].type || \"\"\n            };\n          });\n        }).then(function(files) {\n          var folderPaths, folders;\n          folderPaths = {};\n          files = files.filter(function(file) {\n            var folderPath;\n            if (file.relativePath.match(/\\//)) {\n              folderPath = file.relativePath.replace(/\\/.*$/, \"/\");\n              folderPaths[folderPath] = true;\n            } else {\n              return file;\n            }\n          });\n          folders = Object.keys(folderPaths).map(function(folderPath) {\n            return FolderEntry(folderPath, dir);\n          });\n          return folders.concat(files);\n        });\n      }\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/s3-fs": {
      "path": "lib/s3-fs",
      "content": "(function() {\n  var Bindable, BlobSham, FileEntry, FolderEntry, Model, blob, deleteFromS3, delimiter, endsWith, fetchFileMeta, fetchMeta, getRemote, json, list, localCache, pinvoke, startsWith, status, uploadToS3, _ref;\n\n  Bindable = require(\"bindable\");\n\n  Model = require(\"model\");\n\n  _ref = require(\"../util\"), pinvoke = _ref.pinvoke, startsWith = _ref.startsWith, endsWith = _ref.endsWith;\n\n  delimiter = \"/\";\n\n  localCache = {};\n\n  status = function(response) {\n    if (response.status >= 200 && response.status < 300) {\n      return response;\n    } else {\n      throw response;\n    }\n  };\n\n  json = function(response) {\n    return response.json();\n  };\n\n  blob = function(response) {\n    return response.blob();\n  };\n\n  uploadToS3 = function(bucket, key, file, options) {\n    var cacheControl;\n    if (options == null) {\n      options = {};\n    }\n    cacheControl = options.cacheControl;\n    if (cacheControl == null) {\n      cacheControl = 0;\n    }\n    localCache[key] = file;\n    return pinvoke(bucket, \"putObject\", {\n      Key: key,\n      ContentType: file.type,\n      Body: file,\n      CacheControl: \"max-age=\" + cacheControl\n    });\n  };\n\n  getRemote = function(bucket, key) {\n    var cachedItem;\n    cachedItem = localCache[key];\n    if (cachedItem) {\n      if (cachedItem instanceof Blob) {\n        return Promise.resolve(cachedItem);\n      } else {\n        return Promise.reject(cachedItem);\n      }\n    }\n    return pinvoke(bucket, \"getObject\", {\n      Key: key\n    }).then(function(data) {\n      var Body, ContentType;\n      Body = data.Body, ContentType = data.ContentType;\n      return new Blob([Body], {\n        type: ContentType\n      });\n    }).then(function(data) {\n      return localCache[key] = data;\n    })[\"catch\"](function(e) {\n      localCache[key] = e;\n      throw e;\n    });\n  };\n\n  deleteFromS3 = function(bucket, key) {\n    localCache[key] = new Error(\"Not Found\");\n    return pinvoke(bucket, \"deleteObject\", {\n      Key: key\n    });\n  };\n\n  list = function(bucket, id, dir) {\n    var prefix;\n    if (!startsWith(dir, delimiter)) {\n      dir = \"\" + delimiter + dir;\n    }\n    if (!endsWith(dir, delimiter)) {\n      dir = \"\" + dir + delimiter;\n    }\n    prefix = \"\" + id + dir;\n    return pinvoke(bucket, \"listObjects\", {\n      Prefix: prefix,\n      Delimiter: delimiter\n    }).then(function(result) {\n      var results;\n      results = result.CommonPrefixes.map(function(p) {\n        return FolderEntry(p.Prefix, id, prefix);\n      }).concat(result.Contents.map(function(o) {\n        return FileEntry(o, id, prefix, bucket);\n      })).map(function(entry) {\n        return fetchMeta(entry, bucket);\n      });\n      return Promise.all(results);\n    });\n  };\n\n  module.exports = function(id, bucket) {\n    var notify, self;\n    notify = function(eventType, path) {\n      return function(result) {\n        self.trigger(eventType, path);\n        return result;\n      };\n    };\n    return self = Model().include(Bindable).extend({\n      read: function(path) {\n        var key;\n        if (!startsWith(path, delimiter)) {\n          path = delimiter + path;\n        }\n        key = \"\" + id + path;\n        return getRemote(bucket, key).then(notify(\"read\", path));\n      },\n      write: function(path, blob) {\n        var key;\n        if (!startsWith(path, delimiter)) {\n          path = delimiter + path;\n        }\n        key = \"\" + id + path;\n        return uploadToS3(bucket, key, blob).then(notify(\"write\", path));\n      },\n      \"delete\": function(path) {\n        var key;\n        if (!startsWith(path, delimiter)) {\n          path = delimiter + path;\n        }\n        key = \"\" + id + path;\n        return deleteFromS3(bucket, key).then(notify(\"delete\", path));\n      },\n      list: function(folderPath) {\n        if (folderPath == null) {\n          folderPath = \"/\";\n        }\n        return list(bucket, id, folderPath);\n      }\n    });\n  };\n\n  fetchFileMeta = function(fileEntry, bucket) {\n    return pinvoke(bucket, \"headObject\", {\n      Key: fileEntry.remotePath\n    }).then(function(result) {\n      fileEntry.type = result.ContentType;\n      return fileEntry;\n    });\n  };\n\n  fetchMeta = function(entry, bucket) {\n    return Promise.resolve().then(function() {\n      if (entry.folder) {\n        return entry;\n      }\n      return fetchFileMeta(entry, bucket);\n    });\n  };\n\n  FolderEntry = function(path, id, prefix) {\n    return {\n      folder: true,\n      path: path.replace(id, \"\"),\n      relativePath: path.replace(prefix, \"\"),\n      remotePath: path\n    };\n  };\n\n  FileEntry = function(object, id, prefix, bucket) {\n    var entry, path;\n    path = object.Key;\n    entry = {\n      path: path.replace(id, \"\"),\n      relativePath: path.replace(prefix, \"\"),\n      remotePath: path,\n      size: object.Size\n    };\n    entry.blob = BlobSham(entry, bucket);\n    return entry;\n  };\n\n  BlobSham = function(entry, bucket) {\n    var remotePath;\n    remotePath = entry.remotePath;\n    return {\n      getURL: function() {\n        return getRemote(bucket, remotePath).then(URL.createObjectURL);\n      },\n      readAsText: function() {\n        return getRemote(bucket, remotePath).then(function(blob) {\n          return blob.readAsText();\n        });\n      }\n    };\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/stylus.min": {
      "path": "lib/stylus.min",
      "content": "if(Function.prototype.name===undefined&&Object.defineProperty!==undefined){Object.defineProperty(Function.prototype,\"name\",{get:function(){var regex=/function\\s([^(]{1,})\\(/,match=regex.exec(this.toString());return match&&match.length>1?match[1].trim():\"\"}})}if(String.prototype.trimRight===undefined){String.prototype.trimRight=function(){return String(this).replace(/\\s+$/,\"\")}}var stylus=module.exports=function(){function require(p){var path=require.resolve(p),mod=require.modules[path];if(!mod)throw new Error('failed to require \"'+p+'\"');if(!mod.exports){mod.exports={};mod.call(mod.exports,mod,mod.exports,require.relative(path))}return mod.exports}var bifs=\"called-from = ()\\n\\nvendors = moz webkit o ms official\\n\\n// stringify the given arg\\n\\n-string(arg)\\n  type(arg) + ' ' + arg\\n\\n// require a color\\n\\nrequire-color(color)\\n  unless color is a 'color'\\n    error('RGB or HSL value expected, got a ' + -string(color))\\n\\n// require a unit\\n\\nrequire-unit(n)\\n  unless n is a 'unit'\\n    error('unit expected, got a ' + -string(n))\\n\\n// require a string\\n\\nrequire-string(str)\\n  unless str is a 'string' or str is a 'ident'\\n    error('string expected, got a ' + -string(str))\\n\\n// Math functions\\n\\nabs(n) { math(n, 'abs') }\\nmin(a, b) { a < b ? a : b }\\nmax(a, b) { a > b ? a : b }\\n\\n// Trigonometrics\\nPI = -math-prop('PI')\\n\\nradians-to-degrees(angle)\\n  angle * (180 / PI)\\n\\ndegrees-to-radians(angle)\\n  unit(angle * (PI / 180),'')\\n\\nsin(n)\\n  n = degrees-to-radians(n) if unit(n) == 'deg'\\n  round(math(n, 'sin'), 9)\\n\\ncos(n)\\n  n = degrees-to-radians(n) if unit(n) == 'deg'\\n  round(math(n, 'cos'), 9)\\n\\n// Rounding Math functions\\n\\nceil(n, precision = 0)\\n  multiplier = 10 ** precision\\n  math(n * multiplier, 'ceil') / multiplier\\n\\nfloor(n, precision = 0)\\n  multiplier = 10 ** precision\\n  math(n * multiplier, 'floor') / multiplier\\n\\nround(n, precision = 0)\\n  multiplier = 10 ** precision\\n  math(n * multiplier, 'round') / multiplier\\n\\n// return the sum of the given numbers\\n\\nsum(nums)\\n  sum = 0\\n  sum += n for n in nums\\n\\n// return the average of the given numbers\\n\\navg(nums)\\n  sum(nums) / length(nums)\\n\\n// return a unitless number, or pass through\\n\\nremove-unit(n)\\n  if typeof(n) is 'unit'\\n    unit(n, '')\\n  else\\n    n\\n\\n// convert a percent to a decimal, or pass through\\n\\npercent-to-decimal(n)\\n  if unit(n) is '%'\\n    remove-unit(n) / 100\\n  else\\n    n\\n\\n// check if n is an odd number\\n\\nodd(n)\\n  1 == n % 2\\n\\n// check if n is an even number\\n\\neven(n)\\n  0 == n % 2\\n\\n// check if color is light\\n\\nlight(color)\\n  lightness(color) >= 50%\\n\\n// check if color is dark\\n\\ndark(color)\\n  lightness(color) < 50%\\n\\n// desaturate color by amount\\n\\ndesaturate(color, amount)\\n  adjust(color, 'saturation', - amount)\\n\\n// saturate color by amount\\n\\nsaturate(color = '', amount = 100%)\\n  if color is a 'color'\\n    adjust(color, 'saturation', amount)\\n  else\\n    unquote( 'saturate(' + color + ')' )\\n\\n// darken by the given amount\\n\\ndarken(color, amount)\\n  adjust(color, 'lightness', - amount)\\n\\n// lighten by the given amount\\n\\nlighten(color, amount)\\n  adjust(color, 'lightness', amount)\\n\\n// decrease opacity by amount\\n\\nfade-out(color, amount)\\n  color - rgba(black, percent-to-decimal(amount))\\n\\n// increase opacity by amount\\n\\nfade-in(color, amount)\\n  color + rgba(black, percent-to-decimal(amount))\\n\\n// spin hue by a given amount\\n\\nspin(color, amount)\\n  color + unit(amount, deg)\\n\\n// mix two colors by a given amount\\n\\nmix(color1, color2, weight = 50%)\\n  unless weight in 0..100\\n    error('Weight must be between 0% and 100%')\\n\\n  if length(color1) == 2\\n    weight = color1[0]\\n    color1 = color1[1]\\n\\n  else if length(color2) == 2\\n    weight = 100 - color2[0]\\n    color2 = color2[1]\\n\\n  require-color(color1)\\n  require-color(color2)\\n\\n  p = unit(weight / 100, '')\\n  w = p * 2 - 1\\n\\n  a = alpha(color1) - alpha(color2)\\n\\n  w1 = (((w * a == -1) ? w : (w + a) / (1 + w * a)) + 1) / 2\\n  w2 = 1 - w1\\n\\n  channels = (red(color1) red(color2)) (green(color1) green(color2)) (blue(color1) blue(color2))\\n  rgb = ()\\n\\n  for pair in channels\\n    push(rgb, floor(pair[0] * w1 + pair[1] * w2))\\n\\n  a1 = alpha(color1) * p\\n  a2 = alpha(color2) * (1 - p)\\n  alpha = a1 + a2\\n\\n  rgba(rgb[0], rgb[1], rgb[2], alpha)\\n\\n// invert colors, leave alpha intact\\n\\ninvert(color = '')\\n  if color is a 'color'\\n    rgba(#fff - color, alpha(color))\\n  else\\n    unquote( 'invert(' + color + ')' )\\n\\n// give complement of the given color\\n\\ncomplement( color )\\n  spin( color, 180 )\\n\\n// give grayscale of the given color\\n\\ngrayscale( color = '' )\\n  if color is a 'color'\\n    desaturate( color, 100% )\\n  else\\n    unquote( 'grayscale(' + color + ')' )\\n\\n// mix the given color with white\\n\\ntint( color, percent )\\n  mix( white, color, percent )\\n\\n// mix the given color with black\\n\\nshade( color, percent )\\n  mix( black, color, percent )\\n\\n// return the last value in the given expr\\n\\nlast(expr)\\n  expr[length(expr) - 1]\\n\\n// return keys in the given pairs or object\\n\\nkeys(pairs)\\n  ret = ()\\n  if type(pairs) == 'object'\\n    for key in pairs\\n      push(ret, key)\\n  else\\n    for pair in pairs\\n      push(ret, pair[0]);\\n  ret\\n\\n// return values in the given pairs or object\\n\\nvalues(pairs)\\n  ret = ()\\n  if type(pairs) == 'object'\\n    for key, val in pairs\\n      push(ret, val)\\n  else\\n    for pair in pairs\\n      push(ret, pair[1]);\\n  ret\\n\\n// join values with the given delimiter\\n\\njoin(delim, vals...)\\n  buf = ''\\n  vals = vals[0] if length(vals) == 1\\n  for val, i in vals\\n    buf += i ? delim + val : val\\n\\n// add a CSS rule to the containing block\\n\\n// - This definition allows add-property to be used as a mixin\\n// - It has the same effect as interpolation but allows users\\n//   to opt for a functional style\\n\\nadd-property-function = add-property\\nadd-property(name, expr)\\n  if mixin\\n    {name} expr\\n  else\\n    add-property-function(name, expr)\\n\\nprefix-classes(prefix)\\n  -prefix-classes(prefix, block)\\n\\n// Caching mixin, use inside your functions to enable caching by extending.\\n\\n$stylus_mixin_cache = {}\\ncache()\\n  $key = (current-media() or 'no-media') + '__' + called-from[0] + '__' + arguments\\n  if $key in $stylus_mixin_cache\\n    @extend {'$cache_placeholder_for_' + $stylus_mixin_cache[$key]}\\n  else if 'cache' in called-from\\n    {block}\\n  else\\n    $id = length($stylus_mixin_cache)\\n\\n    &,\\n    /$cache_placeholder_for_{$id}\\n      $stylus_mixin_cache[$key] = $id\\n      {block}\\n\";require.modules={};require.resolve=function(path){var orig=path,reg=path+\".js\",index=path+\"/index.js\";return require.modules[reg]&&reg||require.modules[index]&&index||orig};require.register=function(path,fn){require.modules[path]=fn};require.relative=function(parent){return function(p){if(\".\"!=p[0])return require(p);var path=parent.split(\"/\"),segs=p.split(\"/\");path.pop();for(var i=0;i<segs.length;i++){var seg=segs[i];if(\"..\"==seg)path.pop();else if(\".\"!=seg)path.push(seg)}return require(path.join(\"/\"))}};require.register(\"path.js\",function(module,exports,require){var isWindows=false;function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==\".\"){parts.splice(i,1)}else if(last===\"..\"){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift(\"..\")}}return parts}var splitPathRe=/^([\\s\\S]+\\/(?!$)|\\/)?((?:[\\s\\S]+?)?(\\.[^.]*)?)$/;exports.normalize=function(path){var isAbsolute=path.charAt(0)===\"/\",trailingSlash=path.slice(-1)===\"/\";path=normalizeArray(path.split(\"/\").filter(function(p){return!!p}),!isAbsolute).join(\"/\");if(!path&&!isAbsolute){path=\".\"}if(path&&trailingSlash){path+=\"/\"}return(isAbsolute?\"/\":\"\")+path};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(paths.filter(function(p,index){return p&&typeof p===\"string\"}).join(\"/\"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!==\"\")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!==\"\")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split(\"/\"));var toParts=trim(to.split(\"/\"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push(\"..\")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join(\"/\")};exports.dirname=function(path){var dir=splitPathRe.exec(path)[1]||\"\";if(!dir){return\".\"}else if(dir.length===1||isWindows&&dir.length<=3&&dir.charAt(1)===\":\"){return dir}else{return dir.substring(0,dir.length-1)}};exports.basename=function(path,ext){var f=splitPathRe.exec(path)[2]||\"\";if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){return splitPathRe.exec(path)[3]||\"\"}});require.register(\"colors.js\",function(module,exports,require){module.exports={aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],transparent:[0,0,0,0],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1],rebeccapurple:[102,51,153,1]}});require.register(\"errors.js\",function(module,exports,require){exports.ParseError=ParseError;exports.SyntaxError=SyntaxError;SyntaxError.prototype.__proto__=Error.prototype;function ParseError(msg){this.name=\"ParseError\";this.message=msg;Error.captureStackTrace(this,ParseError)}ParseError.prototype.__proto__=Error.prototype;function SyntaxError(msg){this.name=\"SyntaxError\";this.message=msg;Error.captureStackTrace(this,ParseError)}SyntaxError.prototype.__proto__=Error.prototype});require.register(\"units.js\",function(module,exports,require){module.exports=[\"em\",\"ex\",\"ch\",\"rem\",\"vw\",\"vh\",\"vmin\",\"vmax\",\"cm\",\"mm\",\"in\",\"pt\",\"pc\",\"px\",\"deg\",\"grad\",\"rad\",\"turn\",\"s\",\"ms\",\"Hz\",\"kHz\",\"dpi\",\"dpcm\",\"dppx\",\"x\",\"%\",\"fr\"]});require.register(\"functions/index.js\",function(module,exports,require){exports[\"add-property\"]=require(\"./add-property\");exports.adjust=require(\"./adjust\");exports.alpha=require(\"./alpha\");exports[\"base-convert\"]=require(\"./base-convert\");exports.basename=require(\"./basename\");exports.blend=require(\"./blend\");exports.blue=require(\"./blue\");exports.clone=require(\"./clone\");exports.component=require(\"./component\");exports.contrast=require(\"./contrast\");exports.convert=require(\"./convert\");exports[\"current-media\"]=require(\"./current-media\");exports.define=require(\"./define\");exports.dirname=require(\"./dirname\");exports.error=require(\"./error\");exports.extname=require(\"./extname\");exports.green=require(\"./green\");exports.hsl=require(\"./hsl\");exports.hsla=require(\"./hsla\");exports.hue=require(\"./hue\");exports.length=require(\"./length\");exports.lightness=require(\"./lightness\");exports[\"list-separator\"]=require(\"./list-separator\");exports.lookup=require(\"./lookup\");exports.luminosity=require(\"./luminosity\");exports.match=require(\"./match\");exports.math=require(\"./math\");exports.merge=exports.extend=require(\"./merge\");exports.operate=require(\"./operate\");exports[\"opposite-position\"]=require(\"./opposite-position\");exports.p=require(\"./p\");exports.pathjoin=require(\"./pathjoin\");exports.pop=require(\"./pop\");exports.push=exports.append=require(\"./push\");exports.range=require(\"./range\");exports.red=require(\"./red\");exports.remove=require(\"./remove\");exports.replace=require(\"./replace\");exports.rgb=require(\"./rgb\");exports.rgba=require(\"./rgba\");exports.s=require(\"./s\");exports.saturation=require(\"./saturation\");exports[\"selector-exists\"]=require(\"./selector-exists\");exports.selector=require(\"./selector\");exports.selectors=require(\"./selectors\");exports.shift=require(\"./shift\");exports.split=require(\"./split\");exports.substr=require(\"./substr\");exports.tan=require(\"./tan\");exports.trace=require(\"./trace\");exports.transparentify=require(\"./transparentify\");exports.type=exports.typeof=exports[\"type-of\"]=require(\"./type\");exports.unit=require(\"./unit\");exports.unquote=require(\"./unquote\");exports.unshift=exports.prepend=require(\"./unshift\");exports.warn=require(\"./warn\");exports[\"-math-prop\"]=require(\"./math-prop\");exports[\"-prefix-classes\"]=require(\"./prefix-classes\")});require.register(\"functions/url.js\",function(module,exports,require){var Compiler=require(\"../visitor/compiler\"),events=require(\"../renderer\").events,nodes=require(\"../nodes\"),extname=require(\"../path\").extname,utils=require(\"../utils\");var defaultMimes={\".gif\":\"image/gif\",\".png\":\"image/png\",\".jpg\":\"image/jpeg\",\".jpeg\":\"image/jpeg\",\".svg\":\"image/svg+xml\",\".webp\":\"image/webp\",\".ttf\":\"application/x-font-ttf\",\".eot\":\"application/vnd.ms-fontobject\",\".woff\":\"application/font-woff\",\".woff2\":\"application/font-woff2\"};module.exports=function(options){options=options||{};var _paths=options.paths||[];var sizeLimit=null!=options.limit?options.limit:3e4;var mimes=options.mimes||defaultMimes;function fn(url){var compiler=new Compiler(url);compiler.isURL=true;url=url.nodes.map(function(node){return compiler.visit(node)}).join(\"\");url=parse(url);var ext=extname(url.pathname),mime=mimes[ext],hash=url.hash||\"\",literal=new nodes.Literal('url(\"'+url.href+'\")'),paths=_paths.concat(this.paths),buf;if(!mime)return literal;if(url.protocol)return literal;var found=utils.lookup(url.pathname,paths);if(!found){events.emit(\"file not found\",\"File \"+literal+\" could not be found, literal url retained!\");return literal}buf=fs.readFileSync(found);if(false!==sizeLimit&&buf.length>sizeLimit)return literal;return new nodes.Literal('url(\"data:'+mime+\";base64,\"+buf.toString(\"base64\")+hash+'\")')}fn.raw=true;return fn};module.exports.mimes=defaultMimes});require.register(\"functions/add-property.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function addProperty(name,expr){utils.assertType(name,\"expression\",\"name\");name=utils.unwrap(name).first;utils.assertString(name,\"name\");utils.assertType(expr,\"expression\",\"expr\");var prop=new nodes.Property([name],expr);var block=this.closestBlock;var len=block.nodes.length,head=block.nodes.slice(0,block.index),tail=block.nodes.slice(block.index++,len);head.push(prop);block.nodes=head.concat(tail);return prop}).raw=true});require.register(\"functions/adjust.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function adjust(color,prop,amount){utils.assertColor(color,\"color\");utils.assertString(prop,\"prop\");utils.assertType(amount,\"unit\",\"amount\");var hsl=color.hsla.clone();prop={hue:\"h\",saturation:\"s\",lightness:\"l\"}[prop.string];if(!prop)throw new Error(\"invalid adjustment property\");var val=amount.val;if(\"%\"==amount.type){val=\"l\"==prop&&val>0?(100-hsl[prop])*val/100:hsl[prop]*(val/100)}hsl[prop]+=val;return hsl.rgba}});require.register(\"functions/alpha.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function alpha(color,value){color=color.rgba;if(value){return rgba(new nodes.Unit(color.r),new nodes.Unit(color.g),new nodes.Unit(color.b),value)}return new nodes.Unit(color.a,\"\")}});require.register(\"functions/base-convert.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function(num,base,width){utils.assertPresent(num,\"number\");utils.assertPresent(base,\"base\");num=utils.unwrap(num).nodes[0].val;base=utils.unwrap(base).nodes[0].val;width=width&&utils.unwrap(width).nodes[0].val||2;var result=Number(num).toString(base);while(result.length<width){result=\"0\"+result}return new nodes.Literal(result)}).raw=true});require.register(\"functions/basename.js\",function(module,exports,require){var utils=require(\"../utils\"),path=require(\"../path\");module.exports=function basename(p,ext){utils.assertString(p,\"path\");return path.basename(p.val,ext&&ext.val)}});require.register(\"functions/blend.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function blend(top,bottom){utils.assertColor(top);top=top.rgba;bottom=bottom||new nodes.RGBA(255,255,255,1);utils.assertColor(bottom);bottom=bottom.rgba;return new nodes.RGBA(top.r*top.a+bottom.r*(1-top.a),top.g*top.a+bottom.g*(1-top.a),top.b*top.a+bottom.b*(1-top.a),top.a+bottom.a-top.a*bottom.a)}});require.register(\"functions/blue.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function blue(color,value){color=color.rgba;if(value){return rgba(new nodes.Unit(color.r),new nodes.Unit(color.g),value,new nodes.Unit(color.a))}return new nodes.Unit(color.b,\"\")}});require.register(\"functions/clone.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function clone(expr){utils.assertPresent(expr,\"expr\");return expr.clone()}).raw=true});require.register(\"functions/component.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");var componentMap={red:\"r\",green:\"g\",blue:\"b\",alpha:\"a\",hue:\"h\",saturation:\"s\",lightness:\"l\"};var unitMap={hue:\"deg\",saturation:\"%\",lightness:\"%\"};var typeMap={red:\"rgba\",blue:\"rgba\",green:\"rgba\",alpha:\"rgba\",hue:\"hsla\",saturation:\"hsla\",lightness:\"hsla\"};module.exports=function component(color,name){utils.assertColor(color,\"color\");utils.assertString(name,\"name\");var name=name.string,unit=unitMap[name],type=typeMap[name],name=componentMap[name];if(!name)throw new Error('invalid color component \"'+name+'\"');return new nodes.Unit(color[type][name],unit)}});require.register(\"functions/contrast.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),blend=require(\"./blend\"),luminosity=require(\"./luminosity\");module.exports=function contrast(top,bottom){if(\"rgba\"!=top.nodeName&&\"hsla\"!=top.nodeName){return new nodes.Literal(\"contrast(\"+(top.isNull?\"\":top.toString())+\")\")}var result=new nodes.Object;top=top.rgba;bottom=bottom||new nodes.RGBA(255,255,255,1);utils.assertColor(bottom);bottom=bottom.rgba;function contrast(top,bottom){if(1>top.a){top=blend(top,bottom)}var l1=luminosity(bottom).val+.05,l2=luminosity(top).val+.05,ratio=l1/l2;if(l2>l1){ratio=1/ratio}return Math.round(ratio*10)/10}if(1<=bottom.a){var resultRatio=new nodes.Unit(contrast(top,bottom));result.set(\"ratio\",resultRatio);result.set(\"error\",new nodes.Unit(0));result.set(\"min\",resultRatio);result.set(\"max\",resultRatio)}else{var onBlack=contrast(top,blend(bottom,new nodes.RGBA(0,0,0,1))),onWhite=contrast(top,blend(bottom,new nodes.RGBA(255,255,255,1))),max=Math.max(onBlack,onWhite);function processChannel(topChannel,bottomChannel){return Math.min(Math.max(0,(topChannel-bottomChannel*bottom.a)/(1-bottom.a)),255)}var closest=new nodes.RGBA(processChannel(top.r,bottom.r),processChannel(top.g,bottom.g),processChannel(top.b,bottom.b),1);var min=contrast(top,blend(bottom,closest));result.set(\"ratio\",new nodes.Unit(Math.round((min+max)*50)/100));result.set(\"error\",new nodes.Unit(Math.round((max-min)*50)/100));result.set(\"min\",new nodes.Unit(min));result.set(\"max\",new nodes.Unit(max))}return result}});require.register(\"functions/convert.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function convert(str){utils.assertString(str,\"str\");return utils.parseString(str.string)}});require.register(\"functions/current-media.js\",function(module,exports,require){var nodes=require(\"../nodes\");module.exports=function currentMedia(){return new nodes.String(lookForMedia(this.closestBlock.node)||\"\");function lookForMedia(node){if(\"media\"==node.nodeName){return node.toString()}else if(node.block.parent.node){return lookForMedia(node.block.parent.node)}}}});require.register(\"functions/define.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function define(name,expr){utils.assertType(name,\"string\",\"name\");expr=utils.unwrap(expr);var scope=this.currentScope;var node=new nodes.Ident(name.val,expr);scope.add(node);return nodes.nil}});require.register(\"functions/dirname.js\",function(module,exports,require){var utils=require(\"../utils\"),path=require(\"../path\");module.exports=function dirname(p){utils.assertString(p,\"path\");return path.dirname(p.val).replace(/\\\\/g,\"/\")}});require.register(\"functions/error.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function error(msg){utils.assertType(msg,\"string\",\"msg\");var err=new Error(msg.val);err.fromStylus=true;throw err}});require.register(\"functions/extname.js\",function(module,exports,require){var utils=require(\"../utils\"),path=require(\"../path\");module.exports=function extname(p){utils.assertString(p,\"path\");return path.extname(p.val)}});require.register(\"functions/green.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function green(color,value){color=color.rgba;if(value){return rgba(new nodes.Unit(color.r),value,new nodes.Unit(color.b),new nodes.Unit(color.a))}return new nodes.Unit(color.g,\"\")}});require.register(\"functions/hsl.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),hsla=require(\"./hsla\");module.exports=function hsl(hue,saturation,lightness){if(1==arguments.length){utils.assertColor(hue,\"color\");return hue.hsla}else{return hsla(hue,saturation,lightness,new nodes.Unit(1))}}});require.register(\"functions/hsla.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function hsla(hue,saturation,lightness,alpha){switch(arguments.length){case 1:utils.assertColor(hue);return hue.hsla;case 2:utils.assertColor(hue);var color=hue.hsla;utils.assertType(saturation,\"unit\",\"alpha\");var alpha=saturation.clone();if(\"%\"==alpha.type)alpha.val/=100;return new nodes.HSLA(color.h,color.s,color.l,alpha.val);default:utils.assertType(hue,\"unit\",\"hue\");utils.assertType(saturation,\"unit\",\"saturation\");utils.assertType(lightness,\"unit\",\"lightness\");utils.assertType(alpha,\"unit\",\"alpha\");var alpha=alpha.clone();if(alpha&&\"%\"==alpha.type)alpha.val/=100;return new nodes.HSLA(hue.val,saturation.val,lightness.val,alpha.val)}}});require.register(\"functions/hue.js\",function(module,exports,require){var nodes=require(\"../nodes\"),hsla=require(\"./hsla\"),component=require(\"./component\");module.exports=function hue(color,value){if(value){var hslaColor=color.hsla;return hsla(value,new nodes.Unit(hslaColor.s),new nodes.Unit(hslaColor.l),new nodes.Unit(hslaColor.a))}return component(color,new nodes.String(\"hue\"))}});require.register(\"functions/length.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function length(expr){if(expr){if(expr.nodes){var nodes=utils.unwrap(expr).nodes;if(1==nodes.length&&\"object\"==nodes[0].nodeName){return nodes[0].length}else{return nodes.length}}else{return 1}}return 0}).raw=true});require.register(\"functions/lightness.js\",function(module,exports,require){var nodes=require(\"../nodes\"),hsla=require(\"./hsla\"),component=require(\"./component\");module.exports=function lightness(color,value){if(value){var hslaColor=color.hsla;return hsla(new nodes.Unit(hslaColor.h),new nodes.Unit(hslaColor.s),value,new nodes.Unit(hslaColor.a))}return component(color,new nodes.String(\"lightness\"))}});require.register(\"functions/list-separator.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function listSeparator(list){list=utils.unwrap(list);return new nodes.String(list.isList?\",\":\" \")}).raw=true});require.register(\"functions/lookup.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function lookup(name){utils.assertType(name,\"string\",\"name\");var node=this.lookup(name.val);if(!node)return nodes.nil;return this.visit(node)}});require.register(\"functions/luminosity.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function luminosity(color){utils.assertColor(color);color=color.rgba;function processChannel(channel){channel=channel/255;return.03928>channel?channel/12.92:Math.pow((channel+.055)/1.055,2.4)}return new nodes.Unit(.2126*processChannel(color.r)+.7152*processChannel(color.g)+.0722*processChannel(color.b))}});require.register(\"functions/match.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function match(pattern,val){utils.assertType(pattern,\"string\",\"pattern\");utils.assertString(val,\"val\");var re=new RegExp(pattern.val);return new nodes.Boolean(re.test(val.string))}});require.register(\"functions/math-prop.js\",function(module,exports,require){var nodes=require(\"../nodes\");module.exports=function math(prop){return new nodes.Unit(Math[prop.string])}});require.register(\"functions/math.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function math(n,fn){utils.assertType(n,\"unit\",\"n\");utils.assertString(fn,\"fn\");return new nodes.Unit(Math[fn.string](n.val),n.type)}});require.register(\"functions/merge.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function merge(dest){utils.assertPresent(dest,\"dest\");dest=utils.unwrap(dest).first;utils.assertType(dest,\"object\",\"dest\");var last=utils.unwrap(arguments[arguments.length-1]).first,deep=true===last.val;for(var i=1,len=arguments.length-deep;i<len;++i){utils.merge(dest.vals,utils.unwrap(arguments[i]).first.vals,deep)}return dest}).raw=true});require.register(\"functions/operate.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function operate(op,left,right){utils.assertType(op,\"string\",\"op\");utils.assertPresent(left,\"left\");utils.assertPresent(right,\"right\");return left.operate(op.val,right)}});require.register(\"functions/opposite-position.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function oppositePosition(positions){var expr=[];utils.unwrap(positions).nodes.forEach(function(pos,i){utils.assertString(pos,\"position \"+i);pos=function(){switch(pos.string){case\"top\":return\"bottom\";case\"bottom\":return\"top\";case\"left\":return\"right\";case\"right\":return\"left\";case\"center\":return\"center\";default:throw new Error(\"invalid position \"+pos)}}();expr.push(new nodes.Literal(pos))});return expr}).raw=true});require.register(\"functions/p.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");(module.exports=function p(){[].slice.call(arguments).forEach(function(expr){expr=utils.unwrap(expr);if(!expr.nodes.length)return;console.log(\"\u001b[90minspect:\u001b[0m %s\",expr.toString().replace(/^\\(|\\)$/g,\"\"))});return nodes.nil}).raw=true});require.register(\"functions/pathjoin.js\",function(module,exports,require){var path=require(\"../path\");(module.exports=function pathjoin(){var paths=[].slice.call(arguments).map(function(path){return path.first.string});return path.join.apply(null,paths).replace(/\\\\/g,\"/\")}).raw=true});require.register(\"functions/pop.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function pop(expr){expr=utils.unwrap(expr);return expr.nodes.pop()}).raw=true});require.register(\"functions/prefix-classes.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function prefixClasses(prefix,block){utils.assertString(prefix,\"prefix\");utils.assertType(block,\"block\",\"block\");var _prefix=this.prefix;this.options.prefix=this.prefix=prefix.string;block=this.visit(block);this.options.prefix=this.prefix=_prefix;return block}});require.register(\"functions/push.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function(expr){expr=utils.unwrap(expr);for(var i=1,len=arguments.length;i<len;++i){expr.nodes.push(utils.unwrap(arguments[i]).clone())}return expr.nodes.length}).raw=true});require.register(\"functions/range.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function range(start,stop,step){utils.assertType(start,\"unit\",\"start\");utils.assertType(stop,\"unit\",\"stop\");if(step){utils.assertType(step,\"unit\",\"step\");if(0==step.val){throw new Error('ArgumentError: \"step\" argument must not be zero')}}else{step=new nodes.Unit(1)}var list=new nodes.Expression;for(var i=start.val;i<=stop.val;i+=step.val){list.push(new nodes.Unit(i,start.type))\n}return list}});require.register(\"functions/red.js\",function(module,exports,require){var nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function red(color,value){color=color.rgba;if(value){return rgba(value,new nodes.Unit(color.g),new nodes.Unit(color.b),new nodes.Unit(color.a))}return new nodes.Unit(color.r,\"\")}});require.register(\"functions/remove.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function remove(object,key){utils.assertType(object,\"object\",\"object\");utils.assertString(key,\"key\");delete object.vals[key.string];return object}});require.register(\"functions/replace.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function replace(pattern,replacement,val){utils.assertString(pattern,\"pattern\");utils.assertString(replacement,\"replacement\");utils.assertString(val,\"val\");pattern=new RegExp(pattern.string,\"g\");var res=val.string.replace(pattern,replacement.string);return val instanceof nodes.Ident?new nodes.Ident(res):new nodes.String(res)}});require.register(\"functions/rgb.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),rgba=require(\"./rgba\");module.exports=function rgb(red,green,blue){switch(arguments.length){case 1:utils.assertColor(red);var color=red.rgba;return new nodes.RGBA(color.r,color.g,color.b,1);default:return rgba(red,green,blue,new nodes.Unit(1))}}});require.register(\"functions/rgba.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function rgba(red,green,blue,alpha){switch(arguments.length){case 1:utils.assertColor(red);return red.rgba;case 2:utils.assertColor(red);var color=red.rgba;utils.assertType(green,\"unit\",\"alpha\");alpha=green.clone();if(\"%\"==alpha.type)alpha.val/=100;return new nodes.RGBA(color.r,color.g,color.b,alpha.val);default:utils.assertType(red,\"unit\",\"red\");utils.assertType(green,\"unit\",\"green\");utils.assertType(blue,\"unit\",\"blue\");utils.assertType(alpha,\"unit\",\"alpha\");var r=\"%\"==red.type?Math.round(red.val*2.55):red.val,g=\"%\"==green.type?Math.round(green.val*2.55):green.val,b=\"%\"==blue.type?Math.round(blue.val*2.55):blue.val;alpha=alpha.clone();if(alpha&&\"%\"==alpha.type)alpha.val/=100;return new nodes.RGBA(r,g,b,alpha.val)}}});require.register(\"functions/s.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\"),Compiler=require(\"../visitor/compiler\");(module.exports=function s(fmt){fmt=utils.unwrap(fmt).nodes[0];utils.assertString(fmt);var self=this,str=fmt.string,args=arguments,i=1;str=str.replace(/%(s|d)/g,function(_,specifier){var arg=args[i++]||nodes.nil;switch(specifier){case\"s\":return new Compiler(arg,self.options).compile();case\"d\":arg=utils.unwrap(arg).first;if(\"unit\"!=arg.nodeName)throw new Error(\"%d requires a unit\");return arg.val}});return new nodes.Literal(str)}).raw=true});require.register(\"functions/saturation.js\",function(module,exports,require){var nodes=require(\"../nodes\"),hsla=require(\"./hsla\"),component=require(\"./component\");module.exports=function saturation(color,value){if(value){var hslaColor=color.hsla;return hsla(new nodes.Unit(hslaColor.h),value,new nodes.Unit(hslaColor.l),new nodes.Unit(hslaColor.a))}return component(color,new nodes.String(\"saturation\"))}});require.register(\"functions/selector-exists.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function selectorExists(sel){utils.assertString(sel,\"selector\");if(!this.__selectorsMap__){var Normalizer=require(\"../visitor/normalizer\"),visitor=new Normalizer(this.root.clone());visitor.visit(visitor.root);this.__selectorsMap__=visitor.map}return sel.string in this.__selectorsMap__}});require.register(\"functions/selector.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function selector(){var stack=this.selectorStack,args=[].slice.call(arguments);if(1==args.length){var expr=utils.unwrap(args[0]),len=expr.nodes.length;if(1==len){utils.assertString(expr.first,\"selector\");var SelectorParser=require(\"../selector-parser\"),val=expr.first.string,parsed=new SelectorParser(val).parse().val;if(parsed==val)return val;stack.push(parse(val))}else if(len>1){if(expr.isList){pushToStack(expr.nodes,stack)}else{stack.push(parse(expr.nodes.map(function(node){utils.assertString(node,\"selector\");return node.string}).join(\" \")))}}}else if(args.length>1){pushToStack(args,stack)}return stack.length?utils.compileSelectors(stack).join(\",\"):\"&\"}).raw=true;function pushToStack(selectors,stack){selectors.forEach(function(sel){sel=sel.first;utils.assertString(sel,\"selector\");stack.push(parse(sel.string))})}function parse(selector){var Parser=new require(\"../parser\"),parser=new Parser(selector),nodes;parser.state.push(\"selector-parts\");nodes=parser.selector();nodes.forEach(function(node){node.val=node.segments.map(function(seg){return seg.toString()}).join(\"\")});return nodes}});require.register(\"functions/selectors.js\",function(module,exports,require){var nodes=require(\"../nodes\"),Parser=require(\"../selector-parser\");module.exports=function selectors(){var stack=this.selectorStack,expr=new nodes.Expression(true);if(stack.length){for(var i=0;i<stack.length;i++){var group=stack[i],nested;if(group.length>1){expr.push(new nodes.String(group.map(function(selector){nested=new Parser(selector.val).parse().nested;return(nested&&i?\"& \":\"\")+selector.val}).join(\",\")))}else{var selector=group[0].val;nested=new Parser(selector).parse().nested;expr.push(new nodes.String((nested&&i?\"& \":\"\")+selector))}}}else{expr.push(new nodes.String(\"&\"))}return expr}});require.register(\"functions/shift.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function(expr){expr=utils.unwrap(expr);return expr.nodes.shift()}).raw=true});require.register(\"functions/split.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function split(delim,val){utils.assertString(delim,\"delimiter\");utils.assertString(val,\"val\");var splitted=val.string.split(delim.string);var expr=new nodes.Expression;var ItemNode=val instanceof nodes.Ident?nodes.Ident:nodes.String;for(var i=0,len=splitted.length;i<len;++i){expr.nodes.push(new ItemNode(splitted[i]))}return expr}});require.register(\"functions/substr.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function substr(val,start,length){utils.assertString(val,\"val\");utils.assertType(start,\"unit\",\"start\");length=length&&length.val;var res=val.string.substr(start.val,length);return val instanceof nodes.Ident?new nodes.Ident(res):new nodes.String(res)}});require.register(\"functions/tan.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function tan(angle){utils.assertType(angle,\"unit\",\"angle\");var radians=angle.val;if(angle.type===\"deg\"){radians*=Math.PI/180}var m=Math.pow(10,9);var sin=Math.round(Math.sin(radians)*m)/m,cos=Math.round(Math.cos(radians)*m)/m,tan=Math.round(m*sin/cos)/m;return new nodes.Unit(tan,\"\")}});require.register(\"functions/trace.js\",function(module,exports,require){var nodes=require(\"../nodes\");module.exports=function trace(){console.log(this.stack);return nodes.nil}});require.register(\"functions/transparentify.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function transparentify(top,bottom,alpha){utils.assertColor(top);top=top.rgba;bottom=bottom||new nodes.RGBA(255,255,255,1);if(!alpha&&bottom&&!bottom.rgba){alpha=bottom;bottom=new nodes.RGBA(255,255,255,1)}utils.assertColor(bottom);bottom=bottom.rgba;var bestAlpha=[\"r\",\"g\",\"b\"].map(function(channel){return(top[channel]-bottom[channel])/((0<top[channel]-bottom[channel]?255:0)-bottom[channel])}).sort(function(a,b){return a<b})[0];if(alpha){utils.assertType(alpha,\"unit\",\"alpha\");if(\"%\"==alpha.type){bestAlpha=alpha.val/100}else if(!alpha.type){bestAlpha=alpha=alpha.val}}bestAlpha=Math.max(Math.min(bestAlpha,1),0);function processChannel(channel){if(0==bestAlpha){return bottom[channel]}else{return bottom[channel]+(top[channel]-bottom[channel])/bestAlpha}}return new nodes.RGBA(processChannel(\"r\"),processChannel(\"g\"),processChannel(\"b\"),Math.round(bestAlpha*100)/100)}});require.register(\"functions/type.js\",function(module,exports,require){var utils=require(\"../utils\");module.exports=function type(node){utils.assertPresent(node,\"expression\");return node.nodeName}});require.register(\"functions/unit.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function unit(unit,type){utils.assertType(unit,\"unit\",\"unit\");if(type){utils.assertString(type,\"type\");return new nodes.Unit(unit.val,type.string)}else{return unit.type||\"\"}}});require.register(\"functions/unquote.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function unquote(string){utils.assertString(string,\"string\");return new nodes.Literal(string.string)}});require.register(\"functions/unshift.js\",function(module,exports,require){var utils=require(\"../utils\");(module.exports=function(expr){expr=utils.unwrap(expr);for(var i=1,len=arguments.length;i<len;++i){expr.nodes.unshift(utils.unwrap(arguments[i]))}return expr.nodes.length}).raw=true});require.register(\"functions/warn.js\",function(module,exports,require){var utils=require(\"../utils\"),nodes=require(\"../nodes\");module.exports=function warn(msg){utils.assertType(msg,\"string\",\"msg\");console.warn(\"Warning: %s\",msg.val);return nodes.nil}});require.register(\"lexer.js\",function(module,exports,require){var Token=require(\"./token\"),nodes=require(\"./nodes\"),errors=require(\"./errors\");exports=module.exports=Lexer;var alias={and:\"&&\",or:\"||\",is:\"==\",isnt:\"!=\",\"is not\":\"!=\",\":=\":\"?=\"};function Lexer(str,options){options=options||{};this.stash=[];this.indentStack=[];this.indentRe=null;this.lineno=1;this.column=1;function comment(str,val,offset,s){var inComment=s.lastIndexOf(\"/*\",offset)>s.lastIndexOf(\"*/\",offset),commentIdx=s.lastIndexOf(\"//\",offset),i=s.lastIndexOf(\"\\n\",offset),double=0,single=0;if(~commentIdx&&commentIdx>i){while(i!=offset){if(\"'\"==s[i])single?single--:single++;if('\"'==s[i])double?double--:double++;if(\"/\"==s[i]&&\"/\"==s[i+1]){inComment=!single&&!double;break}++i}}return inComment?str:val+\"\\r\"}if(\"﻿\"==str.charAt(0))str=str.slice(1);this.str=str.replace(/\\s+$/,\"\\n\").replace(/\\r\\n?/g,\"\\n\").replace(/\\\\ *\\n/g,\"\\r\").replace(/([,(:](?!\\/\\/[^ ])) *(?:\\/\\/[^\\n]*)?\\n\\s*/g,comment).replace(/\\s*\\n[ \\t]*([,)])/g,comment)}Lexer.prototype={inspect:function(){var tok,tmp=this.str,buf=[];while(\"eos\"!=(tok=this.next()).type){buf.push(tok.inspect())}this.str=tmp;return buf.concat(tok.inspect()).join(\"\\n\")},lookahead:function(n){var fetch=n-this.stash.length;while(fetch-->0)this.stash.push(this.advance());return this.stash[--n]},skip:function(len){var chunk=len[0];len=chunk?chunk.length:len;this.str=this.str.substr(len);if(chunk){this.move(chunk)}else{this.column+=len}},move:function(str){var lines=str.match(/\\n/g),idx=str.lastIndexOf(\"\\n\");if(lines)this.lineno+=lines.length;this.column=~idx?str.length-idx:this.column+str.length},next:function(){var tok=this.stashed()||this.advance();this.prev=tok;return tok},isPartOfSelector:function(){var tok=this.stash[this.stash.length-1]||this.prev;switch(tok&&tok.type){case\"color\":return 2==tok.val.raw.length;case\".\":case\"[\":return true}return false},advance:function(){var column=this.column,line=this.lineno,tok=this.eos()||this.nil()||this.sep()||this.keyword()||this.urlchars()||this.comment()||this.newline()||this.escaped()||this.important()||this.literal()||this.fun()||this.anonFunc()||this.atrule()||this.brace()||this.paren()||this.color()||this.string()||this.unit()||this.namedop()||this.boolean()||this.unicode()||this.ident()||this.op()||this.eol()||this.space()||this.selector();tok.lineno=line;tok.column=column;return tok},peek:function(){return this.lookahead(1)},stashed:function(){return this.stash.shift()},eos:function(){if(this.str.length)return;if(this.indentStack.length){this.indentStack.shift();return new Token(\"outdent\")}else{return new Token(\"eos\")}},urlchars:function(){var captures;if(!this.isURL)return;if(captures=/^[\\/:@.;?&=*!,<>#%0-9]+/.exec(this.str)){this.skip(captures);return new Token(\"literal\",new nodes.Literal(captures[0]))}},sep:function(){var captures;if(captures=/^;[ \\t]*/.exec(this.str)){this.skip(captures);return new Token(\";\")}},eol:function(){if(\"\\r\"==this.str[0]){++this.lineno;this.skip(1);return this.advance()}},space:function(){var captures;if(captures=/^([ \\t]+)/.exec(this.str)){this.skip(captures);return new Token(\"space\")}},escaped:function(){var captures;if(captures=/^\\\\(.)[ \\t]*/.exec(this.str)){var c=captures[1];this.skip(captures);return new Token(\"ident\",new nodes.Literal(c))}},literal:function(){var captures;if(captures=/^@css[ \\t]*\\{/.exec(this.str)){this.skip(captures);var c,braces=1,css=\"\",node;while(c=this.str[0]){this.str=this.str.substr(1);switch(c){case\"{\":++braces;break;case\"}\":--braces;break;case\"\\n\":case\"\\r\":++this.lineno;break}css+=c;if(!braces)break}css=css.replace(/\\s*}$/,\"\");node=new nodes.Literal(css);node.css=true;return new Token(\"literal\",node)}},important:function(){var captures;if(captures=/^!important[ \\t]*/.exec(this.str)){this.skip(captures);return new Token(\"ident\",new nodes.Literal(\"!important\"))}},brace:function(){var captures;if(captures=/^([{}])/.exec(this.str)){this.skip(1);var brace=captures[1];return new Token(brace,brace)}},paren:function(){var captures;if(captures=/^([()])([ \\t]*)/.exec(this.str)){var paren=captures[1];this.skip(captures);if(\")\"==paren)this.isURL=false;var tok=new Token(paren,paren);tok.space=captures[2];return tok}},nil:function(){var captures,tok;if(captures=/^(null)\\b[ \\t]*/.exec(this.str)){this.skip(captures);if(this.isPartOfSelector()){tok=new Token(\"ident\",new nodes.Ident(captures[0]))}else{tok=new Token(\"null\",nodes.nil)}return tok}},keyword:function(){var captures,tok;if(captures=/^(return|if|else|unless|for|in)\\b[ \\t]*/.exec(this.str)){var keyword=captures[1];this.skip(captures);if(this.isPartOfSelector()){tok=new Token(\"ident\",new nodes.Ident(captures[0]))}else{tok=new Token(keyword,keyword)}return tok}},namedop:function(){var captures,tok;if(captures=/^(not|and|or|is a|is defined|isnt|is not|is)(?!-)\\b([ \\t]*)/.exec(this.str)){var op=captures[1];this.skip(captures);if(this.isPartOfSelector()){tok=new Token(\"ident\",new nodes.Ident(captures[0]))}else{op=alias[op]||op;tok=new Token(op,op)}tok.space=captures[2];return tok}},op:function(){var captures;if(captures=/^([.]{1,3}|&&|\\|\\||[!<>=?:]=|\\*\\*|[-+*\\/%]=?|[,=?:!~<>&\\[\\]])([ \\t]*)/.exec(this.str)){var op=captures[1];this.skip(captures);op=alias[op]||op;var tok=new Token(op,op);tok.space=captures[2];this.isURL=false;return tok}},anonFunc:function(){var tok;if(\"@\"==this.str[0]&&\"(\"==this.str[1]){this.skip(2);tok=new Token(\"function\",new nodes.Ident(\"anonymous\"));tok.anonymous=true;return tok}},atrule:function(){var captures;if(captures=/^@(?:-(\\w+)-)?([a-zA-Z0-9-_]+)[ \\t]*/.exec(this.str)){this.skip(captures);var vendor=captures[1],type=captures[2],tok;switch(type){case\"require\":case\"import\":case\"charset\":case\"namespace\":case\"media\":case\"scope\":case\"supports\":return new Token(type);case\"document\":return new Token(\"-moz-document\");case\"block\":return new Token(\"atblock\");case\"extend\":case\"extends\":return new Token(\"extend\");case\"keyframes\":return new Token(type,vendor);default:return new Token(\"atrule\",vendor?\"-\"+vendor+\"-\"+type:type)}}},comment:function(){if(\"/\"==this.str[0]&&\"/\"==this.str[1]){var end=this.str.indexOf(\"\\n\");if(-1==end)end=this.str.length;this.skip(end);return this.advance()}if(\"/\"==this.str[0]&&\"*\"==this.str[1]){var end=this.str.indexOf(\"*/\");if(-1==end)end=this.str.length;var str=this.str.substr(0,end+2),lines=str.split(/\\n|\\r/).length-1,suppress=true,inline=false;this.lineno+=lines;this.skip(end+2);if(\"!\"==str[2]){str=str.replace(\"*!\",\"*\");suppress=false}if(this.prev&&\";\"==this.prev.type)inline=true;return new Token(\"comment\",new nodes.Comment(str,suppress,inline))}},\"boolean\":function(){var captures;if(captures=/^(true|false)\\b([ \\t]*)/.exec(this.str)){var val=nodes.Boolean(\"true\"==captures[1]);this.skip(captures);var tok=new Token(\"boolean\",val);tok.space=captures[2];return tok}},unicode:function(){var captures;if(captures=/^u\\+[0-9a-f?]{1,6}(?:-[0-9a-f]{1,6})?/i.exec(this.str)){this.skip(captures);return new Token(\"literal\",new nodes.Literal(captures[0]))}},fun:function(){var captures;if(captures=/^(-*[_a-zA-Z$][-\\w\\d$]*)\\(([ \\t]*)/.exec(this.str)){var name=captures[1];this.skip(captures);this.isURL=\"url\"==name;var tok=new Token(\"function\",new nodes.Ident(name));tok.space=captures[2];return tok}},ident:function(){var captures;if(captures=/^-*[_a-zA-Z$][-\\w\\d$]*/.exec(this.str)){this.skip(captures);return new Token(\"ident\",new nodes.Ident(captures[0]))}},newline:function(){var captures,re;if(this.indentRe){captures=this.indentRe.exec(this.str)}else{re=/^\\n([\\t]*)[ \\t]*/;captures=re.exec(this.str);if(captures&&!captures[1].length){re=/^\\n([ \\t]*)/;captures=re.exec(this.str)}if(captures&&captures[1].length)this.indentRe=re}if(captures){var tok,indents=captures[1].length;this.skip(captures);if(this.str[0]===\" \"||this.str[0]===\"\t\"){throw new errors.SyntaxError(\"Invalid indentation. You can use tabs or spaces to indent, but not both.\")}if(\"\\n\"==this.str[0])return this.advance();if(this.indentStack.length&&indents<this.indentStack[0]){while(this.indentStack.length&&this.indentStack[0]>indents){this.stash.push(new Token(\"outdent\"));this.indentStack.shift()}tok=this.stash.pop()}else if(indents&&indents!=this.indentStack[0]){this.indentStack.unshift(indents);tok=new Token(\"indent\")}else{tok=new Token(\"newline\")}return tok}},unit:function(){var captures;if(captures=/^(-)?(\\d+\\.\\d+|\\d+|\\.\\d+)(%|[a-zA-Z]+)?[ \\t]*/.exec(this.str)){this.skip(captures);var n=parseFloat(captures[2]);if(\"-\"==captures[1])n=-n;var node=new nodes.Unit(n,captures[3]);node.raw=captures[0];return new Token(\"unit\",node)}},string:function(){var captures;if(captures=/^(\"[^\"]*\"|'[^']*')[ \\t]*/.exec(this.str)){var str=captures[1],quote=captures[0][0];this.skip(captures);str=str.slice(1,-1).replace(/\\\\n/g,\"\\n\");return new Token(\"string\",new nodes.String(str,quote))}},color:function(){return this.rrggbbaa()||this.rrggbb()||this.rgba()||this.rgb()||this.nn()||this.n()},n:function(){var captures;if(captures=/^#([a-fA-F0-9]{1})[ \\t]*/.exec(this.str)){this.skip(captures);var n=parseInt(captures[1]+captures[1],16),color=new nodes.RGBA(n,n,n,1);color.raw=captures[0];return new Token(\"color\",color)}},nn:function(){var captures;if(captures=/^#([a-fA-F0-9]{2})[ \\t]*/.exec(this.str)){this.skip(captures);var n=parseInt(captures[1],16),color=new nodes.RGBA(n,n,n,1);color.raw=captures[0];return new Token(\"color\",color)}},rgb:function(){var captures;if(captures=/^#([a-fA-F0-9]{3})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb[0]+rgb[0],16),g=parseInt(rgb[1]+rgb[1],16),b=parseInt(rgb[2]+rgb[2],16),color=new nodes.RGBA(r,g,b,1);color.raw=captures[0];return new Token(\"color\",color)}},rgba:function(){var captures;if(captures=/^#([a-fA-F0-9]{4})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb[0]+rgb[0],16),g=parseInt(rgb[1]+rgb[1],16),b=parseInt(rgb[2]+rgb[2],16),a=parseInt(rgb[3]+rgb[3],16),color=new nodes.RGBA(r,g,b,a/255);color.raw=captures[0];return new Token(\"color\",color)}},rrggbb:function(){var captures;if(captures=/^#([a-fA-F0-9]{6})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb.substr(0,2),16),g=parseInt(rgb.substr(2,2),16),b=parseInt(rgb.substr(4,2),16),color=new nodes.RGBA(r,g,b,1);color.raw=captures[0];return new Token(\"color\",color)}},rrggbbaa:function(){var captures;if(captures=/^#([a-fA-F0-9]{8})[ \\t]*/.exec(this.str)){this.skip(captures);var rgb=captures[1],r=parseInt(rgb.substr(0,2),16),g=parseInt(rgb.substr(2,2),16),b=parseInt(rgb.substr(4,2),16),a=parseInt(rgb.substr(6,2),16),color=new nodes.RGBA(r,g,b,a/255);color.raw=captures[0];return new Token(\"color\",color)}},selector:function(){var captures;if(captures=/^\\^|.*?(?=\\/\\/(?![^\\[]*\\])|[,\\n{])/.exec(this.str)){var selector=captures[0];this.skip(captures);return new Token(\"selector\",selector)}}}});require.register(\"nodes/arguments.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"../nodes\"),utils=require(\"../utils\");var Arguments=module.exports=function Arguments(){nodes.Expression.call(this);this.map={}};Arguments.prototype.__proto__=nodes.Expression.prototype;Arguments.fromExpression=function(expr){var args=new Arguments,len=expr.nodes.length;args.lineno=expr.lineno;args.column=expr.column;args.isList=expr.isList;for(var i=0;i<len;++i){args.push(expr.nodes[i])}return args};Arguments.prototype.clone=function(parent){var clone=nodes.Expression.prototype.clone.call(this,parent);clone.map={};for(var key in this.map){clone.map[key]=this.map[key].clone(parent,clone)}clone.isList=this.isList;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Arguments.prototype.toJSON=function(){return{__type:\"Arguments\",map:this.map,isList:this.isList,preserve:this.preserve,lineno:this.lineno,column:this.column,filename:this.filename,nodes:this.nodes}}});require.register(\"nodes/binop.js\",function(module,exports,require){var Node=require(\"./node\");var BinOp=module.exports=function BinOp(op,left,right){Node.call(this);this.op=op;this.left=left;this.right=right};BinOp.prototype.__proto__=Node.prototype;BinOp.prototype.clone=function(parent){var clone=new BinOp(this.op);clone.left=this.left.clone(parent,clone);clone.right=this.right&&this.right.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;if(this.val)clone.val=this.val.clone(parent,clone);return clone};BinOp.prototype.toString=function(){return this.left.toString()+\" \"+this.op+\" \"+this.right.toString()};BinOp.prototype.toJSON=function(){var json={__type:\"BinOp\",left:this.left,right:this.right,op:this.op,lineno:this.lineno,column:this.column,filename:this.filename};if(this.val)json.val=this.val;return json}});require.register(\"nodes/block.js\",function(module,exports,require){var Node=require(\"./node\");var Block=module.exports=function Block(parent,node){Node.call(this);this.nodes=[];this.parent=parent;this.node=node;this.scope=true};Block.prototype.__proto__=Node.prototype;Block.prototype.__defineGetter__(\"hasProperties\",function(){for(var i=0,len=this.nodes.length;i<len;++i){if(\"property\"==this.nodes[i].nodeName){return true}}});Block.prototype.__defineGetter__(\"hasMedia\",function(){for(var i=0,len=this.nodes.length;i<len;++i){var nodeName=this.nodes[i].nodeName;if(\"media\"==nodeName){return true}}return false});Block.prototype.__defineGetter__(\"isEmpty\",function(){return!this.nodes.length});Block.prototype.clone=function(parent,node){parent=parent||this.parent;var clone=new Block(parent,node||this.node);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.scope=this.scope;this.nodes.forEach(function(node){clone.push(node.clone(clone,clone))});return clone};Block.prototype.push=function(node){this.nodes.push(node)};Block.prototype.toJSON=function(){return{__type:\"Block\",scope:this.scope,lineno:this.lineno,column:this.column,filename:this.filename,nodes:this.nodes}}});require.register(\"nodes/boolean.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Boolean=module.exports=function Boolean(val){Node.call(this);if(this.nodeName){this.val=!!val}else{return new Boolean(val)}};Boolean.prototype.__proto__=Node.prototype;Boolean.prototype.toBoolean=function(){return this};Boolean.prototype.__defineGetter__(\"isTrue\",function(){return this.val});Boolean.prototype.__defineGetter__(\"isFalse\",function(){return!this.val});Boolean.prototype.negate=function(){return new Boolean(!this.val)};Boolean.prototype.inspect=function(){return\"[Boolean \"+this.val+\"]\"};Boolean.prototype.toString=function(){return this.val?\"true\":\"false\"};Boolean.prototype.toJSON=function(){return{__type:\"Boolean\",val:this.val}}});require.register(\"nodes/call.js\",function(module,exports,require){var Node=require(\"./node\");var Call=module.exports=function Call(name,args){Node.call(this);this.name=name;this.args=args};Call.prototype.__proto__=Node.prototype;Call.prototype.clone=function(parent){var clone=new Call(this.name);clone.args=this.args.clone(parent,clone);if(this.block)clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Call.prototype.toString=function(){var args=this.args.nodes.map(function(node){var str=node.toString();return str.slice(1,str.length-1)}).join(\", \");return this.name+\"(\"+args+\")\"};Call.prototype.toJSON=function(){var json={__type:\"Call\",name:this.name,args:this.args,lineno:this.lineno,column:this.column,filename:this.filename};if(this.block)json.block=this.block;return json}});require.register(\"nodes/charset.js\",function(module,exports,require){var Node=require(\"./node\");var Charset=module.exports=function Charset(val){Node.call(this);this.val=val};Charset.prototype.__proto__=Node.prototype;Charset.prototype.toString=function(){return\"@charset \"+this.val};Charset.prototype.toJSON=function(){return{__type:\"Charset\",val:this.val,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/namespace.js\",function(module,exports,require){var Node=require(\"./node\");var Namespace=module.exports=function Namespace(val,prefix){Node.call(this);this.val=val;this.prefix=prefix};Namespace.prototype.__proto__=Node.prototype;Namespace.prototype.toString=function(){return\"@namespace \"+(this.prefix?this.prefix+\" \":\"\")+this.val};Namespace.prototype.toJSON=function(){return{__type:\"Namespace\",val:this.val,prefix:this.prefix,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/comment.js\",function(module,exports,require){var Node=require(\"./node\");var Comment=module.exports=function Comment(str,suppress,inline){Node.call(this);this.str=str;this.suppress=suppress;this.inline=inline};Comment.prototype.__proto__=Node.prototype;Comment.prototype.toJSON=function(){return{__type:\"Comment\",str:this.str,suppress:this.suppress,inline:this.inline,lineno:this.lineno,column:this.column,filename:this.filename}};Comment.prototype.toString=function(){return this.str}});require.register(\"nodes/each.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Each=module.exports=function Each(val,key,expr,block){Node.call(this);this.val=val;this.key=key;this.expr=expr;this.block=block};Each.prototype.__proto__=Node.prototype;Each.prototype.clone=function(parent){var clone=new Each(this.val,this.key);clone.expr=this.expr.clone(parent,clone);clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Each.prototype.toJSON=function(){return{__type:\"Each\",val:this.val,key:this.key,expr:this.expr,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/expression.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"../nodes\"),utils=require(\"../utils\");var Expression=module.exports=function Expression(isList){Node.call(this);this.nodes=[];this.isList=isList};Expression.prototype.__defineGetter__(\"isEmpty\",function(){return!this.nodes.length});Expression.prototype.__defineGetter__(\"first\",function(){return this.nodes[0]?this.nodes[0].first:nodes.nil});Expression.prototype.__defineGetter__(\"hash\",function(){return this.nodes.map(function(node){return node.hash}).join(\"::\")});Expression.prototype.__proto__=Node.prototype;Expression.prototype.clone=function(parent){var clone=new this.constructor(this.isList);clone.preserve=this.preserve;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.nodes=this.nodes.map(function(node){return node.clone(parent,clone)});return clone};Expression.prototype.push=function(node){this.nodes.push(node)};Expression.prototype.operate=function(op,right,val){switch(op){case\"[]=\":var self=this,range=utils.unwrap(right).nodes,val=utils.unwrap(val),len,node;range.forEach(function(unit){len=self.nodes.length;if(\"unit\"==unit.nodeName){var i=unit.val<0?len+unit.val:unit.val,n=i;while(i-->len)self.nodes[i]=nodes.nil;self.nodes[n]=val}else if(unit.string){node=self.nodes[0];if(node&&\"object\"==node.nodeName)node.set(unit.string,val.clone())}});return val;case\"[]\":var expr=new nodes.Expression,vals=utils.unwrap(this).nodes,range=utils.unwrap(right).nodes,node;range.forEach(function(unit){if(\"unit\"==unit.nodeName){node=vals[unit.val<0?vals.length+unit.val:unit.val]}else if(\"object\"==vals[0].nodeName){node=vals[0].get(unit.string)}if(node)expr.push(node)});return expr.isEmpty?nodes.nil:utils.unwrap(expr);case\"||\":return this.toBoolean().isTrue?this:right;case\"in\":return Node.prototype.operate.call(this,op,right);case\"!=\":return this.operate(\"==\",right,val).negate();case\"==\":var len=this.nodes.length,right=right.toExpression(),a,b;if(len!=right.nodes.length)return nodes.no;for(var i=0;i<len;++i){a=this.nodes[i];b=right.nodes[i];if(a.operate(op,b).isTrue)continue;return nodes.no}return nodes.yes;break;default:return this.first.operate(op,right,val)}};Expression.prototype.toBoolean=function(){if(this.nodes.length>1)return nodes.yes;return this.first.toBoolean()};Expression.prototype.toString=function(){return\"(\"+this.nodes.map(function(node){return node.toString()}).join(this.isList?\", \":\" \")+\")\"};Expression.prototype.toJSON=function(){return{__type:\"Expression\",isList:this.isList,preserve:this.preserve,lineno:this.lineno,column:this.column,filename:this.filename,nodes:this.nodes}}});require.register(\"nodes/function.js\",function(module,exports,require){var Node=require(\"./node\");var Function=module.exports=function Function(name,params,body){Node.call(this);this.name=name;this.params=params;this.block=body;if(\"function\"==typeof params)this.fn=params};Function.prototype.__defineGetter__(\"arity\",function(){return this.params.length});Function.prototype.__proto__=Node.prototype;Function.prototype.__defineGetter__(\"hash\",function(){return\"function \"+this.name});Function.prototype.clone=function(parent){if(this.fn){var clone=new Function(this.name,this.fn)}else{var clone=new Function(this.name);clone.params=this.params.clone(parent,clone);clone.block=this.block.clone(parent,clone)}clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Function.prototype.toString=function(){if(this.fn){return this.name+\"(\"+this.fn.toString().match(/^function *\\w*\\((.*?)\\)/).slice(1).join(\", \")+\")\"}else{return this.name+\"(\"+this.params.nodes.join(\", \")+\")\"}};Function.prototype.toJSON=function(){var json={__type:\"Function\",name:this.name,lineno:this.lineno,column:this.column,filename:this.filename};if(this.fn){json.fn=this.fn}else{json.params=this.params;json.block=this.block}return json}});require.register(\"nodes/group.js\",function(module,exports,require){var Node=require(\"./node\");var Group=module.exports=function Group(){Node.call(this);this.nodes=[];this.extends=[]};Group.prototype.__proto__=Node.prototype;Group.prototype.push=function(selector){this.nodes.push(selector)};Group.prototype.__defineGetter__(\"block\",function(){return this.nodes[0].block});Group.prototype.__defineSetter__(\"block\",function(block){for(var i=0,len=this.nodes.length;i<len;++i){this.nodes[i].block=block}});Group.prototype.__defineGetter__(\"hasOnlyPlaceholders\",function(){return this.nodes.every(function(selector){return selector.isPlaceholder})});Group.prototype.clone=function(parent){var clone=new Group;clone.lineno=this.lineno;clone.column=this.column;this.nodes.forEach(function(node){clone.push(node.clone(parent,clone))\n});clone.filename=this.filename;clone.block=this.block.clone(parent,clone);return clone};Group.prototype.toJSON=function(){return{__type:\"Group\",nodes:this.nodes,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/hsla.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var HSLA=exports=module.exports=function HSLA(h,s,l,a){Node.call(this);this.h=clampDegrees(h);this.s=clampPercentage(s);this.l=clampPercentage(l);this.a=clampAlpha(a);this.hsla=this};HSLA.prototype.__proto__=Node.prototype;HSLA.prototype.toString=function(){return\"hsla(\"+this.h+\",\"+this.s.toFixed(0)+\"%,\"+this.l.toFixed(0)+\"%,\"+this.a+\")\"};HSLA.prototype.clone=function(parent){var clone=new HSLA(this.h,this.s,this.l,this.a);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};HSLA.prototype.toJSON=function(){return{__type:\"HSLA\",h:this.h,s:this.s,l:this.l,a:this.a,lineno:this.lineno,column:this.column,filename:this.filename}};HSLA.prototype.__defineGetter__(\"rgba\",function(){return nodes.RGBA.fromHSLA(this)});HSLA.prototype.__defineGetter__(\"hash\",function(){return this.rgba.toString()});HSLA.prototype.add=function(h,s,l){return new HSLA(this.h+h,this.s+s,this.l+l,this.a)};HSLA.prototype.sub=function(h,s,l){return this.add(-h,-s,-l)};HSLA.prototype.operate=function(op,right){switch(op){case\"==\":case\"!=\":case\"<=\":case\">=\":case\"<\":case\">\":case\"is a\":case\"||\":case\"&&\":return this.rgba.operate(op,right);default:return this.rgba.operate(op,right).hsla}};exports.fromRGBA=function(rgba){var r=rgba.r/255,g=rgba.g/255,b=rgba.b/255,a=rgba.a;var min=Math.min(r,g,b),max=Math.max(r,g,b),l=(max+min)/2,d=max-min,h,s;switch(max){case min:h=0;break;case r:h=60*(g-b)/d;break;case g:h=60*(b-r)/d+120;break;case b:h=60*(r-g)/d+240;break}if(max==min){s=0}else if(l<.5){s=d/(2*l)}else{s=d/(2-2*l)}h%=360;s*=100;l*=100;return new HSLA(h,s,l,a)};HSLA.prototype.adjustLightness=function(percent){this.l=clampPercentage(this.l+this.l*(percent/100));return this};HSLA.prototype.adjustHue=function(deg){this.h=clampDegrees(this.h+deg);return this};function clampDegrees(n){n=n%360;return n>=0?n:360+n}function clampPercentage(n){return Math.max(0,Math.min(n,100))}function clampAlpha(n){return Math.max(0,Math.min(n,1))}});require.register(\"nodes/ident.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Ident=module.exports=function Ident(name,val,mixin){Node.call(this);this.name=name;this.string=name;this.val=val||nodes.nil;this.mixin=!!mixin};Ident.prototype.__defineGetter__(\"isEmpty\",function(){return undefined==this.val});Ident.prototype.__defineGetter__(\"hash\",function(){return this.name});Ident.prototype.__proto__=Node.prototype;Ident.prototype.clone=function(parent){var clone=new Ident(this.name);clone.val=this.val.clone(parent,clone);clone.mixin=this.mixin;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.property=this.property;clone.rest=this.rest;return clone};Ident.prototype.toJSON=function(){return{__type:\"Ident\",name:this.name,val:this.val,mixin:this.mixin,property:this.property,rest:this.rest,lineno:this.lineno,column:this.column,filename:this.filename}};Ident.prototype.toString=function(){return this.name};Ident.prototype.coerce=function(other){switch(other.nodeName){case\"ident\":case\"string\":case\"literal\":return new Ident(other.string);case\"unit\":return new Ident(other.toString());default:return Node.prototype.coerce.call(this,other)}};Ident.prototype.operate=function(op,right){var val=right.first;switch(op){case\"-\":if(\"unit\"==val.nodeName){var expr=new nodes.Expression;val=val.clone();val.val=-val.val;expr.push(this);expr.push(val);return expr}case\"+\":return new nodes.Ident(this.string+this.coerce(val).string)}return Node.prototype.operate.call(this,op,right)}});require.register(\"nodes/if.js\",function(module,exports,require){var Node=require(\"./node\");var If=module.exports=function If(cond,negate){Node.call(this);this.cond=cond;this.elses=[];if(negate&&negate.nodeName){this.block=negate}else{this.negate=negate}};If.prototype.__proto__=Node.prototype;If.prototype.clone=function(parent){var clone=new If;clone.cond=this.cond.clone(parent,clone);clone.block=this.block.clone(parent,clone);clone.elses=this.elses.map(function(node){return node.clone(parent,clone)});clone.negate=this.negate;clone.postfix=this.postfix;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};If.prototype.toJSON=function(){return{__type:\"If\",cond:this.cond,block:this.block,elses:this.elses,negate:this.negate,postfix:this.postfix,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/import.js\",function(module,exports,require){var Node=require(\"./node\");var Import=module.exports=function Import(expr,once){Node.call(this);this.path=expr;this.once=once||false};Import.prototype.__proto__=Node.prototype;Import.prototype.clone=function(parent){var clone=new Import;clone.path=this.path.nodeName?this.path.clone(parent,clone):this.path;clone.once=this.once;clone.mtime=this.mtime;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Import.prototype.toJSON=function(){return{__type:\"Import\",path:this.path,once:this.once,mtime:this.mtime,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/extend.js\",function(module,exports,require){var Node=require(\"./node\");var Extend=module.exports=function Extend(selectors){Node.call(this);this.selectors=selectors};Extend.prototype.__proto__=Node.prototype;Extend.prototype.clone=function(){return new Extend(this.selectors)};Extend.prototype.toString=function(){return\"@extend \"+this.selectors.join(\", \")};Extend.prototype.toJSON=function(){return{__type:\"Extend\",selectors:this.selectors,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/index.js\",function(module,exports,require){exports.Node=require(\"./node\");exports.Root=require(\"./root\");exports.Null=require(\"./null\");exports.Each=require(\"./each\");exports.If=require(\"./if\");exports.Call=require(\"./call\");exports.UnaryOp=require(\"./unaryop\");exports.BinOp=require(\"./binop\");exports.Ternary=require(\"./ternary\");exports.Block=require(\"./block\");exports.Unit=require(\"./unit\");exports.String=require(\"./string\");exports.HSLA=require(\"./hsla\");exports.RGBA=require(\"./rgba\");exports.Ident=require(\"./ident\");exports.Group=require(\"./group\");exports.Literal=require(\"./literal\");exports.Boolean=require(\"./boolean\");exports.Return=require(\"./return\");exports.Media=require(\"./media\");exports.QueryList=require(\"./query-list\");exports.Query=require(\"./query\");exports.Feature=require(\"./feature\");exports.Params=require(\"./params\");exports.Comment=require(\"./comment\");exports.Keyframes=require(\"./keyframes\");exports.Member=require(\"./member\");exports.Charset=require(\"./charset\");exports.Namespace=require(\"./namespace\");exports.Import=require(\"./import\");exports.Extend=require(\"./extend\");exports.Object=require(\"./object\");exports.Function=require(\"./function\");exports.Property=require(\"./property\");exports.Selector=require(\"./selector\");exports.Expression=require(\"./expression\");exports.Arguments=require(\"./arguments\");exports.Atblock=require(\"./atblock\");exports.Atrule=require(\"./atrule\");exports.Supports=require(\"./supports\");exports.yes=new exports.Boolean(true);exports.no=new exports.Boolean(false);exports.nil=new exports.Null});require.register(\"nodes/keyframes.js\",function(module,exports,require){var Atrule=require(\"./atrule\");var Keyframes=module.exports=function Keyframes(segs,prefix){Atrule.call(this,\"keyframes\");this.segments=segs;this.prefix=prefix||\"official\"};Keyframes.prototype.__proto__=Atrule.prototype;Keyframes.prototype.clone=function(parent){var clone=new Keyframes;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});clone.prefix=this.prefix;clone.block=this.block.clone(parent,clone);return clone};Keyframes.prototype.toJSON=function(){return{__type:\"Keyframes\",segments:this.segments,prefix:this.prefix,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}};Keyframes.prototype.toString=function(){return\"@keyframes \"+this.segments.join(\"\")}});require.register(\"nodes/literal.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Literal=module.exports=function Literal(str){Node.call(this);this.val=str;this.string=str;this.prefixed=false};Literal.prototype.__proto__=Node.prototype;Literal.prototype.__defineGetter__(\"hash\",function(){return this.val});Literal.prototype.toString=function(){return this.val};Literal.prototype.coerce=function(other){switch(other.nodeName){case\"ident\":case\"string\":case\"literal\":return new Literal(other.string);default:return Node.prototype.coerce.call(this,other)}};Literal.prototype.operate=function(op,right){var val=right.first;switch(op){case\"+\":return new nodes.Literal(this.string+this.coerce(val).string);default:return Node.prototype.operate.call(this,op,right)}};Literal.prototype.toJSON=function(){return{__type:\"Literal\",val:this.val,string:this.string,prefixed:this.prefixed,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/media.js\",function(module,exports,require){var Atrule=require(\"./atrule\");var Media=module.exports=function Media(val){Atrule.call(this,\"media\");this.val=val};Media.prototype.__proto__=Atrule.prototype;Media.prototype.clone=function(parent){var clone=new Media;clone.val=this.val.clone(parent,clone);clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Media.prototype.toJSON=function(){return{__type:\"Media\",val:this.val,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}};Media.prototype.toString=function(){return\"@media \"+this.val}});require.register(\"nodes/query-list.js\",function(module,exports,require){var Node=require(\"./node\");var QueryList=module.exports=function QueryList(){Node.call(this);this.nodes=[]};QueryList.prototype.__proto__=Node.prototype;QueryList.prototype.clone=function(parent){var clone=new QueryList;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;for(var i=0;i<this.nodes.length;++i){clone.push(this.nodes[i].clone(parent,clone))}return clone};QueryList.prototype.push=function(node){this.nodes.push(node)};QueryList.prototype.merge=function(other){var list=new QueryList,merged;this.nodes.forEach(function(query){for(var i=0,len=other.nodes.length;i<len;++i){merged=query.merge(other.nodes[i]);if(merged)list.push(merged)}});return list};QueryList.prototype.toString=function(){return\"(\"+this.nodes.map(function(node){return node.toString()}).join(\", \")+\")\"};QueryList.prototype.toJSON=function(){return{__type:\"QueryList\",nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/query.js\",function(module,exports,require){var Node=require(\"./node\");var Query=module.exports=function Query(){Node.call(this);this.nodes=[];this.type=\"\";this.predicate=\"\"};Query.prototype.__proto__=Node.prototype;Query.prototype.clone=function(parent){var clone=new Query;clone.predicate=this.predicate;clone.type=this.type;for(var i=0,len=this.nodes.length;i<len;++i){clone.push(this.nodes[i].clone(parent,clone))}clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Query.prototype.push=function(feature){this.nodes.push(feature)};Query.prototype.__defineGetter__(\"resolvedType\",function(){if(this.type){return this.type.nodeName?this.type.string:this.type}});Query.prototype.__defineGetter__(\"resolvedPredicate\",function(){if(this.predicate){return this.predicate.nodeName?this.predicate.string:this.predicate}});Query.prototype.merge=function(other){var query=new Query,p1=this.resolvedPredicate,p2=other.resolvedPredicate,t1=this.resolvedType,t2=other.resolvedType,type,pred;t1=t1||t2;t2=t2||t1;if(\"not\"==p1^\"not\"==p2){if(t1==t2)return;type=\"not\"==p1?t2:t1;pred=\"not\"==p1?p2:p1}else if(\"not\"==p1&&\"not\"==p2){if(t1!=t2)return;type=t1;pred=\"not\"}else if(t1!=t2){return}else{type=t1;pred=p1||p2}query.predicate=pred;query.type=type;query.nodes=this.nodes.concat(other.nodes);return query};Query.prototype.toString=function(){var pred=this.predicate?this.predicate+\" \":\"\",type=this.type||\"\",len=this.nodes.length,str=pred+type;if(len){str+=(type&&\" and \")+this.nodes.map(function(expr){return expr.toString()}).join(\" and \")}return str};Query.prototype.toJSON=function(){return{__type:\"Query\",predicate:this.predicate,type:this.type,nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/feature.js\",function(module,exports,require){var Node=require(\"./node\");var Feature=module.exports=function Feature(segs){Node.call(this);this.segments=segs;this.expr=null};Feature.prototype.__proto__=Node.prototype;Feature.prototype.clone=function(parent){var clone=new Feature;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});if(this.expr)clone.expr=this.expr.clone(parent,clone);if(this.name)clone.name=this.name;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Feature.prototype.toString=function(){if(this.expr){return\"(\"+this.segments.join(\"\")+\": \"+this.expr.toString()+\")\"}else{return this.segments.join(\"\")}};Feature.prototype.toJSON=function(){var json={__type:\"Feature\",segments:this.segments,lineno:this.lineno,column:this.column,filename:this.filename};if(this.expr)json.expr=this.expr;if(this.name)json.name=this.name;return json}});require.register(\"nodes/node.js\",function(module,exports,require){var Evaluator=require(\"../visitor/evaluator\"),utils=require(\"../utils\"),nodes=require(\"./index\");function CoercionError(msg){this.name=\"CoercionError\";this.message=msg;Error.captureStackTrace(this,CoercionError)}CoercionError.prototype.__proto__=Error.prototype;var Node=module.exports=function Node(){this.lineno=nodes.lineno||1;this.column=nodes.column||1;this.filename=nodes.filename};Node.prototype={constructor:Node,get first(){return this},get hash(){return this.val},get nodeName(){return this.constructor.name.toLowerCase()},clone:function(){return this},toJSON:function(){return{lineno:this.lineno,column:this.column,filename:this.filename}},eval:function(){return new Evaluator(this).evaluate()},toBoolean:function(){return nodes.yes},toExpression:function(){if(\"expression\"==this.nodeName)return this;var expr=new nodes.Expression;expr.push(this);return expr},shouldCoerce:function(op){switch(op){case\"is a\":case\"in\":case\"||\":case\"&&\":return false;default:return true}},operate:function(op,right){switch(op){case\"is a\":if(\"string\"==right.nodeName){return nodes.Boolean(this.nodeName==right.val)}else{throw new Error('\"is a\" expects a string, got '+right.toString())}case\"==\":return nodes.Boolean(this.hash==right.hash);case\"!=\":return nodes.Boolean(this.hash!=right.hash);case\">=\":return nodes.Boolean(this.hash>=right.hash);case\"<=\":return nodes.Boolean(this.hash<=right.hash);case\">\":return nodes.Boolean(this.hash>right.hash);case\"<\":return nodes.Boolean(this.hash<right.hash);case\"||\":return this.toBoolean().isTrue?this:right;case\"in\":var vals=utils.unwrap(right).nodes,len=vals&&vals.length,hash=this.hash;if(!vals)throw new Error('\"in\" given invalid right-hand operand, expecting an expression');if(1==len&&\"object\"==vals[0].nodeName){return nodes.Boolean(vals[0].has(this.hash))}for(var i=0;i<len;++i){if(hash==vals[i].hash){return nodes.yes}}return nodes.no;case\"&&\":var a=this.toBoolean(),b=right.toBoolean();return a.isTrue&&b.isTrue?right:a.isFalse?this:right;default:if(\"[]\"==op){var msg=\"cannot perform \"+this+\"[\"+right+\"]\"}else{var msg=\"cannot perform\"+\" \"+this+\" \"+op+\" \"+right}throw new Error(msg)}},coerce:function(other){if(other.nodeName==this.nodeName)return other;throw new CoercionError(\"cannot coerce \"+other+\" to \"+this.nodeName)}}});require.register(\"nodes/null.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Null=module.exports=function Null(){};Null.prototype.__proto__=Node.prototype;Null.prototype.inspect=Null.prototype.toString=function(){return\"null\"};Null.prototype.toBoolean=function(){return nodes.no};Null.prototype.__defineGetter__(\"isNull\",function(){return true});Null.prototype.__defineGetter__(\"hash\",function(){return null});Null.prototype.toJSON=function(){return{__type:\"Null\",lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/params.js\",function(module,exports,require){var Node=require(\"./node\");var Params=module.exports=function Params(){Node.call(this);this.nodes=[]};Params.prototype.__defineGetter__(\"length\",function(){return this.nodes.length});Params.prototype.__proto__=Node.prototype;Params.prototype.push=function(node){this.nodes.push(node)};Params.prototype.clone=function(parent){var clone=new Params;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;this.nodes.forEach(function(node){clone.push(node.clone(parent,clone))});return clone};Params.prototype.toJSON=function(){return{__type:\"Params\",nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/property.js\",function(module,exports,require){var Node=require(\"./node\");var Property=module.exports=function Property(segs,expr){Node.call(this);this.segments=segs;this.expr=expr};Property.prototype.__proto__=Node.prototype;Property.prototype.clone=function(parent){var clone=new Property(this.segments);clone.name=this.name;if(this.literal)clone.literal=this.literal;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});if(this.expr)clone.expr=this.expr.clone(parent,clone);return clone};Property.prototype.toJSON=function(){var json={__type:\"Property\",segments:this.segments,name:this.name,lineno:this.lineno,column:this.column,filename:this.filename};if(this.expr)json.expr=this.expr;if(this.literal)json.literal=this.literal;return json};Property.prototype.toString=function(){return\"property(\"+this.segments.join(\"\")+\", \"+this.expr+\")\"};Property.prototype.operate=function(op,right,val){return this.expr.operate(op,right,val)}});require.register(\"nodes/return.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var Return=module.exports=function Return(expr){this.expr=expr||nodes.nil};Return.prototype.__proto__=Node.prototype;Return.prototype.clone=function(parent){var clone=new Return;clone.expr=this.expr.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Return.prototype.toJSON=function(){return{__type:\"Return\",expr:this.expr,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/rgba.js\",function(module,exports,require){var Node=require(\"./node\"),HSLA=require(\"./hsla\"),functions=require(\"../functions\"),adjust=functions.adjust,nodes=require(\"./index\");var RGBA=exports=module.exports=function RGBA(r,g,b,a){Node.call(this);this.r=clamp(r);this.g=clamp(g);this.b=clamp(b);this.a=clampAlpha(a);this.name=\"\";this.rgba=this};RGBA.prototype.__proto__=Node.prototype;RGBA.withoutClamping=function(r,g,b,a){var rgba=new RGBA(0,0,0,0);rgba.r=r;rgba.g=g;rgba.b=b;rgba.a=a;return rgba};RGBA.prototype.clone=function(){var clone=new RGBA(this.r,this.g,this.b,this.a);clone.raw=this.raw;clone.name=this.name;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};RGBA.prototype.toJSON=function(){return{__type:\"RGBA\",r:this.r,g:this.g,b:this.b,a:this.a,raw:this.raw,name:this.name,lineno:this.lineno,column:this.column,filename:this.filename}};RGBA.prototype.toBoolean=function(){return nodes.yes};RGBA.prototype.__defineGetter__(\"hsla\",function(){return HSLA.fromRGBA(this)});RGBA.prototype.__defineGetter__(\"hash\",function(){return this.toString()});RGBA.prototype.add=function(r,g,b,a){return new RGBA(this.r+r,this.g+g,this.b+b,this.a+a)};RGBA.prototype.sub=function(r,g,b,a){return new RGBA(this.r-r,this.g-g,this.b-b,a==1?this.a:this.a-a)};RGBA.prototype.multiply=function(n){return new RGBA(this.r*n,this.g*n,this.b*n,this.a)};RGBA.prototype.divide=function(n){return new RGBA(this.r/n,this.g/n,this.b/n,this.a)};RGBA.prototype.operate=function(op,right){if(\"in\"!=op)right=right.first;switch(op){case\"is a\":if(\"string\"==right.nodeName&&\"color\"==right.string){return nodes.yes}break;case\"+\":switch(right.nodeName){case\"unit\":var n=right.val;switch(right.type){case\"%\":return adjust(this,new nodes.String(\"lightness\"),right);case\"deg\":return this.hsla.adjustHue(n).rgba;default:return this.add(n,n,n,0)}case\"rgba\":return this.add(right.r,right.g,right.b,right.a);case\"hsla\":return this.hsla.add(right.h,right.s,right.l)}break;case\"-\":switch(right.nodeName){case\"unit\":var n=right.val;switch(right.type){case\"%\":return adjust(this,new nodes.String(\"lightness\"),new nodes.Unit(-n,\"%\"));case\"deg\":return this.hsla.adjustHue(-n).rgba;default:return this.sub(n,n,n,0)}case\"rgba\":return this.sub(right.r,right.g,right.b,right.a);case\"hsla\":return this.hsla.sub(right.h,right.s,right.l)}break;case\"*\":switch(right.nodeName){case\"unit\":return this.multiply(right.val)}break;case\"/\":switch(right.nodeName){case\"unit\":return this.divide(right.val)}break}return Node.prototype.operate.call(this,op,right)};RGBA.prototype.toString=function(){function pad(n){return n<16?\"0\"+n.toString(16):n.toString(16)}if(\"transparent\"==this.name)return this.name;if(1==this.a){var r=pad(this.r),g=pad(this.g),b=pad(this.b);if(r[0]==r[1]&&g[0]==g[1]&&b[0]==b[1]){return\"#\"+r[0]+g[0]+b[0]}else{return\"#\"+r+g+b}}else{return\"rgba(\"+this.r+\",\"+this.g+\",\"+this.b+\",\"+ +this.a.toFixed(3)+\")\"}};exports.fromHSLA=function(hsla){var h=hsla.h/360,s=hsla.s/100,l=hsla.l/100,a=hsla.a;var m2=l<=.5?l*(s+1):l+s-l*s,m1=l*2-m2;var r=hue(h+1/3)*255,g=hue(h)*255,b=hue(h-1/3)*255;function hue(h){if(h<0)++h;if(h>1)--h;if(h*6<1)return m1+(m2-m1)*h*6;if(h*2<1)return m2;if(h*3<2)return m1+(m2-m1)*(2/3-h)*6;return m1}return new RGBA(r,g,b,a)};function clamp(n){return Math.max(0,Math.min(n.toFixed(0),255))}function clampAlpha(n){return Math.max(0,Math.min(n,1))}});require.register(\"nodes/root.js\",function(module,exports,require){var Node=require(\"./node\");var Root=module.exports=function Root(){this.nodes=[]};Root.prototype.__proto__=Node.prototype;Root.prototype.push=function(node){this.nodes.push(node)};Root.prototype.unshift=function(node){this.nodes.unshift(node)};Root.prototype.clone=function(){var clone=new Root;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;this.nodes.forEach(function(node){clone.push(node.clone(clone,clone))});return clone};Root.prototype.toString=function(){return\"[Root]\"};Root.prototype.toJSON=function(){return{__type:\"Root\",nodes:this.nodes,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/selector.js\",function(module,exports,require){var Block=require(\"./block\"),Node=require(\"./node\");var Selector=module.exports=function Selector(segs){Node.call(this);this.inherits=true;this.segments=segs;this.optional=false};Selector.prototype.__proto__=Node.prototype;Selector.prototype.toString=function(){return this.segments.join(\"\")+(this.optional?\" !optional\":\"\")};Selector.prototype.__defineGetter__(\"isPlaceholder\",function(){return this.val&&~this.val.substr(0,2).indexOf(\"$\")});Selector.prototype.clone=function(parent){var clone=new Selector;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;clone.inherits=this.inherits;clone.val=this.val;clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});clone.optional=this.optional;return clone};Selector.prototype.toJSON=function(){return{__type:\"Selector\",inherits:this.inherits,segments:this.segments,optional:this.optional,val:this.val,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/string.js\",function(module,exports,require){var Node=require(\"./node\"),sprintf=require(\"../functions\").s,utils=require(\"../utils\"),nodes=require(\"./index\");var String=module.exports=function String(val,quote){Node.call(this);this.val=val;this.string=val;this.prefixed=false;if(typeof quote!==\"string\"){this.quote=\"'\"}else{this.quote=quote}};String.prototype.__proto__=Node.prototype;String.prototype.toString=function(){return this.quote+this.val+this.quote};String.prototype.clone=function(){var clone=new String(this.val,this.quote);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};String.prototype.toJSON=function(){return{__type:\"String\",val:this.val,quote:this.quote,lineno:this.lineno,column:this.column,filename:this.filename}};String.prototype.toBoolean=function(){return nodes.Boolean(this.val.length)};String.prototype.coerce=function(other){switch(other.nodeName){case\"string\":return other;case\"expression\":return new String(other.nodes.map(function(node){return this.coerce(node).val},this).join(\" \"));default:return new String(other.toString())}};String.prototype.operate=function(op,right){switch(op){case\"%\":var expr=new nodes.Expression;expr.push(this);var args=\"expression\"==right.nodeName?utils.unwrap(right).nodes:[right];return sprintf.apply(null,[expr].concat(args));case\"+\":var expr=new nodes.Expression;expr.push(new String(this.val+this.coerce(right).val));return expr;default:return Node.prototype.operate.call(this,op,right)}}});require.register(\"nodes/ternary.js\",function(module,exports,require){var Node=require(\"./node\");var Ternary=module.exports=function Ternary(cond,trueExpr,falseExpr){Node.call(this);this.cond=cond;this.trueExpr=trueExpr;this.falseExpr=falseExpr};Ternary.prototype.__proto__=Node.prototype;Ternary.prototype.clone=function(parent){var clone=new Ternary;clone.cond=this.cond.clone(parent,clone);clone.trueExpr=this.trueExpr.clone(parent,clone);clone.falseExpr=this.falseExpr.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Ternary.prototype.toJSON=function(){return{__type:\"Ternary\",cond:this.cond,trueExpr:this.trueExpr,falseExpr:this.falseExpr,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/unaryop.js\",function(module,exports,require){var Node=require(\"./node\");var UnaryOp=module.exports=function UnaryOp(op,expr){Node.call(this);this.op=op;this.expr=expr};UnaryOp.prototype.__proto__=Node.prototype;UnaryOp.prototype.clone=function(parent){var clone=new UnaryOp(this.op);clone.expr=this.expr.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};UnaryOp.prototype.toJSON=function(){return{__type:\"UnaryOp\",op:this.op,expr:this.expr,lineno:this.lineno,column:this.column,filename:this.filename}}});require.register(\"nodes/unit.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\");var FACTOR_TABLE={mm:{val:1,label:\"mm\"},cm:{val:10,label:\"mm\"},\"in\":{val:25.4,label:\"mm\"},pt:{val:25.4/72,label:\"mm\"},ms:{val:1,label:\"ms\"},s:{val:1e3,label:\"ms\"},Hz:{val:1,label:\"Hz\"},kHz:{val:1e3,label:\"Hz\"}};var Unit=module.exports=function Unit(val,type){Node.call(this);this.val=val;this.type=type};Unit.prototype.__proto__=Node.prototype;Unit.prototype.toBoolean=function(){return nodes.Boolean(this.type?true:this.val)};Unit.prototype.toString=function(){return this.val+(this.type||\"\")};Unit.prototype.clone=function(){var clone=new Unit(this.val,this.type);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Unit.prototype.toJSON=function(){return{__type:\"Unit\",val:this.val,type:this.type,lineno:this.lineno,column:this.column,filename:this.filename}};Unit.prototype.operate=function(op,right){var type=this.type||right.first.type;if(\"rgba\"==right.nodeName||\"hsla\"==right.nodeName){return right.operate(op,this)}if(this.shouldCoerce(op)){right=right.first;if(\"%\"!=this.type&&(\"-\"==op||\"+\"==op)&&\"%\"==right.type){right=new Unit(this.val*(right.val/100),\"%\")}else{right=this.coerce(right)}switch(op){case\"-\":return new Unit(this.val-right.val,type);case\"+\":type=type||right.type==\"%\"&&right.type;return new Unit(this.val+right.val,type);case\"/\":return new Unit(this.val/right.val,type);case\"*\":return new Unit(this.val*right.val,type);case\"%\":return new Unit(this.val%right.val,type);case\"**\":return new Unit(Math.pow(this.val,right.val),type);case\"..\":case\"...\":var start=this.val,end=right.val,expr=new nodes.Expression,inclusive=\"..\"==op;if(start<end){do{expr.push(new nodes.Unit(start))}while(inclusive?++start<=end:++start<end)}else{do{expr.push(new nodes.Unit(start))}while(inclusive?--start>=end:--start>end)}return expr}}return Node.prototype.operate.call(this,op,right)};Unit.prototype.coerce=function(other){if(\"unit\"==other.nodeName){var a=this,b=other,factorA=FACTOR_TABLE[a.type],factorB=FACTOR_TABLE[b.type];if(factorA&&factorB&&factorA.label==factorB.label){var bVal=b.val*(factorB.val/factorA.val);return new nodes.Unit(bVal,a.type)}else{return new nodes.Unit(b.val,a.type)}}else if(\"string\"==other.nodeName){if(\"%\"==other.val)return new nodes.Unit(0,\"%\");var val=parseFloat(other.val);if(isNaN(val))Node.prototype.coerce.call(this,other);return new nodes.Unit(val)}else{return Node.prototype.coerce.call(this,other)}}});require.register(\"nodes/object.js\",function(module,exports,require){var Node=require(\"./node\"),nodes=require(\"./index\"),nativeObj={}.constructor;var Object=module.exports=function Object(){Node.call(this);this.vals={}};Object.prototype.__proto__=Node.prototype;Object.prototype.set=function(key,val){this.vals[key]=val;return this};Object.prototype.__defineGetter__(\"length\",function(){return nativeObj.keys(this.vals).length});Object.prototype.get=function(key){return this.vals[key]||nodes.nil};Object.prototype.has=function(key){return key in this.vals};Object.prototype.operate=function(op,right){switch(op){case\".\":case\"[]\":return this.get(right.hash);case\"==\":var vals=this.vals,a,b;if(\"object\"!=right.nodeName||this.length!=right.length)return nodes.no;for(var key in vals){a=vals[key];b=right.vals[key];if(a.operate(op,b).isFalse)return nodes.no}return nodes.yes;case\"!=\":return this.operate(\"==\",right).negate();default:return Node.prototype.operate.call(this,op,right)}};Object.prototype.toBoolean=function(){return nodes.Boolean(this.length)};Object.prototype.toBlock=function(){var str=\"{\",key,val;for(key in this.vals){val=this.get(key);if(\"object\"==val.first.nodeName){str+=key+\" \"+val.first.toBlock()}else{switch(key){case\"@charset\":str+=key+\" \"+val.first.toString()+\";\";break;default:str+=key+\":\"+toString(val)+\";\"}}}str+=\"}\";return str;function toString(node){if(node.nodes){return node.nodes.map(toString).join(node.isList?\",\":\" \")}else if(\"literal\"==node.nodeName&&\",\"==node.val){return\"\\\\,\"}return node.toString()}};Object.prototype.clone=function(parent){var clone=new Object;clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;for(var key in this.vals){clone.vals[key]=this.vals[key].clone(parent,clone)}return clone};Object.prototype.toJSON=function(){return{__type:\"Object\",vals:this.vals,lineno:this.lineno,column:this.column,filename:this.filename}};Object.prototype.toString=function(){var obj={};for(var prop in this.vals){obj[prop]=this.vals[prop].toString()}return JSON.stringify(obj)}});require.register(\"nodes/supports.js\",function(module,exports,require){var Atrule=require(\"./atrule\");var Supports=module.exports=function Supports(condition){Atrule.call(this,\"supports\");this.condition=condition};Supports.prototype.__proto__=Atrule.prototype;Supports.prototype.clone=function(parent){var clone=new Supports;clone.condition=this.condition.clone(parent,clone);\nclone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Supports.prototype.toJSON=function(){return{__type:\"Supports\",condition:this.condition,block:this.block,lineno:this.lineno,column:this.column,filename:this.filename}};Supports.prototype.toString=function(){return\"@supports \"+this.condition}});require.register(\"nodes/member.js\",function(module,exports,require){var Node=require(\"./node\");var Member=module.exports=function Member(left,right){Node.call(this);this.left=left;this.right=right};Member.prototype.__proto__=Node.prototype;Member.prototype.clone=function(parent){var clone=new Member;clone.left=this.left.clone(parent,clone);clone.right=this.right.clone(parent,clone);if(this.val)clone.val=this.val.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Member.prototype.toJSON=function(){var json={__type:\"Member\",left:this.left,right:this.right,lineno:this.lineno,column:this.column,filename:this.filename};if(this.val)json.val=this.val;return json};Member.prototype.toString=function(){return this.left.toString()+\".\"+this.right.toString()}});require.register(\"nodes/atblock.js\",function(module,exports,require){var Node=require(\"./node\");var Atblock=module.exports=function Atblock(){Node.call(this)};Atblock.prototype.__defineGetter__(\"nodes\",function(){return this.block.nodes});Atblock.prototype.__proto__=Node.prototype;Atblock.prototype.clone=function(parent){var clone=new Atblock;clone.block=this.block.clone(parent,clone);clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Atblock.prototype.toString=function(){return\"@block\"};Atblock.prototype.toJSON=function(){return{__type:\"Atblock\",block:this.block,lineno:this.lineno,column:this.column,fileno:this.fileno}}});require.register(\"nodes/atrule.js\",function(module,exports,require){var Node=require(\"./node\");var Atrule=module.exports=function Atrule(type){Node.call(this);this.type=type};Atrule.prototype.__proto__=Node.prototype;Atrule.prototype.__defineGetter__(\"hasOnlyProperties\",function(){if(!this.block)return false;var nodes=this.block.nodes;for(var i=0,len=nodes.length;i<len;++i){var nodeName=nodes[i].nodeName;switch(nodes[i].nodeName){case\"property\":case\"expression\":case\"comment\":continue;default:return false}}return true});Atrule.prototype.clone=function(parent){var clone=new Atrule(this.type);if(this.block)clone.block=this.block.clone(parent,clone);clone.segments=this.segments.map(function(node){return node.clone(parent,clone)});clone.lineno=this.lineno;clone.column=this.column;clone.filename=this.filename;return clone};Atrule.prototype.toJSON=function(){var json={__type:\"Atrule\",type:this.type,segments:this.segments,lineno:this.lineno,column:this.column,filename:this.filename};if(this.block)json.block=this.block;return json};Atrule.prototype.toString=function(){return\"@\"+this.type};Atrule.prototype.__defineGetter__(\"hasOutput\",function(){return!!this.block&&hasOutput(this.block)});function hasOutput(block){var nodes=block.nodes;if(nodes.every(function(node){return\"group\"==node.nodeName&&node.hasOnlyPlaceholders}))return false;return nodes.some(function(node){switch(node.nodeName){case\"property\":case\"literal\":case\"import\":return true;case\"block\":return hasOutput(node);default:if(node.block)return hasOutput(node.block)}})}});require.register(\"parser.js\",function(module,exports,require){var Lexer=require(\"./lexer\"),nodes=require(\"./nodes\"),Token=require(\"./token\"),units=require(\"./units\"),errors=require(\"./errors\");var selectorTokens=[\"ident\",\"string\",\"selector\",\"function\",\"comment\",\"boolean\",\"space\",\"color\",\"unit\",\"for\",\"in\",\"[\",\"]\",\"(\",\")\",\"+\",\"-\",\"*\",\"*=\",\"<\",\">\",\"=\",\":\",\"&\",\"&&\",\"~\",\"{\",\"}\",\".\",\"..\",\"/\"];var pseudoSelectors=[\"matches\",\"not\",\"dir\",\"lang\",\"any-link\",\"link\",\"visited\",\"local-link\",\"target\",\"scope\",\"hover\",\"active\",\"focus\",\"drop\",\"current\",\"past\",\"future\",\"enabled\",\"disabled\",\"read-only\",\"read-write\",\"placeholder-shown\",\"checked\",\"indeterminate\",\"valid\",\"invalid\",\"in-range\",\"out-of-range\",\"required\",\"optional\",\"user-error\",\"root\",\"empty\",\"blank\",\"nth-child\",\"nth-last-child\",\"first-child\",\"last-child\",\"only-child\",\"nth-of-type\",\"nth-last-of-type\",\"first-of-type\",\"last-of-type\",\"only-of-type\",\"nth-match\",\"nth-last-match\",\"nth-column\",\"nth-last-column\",\"first-line\",\"first-letter\",\"before\",\"after\",\"selection\"];var Parser=module.exports=function Parser(str,options){var self=this;options=options||{};this.lexer=new Lexer(str,options);this.prefix=options.prefix||\"\";this.root=options.root||new nodes.Root;this.state=[\"root\"];this.stash=[];this.parens=0;this.css=0;this.state.pop=function(){self.prevState=[].pop.call(this)}};Parser.prototype={constructor:Parser,currentState:function(){return this.state[this.state.length-1]},previousState:function(){return this.state[this.state.length-2]},parse:function(){var block=this.parent=this.root;while(\"eos\"!=this.peek().type){this.skipWhitespace();if(\"eos\"==this.peek().type)break;var stmt=this.statement();this.accept(\";\");if(!stmt)this.error(\"unexpected token {peek}, not allowed at the root level\");block.push(stmt)}return block},error:function(msg){var type=this.peek().type,val=undefined==this.peek().val?\"\":\" \"+this.peek().toString();if(val.trim()==type.trim())val=\"\";throw new errors.ParseError(msg.replace(\"{peek}\",'\"'+type+val+'\"'))},accept:function(type){if(type==this.peek().type){return this.next()}},expect:function(type){if(type!=this.peek().type){this.error('expected \"'+type+'\", got {peek}')}return this.next()},next:function(){var tok=this.stash.length?this.stash.pop():this.lexer.next(),line=tok.lineno,column=tok.column||1;if(tok.val&&tok.val.nodeName){tok.val.lineno=line;tok.val.column=column}nodes.lineno=line;nodes.column=column;return tok},peek:function(){return this.lexer.peek()},lookahead:function(n){return this.lexer.lookahead(n)},isSelectorToken:function(n){var la=this.lookahead(n).type;switch(la){case\"for\":return this.bracketed;case\"[\":this.bracketed=true;return true;case\"]\":this.bracketed=false;return true;default:return~selectorTokens.indexOf(la)}},isPseudoSelector:function(n){var val=this.lookahead(n).val;return val&&~pseudoSelectors.indexOf(val.name)},lineContains:function(type){var i=1,la;while(la=this.lookahead(i++)){if(~[\"indent\",\"outdent\",\"newline\",\"eos\"].indexOf(la.type))return;if(type==la.type)return true}},selectorToken:function(){if(this.isSelectorToken(1)){if(\"{\"==this.peek().type){if(!this.lineContains(\"}\"))return;var i=0,la;while(la=this.lookahead(++i)){if(\"}\"==la.type){if(i==2||i==3&&this.lookahead(i-1).type==\"space\")return;break}if(\":\"==la.type)return}}return this.next()}},skip:function(tokens){while(~tokens.indexOf(this.peek().type))this.next()},skipWhitespace:function(){this.skip([\"space\",\"indent\",\"outdent\",\"newline\"])},skipNewlines:function(){while(\"newline\"==this.peek().type)this.next()},skipSpaces:function(){while(\"space\"==this.peek().type)this.next()},skipSpacesAndComments:function(){while(\"space\"==this.peek().type||\"comment\"==this.peek().type)this.next()},looksLikeFunctionDefinition:function(i){return\"indent\"==this.lookahead(i).type||\"{\"==this.lookahead(i).type},looksLikeSelector:function(fromProperty){var i=1,brace;if(fromProperty&&\":\"==this.lookahead(i+1).type&&(this.lookahead(i+1).space||\"indent\"==this.lookahead(i+2).type))return false;while(\"ident\"==this.lookahead(i).type&&(\"newline\"==this.lookahead(i+1).type||\",\"==this.lookahead(i+1).type))i+=2;while(this.isSelectorToken(i)||\",\"==this.lookahead(i).type){if(\"selector\"==this.lookahead(i).type)return true;if(\"&\"==this.lookahead(i+1).type)return true;if(\".\"==this.lookahead(i).type&&\"ident\"==this.lookahead(i+1).type)return true;if(\"*\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true;if(\":\"==this.lookahead(i).type&&\":\"==this.lookahead(i+1).type)return true;if(\"color\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i-1).type)return true;if(this.looksLikeAttributeSelector(i))return true;if((\"=\"==this.lookahead(i).type||\"function\"==this.lookahead(i).type)&&\"{\"==this.lookahead(i+1).type)return false;if(\":\"==this.lookahead(i).type&&!this.isPseudoSelector(i+1)&&this.lineContains(\".\"))return false;if(\"{\"==this.lookahead(i).type)brace=true;else if(\"}\"==this.lookahead(i).type)brace=false;if(brace&&\":\"==this.lookahead(i).type)return true;if(\"space\"==this.lookahead(i).type&&\"{\"==this.lookahead(i+1).type)return true;if(\":\"==this.lookahead(i++).type&&!this.lookahead(i-1).space&&this.isPseudoSelector(i))return true;if(\"space\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type&&\"{\"==this.lookahead(i+2).type)return true;if(\",\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true}if(\",\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true;if(\"{\"==this.lookahead(i).type&&\"newline\"==this.lookahead(i+1).type)return true;if(this.css){if(\";\"==this.lookahead(i).type||\"}\"==this.lookahead(i-1).type)return false}while(!~[\"indent\",\"outdent\",\"newline\",\"for\",\"if\",\";\",\"}\",\"eos\"].indexOf(this.lookahead(i).type))++i;if(\"indent\"==this.lookahead(i).type)return true},looksLikeAttributeSelector:function(n){var type=this.lookahead(n).type;if(\"=\"==type&&this.bracketed)return true;return(\"ident\"==type||\"string\"==type)&&\"]\"==this.lookahead(n+1).type&&(\"newline\"==this.lookahead(n+2).type||this.isSelectorToken(n+2))&&!this.lineContains(\":\")&&!this.lineContains(\"=\")},looksLikeKeyframe:function(){var i=2,type;switch(this.lookahead(i).type){case\"{\":case\"indent\":case\",\":return true;case\"newline\":while(\"unit\"==this.lookahead(++i).type||\"newline\"==this.lookahead(i).type);type=this.lookahead(i).type;return\"indent\"==type||\"{\"==type}},stateAllowsSelector:function(){switch(this.currentState()){case\"root\":case\"atblock\":case\"selector\":case\"conditional\":case\"function\":case\"atrule\":case\"for\":return true}},assignAtblock:function(expr){try{expr.push(this.atblock(expr))}catch(err){this.error(\"invalid right-hand side operand in assignment, got {peek}\")}},statement:function(){var stmt=this.stmt(),state=this.prevState,block,op;if(this.allowPostfix){this.allowPostfix=false;state=\"expression\"}switch(state){case\"assignment\":case\"expression\":case\"function arguments\":while(op=this.accept(\"if\")||this.accept(\"unless\")||this.accept(\"for\")){switch(op.type){case\"if\":case\"unless\":stmt=new nodes.If(this.expression(),stmt);stmt.postfix=true;stmt.negate=\"unless\"==op.type;this.accept(\";\");break;case\"for\":var key,val=this.id().name;if(this.accept(\",\"))key=this.id().name;this.expect(\"in\");var each=new nodes.Each(val,key,this.expression());block=new nodes.Block(this.parent,each);block.push(stmt);each.block=block;stmt=each}}}return stmt},stmt:function(){var type=this.peek().type;switch(type){case\"keyframes\":return this.keyframes();case\"-moz-document\":return this.mozdocument();case\"comment\":case\"selector\":case\"extend\":case\"literal\":case\"charset\":case\"namespace\":case\"require\":case\"extend\":case\"media\":case\"atrule\":case\"ident\":case\"scope\":case\"supports\":case\"unless\":return this[type]();case\"function\":return this.fun();case\"import\":return this.atimport();case\"if\":return this.ifstmt();case\"for\":return this.forin();case\"return\":return this.ret();case\"{\":return this.property();default:if(this.stateAllowsSelector()){switch(type){case\"color\":case\"~\":case\">\":case\"<\":case\":\":case\"&\":case\"&&\":case\"[\":case\".\":case\"/\":return this.selector();case\"..\":if(\"/\"==this.lookahead(2).type)return this.selector();case\"+\":return\"function\"==this.lookahead(2).type?this.functionCall():this.selector();case\"*\":return this.property();case\"unit\":if(this.looksLikeKeyframe())return this.selector();case\"-\":if(\"{\"==this.lookahead(2).type)return this.property()}}var expr=this.expression();if(expr.isEmpty)this.error(\"unexpected {peek}\");return expr}},block:function(node,scope){var delim,stmt,next,block=this.parent=new nodes.Block(this.parent,node);if(false===scope)block.scope=false;this.accept(\"newline\");if(this.accept(\"{\")){this.css++;delim=\"}\";this.skipWhitespace()}else{delim=\"outdent\";this.expect(\"indent\")}while(delim!=this.peek().type){if(this.css){if(this.accept(\"newline\")||this.accept(\"indent\"))continue;stmt=this.statement();this.accept(\";\");this.skipWhitespace()}else{if(this.accept(\"newline\"))continue;next=this.lookahead(2).type;if(\"indent\"==this.peek().type&&~[\"outdent\",\"newline\",\"comment\"].indexOf(next)){this.skip([\"indent\",\"outdent\"]);continue}if(\"eos\"==this.peek().type)return block;stmt=this.statement();this.accept(\";\")}if(!stmt)this.error(\"unexpected token {peek} in block\");block.push(stmt)}if(this.css){this.skipWhitespace();this.expect(\"}\");this.skipSpaces();this.css--}else{this.expect(\"outdent\")}this.parent=block.parent;return block},comment:function(){var node=this.next().val;this.skipSpaces();return node},forin:function(){this.expect(\"for\");var key,val=this.id().name;if(this.accept(\",\"))key=this.id().name;this.expect(\"in\");this.state.push(\"for\");this.cond=true;var each=new nodes.Each(val,key,this.expression());this.cond=false;each.block=this.block(each,false);this.state.pop();return each},ret:function(){this.expect(\"return\");var expr=this.expression();return expr.isEmpty?new nodes.Return:new nodes.Return(expr)},unless:function(){this.expect(\"unless\");this.state.push(\"conditional\");this.cond=true;var node=new nodes.If(this.expression(),true);this.cond=false;node.block=this.block(node,false);this.state.pop();return node},ifstmt:function(){this.expect(\"if\");this.state.push(\"conditional\");this.cond=true;var node=new nodes.If(this.expression()),cond,block;this.cond=false;node.block=this.block(node,false);this.skip([\"newline\",\"comment\"]);while(this.accept(\"else\")){if(this.accept(\"if\")){this.cond=true;cond=this.expression();this.cond=false;block=this.block(node,false);node.elses.push(new nodes.If(cond,block))}else{node.elses.push(this.block(node,false));break}this.skip([\"newline\",\"comment\"])}this.state.pop();return node},atblock:function(node){if(!node)this.expect(\"atblock\");node=new nodes.Atblock;this.state.push(\"atblock\");node.block=this.block(node,false);this.state.pop();return node},atrule:function(){var type=this.expect(\"atrule\").val,node=new nodes.Atrule(type),tok;this.skipSpacesAndComments();node.segments=this.selectorParts();this.skipSpacesAndComments();tok=this.peek().type;if(\"indent\"==tok||\"{\"==tok||\"newline\"==tok&&\"{\"==this.lookahead(2).type){this.state.push(\"atrule\");node.block=this.block(node);this.state.pop()}return node},scope:function(){this.expect(\"scope\");var selector=this.selectorParts().map(function(selector){return selector.val}).join(\"\");this.selectorScope=selector.trim();return nodes.nil},supports:function(){this.expect(\"supports\");var node=new nodes.Supports(this.supportsCondition());this.state.push(\"atrule\");node.block=this.block(node);this.state.pop();return node},supportsCondition:function(){var node=this.supportsNegation()||this.supportsOp();if(!node){this.cond=true;node=this.expression();this.cond=false}return node},supportsNegation:function(){if(this.accept(\"not\")){var node=new nodes.Expression;node.push(new nodes.Literal(\"not\"));node.push(this.supportsFeature());return node}},supportsOp:function(){var feature=this.supportsFeature(),op,expr;if(feature){expr=new nodes.Expression;expr.push(feature);while(op=this.accept(\"&&\")||this.accept(\"||\")){expr.push(new nodes.Literal(\"&&\"==op.val?\"and\":\"or\"));expr.push(this.supportsFeature())}return expr}},supportsFeature:function(){this.skipSpacesAndComments();if(\"(\"==this.peek().type){var la=this.lookahead(2).type;if(\"ident\"==la||\"{\"==la){return this.feature()}else{this.expect(\"(\");var node=new nodes.Expression;node.push(new nodes.Literal(\"(\"));node.push(this.supportsCondition());this.expect(\")\");node.push(new nodes.Literal(\")\"));this.skipSpacesAndComments();return node}}},extend:function(){var tok=this.expect(\"extend\"),selectors=[],sel,node,arr;do{arr=this.selectorParts();if(!arr.length)continue;sel=new nodes.Selector(arr);selectors.push(sel);if(\"!\"!==this.peek().type)continue;tok=this.lookahead(2);if(\"ident\"!==tok.type||\"optional\"!==tok.val.name)continue;this.skip([\"!\",\"ident\"]);sel.optional=true}while(this.accept(\",\"));node=new nodes.Extend(selectors);node.lineno=tok.lineno;node.column=tok.column;return node},media:function(){this.expect(\"media\");this.state.push(\"atrule\");var media=new nodes.Media(this.queries());media.block=this.block(media);this.state.pop();return media},queries:function(){var queries=new nodes.QueryList,skip=[\"comment\",\"newline\",\"space\"];do{this.skip(skip);queries.push(this.query());this.skip(skip)}while(this.accept(\",\"));return queries},query:function(){var query=new nodes.Query,expr,pred,id;if(\"ident\"==this.peek().type&&(\".\"==this.lookahead(2).type||\"[\"==this.lookahead(2).type)){this.cond=true;expr=this.expression();this.cond=false;query.push(new nodes.Feature(expr.nodes));return query}if(pred=this.accept(\"ident\")||this.accept(\"not\")){pred=new nodes.Literal(pred.val.string||pred.val);this.skipSpacesAndComments();if(id=this.accept(\"ident\")){query.type=id.val;query.predicate=pred}else{query.type=pred}this.skipSpacesAndComments();if(!this.accept(\"&&\"))return query}do{query.push(this.feature())}while(this.accept(\"&&\"));return query},feature:function(){this.skipSpacesAndComments();this.expect(\"(\");this.skipSpacesAndComments();var node=new nodes.Feature(this.interpolate());this.skipSpacesAndComments();this.accept(\":\");this.skipSpacesAndComments();this.inProperty=true;node.expr=this.list();this.inProperty=false;this.skipSpacesAndComments();this.expect(\")\");this.skipSpacesAndComments();return node},mozdocument:function(){this.expect(\"-moz-document\");var mozdocument=new nodes.Atrule(\"-moz-document\"),calls=[];do{this.skipSpacesAndComments();calls.push(this.functionCall());this.skipSpacesAndComments()}while(this.accept(\",\"));mozdocument.segments=[new nodes.Literal(calls.join(\", \"))];this.state.push(\"atrule\");mozdocument.block=this.block(mozdocument,false);this.state.pop();return mozdocument},atimport:function(){this.expect(\"import\");this.allowPostfix=true;return new nodes.Import(this.expression(),false)},require:function(){this.expect(\"require\");this.allowPostfix=true;return new nodes.Import(this.expression(),true)},charset:function(){this.expect(\"charset\");var str=this.expect(\"string\").val;this.allowPostfix=true;return new nodes.Charset(str)},namespace:function(){var str,prefix;this.expect(\"namespace\");this.skipSpacesAndComments();if(prefix=this.accept(\"ident\")){prefix=prefix.val}this.skipSpacesAndComments();str=this.accept(\"string\")||this.url();this.allowPostfix=true;return new nodes.Namespace(str,prefix)},keyframes:function(){var tok=this.expect(\"keyframes\"),keyframes;this.skipSpacesAndComments();keyframes=new nodes.Keyframes(this.selectorParts(),tok.val);this.skipSpacesAndComments();this.state.push(\"atrule\");keyframes.block=this.block(keyframes);this.state.pop();return keyframes},literal:function(){return this.expect(\"literal\").val},id:function(){var tok=this.expect(\"ident\");this.accept(\"space\");return tok.val},ident:function(){var i=2,la=this.lookahead(i).type;while(\"space\"==la)la=this.lookahead(++i).type;switch(la){case\"=\":case\"?=\":case\"-=\":case\"+=\":case\"*=\":case\"/=\":case\"%=\":return this.assignment();case\".\":if(\"space\"==this.lookahead(i-1).type)return this.selector();if(this._ident==this.peek())return this.id();while(\"=\"!=this.lookahead(++i).type&&!~[\"[\",\",\",\"newline\",\"indent\",\"eos\"].indexOf(this.lookahead(i).type));if(\"=\"==this.lookahead(i).type){this._ident=this.peek();return this.expression()}else if(this.looksLikeSelector()&&this.stateAllowsSelector()){return this.selector()}case\"[\":if(this._ident==this.peek())return this.id();while(\"]\"!=this.lookahead(i++).type&&\"selector\"!=this.lookahead(i).type&&\"eos\"!=this.lookahead(i).type);if(\"=\"==this.lookahead(i).type){this._ident=this.peek();return this.expression()}else if(this.looksLikeSelector()&&this.stateAllowsSelector()){return this.selector()}case\"-\":case\"+\":case\"/\":case\"*\":case\"%\":case\"**\":case\"&&\":case\"||\":case\">\":case\"<\":case\">=\":case\"<=\":case\"!=\":case\"==\":case\"?\":case\"in\":case\"is a\":case\"is defined\":if(this._ident==this.peek()){return this.id()}else{this._ident=this.peek();switch(this.currentState()){case\"for\":case\"selector\":return this.property();case\"root\":case\"atblock\":case\"atrule\":return\"[\"==la?this.subscript():this.selector();case\"function\":case\"conditional\":return this.looksLikeSelector()?this.selector():this.expression();default:return this.operand?this.id():this.expression()}}default:switch(this.currentState()){case\"root\":return this.selector();case\"for\":case\"selector\":case\"function\":case\"conditional\":case\"atblock\":case\"atrule\":return this.property();default:var id=this.id();if(\"interpolation\"==this.previousState())id.mixin=true;return id}}},interpolate:function(){var node,segs=[],star;star=this.accept(\"*\");if(star)segs.push(new nodes.Literal(\"*\"));while(true){if(this.accept(\"{\")){this.state.push(\"interpolation\");segs.push(this.expression());this.expect(\"}\");this.state.pop()}else if(node=this.accept(\"-\")){segs.push(new nodes.Literal(\"-\"))}else if(node=this.accept(\"ident\")){segs.push(node.val)}else{break}}if(!segs.length)this.expect(\"ident\");return segs},property:function(){if(this.looksLikeSelector(true))return this.selector();var ident=this.interpolate(),prop=new nodes.Property(ident),ret=prop;this.accept(\"space\");if(this.accept(\":\"))this.accept(\"space\");this.state.push(\"property\");this.inProperty=true;prop.expr=this.list();if(prop.expr.isEmpty)ret=ident[0];this.inProperty=false;this.allowPostfix=true;this.state.pop();this.accept(\";\");return ret},selector:function(){var arr,group=new nodes.Group,scope=this.selectorScope,isRoot=\"root\"==this.currentState(),selector;do{this.accept(\"newline\");arr=this.selectorParts();if(isRoot&&scope)arr.unshift(new nodes.Literal(scope+\" \"));if(arr.length){selector=new nodes.Selector(arr);selector.lineno=arr[0].lineno;selector.column=arr[0].column;group.push(selector)}}while(this.accept(\",\")||this.accept(\"newline\"));if(\"selector-parts\"==this.currentState())return group.nodes;this.state.push(\"selector\");group.block=this.block(group);this.state.pop();return group},selectorParts:function(){var tok,arr=[];while(tok=this.selectorToken()){switch(tok.type){case\"{\":this.skipSpaces();var expr=this.expression();this.skipSpaces();this.expect(\"}\");arr.push(expr);break;case this.prefix&&\".\":var literal=new nodes.Literal(tok.val+this.prefix);literal.prefixed=true;arr.push(literal);break;case\"comment\":break;case\"color\":case\"unit\":arr.push(new nodes.Literal(tok.val.raw));break;case\"space\":arr.push(new nodes.Literal(\" \"));break;case\"function\":arr.push(new nodes.Literal(tok.val.name+\"(\"));break;case\"ident\":arr.push(new nodes.Literal(tok.val.name||tok.val.string));break;default:arr.push(new nodes.Literal(tok.val));if(tok.space)arr.push(new nodes.Literal(\" \"))}}return arr},assignment:function(){var op,node,name=this.id().name;if(op=this.accept(\"=\")||this.accept(\"?=\")||this.accept(\"+=\")||this.accept(\"-=\")||this.accept(\"*=\")||this.accept(\"/=\")||this.accept(\"%=\")){this.state.push(\"assignment\");var expr=this.list();if(expr.isEmpty)this.assignAtblock(expr);node=new nodes.Ident(name,expr);this.state.pop();switch(op.type){case\"?=\":var defined=new nodes.BinOp(\"is defined\",node),lookup=new nodes.Ident(name);node=new nodes.Ternary(defined,lookup,node);break;case\"+=\":case\"-=\":case\"*=\":case\"/=\":case\"%=\":node.val=new nodes.BinOp(op.type[0],new nodes.Ident(name),expr);break}}return node},fun:function(){var parens=1,i=2,tok;out:while(tok=this.lookahead(i++)){switch(tok.type){case\"function\":case\"(\":++parens;break;case\")\":if(!--parens)break out;break;case\"eos\":this.error('failed to find closing paren \")\"')}}switch(this.currentState()){case\"expression\":return this.functionCall();default:return this.looksLikeFunctionDefinition(i)?this.functionDefinition():this.expression()}},url:function(){this.expect(\"function\");this.state.push(\"function arguments\");var args=this.args();this.expect(\")\");this.state.pop();return new nodes.Call(\"url\",args)},functionCall:function(){var withBlock=this.accept(\"+\");if(\"url\"==this.peek().val.name)return this.url();var name=this.expect(\"function\").val.name;this.state.push(\"function arguments\");this.parens++;var args=this.args();this.expect(\")\");this.parens--;this.state.pop();var call=new nodes.Call(name,args);if(withBlock){this.state.push(\"function\");call.block=this.block(call);this.state.pop()}return call},functionDefinition:function(){var name=this.expect(\"function\").val.name;this.state.push(\"function params\");this.skipWhitespace();var params=this.params();this.skipWhitespace();this.expect(\")\");this.state.pop();this.state.push(\"function\");var fn=new nodes.Function(name,params);fn.block=this.block(fn);this.state.pop();return new nodes.Ident(name,fn)},params:function(){var tok,node,params=new nodes.Params;while(tok=this.accept(\"ident\")){this.accept(\"space\");params.push(node=tok.val);if(this.accept(\"...\")){node.rest=true}else if(this.accept(\"=\")){node.val=this.expression()}this.skipWhitespace();this.accept(\",\");this.skipWhitespace()}return params},args:function(){var args=new nodes.Arguments,keyword;do{if(\"ident\"==this.peek().type&&\":\"==this.lookahead(2).type){keyword=this.next().val.string;this.expect(\":\");args.map[keyword]=this.expression()}else{args.push(this.expression())}}while(this.accept(\",\"));return args},list:function(){var node=this.expression();while(this.accept(\",\")){if(node.isList){list.push(this.expression())}else{var list=new nodes.Expression(true);list.push(node);list.push(this.expression());node=list}}return node},expression:function(){var node,expr=new nodes.Expression;this.state.push(\"expression\");while(node=this.negation()){if(!node)this.error(\"unexpected token {peek} in expression\");expr.push(node)}this.state.pop();if(expr.nodes.length){expr.lineno=expr.nodes[0].lineno;expr.column=expr.nodes[0].column}return expr},negation:function(){if(this.accept(\"not\")){return new nodes.UnaryOp(\"!\",this.negation())}return this.ternary()},ternary:function(){var node=this.logical();if(this.accept(\"?\")){var trueExpr=this.expression();this.expect(\":\");var falseExpr=this.expression();node=new nodes.Ternary(node,trueExpr,falseExpr)}return node},logical:function(){var op,node=this.typecheck();while(op=this.accept(\"&&\")||this.accept(\"||\")){node=new nodes.BinOp(op.type,node,this.typecheck())}return node},typecheck:function(){var op,node=this.equality();while(op=this.accept(\"is a\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.equality());this.operand=false}return node},equality:function(){var op,node=this.inop();while(op=this.accept(\"==\")||this.accept(\"!=\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.inop());this.operand=false}return node},inop:function(){var node=this.relational();while(this.accept(\"in\")){this.operand=true;if(!node)this.error('illegal unary \"in\", missing left-hand operand');node=new nodes.BinOp(\"in\",node,this.relational());this.operand=false}return node},relational:function(){var op,node=this.range();while(op=this.accept(\">=\")||this.accept(\"<=\")||this.accept(\"<\")||this.accept(\">\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.range());this.operand=false}return node},range:function(){var op,node=this.additive();if(op=this.accept(\"...\")||this.accept(\"..\")){this.operand=true;if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.val,node,this.additive());this.operand=false}return node},additive:function(){var op,node=this.multiplicative();while(op=this.accept(\"+\")||this.accept(\"-\")){this.operand=true;node=new nodes.BinOp(op.type,node,this.multiplicative());this.operand=false}return node},multiplicative:function(){var op,node=this.defined();while(op=this.accept(\"**\")||this.accept(\"*\")||this.accept(\"/\")||this.accept(\"%\")){this.operand=true;if(\"/\"==op&&this.inProperty&&!this.parens){this.stash.push(new Token(\"literal\",new nodes.Literal(\"/\")));this.operand=false;return node}else{if(!node)this.error('illegal unary \"'+op+'\", missing left-hand operand');node=new nodes.BinOp(op.type,node,this.defined());this.operand=false}}return node},defined:function(){var node=this.unary();if(this.accept(\"is defined\")){if(!node)this.error('illegal unary \"is defined\", missing left-hand operand');node=new nodes.BinOp(\"is defined\",node)}return node},unary:function(){var op,node;if(op=this.accept(\"!\")||this.accept(\"~\")||this.accept(\"+\")||this.accept(\"-\")){this.operand=true;node=this.unary();if(!node)this.error('illegal unary \"'+op+'\"');node=new nodes.UnaryOp(op.type,node);this.operand=false;return node}return this.subscript()},subscript:function(){var node=this.member(),id;while(this.accept(\"[\")){node=new nodes.BinOp(\"[]\",node,this.expression());this.expect(\"]\")}if(this.accept(\"=\")){node.op+=\"=\";node.val=this.list();if(node.val.isEmpty)this.assignAtblock(node.val)}return node},member:function(){var node=this.primary();if(node){while(this.accept(\".\")){var id=new nodes.Ident(this.expect(\"ident\").val.string);node=new nodes.Member(node,id)}this.skipSpaces();if(this.accept(\"=\")){node.val=this.list();if(node.val.isEmpty)this.assignAtblock(node.val)}}return node},object:function(){var obj=new nodes.Object,id,val,comma;this.expect(\"{\");this.skipWhitespace();while(!this.accept(\"}\")){if(this.accept(\"comment\")||this.accept(\"newline\"))continue;if(!comma)this.accept(\",\");id=this.accept(\"ident\")||this.accept(\"string\");if(!id)this.error('expected \"ident\" or \"string\", got {peek}');id=id.val.hash;this.skipSpacesAndComments();this.expect(\":\");val=this.expression();obj.set(id,val);comma=this.accept(\",\");this.skipWhitespace()}return obj},primary:function(){var tok;this.skipSpaces();if(this.accept(\"(\")){++this.parens;var expr=this.expression(),paren=this.expect(\")\");--this.parens;if(this.accept(\"%\"))expr.push(new nodes.Ident(\"%\"));tok=this.peek();if(!paren.space&&\"ident\"==tok.type&&~units.indexOf(tok.val.string)){expr.push(new nodes.Ident(tok.val.string));this.next()}return expr}tok=this.peek();switch(tok.type){case\"null\":case\"unit\":case\"color\":case\"string\":case\"literal\":case\"boolean\":case\"comment\":return this.next().val;case!this.cond&&\"{\":return this.object();case\"atblock\":return this.atblock();case\"atrule\":var id=new nodes.Ident(this.next().val);id.property=true;return id;case\"ident\":return this.ident();case\"function\":return tok.anonymous?this.functionDefinition():this.functionCall()}}}});require.register(\"renderer.js\",function(module,exports,require){var Parser=require(\"./parser\"),Evaluator=require(\"./visitor/evaluator\"),Normalizer=require(\"./visitor/normalizer\"),utils=require(\"./utils\"),nodes=require(\"./nodes\"),join=require(\"./path\").join;module.exports=Renderer;function Renderer(str,options){options=options||{};options.globals=options.globals||{};options.functions=options.functions||{};options.use=options.use||[];options.use=Array.isArray(options.use)?options.use:[options.use];options.imports=[];options.paths=options.paths||[];options.filename=options.filename||\"stylus\";options.Evaluator=options.Evaluator||Evaluator;this.options=options;this.str=str}Renderer.prototype.render=function(fn){var parser=this.parser=new Parser(this.str,this.options);for(var i=0,len=this.options.use.length;i<len;i++){this.use(this.options.use[i])}try{nodes.filename=this.options.filename;var ast=parser.parse();this.evaluator=new this.options.Evaluator(ast,this.options);this.nodes=nodes;this.evaluator.renderer=this;ast=this.evaluator.evaluate();var normalizer=new Normalizer(ast,this.options);ast=normalizer.normalize();var compiler=this.options.sourcemap?new(require(\"./visitor/sourcemapper\"))(ast,this.options):new(require(\"./visitor/compiler\"))(ast,this.options),css=compiler.compile();if(this.options.sourcemap)this.sourcemap=compiler.map.toJSON()}catch(err){var options={};options.input=err.input||this.str;options.filename=err.filename||this.options.filename;\noptions.lineno=err.lineno||parser.lexer.lineno;options.column=err.column||parser.lexer.column;if(!fn)throw utils.formatException(err,options);return fn(utils.formatException(err,options))}if(!fn)return css;fn(null,css)};Renderer.prototype.deps=function(filename){if(filename)this.options.filename=filename;var DepsResolver=require(\"./visitor/deps-resolver\"),parser=new Parser(this.str,this.options);try{nodes.filename=this.options.filename;var ast=parser.parse(),resolver=new DepsResolver(ast,this.options);return resolver.resolve()}catch(err){var options={};options.input=err.input||this.str;options.filename=err.filename||this.options.filename;options.lineno=err.lineno||parser.lexer.lineno;options.column=err.column||parser.lexer.column;throw utils.formatException(err,options)}};Renderer.prototype.set=function(key,val){this.options[key]=val;return this};Renderer.prototype.get=function(key){return this.options[key]};Renderer.prototype.include=function(path){this.options.paths.push(path);return this};Renderer.prototype.use=function(fn){fn.call(this,this);return this};Renderer.prototype.define=function(name,fn,raw){fn=utils.coerce(fn,raw);if(fn.nodeName){this.options.globals[name]=fn;return this}this.options.functions[name]=fn;if(undefined!=raw)fn.raw=raw;return this}});require.register(\"selector-parser.js\",function(module,exports,require){var COMBINATORS=[\">\",\"+\",\"~\"];var SelectorParser=module.exports=function SelectorParser(str,stack,parts){this.str=str;this.stack=stack||[];this.parts=parts||[];this.pos=0;this.level=2;this.nested=true;this.ignore=false};SelectorParser.prototype.skip=function(len){this.str=this.str.substr(len);this.pos+=len};SelectorParser.prototype.skipSpaces=function(){while(\" \"==this.str[0])this.skip(1)};SelectorParser.prototype.advance=function(){return this.root()||this.relative()||this.escaped()||this.parent()||this.partial()||this.char()};SelectorParser.prototype.root=function(){if(!this.pos&&\"/\"==this.str[0]&&\"deep\"!=this.str.slice(1,5)){this.nested=false;this.skip(1)}};SelectorParser.prototype.relative=function(multi){if((!this.pos||multi)&&\"../\"==this.str.slice(0,3)){this.nested=false;this.skip(3);while(this.relative(true))this.level++;if(!this.raw){var ret=this.stack[this.stack.length-this.level];if(ret){return ret}else{this.ignore=true}}}};SelectorParser.prototype.escaped=function(){if(\"\\\\\"==this.str[0]){var char=this.str[1];if(\"&\"==char||\"^\"==char){this.skip(2);return char}}};SelectorParser.prototype.parent=function(){if(\"&\"==this.str[0]){if(!this.pos&&(!this.stack.length||this.raw)){var i=0;while(\" \"==this.str[++i]);if(~COMBINATORS.indexOf(this.str[i])){this.skip(i+1);return}}this.nested=false;this.skip(1);if(!this.raw)return this.stack[this.stack.length-1]}};SelectorParser.prototype.partial=function(){if(\"^\"==this.str[0]&&\"[\"==this.str[1]){this.skip(2);this.skipSpaces();var ret=this.range();this.skipSpaces();if(\"]\"!=this.str[0])return\"^[\";this.nested=false;this.skip(1);if(ret){return ret}else{this.ignore=true}}};SelectorParser.prototype.number=function(){var i=0,ret=\"\";if(\"-\"==this.str[i])ret+=this.str[i++];while(this.str.charCodeAt(i)>=48&&this.str.charCodeAt(i)<=57)ret+=this.str[i++];if(ret){this.skip(i);return Number(ret)}};SelectorParser.prototype.range=function(){var start=this.number(),ret;if(\"..\"==this.str.slice(0,2)){this.skip(2);var end=this.number(),len=this.parts.length;if(start<0)start=len+start-1;if(end<0)end=len+end-1;if(start>end){var tmp=start;start=end;end=tmp}if(end<len-1){ret=this.parts.slice(start,end+1).map(function(part){var selector=new SelectorParser(part,this.stack,this.parts);selector.raw=true;return selector.parse().val.trim()},this).join(\" \")}}else{ret=this.stack[start<0?this.stack.length+start-1:start]}if(ret){return ret}else{this.ignore=true}};SelectorParser.prototype.char=function(){var char=this.str[0];this.skip(1);return char};SelectorParser.prototype.parse=function(){var val=\"\";while(this.str.length){val+=this.advance()||\"\";if(this.ignore){val=\"\";break}}return{val:val.trimRight(),nested:this.nested}}});require.register(\"stack/index.js\",function(module,exports,require){var Stack=module.exports=function Stack(){Array.apply(this,arguments)};Stack.prototype.__proto__=Array.prototype;Stack.prototype.push=function(frame){frame.stack=this;frame.parent=this.currentFrame;return[].push.apply(this,arguments)};Stack.prototype.__defineGetter__(\"currentFrame\",function(){return this[this.length-1]});Stack.prototype.getBlockFrame=function(block){for(var i=0;i<this.length;++i){if(block==this[i].block){return this[i]}}};Stack.prototype.lookup=function(name){var block=this.currentFrame.block,val,ret;do{var frame=this.getBlockFrame(block);if(frame&&(val=frame.lookup(name))){return val}}while(block=block.parent)};Stack.prototype.inspect=function(){return this.reverse().map(function(frame){return frame.inspect()}).join(\"\\n\")};Stack.prototype.toString=function(){var block,node,buf=[],location,len=this.length;while(len--){block=this[len].block;if(node=block.node){location=\"(\"+node.filename+\":\"+(node.lineno+1)+\":\"+node.column+\")\";switch(node.nodeName){case\"function\":buf.push(\"    at \"+node.name+\"() \"+location);break;case\"group\":buf.push('    at \"'+node.nodes[0].val+'\" '+location);break}}}return buf.join(\"\\n\")}});require.register(\"stack/frame.js\",function(module,exports,require){var Scope=require(\"./scope\");var Frame=module.exports=function Frame(block){this._scope=false===block.scope?null:new Scope;this.block=block};Frame.prototype.__defineGetter__(\"scope\",function(){return this._scope||this.parent.scope});Frame.prototype.lookup=function(name){return this.scope.lookup(name)};Frame.prototype.inspect=function(){return\"[Frame \"+(false===this.block.scope?\"scope-less\":this.scope.inspect())+\"]\"}});require.register(\"stack/scope.js\",function(module,exports,require){var Scope=module.exports=function Scope(){this.locals={}};Scope.prototype.add=function(ident){this.locals[ident.name]=ident.val};Scope.prototype.lookup=function(name){return this.locals[name]};Scope.prototype.inspect=function(){var keys=Object.keys(this.locals).map(function(key){return\"@\"+key});return\"[Scope\"+(keys.length?\" \"+keys.join(\", \"):\"\")+\"]\"}});require.register(\"stylus.js\",function(module,exports,require){var Renderer=require(\"./renderer\"),nodes=require(\"./nodes\"),utils=require(\"./utils\");exports=module.exports=render;exports.version=\"0.53.0\";exports.nodes=nodes;exports.functions=require(\"./functions\");exports.utils=require(\"./utils\");exports.Visitor=require(\"./visitor\");exports.Parser=require(\"./parser\");exports.Evaluator=require(\"./visitor/evaluator\");exports.Normalizer=require(\"./visitor/normalizer\");exports.Compiler=require(\"./visitor/compiler\");exports.render=function(str,options,fn){if(\"function\"==typeof options)fn=options,options={};if(bifs)str=bifs+str;return new Renderer(str,options).render(fn)};function render(str,options){if(bifs)str=bifs+str;return new Renderer(str,options)}exports.url=require(\"./functions/url\")});require.register(\"token.js\",function(module,exports,require){var Token=exports=module.exports=function Token(type,val){this.type=type;this.val=val};Token.prototype.inspect=function(){var val=\" \"+this.val;return\"[Token:\"+this.lineno+\":\"+this.column+\" \"+\"\u001b[32m\"+this.type+\"\u001b[0m\"+\"\u001b[33m\"+(this.val?val:\"\")+\"\u001b[0m\"+\"]\"};Token.prototype.toString=function(){return(undefined===this.val?this.type:this.val).toString()}});require.register(\"utils.js\",function(module,exports,require){var nodes=require(\"./nodes\"),join=require(\"./path\").join,isAbsolute=require(\"./path\").isAbsolute;exports.absolute=isAbsolute||function(path){return path.substr(0,2)==\"\\\\\\\\\"||\"/\"===path.charAt(0)||/^[a-z]:[\\\\\\/]/i.test(path)};exports.lookup=function(path,paths,ignore){var lookup,i=paths.length;if(exports.absolute(path)){try{return path}catch(err){}}while(i--){try{lookup=join(paths[i],path);if(ignore==lookup)continue;return lookup}catch(err){}}};exports.find=function(path,paths,ignore){var lookup,found,i=paths.length;if(exports.absolute(path)){if((found=glob.sync(path)).length){return found}}while(i--){lookup=join(paths[i],path);if(ignore==lookup)continue;if((found=glob.sync(lookup)).length){return found}}};exports.lookupIndex=function(name,paths,filename){var found=exports.find(join(name,\"index.styl\"),paths,filename);if(!found){found=exports.find(join(name,basename(name).replace(/\\.styl/i,\"\")+\".styl\"),paths,filename)}if(!found&&!~name.indexOf(\"node_modules\")){found=lookupPackage(join(\"node_modules\",name))}return found;function lookupPackage(dir){var pkg=exports.lookup(join(dir,\"package.json\"),paths,filename);if(!pkg){return/\\.styl$/i.test(dir)?exports.lookupIndex(dir,paths,filename):lookupPackage(dir+\".styl\")}var main=require(relative(__dirname,pkg)).main;if(main){found=exports.find(join(dir,main),paths,filename)}else{found=exports.lookupIndex(dir,paths,filename)}return found}};exports.formatException=function(err,options){var lineno=options.lineno,column=options.column,filename=options.filename,str=options.input,context=options.context||8,context=context/2,lines=(\"\\n\"+str).split(\"\\n\"),start=Math.max(lineno-context,1),end=Math.min(lines.length,lineno+context),pad=end.toString().length;var context=lines.slice(start,end).map(function(line,i){var curr=i+start;return\"   \"+Array(pad-curr.toString().length+1).join(\" \")+curr+\"| \"+line+(curr==lineno?\"\\n\"+Array(curr.toString().length+5+column).join(\"-\")+\"^\":\"\")}).join(\"\\n\");err.message=filename+\":\"+lineno+\":\"+column+\"\\n\"+context+\"\\n\\n\"+err.message+\"\\n\"+(err.stylusStack?err.stylusStack+\"\\n\":\"\");if(err.fromStylus)err.stack=\"Error: \"+err.message;return err};exports.assertType=function(node,type,param){exports.assertPresent(node,param);if(node.nodeName==type)return;var actual=node.nodeName,msg=\"expected \"+(param?'\"'+param+'\" to be a ':\"\")+type+\", but got \"+actual+\":\"+node;throw new Error(\"TypeError: \"+msg)};exports.assertString=function(node,param){exports.assertPresent(node,param);switch(node.nodeName){case\"string\":case\"ident\":case\"literal\":return;default:var actual=node.nodeName,msg=\"expected string, ident or literal, but got \"+actual+\":\"+node;throw new Error(\"TypeError: \"+msg)}};exports.assertColor=function(node,param){exports.assertPresent(node,param);switch(node.nodeName){case\"rgba\":case\"hsla\":return;default:var actual=node.nodeName,msg=\"expected rgba or hsla, but got \"+actual+\":\"+node;throw new Error(\"TypeError: \"+msg)}};exports.assertPresent=function(node,name){if(node)return;if(name)throw new Error('\"'+name+'\" argument required');throw new Error(\"argument missing\")};exports.unwrap=function(expr){if(expr.preserve)return expr;if(\"arguments\"!=expr.nodeName&&\"expression\"!=expr.nodeName)return expr;if(1!=expr.nodes.length)return expr;if(\"arguments\"!=expr.nodes[0].nodeName&&\"expression\"!=expr.nodes[0].nodeName)return expr;return exports.unwrap(expr.nodes[0])};exports.coerce=function(val,raw){switch(typeof val){case\"function\":return val;case\"string\":return new nodes.String(val);case\"boolean\":return new nodes.Boolean(val);case\"number\":return new nodes.Unit(val);default:if(null==val)return nodes.nil;if(Array.isArray(val))return exports.coerceArray(val,raw);if(val.nodeName)return val;return exports.coerceObject(val,raw)}};exports.coerceArray=function(val,raw){var expr=new nodes.Expression;val.forEach(function(val){expr.push(exports.coerce(val,raw))});return expr};exports.coerceObject=function(obj,raw){var node=raw?new nodes.Object:new nodes.Expression,val;for(var key in obj){val=exports.coerce(obj[key],raw);key=new nodes.Ident(key);if(raw){node.set(key,val)}else{node.push(exports.coerceArray([key,val]))}}return node};exports.params=function(fn){return fn.toString().match(/\\(([^)]*)\\)/)[1].split(/ *, */)};exports.merge=function(a,b,deep){for(var k in b){if(deep&&a[k]){var nodeA=exports.unwrap(a[k]).first,nodeB=exports.unwrap(b[k]).first;if(\"object\"==nodeA.nodeName&&\"object\"==nodeB.nodeName){a[k].first.vals=exports.merge(nodeA.vals,nodeB.vals,deep)}else{a[k]=b[k]}}else{a[k]=b[k]}}return a};exports.uniq=function(arr){var obj={},ret=[];for(var i=0,len=arr.length;i<len;++i){if(arr[i]in obj)continue;obj[arr[i]]=true;ret.push(arr[i])}return ret};exports.compileSelectors=function(arr,leaveHidden){var selectors=[],Parser=require(\"./selector-parser\"),indent=this.indent||\"\",buf=[];function parse(selector,buf){var parts=[selector.val],str=new Parser(parts[0],parents,parts).parse().val,parents=[];if(buf.length){for(var i=0,len=buf.length;i<len;++i){parts.push(buf[i]);parents.push(str);child=new Parser(buf[i],parents,parts).parse();if(child.nested){str+=\" \"+child.val}else{str=child.val}}}return str.trim()}function compile(arr,i){if(i){arr[i].forEach(function(selector){if(!leaveHidden&&selector.isPlaceholder)return;if(selector.inherits){buf.unshift(selector.val);compile(arr,i-1);buf.shift()}else{selectors.push(indent+parse(selector,buf))}})}else{arr[0].forEach(function(selector){if(!leaveHidden&&selector.isPlaceholder)return;var str=parse(selector,buf);if(str)selectors.push(indent+str)})}}compile(arr,arr.length-1);return exports.uniq(selectors)};exports.parseString=function(str){var Parser=require(\"./parser\"),parser,ret;try{parser=new Parser(str);parser.state.push(\"expression\");ret=new nodes.Expression;ret.nodes=parser.parse().nodes}catch(e){ret=new nodes.Literal(str)}return ret}});require.register(\"visitor/index.js\",function(module,exports,require){var Visitor=module.exports=function Visitor(root){this.root=root};Visitor.prototype.visit=function(node,fn){var method=\"visit\"+node.constructor.name;if(this[method])return this[method](node);return node}});require.register(\"visitor/compiler.js\",function(module,exports,require){var Visitor=require(\"./index\"),utils=require(\"../utils\");var Compiler=module.exports=function Compiler(root,options){options=options||{};this.compress=options.compress;this.firebug=options.firebug;this.linenos=options.linenos;this.spaces=options[\"indent spaces\"]||2;this.includeCSS=options[\"include css\"];this.indents=1;Visitor.call(this,root);this.stack=[]};Compiler.prototype.__proto__=Visitor.prototype;Compiler.prototype.compile=function(){return this.visit(this.root)};Compiler.prototype.out=function(str,node){return str};Compiler.prototype.__defineGetter__(\"indent\",function(){if(this.compress)return\"\";return new Array(this.indents).join(Array(this.spaces+1).join(\" \"))});Compiler.prototype.needBrackets=function(node){return 1==this.indents||\"atrule\"!=node.nodeName||node.hasOnlyProperties};Compiler.prototype.visitRoot=function(block){this.buf=\"\";for(var i=0,len=block.nodes.length;i<len;++i){var node=block.nodes[i];if(this.linenos||this.firebug)this.debugInfo(node);var ret=this.visit(node);if(ret)this.buf+=this.out(ret+\"\\n\",node)}return this.buf};Compiler.prototype.visitBlock=function(block){var node,separator=this.compress?\"\":\"\\n\",needBrackets;if(block.hasProperties&&!block.lacksRenderedSelectors){needBrackets=this.needBrackets(block.node);if(needBrackets){this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents}for(var i=0,len=block.nodes.length;i<len;++i){this.last=len-1==i;node=block.nodes[i];switch(node.nodeName){case\"null\":case\"expression\":case\"function\":case\"group\":case\"block\":case\"unit\":case\"media\":case\"keyframes\":case\"atrule\":case\"supports\":continue;case!this.compress&&node.inline&&\"comment\":this.buf=this.buf.slice(0,-1);this.buf+=this.out(\" \"+this.visit(node)+\"\\n\",node);break;case\"property\":var ret=this.visit(node)+separator;this.buf+=this.compress?ret:this.out(ret,node);break;default:this.buf+=this.out(this.visit(node)+separator,node)}}if(needBrackets){--this.indents;this.buf+=this.out(this.indent+\"}\"+separator)}}for(var i=0,len=block.nodes.length;i<len;++i){node=block.nodes[i];switch(node.nodeName){case\"group\":case\"block\":case\"keyframes\":if(this.linenos||this.firebug)this.debugInfo(node);this.visit(node);break;case\"media\":case\"import\":case\"atrule\":case\"supports\":this.visit(node);break;case\"comment\":if(!node.suppress){this.buf+=this.out(this.indent+this.visit(node)+\"\\n\",node)}break;case\"charset\":case\"literal\":case\"namespace\":this.buf+=this.out(this.visit(node)+\"\\n\",node);break}}};Compiler.prototype.visitKeyframes=function(node){if(!node.frames)return;var prefix=\"official\"==node.prefix?\"\":\"-\"+node.prefix+\"-\";this.buf+=this.out(\"@\"+prefix+\"keyframes \"+this.visit(node.val)+(this.compress?\"{\":\" {\\n\"),node);this.keyframe=true;++this.indents;this.visit(node.block);--this.indents;this.keyframe=false;this.buf+=this.out(\"}\"+(this.compress?\"\":\"\\n\"))};Compiler.prototype.visitMedia=function(media){var val=media.val;if(!media.hasOutput||!val.nodes.length)return;this.buf+=this.out(\"@media \",media);this.visit(val);this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents;this.visit(media.block);--this.indents;this.buf+=this.out(\"}\"+(this.compress?\"\":\"\\n\"))};Compiler.prototype.visitQueryList=function(queries){for(var i=0,len=queries.nodes.length;i<len;++i){this.visit(queries.nodes[i]);if(len-1!=i)this.buf+=this.out(\",\"+(this.compress?\"\":\" \"))}};Compiler.prototype.visitQuery=function(node){var len=node.nodes.length;if(node.predicate)this.buf+=this.out(node.predicate+\" \");if(node.type)this.buf+=this.out(node.type+(len?\" and \":\"\"));for(var i=0;i<len;++i){this.buf+=this.out(this.visit(node.nodes[i]));if(len-1!=i)this.buf+=this.out(\" and \")}};Compiler.prototype.visitFeature=function(node){if(!node.expr){return node.name}else if(node.expr.isEmpty){return\"(\"+node.name+\")\"}else{return\"(\"+node.name+\":\"+(this.compress?\"\":\" \")+this.visit(node.expr)+\")\"}};Compiler.prototype.visitImport=function(imported){this.buf+=this.out(\"@import \"+this.visit(imported.path)+\";\\n\",imported)};Compiler.prototype.visitAtrule=function(atrule){var newline=this.compress?\"\":\"\\n\";this.buf+=this.out(this.indent+\"@\"+atrule.type,atrule);if(atrule.val)this.buf+=this.out(\" \"+atrule.val.trim());if(atrule.block){if(atrule.hasOnlyProperties){this.visit(atrule.block)}else{this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents;this.visit(atrule.block);--this.indents;this.buf+=this.out(this.indent+\"}\"+newline)}}else{this.buf+=this.out(\";\"+newline)}};Compiler.prototype.visitSupports=function(node){if(!node.hasOutput)return;this.buf+=this.out(this.indent+\"@supports \",node);this.isCondition=true;this.buf+=this.out(this.visit(node.condition));this.isCondition=false;this.buf+=this.out(this.compress?\"{\":\" {\\n\");++this.indents;this.visit(node.block);--this.indents;this.buf+=this.out(this.indent+\"}\"+(this.compress?\"\":\"\\n\"))},Compiler.prototype.visitComment=function(comment){return this.compress?comment.suppress?\"\":comment.str:comment.str};Compiler.prototype.visitFunction=function(fn){return fn.name};Compiler.prototype.visitCharset=function(charset){return\"@charset \"+this.visit(charset.val)+\";\"};Compiler.prototype.visitNamespace=function(namespace){return\"@namespace \"+(namespace.prefix?this.visit(namespace.prefix)+\" \":\"\")+this.visit(namespace.val)+\";\"};Compiler.prototype.visitLiteral=function(lit){var val=lit.val;if(lit.css)val=val.replace(/^  /gm,\"\");return val};Compiler.prototype.visitBoolean=function(bool){return bool.toString()};Compiler.prototype.visitRGBA=function(rgba){return rgba.toString()};Compiler.prototype.visitHSLA=function(hsla){return hsla.rgba.toString()};Compiler.prototype.visitUnit=function(unit){var type=unit.type||\"\",n=unit.val,float=n!=(n|0);if(this.compress){if(\"%\"!=type&&\"s\"!=type&&\"ms\"!=type&&0==n)return\"0\";if(float&&n<1&&n>-1){return n.toString().replace(\"0.\",\".\")+type}}return(float?parseFloat(n.toFixed(15)):n).toString()+type};Compiler.prototype.visitGroup=function(group){var stack=this.keyframe?[]:this.stack,comma=this.compress?\",\":\",\\n\";stack.push(group.nodes);if(group.block.hasProperties){var selectors=utils.compileSelectors.call(this,stack),len=selectors.length;if(len){if(this.keyframe)comma=this.compress?\",\":\", \";for(var i=0;i<len;++i){var selector=selectors[i],last=i==len-1;if(this.keyframe)selector=i?selector.trim():selector;this.buf+=this.out(selector+(last?\"\":comma),group.nodes[i])}}else{group.block.lacksRenderedSelectors=true}}this.visit(group.block);stack.pop()};Compiler.prototype.visitIdent=function(ident){return ident.name};Compiler.prototype.visitString=function(string){return this.isURL?string.val:string.toString()};Compiler.prototype.visitNull=function(node){return\"\"};Compiler.prototype.visitCall=function(call){this.isURL=\"url\"==call.name;var args=call.args.nodes.map(function(arg){return this.visit(arg)},this).join(this.compress?\",\":\", \");if(this.isURL)args='\"'+args+'\"';this.isURL=false;return call.name+\"(\"+args+\")\"};Compiler.prototype.visitExpression=function(expr){var buf=[],self=this,len=expr.nodes.length,nodes=expr.nodes.map(function(node){return self.visit(node)});nodes.forEach(function(node,i){var last=i==len-1;buf.push(node);if(\"/\"==nodes[i+1]||\"/\"==node)return;if(last)return;var space=self.isURL||self.isCondition&&(\")\"==nodes[i+1]||\"(\"==node)?\"\":\" \";buf.push(expr.isList?self.compress?\",\":\", \":space)});return buf.join(\"\")};Compiler.prototype.visitArguments=Compiler.prototype.visitExpression;Compiler.prototype.visitProperty=function(prop){var val=this.visit(prop.expr).trim(),name=prop.name||prop.segments.join(\"\"),arr=[];arr.push(this.out(this.indent),this.out(name+(this.compress?\":\":\": \"),prop),this.out(val,prop.expr),this.out(this.compress?this.last?\"\":\";\":\";\"));return arr.join(\"\")};Compiler.prototype.debugInfo=function(node){var path=node.filename==\"stdin\"?\"stdin\":fs.realpathSync(node.filename),line=(node.nodes&&node.nodes.length?node.nodes[0].lineno:node.lineno)||1;if(this.linenos){this.buf+=\"\\n/* \"+\"line \"+line+\" : \"+path+\" */\\n\"}if(this.firebug){path=\"file\\\\:\\\\/\\\\/\"+path.replace(/([.:/\\\\])/g,function(m){return\"\\\\\"+(m===\"\\\\\"?\"/\":m)});line=\"\\\\00003\"+line;this.buf+=\"\\n@media -stylus-debug-info\"+\"{filename{font-family:\"+path+\"}line{font-family:\"+line+\"}}\\n\"}}});require.register(\"visitor/evaluator.js\",function(module,exports,require){var Visitor=require(\"./index\"),nodes=require(\"../nodes\"),Stack=require(\"../stack\"),Frame=require(\"../stack/frame\"),utils=require(\"../utils\"),bifs=require(\"../functions\"),dirname=require(\"../path\").dirname,colors=require(\"../colors\"),units=require(\"../units\");function cloneNode(node){if(node.block&&node.block.node){node.block.node=node.block.node.clone()}if(node.nodes&&node.nodes.length){node.nodes.map(cloneNode)}return node}function importFile(node,file,literal){var importStack=this.importStack,Parser=require(\"../parser\"),stat;if(node.once){if(this.requireHistory[file])return nodes.nil;this.requireHistory[file]=true;if(literal&&!this.includeCSS){return node}}node.path=file;node.dirname=dirname(file);stat=fs.statSync(file);node.mtime=stat.mtime;this.paths.push(node.dirname);if(~importStack.indexOf(file))throw new Error(\"import loop has been found\");if(this.options._imports)this.options._imports.push(node.clone());importStack.push(file);nodes.filename=file;var str=fs.readFileSync(file,\"utf8\");if(literal){literal=new nodes.Literal(str.replace(/\\r\\n?/g,\"\\n\"));literal.lineno=literal.column=1;if(!this.resolveURL)return literal}var block=new nodes.Block,parser=new Parser(str,utils.merge({root:block},this.options));try{block=parser.parse()}catch(err){var line=parser.lexer.lineno,column=parser.lexer.column;if(this.includeCSS&&this.resolveURL){this.warn(\"ParseError: \"+file+\":\"+line+\":\"+column+\". This file included as-is\");return literal}else{err.filename=file;err.lineno=line;err.column=column;err.input=str;throw err}}block=block.clone(this.currentBlock);block.parent=this.currentBlock;block.scope=false;var ret=this.visit(block);importStack.pop();if(!this.resolveURL||this.resolveURL.nocheck)this.paths.pop();return ret}var Evaluator=module.exports=function Evaluator(root,options){options=options||{};Visitor.call(this,root);var functions=this.functions=options.functions||{};this.stack=new Stack;this.imports=options.imports||[];this.globals=options.globals||{};this.paths=options.paths||[];this.prefix=options.prefix||\"\";this.filename=options.filename;this.includeCSS=options[\"include css\"];this.resolveURL=functions.url&&\"resolver\"==functions.url.name&&functions.url.options;this.paths.push(dirname(options.filename||\".\"));this.stack.push(this.global=new Frame(root));this.warnings=options.warn;this.options=options;this.calling=[];this.importStack=[];this.ret=0;this.requireHistory={}};Evaluator.prototype.__proto__=Visitor.prototype;var visit=Visitor.prototype.visit;Evaluator.prototype.visit=function(node){try{return visit.call(this,node)}catch(err){if(err.filename)throw err;err.lineno=node.lineno;err.column=node.column;err.filename=node.filename;err.stylusStack=this.stack.toString();try{}catch(err){}throw err}};Evaluator.prototype.setup=function(){var root=this.root;var imports=[];this.populateGlobalScope();this.imports.forEach(function(file){var expr=new nodes.Expression;expr.push(new nodes.String(file));imports.push(new nodes.Import(expr))},this);root.nodes=imports.concat(root.nodes)};Evaluator.prototype.populateGlobalScope=function(){var scope=this.global.scope;Object.keys(colors).forEach(function(name){var color=colors[name],rgba=new nodes.RGBA(color[0],color[1],color[2],color[3]),node=new nodes.Ident(name,rgba);rgba.name=name;scope.add(node)});var globals=this.globals;Object.keys(globals).forEach(function(name){scope.add(new nodes.Ident(name,globals[name]))})};Evaluator.prototype.evaluate=function(){this.setup();return this.visit(this.root)};Evaluator.prototype.visitGroup=function(group){group.nodes=group.nodes.map(function(selector){selector.val=this.interpolate(selector);return selector},this);group.block=this.visit(group.block);return group};Evaluator.prototype.visitReturn=function(ret){ret.expr=this.visit(ret.expr);throw ret};Evaluator.prototype.visitMedia=function(media){media.block=this.visit(media.block);media.val=this.visit(media.val);return media};Evaluator.prototype.visitQueryList=function(queries){var val,query;queries.nodes.forEach(this.visit,this);if(1==queries.nodes.length){query=queries.nodes[0];if(val=this.lookup(query.type)){val=val.first.string;if(!val)return queries;var Parser=require(\"../parser\"),parser=new Parser(val,this.options);queries=this.visit(parser.queries())}}return queries};Evaluator.prototype.visitQuery=function(node){node.predicate=this.visit(node.predicate);node.type=this.visit(node.type);node.nodes.forEach(this.visit,this);return node};Evaluator.prototype.visitFeature=function(node){node.name=this.interpolate(node);if(node.expr){this.ret++;node.expr=this.visit(node.expr);this.ret--}return node};Evaluator.prototype.visitObject=function(obj){for(var key in obj.vals){obj.vals[key]=this.visit(obj.vals[key])}return obj};Evaluator.prototype.visitMember=function(node){var left=node.left,right=node.right,obj=this.visit(left).first;if(\"object\"!=obj.nodeName){throw new Error(left.toString()+\" has no property .\"+right)}if(node.val){this.ret++;obj.set(right.name,this.visit(node.val));this.ret--}return obj.get(right.name)};Evaluator.prototype.visitKeyframes=function(keyframes){var val;if(keyframes.fabricated)return keyframes;keyframes.val=this.interpolate(keyframes).trim();if(val=this.lookup(keyframes.val)){keyframes.val=val.first.string||val.first.name}keyframes.block=this.visit(keyframes.block);if(\"official\"!=keyframes.prefix)return keyframes;this.vendors.forEach(function(prefix){if(\"ms\"==prefix)return;var node=keyframes.clone();node.val=keyframes.val;node.prefix=prefix;node.block=keyframes.block;node.fabricated=true;this.currentBlock.push(node)},this);return nodes.nil};Evaluator.prototype.visitFunction=function(fn){var local=this.stack.currentFrame.scope.lookup(fn.name);if(local)this.warn(\"local \"+local.nodeName+' \"'+fn.name+'\" previously defined in this scope');var user=this.functions[fn.name];if(user)this.warn('user-defined function \"'+fn.name+'\" is already defined');var bif=bifs[fn.name];if(bif)this.warn('built-in function \"'+fn.name+'\" is already defined');return fn};Evaluator.prototype.visitEach=function(each){this.ret++;var expr=utils.unwrap(this.visit(each.expr)),len=expr.nodes.length,val=new nodes.Ident(each.val),key=new nodes.Ident(each.key||\"__index__\"),scope=this.currentScope,block=this.currentBlock,vals=[],self=this,body,obj;this.ret--;each.block.scope=false;function visitBody(key,val){scope.add(val);scope.add(key);body=self.visit(each.block.clone());vals=vals.concat(body.nodes)}if(1==len&&\"object\"==expr.nodes[0].nodeName){obj=expr.nodes[0];for(var prop in obj.vals){val.val=new nodes.String(prop);key.val=obj.get(prop);visitBody(key,val)}}else{for(var i=0;i<len;++i){val.val=expr.nodes[i];key.val=new nodes.Unit(i);visitBody(key,val)}}this.mixin(vals,block);return vals[vals.length-1]||nodes.nil};Evaluator.prototype.visitCall=function(call){var fn=this.lookup(call.name),literal,ret;this.ignoreColors=\"url\"==call.name;if(fn&&\"expression\"==fn.nodeName){fn=fn.nodes[0]}if(fn&&\"function\"!=fn.nodeName){fn=this.lookupFunction(call.name)}if(!fn||fn.nodeName!=\"function\"){if(\"calc\"==this.unvendorize(call.name)){literal=call.args.nodes&&call.args.nodes[0];if(literal)ret=new nodes.Literal(call.name+literal)}else{ret=this.literalCall(call)}this.ignoreColors=false;return ret}this.calling.push(call.name);if(this.calling.length>200){throw new RangeError(\"Maximum stylus call stack size exceeded\")}if(\"expression\"==fn.nodeName)fn=fn.first;this.ret++;var args=this.visit(call.args);for(var key in args.map){args.map[key]=this.visit(args.map[key].clone())}this.ret--;if(fn.fn){ret=this.invokeBuiltin(fn.fn,args)}else if(\"function\"==fn.nodeName){if(call.block)call.block=this.visit(call.block);ret=this.invokeFunction(fn,args,call.block)}this.calling.pop();this.ignoreColors=false;return ret};Evaluator.prototype.visitIdent=function(ident){var prop;if(ident.property){if(prop=this.lookupProperty(ident.name)){return this.visit(prop.expr.clone())}return nodes.nil}else if(ident.val.isNull){var val=this.lookup(ident.name);if(val&&ident.mixin)this.mixinNode(val);return val?this.visit(val):ident}else{this.ret++;ident.val=this.visit(ident.val);this.ret--;this.currentScope.add(ident);return ident.val}};Evaluator.prototype.visitBinOp=function(binop){if(\"is defined\"==binop.op)return this.isDefined(binop.left);this.ret++;var op=binop.op,left=this.visit(binop.left),right=\"||\"==op||\"&&\"==op?binop.right:this.visit(binop.right);var val=binop.val?this.visit(binop.val):null;this.ret--;try{return this.visit(left.operate(op,right,val))}catch(err){if(\"CoercionError\"==err.name){switch(op){case\"==\":return nodes.no;case\"!=\":return nodes.yes}}throw err}};Evaluator.prototype.visitUnaryOp=function(unary){var op=unary.op,node=this.visit(unary.expr);if(\"!\"!=op){node=node.first.clone();utils.assertType(node,\"unit\")}switch(op){case\"-\":node.val=-node.val;break;case\"+\":node.val=+node.val;break;case\"~\":node.val=~node.val;break;case\"!\":return node.toBoolean().negate()}return node};Evaluator.prototype.visitTernary=function(ternary){var ok=this.visit(ternary.cond).toBoolean();return ok.isTrue?this.visit(ternary.trueExpr):this.visit(ternary.falseExpr)};Evaluator.prototype.visitExpression=function(expr){for(var i=0,len=expr.nodes.length;i<len;++i){expr.nodes[i]=this.visit(expr.nodes[i])}if(this.castable(expr))expr=this.cast(expr);return expr};Evaluator.prototype.visitArguments=Evaluator.prototype.visitExpression;Evaluator.prototype.visitProperty=function(prop){var name=this.interpolate(prop),fn=this.lookup(name),call=fn&&\"function\"==fn.first.nodeName,literal=~this.calling.indexOf(name),_prop=this.property;if(call&&!literal&&!prop.literal){var args=nodes.Arguments.fromExpression(utils.unwrap(prop.expr.clone()));prop.name=name;this.property=prop;this.ret++;this.property.expr=this.visit(prop.expr);this.ret--;var ret=this.visit(new nodes.Call(name,args));this.property=_prop;return ret}else{this.ret++;prop.name=name;prop.literal=true;this.property=prop;prop.expr=this.visit(prop.expr);this.property=_prop;this.ret--;return prop}};Evaluator.prototype.visitRoot=function(block){if(block!=this.root){block.constructor=nodes.Block;return this.visit(block)}for(var i=0;i<block.nodes.length;++i){block.index=i;block.nodes[i]=this.visit(block.nodes[i])}return block};Evaluator.prototype.visitBlock=function(block){this.stack.push(new Frame(block));\nfor(block.index=0;block.index<block.nodes.length;++block.index){try{block.nodes[block.index]=this.visit(block.nodes[block.index])}catch(err){if(\"return\"==err.nodeName){if(this.ret){this.stack.pop();throw err}else{block.nodes[block.index]=err;break}}else{throw err}}}this.stack.pop();return block};Evaluator.prototype.visitAtblock=function(atblock){atblock.block=this.visit(atblock.block);return atblock};Evaluator.prototype.visitAtrule=function(atrule){atrule.val=this.interpolate(atrule);if(atrule.block)atrule.block=this.visit(atrule.block);return atrule};Evaluator.prototype.visitSupports=function(node){var condition=node.condition,val;this.ret++;node.condition=this.visit(condition);this.ret--;val=condition.first;if(1==condition.nodes.length&&\"string\"==val.nodeName){node.condition=val.string}node.block=this.visit(node.block);return node};Evaluator.prototype.visitIf=function(node){var ret,block=this.currentBlock,negate=node.negate;this.ret++;var ok=this.visit(node.cond).first.toBoolean();this.ret--;node.block.scope=node.block.hasMedia;if(negate){if(ok.isFalse){ret=this.visit(node.block)}}else{if(ok.isTrue){ret=this.visit(node.block)}else if(node.elses.length){var elses=node.elses,len=elses.length,cond;for(var i=0;i<len;++i){if(elses[i].cond){elses[i].block.scope=elses[i].block.hasMedia;this.ret++;cond=this.visit(elses[i].cond).first.toBoolean();this.ret--;if(cond.isTrue){ret=this.visit(elses[i].block);break}}else{elses[i].scope=elses[i].hasMedia;ret=this.visit(elses[i])}}}}if(ret&&!node.postfix&&block.node&&~[\"group\",\"atrule\",\"media\",\"supports\",\"keyframes\"].indexOf(block.node.nodeName)){this.mixin(ret.nodes,block);return nodes.nil}return ret||nodes.nil};Evaluator.prototype.visitExtend=function(extend){var block=this.currentBlock;if(\"group\"!=block.node.nodeName)block=this.closestGroup;extend.selectors.forEach(function(selector){block.node.extends.push({selector:this.interpolate(selector.clone()).trim(),optional:selector.optional,lineno:selector.lineno,column:selector.column})},this);return nodes.nil};Evaluator.prototype.visitImport=function(imported){this.ret++;var path=this.visit(imported.path).first,nodeName=imported.once?\"require\":\"import\",found,literal;this.ret--;if(\"url\"==path.name){if(imported.once)throw new Error(\"You cannot @require a url\");return imported}if(!path.string)throw new Error(\"@\"+nodeName+\" string expected\");var name=path=path.string;if(/(?:url\\s*\\(\\s*)?['\"]?(?:#|(?:https?:)?\\/\\/)/i.test(path)){if(imported.once)throw new Error(\"You cannot @require a url\");return imported}if(/\\.css(?:\"|$)/.test(path)){literal=true;if(!imported.once&&!this.includeCSS){return imported}}if(!literal&&!/\\.styl$/i.test(path))path+=\".styl\";found=utils.find(path,this.paths,this.filename);if(!found){found=utils.lookupIndex(name,this.paths,this.filename)}if(!found)throw new Error(\"failed to locate @\"+nodeName+\" file \"+path);var block=new nodes.Block;for(var i=0,len=found.length;i<len;++i){block.push(importFile.call(this,imported,found[i],literal))}return block};Evaluator.prototype.invokeFunction=function(fn,args,content){var block=new nodes.Block(fn.block.parent);var body=fn.block.clone(block);var mixinBlock=this.stack.currentFrame.block;this.stack.push(new Frame(block));var scope=this.currentScope;if(\"arguments\"!=args.nodeName){var expr=new nodes.Expression;expr.push(args);args=nodes.Arguments.fromExpression(expr)}scope.add(new nodes.Ident(\"arguments\",args));scope.add(new nodes.Ident(\"mixin\",this.ret?nodes.no:new nodes.String(mixinBlock.nodeName)));if(this.property){var prop=this.propertyExpression(this.property,fn.name);scope.add(new nodes.Ident(\"current-property\",prop))}else{scope.add(new nodes.Ident(\"current-property\",nodes.nil))}var expr=new nodes.Expression;for(var i=this.calling.length-1;i--;){expr.push(new nodes.Literal(this.calling[i]))}scope.add(new nodes.Ident(\"called-from\",expr));var i=0,len=args.nodes.length;fn.params.nodes.forEach(function(node){if(node.rest){node.val=new nodes.Expression;for(;i<len;++i)node.val.push(args.nodes[i]);node.val.preserve=true;node.val.isList=args.isList}else{var arg=args.map[node.name]||args.nodes[i++];node=node.clone();if(arg){arg.isEmpty?args.nodes[i-1]=node.val:node.val=arg}else{args.push(node.val)}if(node.val.isNull){throw new Error('argument \"'+node+'\" required for '+fn)}}scope.add(node)});if(content)scope.add(new nodes.Ident(\"block\",content,true));return this.invoke(body,true,fn.filename)};Evaluator.prototype.invokeBuiltin=function(fn,args){if(fn.raw){args=args.nodes}else{args=utils.params(fn).reduce(function(ret,param){var arg=args.map[param]||args.nodes.shift();if(arg){arg=utils.unwrap(arg);var len=arg.nodes.length;if(len>1){for(var i=0;i<len;++i){ret.push(utils.unwrap(arg.nodes[i].first))}}else{ret.push(arg.first)}}return ret},[])}var body=utils.coerce(fn.apply(this,args));var expr=new nodes.Expression;expr.push(body);body=expr;return this.invoke(body)};Evaluator.prototype.invoke=function(body,stack,filename){var self=this,ret;if(filename)this.paths.push(dirname(filename));if(this.ret){ret=this.eval(body.nodes);if(stack)this.stack.pop()}else{body=this.visit(body);if(stack)this.stack.pop();this.mixin(body.nodes,this.currentBlock);ret=nodes.nil}if(filename)this.paths.pop();return ret};Evaluator.prototype.mixin=function(nodes,block){if(!nodes.length)return;var len=block.nodes.length,head=block.nodes.slice(0,block.index),tail=block.nodes.slice(block.index+1,len);this._mixin(nodes,head,block);block.index=0;block.nodes=head.concat(tail)};Evaluator.prototype._mixin=function(items,dest,block){var node,len=items.length;for(var i=0;i<len;++i){switch((node=items[i]).nodeName){case\"return\":return;case\"block\":this._mixin(node.nodes,dest,block);break;case\"media\":var parentNode=node.block.parent.node;if(parentNode&&\"call\"!=parentNode.nodeName){node.block.parent=block}case\"property\":var val=node.expr;if(node.literal&&\"block\"==val.first.name){val=utils.unwrap(val);val.nodes[0]=new nodes.Literal(\"block\")}default:dest.push(node)}}};Evaluator.prototype.mixinNode=function(node){node=this.visit(node.first);switch(node.nodeName){case\"object\":this.mixinObject(node);return nodes.nil;case\"block\":case\"atblock\":this.mixin(node.nodes,this.currentBlock);return nodes.nil}};Evaluator.prototype.mixinObject=function(object){var Parser=require(\"../parser\"),root=this.root,str=\"$block \"+object.toBlock(),parser=new Parser(str,utils.merge({root:block},this.options)),block;try{block=parser.parse()}catch(err){err.filename=this.filename;err.lineno=parser.lexer.lineno;err.column=parser.lexer.column;err.input=str;throw err}block.parent=root;block.scope=false;var ret=this.visit(block),vals=ret.first.nodes;for(var i=0,len=vals.length;i<len;++i){if(vals[i].block){this.mixin(vals[i].block.nodes,this.currentBlock);break}}};Evaluator.prototype.eval=function(vals){if(!vals)return nodes.nil;var len=vals.length,node=nodes.nil;try{for(var i=0;i<len;++i){node=vals[i];switch(node.nodeName){case\"if\":if(\"block\"!=node.block.nodeName){node=this.visit(node);break}case\"each\":case\"block\":node=this.visit(node);if(node.nodes)node=this.eval(node.nodes);break;default:node=this.visit(node)}}}catch(err){if(\"return\"==err.nodeName){return err.expr}else{throw err}}return node};Evaluator.prototype.literalCall=function(call){call.args=this.visit(call.args);return call};Evaluator.prototype.lookupProperty=function(name){var i=this.stack.length,index=this.currentBlock.index,top=i,nodes,block,len,other;while(i--){block=this.stack[i].block;if(!block.node)continue;switch(block.node.nodeName){case\"group\":case\"function\":case\"if\":case\"each\":case\"atrule\":case\"media\":case\"atblock\":case\"call\":nodes=block.nodes;if(i+1==top){while(index--){if(this.property==nodes[index])continue;other=this.interpolate(nodes[index]);if(name==other)return nodes[index].clone()}}else{len=nodes.length;while(len--){if(\"property\"!=nodes[len].nodeName||this.property==nodes[len])continue;other=this.interpolate(nodes[len]);if(name==other)return nodes[len].clone()}}break}}return nodes.nil};Evaluator.prototype.__defineGetter__(\"closestBlock\",function(){var i=this.stack.length,block;while(i--){block=this.stack[i].block;if(block.node){switch(block.node.nodeName){case\"group\":case\"keyframes\":case\"atrule\":case\"atblock\":case\"media\":case\"call\":return block}}}});Evaluator.prototype.__defineGetter__(\"closestGroup\",function(){var i=this.stack.length,block;while(i--){block=this.stack[i].block;if(block.node&&\"group\"==block.node.nodeName){return block}}});Evaluator.prototype.__defineGetter__(\"selectorStack\",function(){var block,stack=[];for(var i=0,len=this.stack.length;i<len;++i){block=this.stack[i].block;if(block.node&&\"group\"==block.node.nodeName){block.node.nodes.forEach(function(selector){if(!selector.val)selector.val=this.interpolate(selector)},this);stack.push(block.node.nodes)}}return stack});Evaluator.prototype.lookup=function(name){var val;if(this.ignoreColors&&name in colors)return;if(val=this.stack.lookup(name)){return utils.unwrap(val)}else{return this.lookupFunction(name)}};Evaluator.prototype.interpolate=function(node){var self=this,isSelector=\"selector\"==node.nodeName;function toString(node){switch(node.nodeName){case\"function\":case\"ident\":return node.name;case\"literal\":case\"string\":if(self.prefix&&!node.prefixed&&!node.val.nodeName){node.val=node.val.replace(/\\./g,\".\"+self.prefix);node.prefixed=true}return node.val;case\"unit\":return\"%\"==node.type?node.val+\"%\":node.val;case\"member\":return toString(self.visit(node));case\"expression\":if(self.calling&&~self.calling.indexOf(\"selector\")&&self._selector)return self._selector;self.ret++;var ret=toString(self.visit(node).first);self.ret--;if(isSelector)self._selector=ret;return ret}}if(node.segments){return node.segments.map(toString).join(\"\")}else{return toString(node)}};Evaluator.prototype.lookupFunction=function(name){var fn=this.functions[name]||bifs[name];if(fn)return new nodes.Function(name,fn)};Evaluator.prototype.isDefined=function(node){if(\"ident\"==node.nodeName){return nodes.Boolean(this.lookup(node.name))}else{throw new Error('invalid \"is defined\" check on non-variable '+node)}};Evaluator.prototype.propertyExpression=function(prop,name){var expr=new nodes.Expression,val=prop.expr.clone();expr.push(new nodes.String(prop.name));function replace(node){if(\"call\"==node.nodeName&&name==node.name){return new nodes.Literal(\"__CALL__\")}if(node.nodes)node.nodes=node.nodes.map(replace);return node}replace(val);expr.push(val);return expr};Evaluator.prototype.cast=function(expr){return new nodes.Unit(expr.first.val,expr.nodes[1].name)};Evaluator.prototype.castable=function(expr){return 2==expr.nodes.length&&\"unit\"==expr.first.nodeName&&~units.indexOf(expr.nodes[1].name)};Evaluator.prototype.warn=function(msg){if(!this.warnings)return;console.warn(\"\u001b[33mWarning:\u001b[0m \"+msg)};Evaluator.prototype.__defineGetter__(\"currentBlock\",function(){return this.stack.currentFrame.block});Evaluator.prototype.__defineGetter__(\"vendors\",function(){return this.lookup(\"vendors\").nodes.map(function(node){return node.string})});Evaluator.prototype.unvendorize=function(prop){for(var i=0,len=this.vendors.length;i<len;i++){if(\"official\"!=this.vendors[i]){var vendor=\"-\"+this.vendors[i]+\"-\";if(~prop.indexOf(vendor))return prop.replace(vendor,\"\")}}return prop};Evaluator.prototype.__defineGetter__(\"currentScope\",function(){return this.stack.currentFrame.scope});Evaluator.prototype.__defineGetter__(\"currentFrame\",function(){return this.stack.currentFrame})});require.register(\"visitor/normalizer.js\",function(module,exports,require){var Visitor=require(\"./index\"),nodes=require(\"../nodes/index\"),utils=require(\"../utils\");var Normalizer=module.exports=function Normalizer(root,options){options=options||{};Visitor.call(this,root);this.hoist=options[\"hoist atrules\"];this.stack=[];this.map={};this.imports=[]};Normalizer.prototype.__proto__=Visitor.prototype;Normalizer.prototype.normalize=function(){var ret=this.visit(this.root);if(this.hoist){if(this.imports.length)ret.nodes=this.imports.concat(ret.nodes);if(this.charset)ret.nodes=[this.charset].concat(ret.nodes)}return ret};Normalizer.prototype.bubble=function(node){var props=[],other=[],self=this;function filterProps(block){block.nodes.forEach(function(node){node=self.visit(node);switch(node.nodeName){case\"property\":props.push(node);break;case\"block\":filterProps(node);break;default:other.push(node)}})}filterProps(node.block);if(props.length){var selector=new nodes.Selector([new nodes.Literal(\"&\")]);selector.lineno=node.lineno;selector.column=node.column;selector.filename=node.filename;selector.val=\"&\";var group=new nodes.Group;group.lineno=node.lineno;group.column=node.column;group.filename=node.filename;var block=new nodes.Block(node.block,group);block.lineno=node.lineno;block.column=node.column;block.filename=node.filename;props.forEach(function(prop){block.push(prop)});group.push(selector);group.block=block;node.block.nodes=[];node.block.push(group);other.forEach(function(n){node.block.push(n)});var group=this.closestGroup(node.block);if(group)node.group=group.clone();node.bubbled=true}};Normalizer.prototype.closestGroup=function(block){var parent=block.parent,node;while(parent&&(node=parent.node)){if(\"group\"==node.nodeName)return node;parent=node.block&&node.block.parent}};Normalizer.prototype.visitRoot=function(block){var ret=new nodes.Root,node;for(var i=0;i<block.nodes.length;++i){node=block.nodes[i];switch(node.nodeName){case\"null\":case\"expression\":case\"function\":case\"unit\":case\"atblock\":continue;default:this.rootIndex=i;ret.push(this.visit(node))}}return ret};Normalizer.prototype.visitProperty=function(prop){this.visit(prop.expr);return prop};Normalizer.prototype.visitExpression=function(expr){expr.nodes=expr.nodes.map(function(node){if(\"block\"==node.nodeName){var literal=new nodes.Literal(\"block\");literal.lineno=expr.lineno;literal.column=expr.column;return literal}return node});return expr};Normalizer.prototype.visitBlock=function(block){var node;if(block.hasProperties){for(var i=0,len=block.nodes.length;i<len;++i){node=block.nodes[i];switch(node.nodeName){case\"null\":case\"expression\":case\"function\":case\"group\":case\"unit\":case\"atblock\":continue;default:block.nodes[i]=this.visit(node)}}}for(var i=0,len=block.nodes.length;i<len;++i){node=block.nodes[i];block.nodes[i]=this.visit(node)}return block};Normalizer.prototype.visitGroup=function(group){var stack=this.stack,map=this.map,parts;group.nodes.forEach(function(selector,i){if(!~selector.val.indexOf(\",\"))return;if(~selector.val.indexOf(\"\\\\,\")){selector.val=selector.val.replace(/\\\\,/g,\",\");return}parts=selector.val.split(\",\");var root=\"/\"==selector.val.charAt(0),part,s;for(var k=0,len=parts.length;k<len;++k){part=parts[k].trim();if(root&&k>0&&!~part.indexOf(\"&\")){part=\"/\"+part}s=new nodes.Selector([new nodes.Literal(part)]);s.val=part;s.block=group.block;group.nodes[i++]=s}});stack.push(group.nodes);var selectors=utils.compileSelectors(stack,true);selectors.forEach(function(selector){map[selector]=map[selector]||[];map[selector].push(group)});this.extend(group,selectors);stack.pop();return group};Normalizer.prototype.visitFunction=function(){return nodes.nil};Normalizer.prototype.visitMedia=function(media){var medias=[],group=this.closestGroup(media.block),parent;function mergeQueries(block){block.nodes.forEach(function(node,i){switch(node.nodeName){case\"media\":node.val=media.val.merge(node.val);medias.push(node);block.nodes[i]=nodes.nil;break;case\"block\":mergeQueries(node);break;default:if(node.block&&node.block.nodes)mergeQueries(node.block)}})}mergeQueries(media.block);this.bubble(media);if(medias.length){medias.forEach(function(node){if(group){group.block.push(node)}else{this.root.nodes.splice(++this.rootIndex,0,node)}node=this.visit(node);parent=node.block.parent;if(node.bubbled&&(!group||\"group\"==parent.node.nodeName)){node.group.block=node.block.nodes[0].block;node.block.nodes[0]=node.group}},this)}return media};Normalizer.prototype.visitSupports=function(node){this.bubble(node);return node};Normalizer.prototype.visitAtrule=function(node){if(node.block)node.block=this.visit(node.block);return node};Normalizer.prototype.visitKeyframes=function(node){var frames=node.block.nodes.filter(function(frame){return frame.block&&frame.block.hasProperties});node.frames=frames.length;return node};Normalizer.prototype.visitImport=function(node){this.imports.push(node);return this.hoist?nodes.nil:node};Normalizer.prototype.visitCharset=function(node){this.charset=node;return this.hoist?nodes.nil:node};Normalizer.prototype.extend=function(group,selectors){var map=this.map,self=this,parent=this.closestGroup(group.block);group.extends.forEach(function(extend){var groups=map[extend.selector];if(!groups){if(extend.optional)return;var err=new Error('Failed to @extend \"'+extend.selector+'\"');err.lineno=extend.lineno;err.column=extend.column;throw err}selectors.forEach(function(selector){var node=new nodes.Selector;node.val=selector;node.inherits=false;groups.forEach(function(group){if(!parent||parent!=group)self.extend(group,selectors);group.push(node)})})});group.block=this.visit(group.block)}});return require(\"stylus\")}();\n",
      "type": "blob"
    },
    "lib/system-client": {
      "path": "lib/system-client",
      "content": "(function() {\n  var __slice = [].slice;\n\n  (function() {\n    var Postmaster, UI, applicationProxy, postmaster, style, systemProxy;\n    Postmaster = require(\"_SYS_postmaster\");\n    UI = require(\"_SYS_ui\");\n    style = document.createElement(\"style\");\n    style.innerHTML = UI.Style.all;\n    document.head.appendChild(style);\n    postmaster = Postmaster();\n    applicationProxy = new Proxy({\n      ready: function() {\n        return postmaster.invokeRemote(\"childLoaded\");\n      }\n    }, {\n      get: function(target, property, receiver) {\n        return target[property] || function() {\n          return postmaster.invokeRemote.apply(postmaster, [\"application\", property].concat(__slice.call(arguments)));\n        };\n      }\n    });\n    document.addEventListener(\"mousedown\", function() {\n      return applicationProxy.raiseToTop();\n    });\n    systemProxy = new Proxy({\n      Observable: UI.Observable,\n      UI: UI\n    }, {\n      get: function(target, property, receiver) {\n        return target[property] || function() {\n          return postmaster.invokeRemote.apply(postmaster, [\"system\", property].concat(__slice.call(arguments)));\n        };\n      }\n    });\n    window.system = systemProxy;\n    window.application = applicationProxy;\n    return window.postmaster = postmaster;\n  })();\n\n}).call(this);\n",
      "type": "blob"
    },
    "mailchimp": {
      "path": "mailchimp",
      "content": "(function() {\n  document.head.insertAdjacentHTML(\"beforeend\", \"<link href=\\\"https://cdn-images.mailchimp.com/embedcode/classic-10_7.css\\\" rel=\\\"stylesheet\\\" type=\\\"text/css\\\">\\n<style type=\\\"text/css\\\">\\n\t#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }\\n</style>\");\n\n  module.exports = {\n    show: function() {\n      var div;\n      div = document.createElement(\"div\");\n      div.innerHTML = \"<div id=\\\"mc_embed_signup\\\">\\n<form action=\\\"//space.us14.list-manage.com/subscribe/post?u=8946c32e9db504ccc083d3fc7&amp;id=b8b708aea6\\\" method=\\\"post\\\" id=\\\"mc-embedded-subscribe-form\\\" name=\\\"mc-embedded-subscribe-form\\\" class=\\\"validate\\\" target=\\\"_blank\\\" novalidate>\\n    <div id=\\\"mc_embed_signup_scroll\\\">\\n\\n<div class=\\\"mc-field-group\\\">\\n\t<label for=\\\"mce-EMAIL\\\">Email Address </label>\\n\t<input type=\\\"email\\\" value=\\\"\\\" name=\\\"EMAIL\\\" class=\\\"required email\\\" id=\\\"mce-EMAIL\\\">\\n</div>\\n\t<div id=\\\"mce-responses\\\" class=\\\"clear\\\">\\n\t\t<div class=\\\"response\\\" id=\\\"mce-error-response\\\" style=\\\"display:none\\\"></div>\\n\t\t<div class=\\\"response\\\" id=\\\"mce-success-response\\\" style=\\\"display:none\\\"></div>\\n\t</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->\\n    <div style=\\\"position: absolute; left: -5000px;\\\" aria-hidden=\\\"true\\\"><input type=\\\"text\\\" name=\\\"b_8946c32e9db504ccc083d3fc7_b8b708aea6\\\" tabindex=\\\"-1\\\" value=\\\"\\\"></div>\\n    <div class=\\\"clear\\\"><input type=\\\"submit\\\" value=\\\"Subscribe\\\" name=\\\"subscribe\\\" id=\\\"mc-embedded-subscribe\\\" class=\\\"button\\\"></div>\\n    </div>\\n</form>\\n</div>\";\n      return system.UI.Modal.show(div);\n    }\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "main": {
      "path": "main",
      "content": "(function() {\n  var Explorer, HomeButton, SiteURLTemplate, Style, System, VersionTemplate, endDrag, style;\n\n  require(\"analytics\").init(\"UA-3464282-16\");\n\n  require(\"./extensions\");\n\n  require(\"./lib/outbound-clicks\");\n\n  require(\"./lib/error-reporter\");\n\n  global.Jadelet = require(\"./lib/jadelet.min\");\n\n  System = require(\"./system\");\n\n  global.system = System();\n\n  system.PACKAGE = PACKAGE;\n\n  Style = system.UI.Style;\n\n  style = document.createElement(\"style\");\n\n  style.innerHTML = Style.all + \"\\n\" + require(\"./style\");\n\n  document.head.appendChild(style);\n\n  document.addEventListener(\"dragstart\", function() {\n    return document.body.classList.add(\"drag-active\");\n  });\n\n  endDrag = function() {\n    return document.body.classList.remove(\"drag-active\");\n  };\n\n  document.addEventListener(\"mouseup\", endDrag);\n\n  document.addEventListener(\"dragend\", endDrag);\n\n  Explorer = require(\"./apps/explorer\");\n\n  document.body.appendChild(Explorer());\n\n  VersionTemplate = require(\"./templates/version\");\n\n  document.body.appendChild(VersionTemplate({\n    version: system.version\n  }));\n\n  SiteURLTemplate = require(\"./templates/site-url\");\n\n  document.body.appendChild(SiteURLTemplate());\n\n  HomeButton = require(\"./presenters/home-button\");\n\n  document.body.appendChild(HomeButton());\n\n  system.writeFile(\"feedback.exe\", new Blob([\"\"], {\n    type: \"application/exe\"\n  }));\n\n  system.writeFile(\"My Briefcase\", new Blob([\"\"], {\n    type: \"application/briefcase\"\n  }));\n\n  system.autoboot();\n\n  system.initAppSettings();\n\n  (function() {\n    return system.removeApp(\"Test\");\n  });\n\n  (function() {\n    return system.installApp({\n      name: \"Test\",\n      src: \"https://fs.whimsy.space/us-east-1:90fe8dfb-e9d2-45c7-a347-cf840a3e757f/public/test2/index.html\",\n      launchAtStartup: true,\n      width: 100,\n      height: 100,\n      icon: \"T\",\n      associations: {\n        type: [],\n        extension: [\"test\"]\n      }\n    });\n  });\n\n  require(\"./issues/2017-06\")();\n\n}).call(this);\n",
      "type": "blob"
    },
    "os/file-io": {
      "path": "os/file-io",
      "content": "(function() {\n  module.exports = function(I, self) {\n    var Modal, Observable, confirmUnsaved, currentPath, saved;\n    Observable = system.Observable;\n    Modal = system.UI.Modal;\n    currentPath = Observable(\"\");\n    saved = Observable(true);\n    confirmUnsaved = function() {\n      if (saved()) {\n        return Promise.resolve();\n      }\n      return new Promise(function(resolve, reject) {\n        return Modal.confirm(\"You will lose unsaved progress, continue?\").then(function(result) {\n          if (result) {\n            return resolve();\n          } else {\n            return reject();\n          }\n        });\n      });\n    };\n    self.extend({\n      currentPath: currentPath,\n      saved: saved,\n      \"new\": function() {\n        if (saved()) {\n          currentPath(\"\");\n          return self.newFile();\n        } else {\n          return confirmUnsaved().then(function() {\n            saved(true);\n            return self.newFile();\n          });\n        }\n      },\n      open: function() {\n        return confirmUnsaved().then(function() {\n          return Modal.prompt(\"File Path\", currentPath()).then(function(newPath) {\n            if (newPath) {\n              return currentPath(newPath);\n            } else {\n              throw new Error(\"No path given\");\n            }\n          }).then(function(path) {\n            return system.readFile(path, true);\n          }).then(function(file) {\n            return self.loadFile(file);\n          });\n        });\n      },\n      save: function() {\n        if (currentPath()) {\n          return self.saveData().then(function(blob) {\n            return system.writeFile(currentPath(), blob, true);\n          }).then(function() {\n            saved(true);\n            return currentPath();\n          });\n        } else {\n          return self.saveAs();\n        }\n      },\n      saveAs: function() {\n        return Modal.prompt(\"File Path\", currentPath()).then(function(path) {\n          if (path) {\n            currentPath(path);\n            return self.save();\n          }\n        });\n      }\n    });\n    return self;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "pixie": {
      "path": "pixie",
      "content": "module.exports = {\"title\":\"Whimsy Space - ZineOS v0.420.950a ⌊ALPHA⌉\",\"version\":\"0.420.950a\",\"description\":\"When the bombs drop, and it's OS against OS, you're gonna wish you could view source\",\"dependencies\":{\"ajax\":\"distri/ajax:master\",\"analytics\":\"distri/google-analytics:master\",\"base64\":\"distri/base64:v0.9.2\",\"bindable\":\"distri/bindable:master\",\"model\":\"distri/model:master\",\"postmaster\":\"distri/postmaster:v0.5.3\",\"ui\":\"STRd6/ui:master\"},\"remoteDependencies\":[\"https://cdnjs.cloudflare.com/ajax/libs/dexie/2.0.0-beta.7/dexie.min.js\",\"https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ace.js\",\"https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ext-language_tools.js\",\"https://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.7.1/coffee-script.min.js\",\"https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js\",\"https://sdk.amazonaws.com/js/aws-sdk-2.7.20.min.js\",\"https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js\"]};",
      "type": "blob"
    },
    "presenters/achievement-group-progress": {
      "path": "presenters/achievement-group-progress",
      "content": "(function() {\n  var AchievementBadgeTemplate, ProgressTemplate;\n\n  AchievementBadgeTemplate = require(\"../templates/achievement-badge\");\n\n  ProgressTemplate = require(\"../templates/achievement-progress\");\n\n  module.exports = function(_arg) {\n    var achieved, achievements, name, total, value;\n    name = _arg.name, achievements = _arg.achievements;\n    achieved = achievements.filter(function(_arg1) {\n      var achieved;\n      achieved = _arg1.achieved;\n      return achieved;\n    }).length;\n    total = achievements.length;\n    value = achieved / total;\n    return ProgressTemplate({\n      name: name,\n      achievements: achievements,\n      badges: achievements.map(function(cheevo) {\n        return AchievementBadgeTemplate(Object.assign({}, cheevo, {\n          \"class\": function() {\n            if (cheevo.achieved) {\n              return \"achieved\";\n            }\n          }\n        }));\n      }),\n      fraction: \"\" + achieved + \"/\" + total,\n      value: value.toString()\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "presenters/home-button": {
      "path": "presenters/home-button",
      "content": "(function() {\n  var AceEditor, AchievementStatus, Chateau, Contrasaurus, DungeonOfSadness, HomeButtonTemplate, MyBriefcase, PixiePaint, Spreadsheet;\n\n  AceEditor = require(\"../apps/text-editor\");\n\n  AchievementStatus = require(\"../apps/achievement-status\");\n\n  Chateau = require(\"../apps/chateau\");\n\n  Contrasaurus = require(\"../apps/contrasaurus\");\n\n  DungeonOfSadness = require(\"../apps/dungeon-of-sadness\");\n\n  PixiePaint = require(\"../apps/pixel\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  MyBriefcase = require(\"../apps/my-briefcase\");\n\n  HomeButtonTemplate = require(\"../templates/home-button\");\n\n  module.exports = function() {\n    var Achievement, ContextMenu, contextMenu, element, launch, parseMenu, updateStyle, _ref, _ref1;\n    Achievement = system.Achievement;\n    _ref = system.UI, ContextMenu = _ref.ContextMenu, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu);\n    launch = function(App) {\n      var app;\n      app = App();\n      return system.attachApplication(app);\n    };\n    contextMenu = ContextMenu({\n      items: parseMenu(\"🔨 [A]pplications\\n  📝 [A]ce Editor\\n  🍷 [C]hateau\\n  🎨 [P]ixie Paint\\n🎮 [G]ames\\n  🌭 [B]ionic Hotdog\\n  🍖 [C]ontrasaurus\\n  😭 [D]ungeon Of Sadness\\n📰 [I]ssues\\n  1️⃣ [F]irst\\n  🏰 [E]nter The Dungeon\\n  🏬 [A]TTN: K-Mart Shoppers\\n  💃 [D]isco Tech\\n  🌻 [A] May Zine\\n⚙️ [S]ettings\\n  📱 [A]ppearance\\n  💯 [C]heevos\\n💼 [M]y Briefcase\\n-\\n🔌 S[h]ut Down\"),\n      handlers: {\n        aceEditor: function() {\n          return launch(AceEditor);\n        },\n        aMayZine: function() {\n          return system.launchIssue(\"2017-05\");\n        },\n        appearance: function() {\n          return system.UI.Modal.alert(\"TODO :)\");\n        },\n        aTTNKMartShoppers: function() {\n          return system.launchIssue(\"2017-03\");\n        },\n        bionicHotdog: function() {\n          return Promise.resolve({\n            src: \"https://danielx.net/grappl3r/\",\n            width: 960,\n            height: 540,\n            iconEmoji: \"🌭\",\n            title: \"Bionic Hotdog\"\n          }).then(system.iframeApp).then(system.attachApplication);\n        },\n        chateau: function() {\n          return launch(Chateau);\n        },\n        cheevos: function() {\n          return launch(AchievementStatus);\n        },\n        contrasaurus: function() {\n          return launch(Contrasaurus);\n        },\n        discoTech: function() {\n          return system.launchIssue(\"2017-04\");\n        },\n        dungeonOfSadness: function() {\n          return launch(DungeonOfSadness);\n        },\n        enterTheDungeon: function() {\n          return system.launchIssue(\"2017-02\");\n        },\n        \"1First\": function() {\n          return system.launchIssue(\"2016-12\");\n        },\n        myBriefcase: function() {\n          return launch(MyBriefcase);\n        },\n        pixiePaint: function() {\n          return launch(PixiePaint);\n        },\n        shutDown: function() {\n          Achievement.unlock(\"Shut Down\");\n          return system.UI.Modal.alert(\"You'll never shut us down! ZineOS 5ever!\");\n        }\n      }\n    });\n    updateStyle = function(contextMenu) {\n      var height;\n      height = element.getBoundingClientRect().height;\n      contextMenu.element.style.fontSize = \"1.5rem\";\n      contextMenu.element.style.lineHeight = \"1.5\";\n      contextMenu.element.style.bottom = \"\" + height + \"px\";\n      return contextMenu.element.style.textAlign = \"left\";\n    };\n    element = HomeButtonTemplate({\n      click: function() {\n        contextMenu.display({\n          inElement: document.body\n        });\n        return updateStyle(contextMenu);\n      }\n    });\n    return element;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "social/comment-form": {
      "path": "social/comment-form",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"form\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"h1\", this, {}, function(__root) {\n        __root.buffer(\"Comment\\n\");\n      }));\n      __root.buffer(__root.element(\"label\", this, {}, function(__root) {\n        __root.buffer(__root.element(\"h3\", this, {}, function(__root) {\n          __root.buffer(\"Author\\n\");\n        }));\n        __root.buffer(__root.element(\"input\", this, {\n          \"name\": \"author\",\n          \"value\": \"Anon\"\n        }, function(__root) {}));\n      }));\n      __root.buffer(__root.element(\"label\", this, {}, function(__root) {\n        __root.buffer(__root.element(\"h3\", this, {}, function(__root) {\n          __root.buffer(\"Body\\n\");\n        }));\n        __root.buffer(__root.element(\"textarea\", this, {\n          \"name\": \"body\"\n        }, function(__root) {}));\n      }));\n      __root.buffer(__root.element(\"input\", this, {\n        \"type\": \"hidden\",\n        \"name\": \"area\",\n        \"value\": this.area\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"button\", this, {}, function(__root) {\n        __root.buffer(\"Submit\\n\");\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "social/comments": {
      "path": "social/comments",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"comments\", this, {}, function(__root) {\n      this.forEach(function(comment) {\n        return __root.buffer(__root.element(\"comment\", this, {}, function(__root) {\n          __root.buffer(__root.element(\"div\", this, {}, function(__root) {\n            __root.buffer(comment.body);\n          }));\n          __root.buffer(__root.element(\"div\", this, {\n            \"class\": [\"author\"]\n          }, function(__root) {\n            __root.buffer(comment.author);\n          }));\n        }));\n      });\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "social/social": {
      "path": "social/social",
      "content": "(function() {\n  var Ajax, CommentFormTemplate, CommentsTemplate, ajax;\n\n  CommentFormTemplate = require(\"../social/comment-form\");\n\n  CommentsTemplate = require(\"../social/comments\");\n\n  Ajax = require(\"ajax\");\n\n  ajax = Ajax();\n\n  module.exports = function(I, self) {\n    var Modal;\n    Modal = system.UI.Modal;\n    return self.extend({\n      comment: function() {\n        return Modal.form(CommentFormTemplate({\n          area: self.area()\n        })).then(function(data) {\n          return ajax({\n            url: \"https://whimsy-space.glitch.me/comments\",\n            data: JSON.stringify(data),\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            method: \"POST\"\n          });\n        }).then(function() {\n          return self.viewComments();\n        });\n      },\n      viewComments: function() {\n        return ajax.getJSON(\"https://whimsy-space.glitch.me/comments/\" + (self.area())).then(function(data) {\n          data = data.reverse();\n          if (data.length === 0) {\n            data = [\n              {\n                body: \"no comments\",\n                author: \"mgmt\"\n              }\n            ];\n          }\n          return Modal.show(CommentsTemplate(data));\n        });\n      },\n      like: function() {\n        system.Achievement.unlock(\"Do you 'like' like me?\");\n        return window.open(\"https://www.facebook.com/whimsyspace/\");\n      },\n      subscribe: function() {\n        return require(\"../mailchimp\").show();\n      }\n    });\n  };\n\n  module.exports.menuText = \"S[o]cial Media\\n  [V]iew Comments\\n  [C]omment\\n  [L]ike\\n  [S]ubscribe\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/around-the-world": {
      "path": "stories/around-the-world",
      "content": "(function() {\n  module.exports = \"# Around the World in 20 Years and a Weekend\\n\\nThe history of human progress is rife with us entering things. [Tombs](https://en.wikipedia.org/wiki/Raiders_of_the_Lost_Ark), [dragons](https://en.wikipedia.org/wiki/Enter_the_Dragon), [voids](https://en.wikipedia.org/wiki/Enter_the_Void), even [gungeons](http://dodgeroll.com/gungeon/).\\n\\n\\nBut have you ever stopped to think about what fuels this endless urge to ingress? Rather fearlessly, I decided to find out.\\n\\n![sensuous nights](https://frog-feels.s3.amazonaws.com/2016-52/391848cb-afa1-4149-b2be-054d6d86b540.png)\\n\\nIt's now 20 years later. I've waded through the jungles of the Amazon, skied the slopes of Norway, swam the Ganges, and braved long lines. I've lost a lot too. The years have aged me dramatically - I'm a hot mess. And I lost my phone a month ago, so my friends and family are dead to me now.\\n\\nHere's what I've learned on my journey,\\n\\n![lederhosen leroy](https://frog-feels.s3.amazonaws.com/2016-30/57b1f586-4f32-4cd5-8aea-d1a7c9400964.png)\\n\\nThe Freudian says we want to go in things for obvious sex reasons. Freudian? More like ‘Fraud’-ian, right? Har har.\\n\\n![horse confessional](https://frog-feels.s3.amazonaws.com/2016-27/75889dde-ba0c-434e-b5dd-1edda7daa97e.png)\\n\\nMy Peyote spirit animal is a horse. Under the desert sky he whispers in my ear that what we really want is to enter the stable of the mind. I'm not so sure though. I don't even really like normal earthly stables.\\n\\n![soup boy](https://frog-feels.s3.amazonaws.com/2016-32/821e8ec3-e55d-4388-8cdd-6da58d902924.png)\\n\\nAfter the peyote trip, things get a little fuzzy. I stumbled into a place. It was either a diner, a drive-in, or a dive. There I met TV food guy Guy Fieri. Between mouthfuls of cheese and enthusiasm, he proclaimed that we enter so that we may exit.\\n\\n“We’re all searching for something that’s everything we imagine it to be.”\\n\\n...\\n\\nIf I'm honest, this odyssey only really took a weekend. After that I didn't really feel like going back to work, so I just hung out for a while.\\n\\n![you are great](https://frog-feels.s3.amazonaws.com/2016-50/2d44fdcd-05b9-4a92-a954-ec1235ee7b1e.png)\\n\\n\\n[🐸 cool art made by cool people at [Frog Feels](http://frogfeels.com)]\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/blue-light-special": {
      "path": "stories/blue-light-special",
      "content": "(function() {\n  module.exports = \"Blue Light Special\\n\\n“You know, I really want some cookies.” Elo said. She sat on a cushion on top of a tarp spread on the ground in front of their small campfire and whittled a piece of wood, periodically tossing the shavings into the fire. The warm glow bathed her deft fingers, tired face, and honey-colored hair with a soft light, and faintly illuminated the oak trees around them in the pressing darkness.\\n\\n“We can break camp tomorrow, move on, and see what we can find on the way,” Jib replied, as he munched some popcorn and scratched his dark beard. He scooted his log seat closer to the fire and buttoned his shearling jacket to keep out the fine mist rolling in among the trees.\\n\\n“I don’t want to break camp,” Elo protested. “I like it here. We should stay a while. I just want to have some cookies.” She looked around their camp: at Jib on his stump; at Poli beside her on the tarp, seated on her own cushion; at their reliable and well-used tent; at the horses draped with their blankets; at the clean dishes drying fireside. This was a good place. She rubbed her ever-growing abdomen. The tiny person ensconced within dragged a heel over her insides in response.\\n\\n“Okay, we won’t break camp, then. We can just go to town tomorrow. We need some other supplies anyway.” Jib raised his lanky body to pass the popcorn to Poli, who took the enameled bowl and placed it between her and Elo.\\n\\nPoli offered the popcorn to Elo. “Here, have some popcorn. That will help take your mind off the craving.”\\n\\nElo knitted her brows. “No, it won’t. It’s not the same and you know it.”\\n\\n“Yeah, okay. I know. It’s not. But it’s what we have,” Poli smiled gently, hoping to diffuse the situation.\\n\\n“Why can’t you just go get some now? We didn’t camp that far from town, and it’s not that late,” Elo pleaded.\\n\\n“Because it’s going to rain soon, and because I’m tired, and because we decide things together, not based on whim,” Jib retorted grumpily.\\n\\n“Pleeeeeease! I really, really want them. I’m tired too and my back hurts from hauling this baby around and I just want to have some cookies. Is that too much to ask?” Elo burst into tears.\\n\\n“Elo, please don’t cry.” Poli’s red curls bounced as she snapped her head up to glare at Jib. She enfolded Elo in a hug, and Elo sobbed harder on the petite woman’s shoulder.\\n\\n“Poli, come on,” Jib sighed. “Get Elo settled in the tent and you and I will go tonight. Let’s get moving so we’re not caught in too much rain on the way back.”\\n\\n**\\n\\nGabe sat on a cold concrete bench at a cold, round, concrete table, eating cold pizza under a murky and unforgiving sky in which clouds entirely obscured the stars, and in which mist threatened to give way to outright rain. He reflected miserably that of all the ways to eat pizza, this was probably the second-worst. The worst would be back in the break room with the other Kmart employees, where they would have excited yet hushed conversations that did not include him, the night manager.\\n\\nThe table he was sitting at had recently had a fiberglass umbrella to provide meager protection against the elements. Last week, however, seven drunk teenagers had removed it to use as a boat in a very large puddle at the back of the parking lot and it had not been seen since. The sky began to spit at him, and he thought, “At least the sky is doing what they’re all thinking.”\\n\\nGabe looked up the nearly deserted road and noticed two large figures with an odd gait. They resolved into a tall, bearded man and a petite, redheaded woman, each on horseback, emerging from the mist and entering the Kmart parking lot. Amused, Gabe wondered whether the pair might tie their horses up to the bike racks, or find a parking space near a lamp post and hitch them there, or tether them to a tree.\\n\\nThe man and woman did none of these things. They simply rode the horses through the automatic doors and into the Kmart. Gabe took a moment to process this. He started to get up, looked at his phone, noticed ten minutes remained of his break, and sat back down.\\n\\n**\\n\\nPoli dismounted inside the doors and hitched up a shopping cart to her horse. She nimbly saddled up again, and she and Jib then began perusing the aisles of the Kmart and checking the items off their list.\\n\\n“Sir? Miss? Can I help you?” an employee demanded tersely, body language suggesting the only help would be toward an exit.\\n\\n“Yes, thank you. We are looking for cookies such as would satisfy a pregnancy craving,” Jib replied. He placed some batteries in their cart.\\n\\n“Cookies? Aisle 12A,” the employee responded automatically, then shook her head.  “The horses. You can’t have them in here. You’ll have to take them outside.” The employee was joined by two others, all of them looking simultaneously stern and bewildered.\\n\\nThey reached the aisle’s endcap. “Ooh, look, nut mixes are on sale,” Poli grinned.\\n\\n“Go ahead and get a few,” Jib called to her as he rode ahead to select some prenatal vitamins and toothpaste.\\n\\n“Miss, please. The two of you need to take the horses outside,” the employee wheedled.  As if to respond, Poli’s horse lifted its tail and dropped a steaming load near the employee’s boot. The employee leapt back, dismayed.\\n\\n“Oh, no, I’m afraid that won’t be possible. These are our service animals,” Poli chirped sweetly.\\n\\nThe employees huddled together. “Where’s Gabe?” they worried. They barked into walkie-talkies to Gabe to come over here RIGHT NOW and received no response.\\n\\nPoli caught up with Jib and together they loaded dry beans and rice into the cart. Suddenly, a voice spoke, as if from the heavens, and a flashing blue light punctuated the announcement:\\n\\n“Attention, Kmart shoppers! Blue light special on Aisle 12A. Tedwich Sandwich Cookies, buy two, get one free!”\\n\\n“We have to get those for Elo. I bet they’ll be perfect!” Poli shouted to Jib, and she urged her horse forward. Jib rode after her, followed by the three ineffectual employees, and an ever-growing crowd of onlookers.\\n\\nAisle 12A displayed an alarming variety of cookies, snack cakes, and other treats, and Poli and Jib were, for the first time, ill at ease in the Kmart. A small girl with braids and cutoff jeans approached them.\\n\\n“Here you go,” she smiled shyly, handing up a box. \\n\\n“Thank you,” Jib smiled back. He tore into the box and passed a handful of the Tedwich cookies to Poli. They sampled the miniature bear-shaped cinnamon cookies sandwiching a vanilla cream filling. They were, indeed, exactly what Elo would love.\\n\\n“Can you help us load our cart with every box there is?” Poli asked.\\n\\n“Not every box. I want to have three for myself,” the girl quickly replied.\\n\\n“Done.”\\n\\nWith all but three boxes of Tedwich cookies in their cart, the only thing left was to find some ice cream to go with them. This expedition caused no small amount of chaos in the freezer case aisle when a small, yappy dog in a handbag spooked the horses, which in turn sent the crowd scattering in all directions. Fortunately, it also resulted in Jib’s horse being perfectly positioned in front of a case containing pint after pint of ice cream. They selected one of chocolate and one of vanilla, and Jib and Poli rode to the checkout.\\n\\nPoli pulled a small wooden box from her canvas messenger bag and handed it down to the cashier. “This is a very rare and ancient turtle, carved from an unknown precious stone to bring the bearer untold riches. It is more than enough payment for these goods in our cart.”\\n\\nPoli and Jib rode out of the store, cart still in tow, as Gabe came back in. The two riders disappeared into the night.\\n\\nThe employees surrounded him. Gabe said nothing. He strolled through the store, surveying the relative lack of damage, the confused shoppers, and the piles of manure, and he grinned as he reached for his walkie-talkie.\\n\\n“Cleanup on Aisles 6, 7, 10, and 12. Better get a shovel.”\\n\\n**\\n\\nElo drifted to sleep that night, completely content, filled with cookies and ice cream. She dreamed of a girl with braids and cutoff jeans, holding boxes and boxes of Tedwich cookies stacked higher than she was tall. She flew above the girl as a deep blue light bathed them both.\\n\\n“What is your name?” Elo asked.\\n\\n“Theodosia,” the girl answered. The girl flew up to meet Elo and they soared effortlessly through the ceiling and out into the mist.\\n\\nThree months later, in the middle of another rainy night, Elo gave birth to a baby girl. The child was dusted with cinnamon freckles and looked up at Elo with the bluest eyes she had ever seen. She named the girl Theodosia.\\n\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/crescent": {
      "path": "stories/crescent",
      "content": "(function() {\n  module.exports = \"“Look, Mom, I made a moon!”\\nShe holds aloft a crescent bitten from cereal,\\nand I feel a tug on my memory:\\nnot the usual familiarity\\nof the Earth’s twirling, ever-changing little sister\\nbut something deeper, and more intimate,\\nlike a great truth,\\na resonance of great importance,\\nhad been uncovered within my mind as I slept,\\nand was lost upon waking.\\nAnd then she ate the moon.\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/dungeon-dog": {
      "path": "stories/dungeon-dog",
      "content": "(function() {\n  module.exports = \"Dungeon Crawl with Cliffford!\\n\\nOne sunny day, Cliffford the big rad dog was playing at the park with his friends U-Bone and Cloe. They chased each other through the playground, around the play structures, and through the sand. Children squealed with delight to see Cliffford jump right over the swing set in his excitement. “He’s so big! He can jump over things! Heehee!” they giggled. THUMP! went Cliffford’s paws as he landed on the grassy field, and Cloe and U-Bone followed right behind.\\n\\nThe dogs dashed through a soccer game, U-Bone stopping to bite at the ball, and Cleo weaving her way through at least four players’ legs. They emerged on the other side of the field at the northernmost edge of the park, where the well-kept field gave way to a little meadow, and then the woods.\\n\\nCliffford flopped down in a shady spot, and Cloe and U-Bone stood panting next to him. Cool breezes blew in from the ocean, rippling the leaves on the trees and the long meadow-grass.\\n\\n“What do you guys want to do now?” Cliffford asked. “I could really go for a nap.”\\n“Yeah, a nap sounds good,” U-Bone replied, snuggling up beside him.\\n“We could nap, but what about going back and trying to get that Frisbee over there?” Cloe asked.\\n“Mmphuhuhmph,” U-Bone answered, already half-asleep.\\n“All right, fine,” Cloe huffed. Cliffford began to doze as well, so Cloe meandered away, sniffing around the meadow.\\n\\n“Cliffford? U-BONE! WAAAAAAAKE UP!” Cliffford and U-Bone bolted awake, jumping to their feet.\\n“HAHAHAHA! Did I scare you?” Cloe yipped, bouncing around in circles around her two friends as excitement practically dripped off her.\\n“What’s up, Cloe?” U-Bone asked.\\n“I found something neat. Come with me!”\\n\\nWithout looking behind her to see if the others were coming, Cloe took off at a run down a path that Cliffford and U-Bone hadn’t seen until now. The path wound through the woods, the trees getting taller and closer together the further along they went. The terrain became rockier, and a few times they dodged around large boulders as they continued forward.\\n\\nAround a bend in the path, Cloe came into view, her tail wagging wildly. She stood in front of a large outcropping with a dark, conveniently Cliffford-sized opening in its face.\\n\\n“This place gives me the willies,” U-Bone said, looking around. He noticed crumbling rock around the entrance, which on closer inspection, he realized were carvings of some kind of dog-dragon looking menacingly into his eyes. U-Bone decided not to inspect it further. It was definitely a dungeon.\\n\\n“So? Come on, guys, what do you think? Want to go inside?” Cloe asked.\\n“You know, I’d really rather just go back and see if we can score any free snacks from the picnic blankets,” U-Bone muttered, looking uncomfortable.\\n“Yeah, I’m not even sure I’ll fit in there,” Cliffford said.\\n“Uh, Cliffford, did you see the part up there in the paragraph before last where it said the entrance is conveniently Cliffford-sized? Do you remember the last story where you fit into the double doors of a shopping mall? You can’t worm your way out of this.” Cloe looked smug. “I’m sure there are all kinds of interesting things to eat in there anyway, U-Bone.”\\n“Oh, all right,” Cliffford and U-Bone sighed. “Let’s enter the dungeon.”\\n“Fuck* yeah!” Cloe shouted, and ran inside.\\n\\n*If you’re reading this to young children for some reason, have fun substituting the word of your choice. May we suggest fizzle? Forward? Finagle? Forsooth? Just say it with all the energy of a dog hopped up on self-righteousness and you’ll be fine.\\n\\nCliffford did, indeed, fit inside the entrance, as well as the tunnel just inside. There were plenty of smells wafting around, and his head whipped from side to side trying to take them all in. In doing so, he failed to look at the ground ahead, and he tripped.\\n\\n“Look, a bone!” Clifford said happily as he scrambled up off the floor. Things were beginning to look up. Cliffford picked it up and gnawed around on it as they trekked deeper into the dungeon.\\n\\nU-Bone noticed some orangish clingy stuff close to the bottom of the cave wall. He sniffed it. “Slime mold? Don’t mind if I do.” He nibbled a little, and then scarfed the rest down in just a few bites. Not bad. He feels invigorated!\\n\\n“Oh, wow, another one!” Cliffford shouted around the bone in his mouth as he stopped to pick up a second bone. “And another! This dungeon is turning out to be pretty great.”\\n\\n“I told you!” Cloe grinned. She bounded down the tunnel ahead of the other two. “Come on, there’s a staircase that’s leading down!”\\n\\nThe three dogs descended the stairs into near-blackness. No longer lit by the daylight streaming in from the entrance, the dungeon was distinctly murkier. Something brushed past U-Bone’s ear and he snapped at it.\\n\\n“I found a torch!” Cloe said. “I wonder if there’s any way to light it. We’d better take it with us. She grabbed the torch in her mouth and crept into the gloom.\\n\\nThe trio inched forward, sniffing and listening before moving along the path. Eventually, the darkness lifted a little bit, and they approached a second, lit torch set into a sconce in the wall. Even Cloe felt better once she lit their torch, which now illuminated a small circle around them.\\n\\nSomething else glinted in the darkness just beyond them. Cloe moved closer and the dogs saw a beautifully crafted, lightweight sword lying on the dusty floor. “This one’s all yours, U-Bone,” Cliffford said through his mouthful of bones. U-Bone gingerly took the sword and swung it around a few times. Cliffford and Cloe saw his apprehension turn to excitement as U-Bone growled, advanced on a spiderweb, and dispatched it.\\n\\nU-Bone stumbled upon a sheath and baldric for the sword a short distance away, and strapped them on. BOSS! A few turns of the path later, and the dogs found another staircase down. Come on, it’s a dungeon crawl. Of course they found another staircase!\\n\\nThe dogs explored further and deeper into the dungeon. Cliffford’s mouth was crammed as full as possible with bones, and he looked sadly at each one he had to leave behind as they pressed on.\\n\\n“Humuhlauhsunrrmmmuh,” said the big rad dog, furrowing his brows.\\n“Hmm?” asked Cloe, through the side of her mouth around the torch.\\n“Mmmmahhhhh!” U-Bone hollered as he turned a bat into a meat icon that dropped a large leather satchel and a helmet that fit no one.\\n\\nCliffford pawed the satchel with his foot, turning it over. It flopped open. There was nothing inside, so he started to put his bones in his bag. He was delighted to find every single one fit, and then some. “Huzzzah! A bag of holding!” he shouted, and raced forward to find more.\\n\\nInstead, Cliffford found a kobold corpse. He sniffed it, hesitated, sniffed again, shrugged, and dug in. “Any good?” U-Bone asked, sheathing his sword. “Ugh, no, this corpse is definitely tainted,” Clifford said, not lifting his head from his meal. U-Bone sniffed the corpse and took a bite. “Yeah, man, ugh, that’s rank. Don’t eat those guys.”\\n\\nThe dogs began to feel thirsty from all their exertions, and conveniently the next level had some water! They descended the stairs to find themselves standing in front of an expanse of shimmering deep blue-violet, a gorgeous underground lake.\\n\\n“It’s beautiful!” Cloe sighed. She bent down to drink, and U-Bone followed suit. Cliffford bent over, too, and as he drank, his stomach began to twist. “Uh, guys?” Cliffford said. “HUUUGGGGGGHHHHHHHHHH,” he retched, and vomited into the lake. He lay down in the mud on the shore.\\n\\nU-Bone noticed a sign nearby. “Lake of Eternal Cleanliness,” he read.\\n“Dude, not anymore. HAH!” Cloe barked.\\n\\nJust then, they heard a shout ahead of them. A small, crotchety dog-dragon-hermit thing emerged from a hovel at the edge of the lake.\\n\\n“THIS LAKE HAS BEEN PRISTINE FOR NINE HUNDRED THIRTY SEVEN YEARS!” shouted the angry lake-keeper, shaking one fist wildly and wielding a Staff of Glowing Menace in the other. Cloe backed up, and U-Bone got his sword ready, but Cliffford still lay in the mud, groaning.\\n\\nJust then, Cliffford happened to twist his head at just the right angle to notice a small vial of something pink resting in the mud by his ear. He quaffed this (come on, Cliffford, stop ingesting all these questionable things!) and instantly felt not only invigorated, but also amplified! Cliffford barked an ear-poppingly loud enchanted bark, which repelled the lake-keeper and sent him splashing into the Lake of Recent Uncleanliness, and the three friends hauled ass* (*apples?) further down into the dungeon.\\n\\nBy the time the dogs felt like they could slow down, they had descended what felt like (and was) the umpteenth flight of stairs. They came out in front of a small, narrow opening. Cloe held the torch while U-Bone scouted inside, and he noticed that the path was twistier and turnier than the rest of the dungeon had been.\\n\\n“I think it’s a labyrinth,” he said, as the two smaller dogs emerged from the entrance. “But Cliffford, I don’t think you’re going to fit.”\\n\\n“I’m going to look around and see if there’s any way around,” Cloe said, and trotted off. She came back a few moments later with a rolled-up piece of paper.\\n\\n“Hey guys, what’s this?” she said, dropping it in front of the others.\\n“It’s some kind of scroll,” U-Bone said, nosing at it.\\n“Is that like some kind of newspaper?” she asked. “I love newspapers! I like to go out really early in the morning right after they’re delivered, slide them out of their plastic sleeve, and shaaaaaaaaaake them so hard that they get all shredded up! It’s so funny!” Cloe giggled. “I’m going to go for it. I think this scroll is going to be pretty satisfying too.”\\n\\nCloe whipped her head back and forth, and the scroll unfurled, revealing the text GRRMOC UHLPROOT in old-timey writing, and she stopped. “Grrmoc uhlproot?” she asked, and instantly, Cliffford fell to the ground. Yeah, the scroll was totally cursed.\\n\\nA moment later, Cliffford was back up again, only now he was the size of a normal dog. Yup!\\n\\nThis was a very useful development for our plot, because they heard shouts from the top of the stairs. The angry lake-keeper’s scratchy toenails clicked on the stone treads as he skittered down toward them.\\n\\nThe dogs wasted no time, and all three dove right into the entrance to the labyrinth. They tried their best to stay together, but Clifford, unused to being tiny, lagged behind. He felt weak, and needed food badly.\\n\\nThe other dogs called encouragingly behind them for Cliffford to hurry the fuck* (*fart!) up, but he stopped short when he saw some meat lying in a corner. It was another kobold corpse. His brain said to him, “Hey, wait a second, Cliffford,” but then he discovered he’d already begun to eat it.\\n\\nOh yeah, this one’s tainted too.\\n\\nThe dogs all managed to find their way to the center of the labyrinth in enough time to marvel at the treasure there: the Squeaky Toy of Canidae. A lovely, fuzzy, stuffed squirrel with a magical squeaker that never, ever breaks, and that is also enchanted with legendary but vague special powers.\\n\\nTheir marvel was cut short by the angry lake-keeper, who barreled into the center of the labyrinth behind them, hollering. Cliffford turned to face the lake-keeper, and felt a familiar twist in his stomach as he did so.\\n\\n“HGGGGGRRRRRRRPH!” he grunted, spewing vomit all over the lake-keeper. It sizzled as it hit the lake-keeper, dealing quite a bit of damage. It also broke a curse on the lake-keeper, and from his crusty, smelly robes emerged Moc.\\n\\n“What is going on? I’ve been in this godforsaken cave for the last five and a half days* (*937 dog-hours!). The whole time I’ve been having repeated nightmares that I’m some sort of disgusting hermit encamped by a lake.” He shook himself, and droplets of vomit spattered the labyrinth walls.\\n\\n“And you, Cliffford, your vomit seems to be a recurring feature in my nightmares as well. Can we please get out of here?” Moc huffed, as he caught a whiff of the tainted, partially digested kobold corpse clinging to his fur.\\n\\n“Hey, guys, I think Moc’s curse isn’t the only one that’s broken!!” Cliffford shouted, as he began to grow and grow. The rapid growth broke down the walls of the labyrinth, revealing a clear path to the exit.\\n\\nCliffford stuffed the Squeaky Toy of Canidae into his bag of holding, and all the other dogs hopped on his back and held on for dear life as Cliffford sprinted out of the dungeon and back into the sunshine of the park.\\n\\nAfter rolling around in the grass to get the last of the spiderwebs and vomit off themselves, the dogs went back to Cliffford’s doghouse, where they all feasted on the bones from Cliffford’s bag of holding and took turns with the Squeaky Toy of Canidae.\\n\\nThe friends all agreed that it was the best dungeon crawl ever!\\n\\nTHE END!!\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/izzy": {
      "path": "stories/izzy",
      "content": "(function() {\n  module.exports = \"“Izzy, your grandma is here!” Izzy jumped up from where she was seated on the classroom floor chatting with her friends during after-school care, and she ran to her grandmother to give her a huge hug.\\n\\n“Have a good weekend,” her teacher said as Izzy grabbed her backpack.\\n“You too!” Izzy called, as she ran for the parking lot with Grandma close behind. She nearly flew through the school gate.\\n\\n“Wait for me before you cross the street!” Grandma shouted to Izzy.\\n“Sorry,” Izzy replied as Grandma caught up to her.\\n\\nThey crossed over to where Grandpa was leaning against their 1973 El Camino. He swung Izzy up and spun her around.\\n\\n“Did you have a good day, kiddo?”\\n“Yeah! I finished The BFG and I got to draw my favorite part as a poster and share it with the class,” Izzy said proudly.\\n“Sounds great. Did you try to draw in the style of Quentin Blake, or did you use your own style?” Grandpa asked.\\n“Well, I tried pretty hard to draw like Quentin Blake, but it’s hard to draw like other artists. I didn’t like how it looked so I started over by just reading the description again and imagining it in my head. I’ll show you next week when I bring it home.”\\n\\nIzzy lowered her backpack into a wooden orange crate in the truck bed of the El Camino. Her navy-blue violin case, a small amplifier, and a black bag already sat in the crate. The crate nestled in between a variety of potted plants which took up the remaining space in the bed. Izzy plucked a few ripe cherry tomatoes and some snow peas from their respective vines, which twined around cages in a large planter close to the cab’s rear window. She ran her fingers through the thyme and mint spilling out of smaller planters closer to the tailgate and breathed in, relishing the pungent and spicy smells. She loved her grandparents’ mobile garden.\\n\\nShe munched her snack as she climbed into the front seat of the El Camino and slid in next to Grandma, who sat in the driver’s seat. Grandpa placed three garment bags on Izzy’s lap, and then slid in beside her, sandwiching Izzy in between her grandparents. \\n\\n“Be careful not to get any tomato juice on the garment bags,” Grandpa cautioned.\\n“I know. I’ll be careful.” Izzy replied.\\n“All right. Sorry it’s such a tight fit today!” Grandpa smiled at Izzy. “Are you excited?”\\n“Yeah! I can’t wait until we get to the boardwalk! Everyone is going to love our show!”\\n“Well, then!” Grandma exclaimed. “Let’s go!”\\n\\nThe El Camino’s engine roared to life and Grandma maneuvered the car onto the road. With both windows down, the breeze ruffled everyone’s hair, and as they neared their destination, the fresh scent of the ocean wafted in, filling Izzy’s nostrils with the salty, damp aroma. The plants in the back swayed gently back and forth in time with the rhythm of the car’s motion, and their planters were so tightly arranged that nothing slid around. \\n\\nGrandma pulled into a perfect parking space close to the boardwalk at the beachfront parking lot. Grandpa carried the garment bags; Izzy carried her backpack and violin, and Grandma carried the black bag and the amplifier.\\n\\n“Nice car!” a voice called to them. They turned to see a young man and woman wearing wetsuits and loading surfboards into the back of their SUV.\\n“Thanks!” Grandpa called back. The two surfers smiled at them. Izzy glowed. She loved the way her grandparents brought joy everywhere they went.\\n\\nThe sun was beginning to set over the ocean, creating an air of magic. Izzy and her grandparents walked the short distance to their pre-chosen destination: a bench that overlooked the water, adjoining a large, wide sidewalk upon which Friday night foot traffic was beginning to accumulate.\\n\\nA nearby planter contained palm trees and succulents, as well as a small electrical outlet on one side. Grandma pulled an orange extension cord from her black bag, and plugged it in. She carefully duct-taped the cord to the ground for safety as she ran the cord up to the bench. Izzy plugged her amplifier in the extension cord and began setting up her equipment.\\n\\n“I’m going to go get changed,” said Grandpa to Grandma, taking his garment bag and walking in the direction of the restrooms. As Izzy began tuning her violin a few minutes later, Grandpa appeared wearing a leisure suit that had a complicated design made of conductive fabric circles and lines stitched together in that turned his costume into a drum pad, which connected wirelessly with the amplifier.\\n\\nThe equipment setup complete, Grandpa began do a final check of his suit while Izzy and Grandma took their turn to change as well. A short time later, they emerged, resplendent in their own costumes.\\n\\nGrandma wore a long-sleeved, tight-fitting silver dress that had fiber optic filaments running vertically along her body and dangling beyond the bottom of the dress. She had not yet switched on the battery pack, and the dress appeared at first to be rather unassuming. However, the headdress she was wearing was quite the opposite. Nestled in Grandma’s big hairdo was a variety of feathers, delicately coiled wire shapes, and more fiber optics that skimmed the top of her head before shooting up like the crest of a rainforest bird. Dramatic, dark eyeliner, silver eye shadow, and silver platform shoes completed the look.\\n\\nThe simple cut of Izzy’s dress accentuated the beautiful movement of the fabric. A fitted bodice gave way to a flared skirt. She twirled, and the purple and blue dip-dyed fabric swirled in response around her knees. Opting to keep her costume simple for ease of playing her violin, it had no electronics. The bodice was adorned with sequins she had painstakingly glued in an intricate pattern, which, like a disco ball, would reflect the lights from the small footlight set up next to her. In Izzy’s hair was a small feather and fiber optic fascinator, like Grandma’s but on a smaller scale.\\n\\nIzzy did a quick, final sound check. “Ready?” she asked. \\n“Let’s do it!” grinned Grandma and Grandpa.\\n\\nMonths of effort coalesced into one moment as the sun finally dipped below the horizon, sending the boardwalk into twilight. Grandma and Grandpa switched on their battery packs, and Grandma’s dress lit up. Izzy switched on her footlight, nodded to Grandma and Grandpa, and began to play.\\n\\nInspired by her hero Zoë Keating, Izzy began to loop snippets of her violin with her loop pedal. She built sound after sound up to a fast-paced, catchy, danceable beat, while Grandpa and Grandma began to dance. Grandma’s fiber optics began to pulse with the rhythm of Izzy’s music and Grandpa’s drum pad leisure suit. They whirled and spun, and even Izzy swayed and swirled with the music as she played.\\n\\nA crowd began to form, cheering on the pop-up discotheque. They clapped in time to the music, delighted every time Grandma’s skirt sent pinpricks of light racing around her knees, and murmured in excitement at the intricate movements Grandpa made to keep the drums thumping. As the song ended, the crowd exploded with whoops and shouts, and several people made donations into Izzy’s violin case. The family took a bow, and launched into another song, causing the crowd to cheer yet again.\\n\\nLike any moment that has been anticipated for so long, it seemed to last but the blink of an eye. When the last song ended, the crowd drifted away on the final, lingering notes from Izzy’s violin. As Grandma and Grandpa started to pack up, Izzy took a dime out of the violin case, her favorite coin because it was the smallest, and darted to the fountain down the boardwalk. She pitched the coin into the dark water that reflected the stars.\\n\\n“What did you wish for?” Grandpa asked as Izzy returned.\\n“Not telling,” Izzy replied.\\n\\nShe slipped her small hand into Grandpa’s, and the other into Grandma’s, and they walked back to the El Camino.\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/marigold": {
      "path": "stories/marigold",
      "content": "(function() {\n  module.exports = \"The shutters of a third-story window of the manor house flew open, and a small girl leaned out, hurling a rope to the ground below. She lugged a chair over to the window, and stood on it. She grasped the rope in both hands, and began slowly descending the pitted grey stone walls of her home. Evenly spaced knots helped her tiny hands keep hold of the thick, scratchy rope as she leaned her slender frame away for balance.\\n\\nIn the garden below, the girl brushed rope fibers from her hands on her leggings and smoothed out her tunic. A gust of wind whipped her black hair about her face, and she wrapped her cloak closer about her body and pulled its hood over her head.\\n\\nThe waxing crescent moon, partially obscured by clouds, gave little light, but the girl needed no lantern. She blinked her golden eyes rapidly a few times, letting her cat-like pupils widen enough to collect the scant light, and took in her surroundings in shades of grey. She marched off into the darkness of the nearby woods, hidden under the cover of darkness.\\n\\nThe girl found her favorite deer trail through the forest, almost invisible to anyone else. It wound around the ancient oak trees before descending along a sandy bank to the edge of a softly flowing river. Downstream, the rapids became rough, but here, where rocks were few and the ground was mostly level, the water pooled and was perfect for swimming.\\n\\nDespite the chill of the evening, the girl removed her boots and garments and folded them neatly, placing them on a flat rock several feet from the edge of the river. She stood expectantly, letting the water lap at her toes.\\n\\nShe looked up as a swirling cloud emerged from a hollow tree and collected above her head. She whistled a haunting little tune and the cloud parted, wrapping itself around her body as she stepped into the water. She waded waist-deep into the water as the nanoswarm enveloped her in scaly, flexible skin from her torso all the way down her legs, ending in a tail with long fins. Opening her mouth, she inhaled some of the nanoswarm to allow her to breathe underwater, before her body slipped entirely under the rippling surface. \\n\\nThe girl splashed her tail and a peal of light, uninhibited laughter echoed off the rocks as she resurfaced. She swam off into the night.\\n\\n***\\n\\n“Lady Marigold?” A young woman, shivering in the predawn air, gently shook the girl’s shoulder to rouse her. The girl, Marigold, blinked her eyes and looked to find her lady’s maid standing over her with a look of concern. Marigold lay on the sandy shore where she had fallen asleep hours before.\\n\\n“Hm? Oh, no. I’m so sorry, Raina! I didn’t mean to fall asleep!” she said, brushing sand from her face as she sat up. She was still wrapped in her nanoswarm, so she whistled to them again, and they lifted away from her body and back into their hiding place in the tree. Raina retrieved the neatly folded clothing and helped her lady dress quickly.\\n\\n“My lady, if you must escape the house at night, please return in a timely manner. Surely you can program your nanoswarm to remind you to come home?”\\n“I can, but it is awkward to swim to shore with legs if the nanoswarm leaves me when I am not yet ready. I much prefer the tail.”\\n\\nRaina huffed in exasperation and said nothing further. She tamed Marigold’s long hair in a quick series of braids, which she wound around the girl’s head and pinned into place.\\n\\nMarigold turned to leave, but Raina said, “Your eyes, Lady Marigold.” Marigold paused, closed her eyes, and opened them again. Gone were the cat’s eyes, replaced by dark brown eyes with the usual round pupils one would expect to see in a girl five years of age.\\n\\nRaina followed her lady up the bank and back into the forest. They returned to the manor house quickly and quietly. Raina, feeling that scaling the walls of the house was undignified, had already wound Marigold’s rope back up and closed the shutters. Instead, the two of them tiptoed through the kitchen. The cook, singing loudly to herself, kneaded the day’s bread and did not hear their entrance.\\n\\nBack in Marigold’s rooms, Raina started a fire. “I am not cold,” Marigold protested. “The nanoswarm helps regulate my body temperature.”\\n“Very well, but I have no such protection and I, too, have also been out in the cold this morning.” Raina continued building the fire until it roared in the fireplace.\\n\\nMarigold disappeared into her library, a fortress of shelves she had arranged in a corner of the room adjacent to the fireplace. Books of all shapes and sizes and subjects, borrowed from the big library downstairs, whispered to her their secrets of ancient wars and mythology, poetry and architecture. Soft cushions stacked on a rug served as her seat, and Marigold resumed reading A Brief History of Nanoculture.\\n\\nBreakfast arrived on a tray, which Raina placed next to Marigold on the floor. The girl held the book in one hand, and ate her toast and jam and drank her tea with the other, her eyes never leaving the pages.\\n\\nA knock at the door yielded a sealed note, which, though it was addressed to Raina, was delivered to Marigold. The girl looked over the note, scowled, and snapped the book shut, mentally noting the page number.\\n\\n“My uncle has summoned me,” Marigold said to Raina, who nodded in response. “I do wish that man would write to me directly.” She read the note aloud, rolling her eyes: “‘Send the Lady Marigold to me at half-past nine and ensure the child wears something befitting her station.’ He knows I can read. Why does he torment me thus?”\\n\\n“Your uncle is a good man,” Raina soothed, “He has many responsibilities, and has better things to occupy his time than chastising you for coming to an audience with him dressed for a day out in the woods.”\\n“Formal clothing is pointless. My appearance is arbitrary. I am five, and therefore invisible anyway. I prefer being able to move freely.”\\n\\nMarigold flounced to a small adjoining room where her clothing was stored, and sullenly pulled a long dress from a drawer. Light, soft grey fabric draped over her head as she put the garment on. Long, tight-fitting sleeves with inlaid lace covered her arms, and the hem of the dress, which brushed the tops of her toes, featured more of the same lace. Over the dress, she put on a long, intricately embroidered vest, and Raina helped her cinch her waist with a belt the width of her hand, encrusted with beads made of semiprecious stones. Marigold slipped her feet into soft, ghillie-style shoes made of fine leather that laced up her legs.\\n\\nThey sat at Marigold’s dressing table and Raina brushed Marigold’s hair before smoothing it into a full, low roll at the back of her head, pinning smaller braids around it, and placing a gold hair comb into the top of the roll. Raina carefully adjusted the small curls around Marigold’s face, and turned the girl to face her.\\n\\n“You look lovely,” Raina smiled.\\n“I still prefer the tunic and leggings, but thank you.”\\n\\nMarigold exited her rooms, followed by Raina. They descended the staircase at the end of the hall, and proceeded to the library, where Marigold’s uncle usually received her. Raina knocked, and entered.\\n\\n“Lady Marigold Lavande, Duchess of Frisa.” Raina announced her lady as she slowly inclined her head, a sign of respect for the child’s uncle and guardian, Lord Therus Osmarinus, a duke in his own right of the neighboring county of Astera.\\n\\nMarigold swept past Raina, stopping before her uncle and inclining her head to him. He returned the gesture of respect and motioned to a chair near the table upon which his correspondence was spread before him. Raina left the room, and Marigold sat.\\n\\n“Good morning, Marigold.” Her uncle’s green eyes were kind, but she could see bags under them. He probably had not slept much the previous evening. He sat at the table opposite her.\\n\\n“Good morning, Uncle.” From her perch on the chair, she could just see the letters he had been reading. She strained her eyes to see the details. She noted the seal of the Ruling Council affixed to several of the letters, and the swooping signatures of several different people. She also noted a map of the country he had pulled up on a tablet, with a variety of location markers scattered near the coast.\\n\\n“What is the map for, Uncle?” Marigold asked.\\n\\nHer uncle ran his fingers through his short, brown hair, speckled through with grey. He sighed. “There is some unrest along the coast. We have been summoned to the Palace of the Ruling Council for a meeting.”\\n“We?” Marigold raised her eyebrows. “We are never summoned. You are summoned, and I remain here and you act on my behalf.” She began to feel agitated. She liked her home, and leaving it always made her feel uneasy.\\n“In general, yes, but the Ruling Council specifically requested your presence this time.” Her uncle gestured toward the fireplace where a man and a woman stood, watching them.\\n\\nHe introduced them as Lord and Lady Sicale, and explained that he must accompany them now to the Palace, and that Marigold would follow along as soon as possible. Marigold gathered that the summons had been delivered in person, and must be quite delicate and urgent.\\n\\n“I leave with Lord and Lady Sicale within the hour. I have already sent instructions to Raina to begin packing your things. I shall see you soon.”\\n\\nHe dismissed her with a nod of his head, seeming to want to say more, but refraining. Marigold went back to her rooms.\\n\\n***\\n\\nThat evening, Marigold lay awake in bed. The day’s flurry of activity, rather than tiring her out, had set her brain tingling. Raina and the other household staff had seen to the packing of her clothing, books to study, and other personal effects. She had been left to her own devices to pack a small bag full of whatever she wished to take personally, which consisted largely of the books she was reading for pleasure, a sketchbook, some colored inks, and a variety of colored and graphite pencils. She had nearly everything, but one thing remained she wanted to take.\\n\\nShe rolled over and over, pondering, before finally sitting bolt upright, coming to a decision. Flickering her eyes to golden cat-eyes, she slipped out of bed and put on her tunic and leggings, boots and cloak. She took a tiny glass vial from her dressing table. It fit in the palm of her hand. The vial had a narrow mouth and neck, with a very small silicone stopper in it, and a bulbous base. Delicate filigree metalwork around the neck sported a loop through which she threaded a fine silver chain. She put the chain around her neck and hid it under her tunic.\\n\\nAs Marigold had done the previous night, she flung open the window, and let herself down silently with the rope. She flew over the deer trail to her secluded riverside swimming spot, where she whistled a slightly different nanotune than the night before. The swarm came out of its hiding place in the hollow tree. Instead of swirling around her and transforming her lower body into a sleek, aquatic creature, the nanoswarm poured into the vial around her neck, which she held aloft.\\n\\nMarigold replaced the stopper in the vial and hurried back to her room. The implications of bringing the nanoswarm to the Palace could be disastrous. Aside from her own swarm, nanoswarms had not been seen in hundreds of years. There were rumors of wild swarms, but no official reports existed, much like the mythical creatures she enjoyed reading about in her books.\\n\\nMarigold’s nanoswarm had been with her for as long as she could remember. It was her secret, shared only with Raina. She could not leave her swarm for more than a few days without missing them terribly, and based on the amount Raina and the others had packed, this trip would be much longer than a few days.\\n\\nComforted by the swarm’s nearness, but still terrified at the prospect of her visit to the Palace, Marigold fell into an uneasy sleep.\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/mystery-smell": {
      "path": "stories/mystery-smell",
      "content": "(function() {\n  module.exports = \"The Mystery Smell\\n\\n“I’ve got one!” Cloe shouted. Cliffford, the big rad dog, and his friends U-Bone, Cloe, Moc, Cassy, and Bub were playing their favorite game – Mystery Smell.\\n\\n“It’s smoky and garlicky and meaty,” said Cloe, “and it’s coming from a backyard!” The other dogs trotted down the street, sniffing everywhere until they found the source of the smell.\\n\\n“It’s a backyard barbecue!” called U-Bone from across the street. “I smell carne asada!”\\n“You got it!” Cloe answered.\\n\\n“My turn!” said Cliffford as he caught a whiff of something on the breeze. “It’s strong, almost but not quite like mint, and it’s coming from up high.”\\n\\n“Hmmm,” thought the others. They passed through a park at the end of the street, and the others found the smell right away. “Eucalyptus trees!” Moc declared triumphantly, looking up into the tall trees that grew around the perimeter of the park.\\n\\nCassy’s nose picked up the trail of a jogger, and the dogs gleefully bounded along, following it until it ended at a house a few blocks away.\\n\\n“I smell something citrusy!” U-Bone barked, and his friends sniffed the air. They found a neighbor picking lemons off a tree in their front yard.\\n\\n“GUYS!” shouted Bub. “I have one, and it’s amazing!”\\n\\n“What is it like?” Cliffford wondered, and the others waited expectantly.\\n\\n“Well, it’s...you know...sort of...something...with a hint of...I can’t explain it.” Poor Bub was just a puppy and didn’t know the names of all the tantalizing smells in the neighborhood.\\n\\nThe other dogs sniffed their noses in all directions, hoping to help Bub name the smell he had found. Suddenly, they heard a “yip!” and a scratching of claws and the dogs turned to see Bub bounding away down the street.\\n\\n“Bub!” shouted Cliffford. Bub kept on running. The big rad dog sighed. “Bub is such a little puppy, but he always gets into BIG trouble. We’d better go after him.”\\n\\nCliffford, U-Bone, Cloe, Moc, and Cassy took off after Bub. They practically flew over the sidewalk! They reached the end of the block to see Bub’s tail disappear around the corner. They rounded the corner themselves and stopped short.\\n\\n“What is that huge building?” U-Bone asked. The dogs stared together at the building, which was situated in the middle of a very large, very busy parking lot.\\n\\n“It’s a shopping mall!” Cloe shouted. “Miss Dollar takes me there sometimes. People go there and look at things, and sometimes they take the things out in bags.”\\n“Bub just went inside, guys. We’d better go in after him,” Moc said. The dogs quickly but carefully crossed the street, navigated the cars circling for parking spots, and made their way to the double doors of the BIZWELL MALL.\\n\\nThe mall had two floors, so the dogs split up. U-Bone and Cloe dashed for the escalators and each took one side of the top floor. Moc and Cassy stayed downstairs and each took a side. Cliffford went down the middle, with his feet on the first floor and his nose up in the second!\\n\\nAll five dogs dodged strollers and shopping bags, kiosks and benches, as they continued in pursuit of Bub.\\n\\nBub, meanwhile, was having a fantastic time. He had no idea what this huge building was, but the smells were tantalizing! He found a place with all kinds of different food, from curries to noodles to pizza to tacos, labeled Food Court. He picked up the smell of freshly baked waffle cones, and chocolate chip ice cream as he ran by a kiosk, and paused only briefly to lick the remains of a child’s dropped cone.\\n\\nBub passed a storefront selling candy, and savored the whiffs of peppermint candy canes and caramels and chocolates coming from the entrance. He scampered by a store loaded with candles, body lotions and sprays, all with fruity and floral fragrances.\\n\\n“Shoes!” squealed Bub, as he skittered past a store with hundreds of pairs of brand-new sneakers lining the walls. Bub was tempted to dive headfirst into the store selling leather handbags and wallets and belts and jackets, and chew on everything in sight, but he thought better of it. Besides, all the smells he smelled in this wondrous building were familiar. None of them were the new and enticing scent he was trying to find.\\n\\nPassing a coffee-and-tea kiosk and inhaling the aroma of the freshly ground beans and steaming cups of tea, Bub found himself at the other end of Bizwell Mall. He had nowhere to go but straight into the anchor store at the end, dodging displays as he kept sniffing. The scent was getting stronger – he must be almost there!\\n\\nWearily, the other dogs approached the anchor store as well, just in time to see Bub running headlong into it. They summoned the last of their energy, marveling at Bub’s stamina, and ran through the store themselves.\\n\\n“Well, I think we’ve lost him,” Cliffford huffed to his friends. “I don’t see him anywhere, and we’re here at the exit.”\\n\\n“Wait!” Cassy shouted. “Isn’t that Bub outside?”\\n\\nThe dogs burst out the doors and into the cool air, and there was Bub, happily rolling around on the ground.\\n\\n“I found it, guys!!” Bub called, as he flopped on his back once more and wriggled in the source of his scent: pine needles, fallen from hundreds of freshly cut Christmas trees, filling up a large portion of the parking lot outside the store.\\nThe other dogs agreed that Christmas trees did smell very, very good. Bub had not caused any damage, only a merry chase, so they were all quite relieved. They all meandered through the tree lot, sniffing and looking.\\n\\nCliffford decided that he wanted to get a tree for his doghouse, and picked the biggest, tallest tree he could find. It was taller than he was! The proprietor of the Christmas tree lot wrapped it up for him with rope, making two straps that Cliffford could wear like a backpack. Bub proudly jumped up on Cliffford’s head as they headed for home, with the other dogs close behind.\\n\\nEmma was waiting back at Cliffford’s doghouse, hoping to read him a story, and she gaped as the dogs entered the doghouse. She laughed when she saw what they had with them, and said, “I think we’re going to need more decorations than what we have in the garage!”\\n\\nIn the end, it took two trips back to the mall, a hundred strands of lights, and a thousand ornaments to decorate the huge tree. The dogs gave Bub the honor of plugging it in, and they all agreed it was the best Christmas tree ever.\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/provision": {
      "path": "stories/provision",
      "content": "(function() {\n  module.exports = \"One hundred or so years from now, when I\\ndie, my descendants come across this\\nrich text file while going through the\\ndrawers and the suitcases in my husband\\nand I's house under the pretense of\\ncleaning. They will try to understand\\nwho we were and if we ever were more\\nthan just parents. They will have\\nproblems with technology that has yet to\\nbe invented; they will have kids and\\nlovers that I will never meet.\\n\\nMy husband will die twenty or so years\\nbefore me. He will fall asleep at Sam's\\nClub and refuse to wake up. A\\nbadly-shaken mid-level Sam's Club\\nfranchise manager with kind eyes and a\\npolo T-shirt and exactly one earring\\nwill knock on my door and deliver the\\nnews. I will feel weak and, 18 hours\\nlater, I will cry.\\n\\nI want you to know how ordinary I was. I\\nwanted to be one person and then I ended\\nup being someone else. Cumulatively I\\nthought I had serious fantasies about\\nmarrying three different people and,\\nafter college, I ended up marrying the\\nsecond. I was part of a dozen thousand\\nwho fled to Canada during the dark\\nyears. My grocer patiently taught me how\\nto say 100 words in a French-Canadian\\naccent and gave me the courage to eat\\nugly vegetables. I could have traveled\\nmore and been happy. I could have not\\ntraveled more and been happy.\\n\\nThe worst part about traveling is all\\nthe advertisements for foreign brands.\\nWalking home at night under the\\nspotlights of billboards with which you\\ncannot empathize is a piercing kind of\\nloneliness. The best part about\\ntraveling is meeting all the other\\nexpats in your city, who each is tacitly\\na member of a busy and tired club.\\n\\nMy parents were Armenian mathematicians.\\nThey left their country, which gave me\\nthe courage to leave mine. They were\\nconstantly worried about me and, to\\ndistract themselves, they bought and\\nflipped real estate. The first time you\\nbuy a house it seems impossible that\\neach room will fill with the right\\nfurniture and the each wall will have\\nthe right artwork. The second time is\\ntwice as easy; and the third is twice\\nthat. They met one hundred or so\\ndifferent people that way, which I think\\nsomehow made my relationship with them\\nbetter or at least easier. Toward the\\nend they will play gin with their\\nneighbors in the morning and watch\\nArmenian television in the afternoon, on\\na small satellite modem that only\\nArmenians know where to buy. They forgot\\nEnglish first, then walking, then\\nbreathing. Acting on this information, I\\nwill try to die much faster.\\n\\nThe early 2010s will be remembered\\nfondly as a simpler time, and\\nadditionally I want to add they were my\\nfavorite years. The late 2040s were good\\ntoo, as were the 2060s. It will become\\ndifficult to separate the objective\\nquality of a time period from how much\\nof a burden my body becomes. Every year\\nI will buy clothes that looked like all\\nthe clothes I owned fifteen years ago\\nuntil, one day, I throw everything out\\nthat isn't white and blue. I will die in\\na white blouse and blue shorts. In death\\nI will stop looking cute and start\\nlooking serene.\\n\\nThough I know some facts about the\\nfuture I have a great deal of questions.\\nWhat are the food trends now? Are there\\nany new bands that sound like the old\\nbands I liked? Do radiators still break\\nduring the coldest week?\\n\\nMy husband and I ran into each other in\\nthree different cities. The first two\\ntimes we recognized in each other an\\nunderstanding that the timing was off.\\nThe third time we fucked in a friend's\\ncloset, groping each other like we were\\nyounger, beneath layers of woolen duvets\\nthat we by accident pulled down. It\\nseemed tawdry and sticky at the time and\\nnow it's just a sentence.\\n\\nInto our lives we carved out space for\\neach other. We put up load-bearing\\nbeams. We added good thick curtains and\\na little OLED display that read the\\namount of humidity in the air. We agreed\\nto never make the other person sleep on\\nthe couch, as we wanted ours to be\\nfilled with the flatulence of our\\nfriends. We threw the best parties. We\\nwere an unstoppable hosting machine. We\\nfigured out that a party becomes the\\nmemory of a party. It happens one or two\\ndays after the party, when the\\nconversation and the discoveries curdle\\ninto something distant and bittersweet.\\n\\nThe city will build a subway station\\nnear us in 2031 after years of private\\nfunding into subterranean\\ninfrastructure. The money will come from\\ntech moguls looking to survive zombies\\nand/or climate change, but a subway\\nstation is a subway station. One late\\nnight, as we step off the train on our\\nway home, we will walk past a woman\\nwearing a bright striped parka. I will\\nturn my head to get a second look and\\nshe will not be there. I will crook my\\nhead to see behind the poles until my\\nneck hurts, and still I will see no one.\\nI will turn to my husband, who sees my\\nface, and we will walk home with his\\nhead lying on my shoulder and his hand\\nlying on my chest so that my\\ninexplicably racing heartbeat will bang\\nand shudder against his hand like a\\nhurricane's wind against the shutters of\\na house where nobody has ever lived.\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "stories/residue": {
      "path": "stories/residue",
      "content": "(function() {\n  module.exports = \"\\u200b                                 RESIDUE\\n                                 =======\\n\\nJules, my friend, used to take her new\\ncar to Viretta Park. After a workday\\nfilled with tickets and meetings, she\\nsometimes drove the five miles to this\\none-block wide, one-block tall park at\\nthe northeast coast of the city where\\npeople prospered. There, tourists via\\nUbers and Lyfts came to see the Kurt\\nCobain bench. But Jules would arrive at\\nthe park and drive past. She would not\\nstop. She would not get out. You cannot\\nsee the bench from the road. It was\\nusually dark after work. She told no one\\nabout these trips until years later.\\n\\nJules, our protagonist, (as far as she\\ncould figure) had no conscious logic for\\nher actions. Without it the story\\nrefused to hang together. It was a\\nsequence of events united by space and\\ntime but lacking guts hearts or brains.\\nIt was a propulsion without a\\npropellant. It defied narrative\\nstructure and, without it, lacked\\nrhythm. Jules, being a capable\\nself-aware adult, knew she was acting\\nout of an impulse but it seemed to her\\nthat the situation warranted impulse.\\nAnd, at that time and at the time this\\nwas written, gas was cheap. I can safely\\nsay also that she was not sad; she was\\nnot one of those people who indulged in\\nthe habit of moping about events beyond\\ntheir control. Some people are just\\nstrong this way.\\n\\nIn my presence Jules narrated the story\\nwith the blank point of view of an\\nomniscient witness. There was a lull in\\nthe conversation, this story was told,\\nand then we moved on. She wore a thin\\njacket and a wry frown and we were high,\\nmore high than usual. I, after giving it\\nsome consideration, had a grocery list\\nof questions. Why Kurt Cobain; why\\ndidn't you tell me earlier; and did you\\ndo it to feel an impossible, cosmic\\nconnection to something bigger than\\nyourself, a feeling for which I cannot\\ndo justice but can tell you that, for\\nme, is close to the sensation of an\\negg's cracking against the chest\\ncavity's outer wall. But from looking at\\nher I knew then, just as she had always\\nknown, it was not as if there were\\nanswers and she were ignorant of them.\\nThere just were no answers. At the time\\nthese events I am writing about took\\nplace, she was stuck in a temporary city\\nat a temporary time of her life. In my\\ncountry, where you work for years and\\nyears in search of permanent residence\\nstatus and where adults values\\nfriendship but few pursue them, it seems\\nharder than other places to let out\\nthese prickly stories. I imagine people\\nall around me have them, though – yarn\\nwound and knotted by fingers\\nabsentmindedly rubbing the threads\\ntogether.\\n\\nAfter eighteen months, Jules packed up\\nall her furniture and moved away. She\\ndrove all the way through America.\";\n\n}).call(this);\n",
      "type": "blob"
    },
    "style": {
      "path": "style",
      "content": "module.exports = \"body {\\n  color: rgba(0,0,0,0.87);\\n  overflow: hidden;\\n}\\nh1 {\\n  line-height: 1.25em;\\n  margin: 0;\\n}\\nul {\\n  list-style-type: square;\\n  padding-left: 1.25em;\\n}\\ncomments,\\ncomment {\\n  display: block;\\n  padding: 1em;\\n}\\ncomment {\\n  border: 1px solid #000;\\n  margin-bottom: 1em;\\n}\\ncomment:last-child {\\n  margin-bottom: 0;\\n}\\ncomment > .author {\\n  color: #808080;\\n  font-size: 0.75em;\\n  text-align: right;\\n}\\ncomment > .author::before {\\n  content: \\\"-\\\";\\n}\\nmenu {\\n  font-size: 1rem;\\n}\\nbody.drag-active iframe {\\n  pointer-events: none;\\n}\\nbody > button.home {\\n  background-color: rgba(255,255,255,0.5);\\n  bottom: 0;\\n  color: rgba(0,0,0,0.87);\\n  font-size: 2rem;\\n  left: 0;\\n  padding-right: 0.3em;\\n  position: absolute;\\n  transition-duration: 0.125s;\\n  transition-property: background-color, color;\\n  z-index: 1;\\n}\\nbody > button.home:hover {\\n  background-color: rgba(255,255,255,0.75);\\n}\\nbody > button.home:active {\\n  color: #fff;\\n}\\nexplorer {\\n  display: block;\\n  height: 100%;\\n  padding: 0.5em;\\n  user-select: none;\\n  -moz-user-select: none;\\n  -webkit-user-select: none;\\n  -ms-user-select: none;\\n  width: 100%;\\n  z-index: 1;\\n}\\nbody > explorer {\\n  background-image: url(\\\"https://i.imgur.com/hKOGoex.jpg\\\");\\n  background-size: cover;\\n}\\nexplorer > file,\\nexplorer > folder {\\n  display: inline-block;\\n  padding: 0.5em;\\n}\\nexplorer > file > icon,\\nexplorer > folder > icon {\\n  display: block;\\n  height: 32px;\\n  margin: auto;\\n  width: 32px;\\n}\\nexplorer > file > icon {\\n  background-image: url(\\\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3d3dwAAAAj///////////////cAAAAI///////////////3AAAACP///////3d///d39wAAAAj/zMzM//mZ//+Zn/cAAAAI////////l///+X/3AAAACP/MzMzM//l3d3l/9wAAAAj/////////mZmZf/cAAAAI/8zMzMzM//l/+X/3AAAACP//////////l/l/9wAAAAj/zMzMzMzM//l5f/cAAAAI////////////mX/3AAAACP/MzMzMzMzM//n/9wAAAAj///////////////cAAAAI/8zMzMzMzMzMzP/3AAAACP//////////////9wAAAAj/zMzMzMzMzMzM//cAAAAI///////////////3AAAACP8AAAAA/8zMzMz/9wAAAAj/iZD/8P////////cAAAAI/4AAAAD/zMzMzP/3AAAACP+P8Luw////////9wAAAAj/gAC7sP/MzMzM//cAAAAI/4/wu7D////////3AAAACP+P8Luw/////4AAAAAAAAj/j/AAAP////+P94AAAAAI/4/wzMD/////j3gAAAAACP+IiIiA/////4eAAAAAAAj///////////+IAAAAAAAI////////////gAAAAAAACIiIiIiIiIiIiIAAAAAA4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAP4AAAH+AAAD/gAAB/4AAA/+AAAf8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAACHd3d3d3cAAI//////9wAAj8z5//n3AACP//+ZmfcAAI/MzPn59wAAj////5n3AACPzMzM+fcAAI//////9wAAjwAPzMz3AACPmY////cAAI/Pj8zM9wAAj8+P//AAAACPiI//9/gAAI/////3gAAAiIiIiIgAAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIAHAACADwAAgB8AAA==\\\");\\n}\\nexplorer > file[type=\\\"application/briefcase\\\"] > icon {\\n  background-image: url(\\\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACIiIiIiIiIiIiIiIiIiIAAj3d3d3d3d3d3d3d3d3eIAI93d39/f39/f39/f393iICPd3d4eHh4eHh4eHh4d4iAj3d3d3d3d3d3d3d3d3eIgI93d3d//////////3d3iICPd3d/8AAAAAAAAAD/d4iAj3mXeIAAAAAAAAAAiHeIgI95l3iAAAAAAAAAAIh3iICPd3d3eIiIiIiIiIh3d4iAj3d3d3d3d3d3d3d3d3eIgI//////////////////iIAId3d3d3d3d3d3d3d3d3iAAId3d3d3d3d3d3d3d3d3gAAIiIiIiIiIiIiIiIiIiIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////gAAABwAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAADAAAAA4AAAAf////////////////////////////////////////////////////////////////////8oAAAAEAAAACAAAAABAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI+IiIiIiIgAj3d3d3d3eICPd3////d4gI938AAAD3iAj5eAAAAIeICPd3d3d3d4gI////////iACHd3d3d3d4AAiIiIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP//AACAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAADAAQAA//8AAP//AAD//wAA//8AAA==\\\");\\n}\\nexplorer > file[type^=\\\"text/\\\"] > icon {\\n  background-image: url(\\\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3dwcAAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA/////////3BwAAAI//////////////9wcAAACP8AAAD/////////cHAAAAj//////////////3BwAAAI//////////////9wcAAACP8AAAAAAAAAAAD/cHAAAAj//////////////3BwAAAI/wAAAAAAAAAAAP9wcAAACP//////////////cHAAAAj/AAAAAAAAAAAA/3BwAAAI//////////////9wcAAACP8AAAAAAAAAAAD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP8AAAD/////////cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA/////////3BwAAAI//////////////9wcAAACP8AAAD////w8AD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAjw/w/w/w/w/w/w/4BwAAAI8P8P8P8P8P8P8P+AcAAAAI+I+I+I+I+I+I+I+AAAAAAAAAAAAAAAAAAAAAAAAA8AAAH+AAAA/AAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAH4AAAD/JJJL8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAh3d3d3d3AACP//////cAAI//////9wAAj/AAAA/3AACP//////cAAI/wAAAP9wAAj//////3AACP8AAAD/cAAI//////9wAAj/AA8A/3AACP//////cAAI//////9wAAjw8PDw8PAAAA+Pj4+PAAAAAAAAAAAAAAgA8AAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAcAAAAHAACADwAA1V8AAA==\\\");\\n}\\nexplorer > file[type=\\\"application/javascript\\\"] > icon {\\n  background-image: url(\\\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3dwcAAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA////AAD//3BwAAAI////////AwsDAP9wcAAACP8AAAD//zu7uzD/cHAAAAj///////M7MDsAD3BwAAAI///////zuwgLsw9wcAAACP8AAAAAAzswOwAPcHAAAAj///////87u7sw/3BwAAAI/wAAAAAAMwsDAP9wcAAACP////////8zM///cHAAAAj/AAAAAAAAAAAA/3BwAAAI//////////////9wcAAACP8AAAAAAAAAAAD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP8AAAD/////////cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAj/AAAA/////////3BwAAAI//////////////9wcAAACP8AAAD////w8AD/cHAAAAj//////////////3BwAAAI//////////////9wcAAACP//////////////cHAAAAjw/w/w/w/w/w/w/4BwAAAI8P8P8P8P8P8P8P+AcAAAAI+I+I+I+I+I+I+I+AAAAAAAAAAAAAAAAAAAAAAAAA8AAAH+AAAA/AAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAH4AAAD/JJJL8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAACHd3d3d3cAAI//////9wAAj///Aw/3AACP8Ac7MPcAAI//87Cz9wAAj/AHOzD3AACP//9zf/cAAI/wAAAP9wAAj//////3AACP8ADwD/cAAI//////9wAAj//////3AACPDw8PDw8AAAD4+Pj48AAAAAAAAAAAAAwAcAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAADABwAA6q8AAA==\\\");\\n}\\nexplorer > file[path$=\\\"💾\\\"] > icon {\\n  background-image: url(\\\"http://www.myiconfinder.com/uploads/iconsets/256-256-517c80793c96fa23c342ae1a5560ddf6.png\\\");\\n  background-size: cover;\\n  image-rendering: pixelated;\\n}\\nexplorer > folder > icon {\\n  background-image: url(\\\"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDMzMzMzMzMzMzMzMzMzMwj7e3t7e3t7e3t7e3t7e3MI97e3t7e3t7e3t7e3t7ezCPt7e3t7e3t7e3t7e3t7cwj3t7e3t7e3t7e3t7e3t7MI+3t7e3t7e3t7e3t7e3tzCPe3t7e3t7e3t7e3t7e3swj7e3t7e3t7e3t7e3t7e3MI97e3t7e3t7e3t7e3t7ezCPt7e3t7e3t7e3t7e3t7cwj3t7e3t7e3t7e3t7e3t7MI+3t7e3t7e3t7e3t7e3tzCPe3t7e3t7e3t7e3t7e3swj7e3t7e3t7e3t7e3t7e3MI97e3t7e3t7e3t7e3t7ezCPt7e3t7e3t7e3t7e3t7cwj3t7e3t7e3t7e3t7e3t7MI+3t7e3t7e3t7e3t7e3tzCPe3t7e3t7e3t7e3t7e3swj7e3t7e3t7e3t7e3t7e3MI///////////////////wCHd3d3d3d3d4iIiIiIiIgACPt7e3t7e3gAAAAAAAAAAACPt7e3t7eAAAAAAAAAAAAACP/////4AAAAAAAAAAAAAACIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////gAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAP//wAH//+AD///wB/////////////8oAAAAEAAAACAAAAABAAQAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiIiIiIgAj7e3t7e3uACPe3t7e3t4AI+3t7e3t7gAj3t7e3t7eACPt7e3t7e4AI97e3t7e3gAj7e3t7e3uACP///////4AIe3t7eIiIgACHt7eAAAAAAAiIiAAAAAAAAAAAAAAAAA//8AAP//AACAAQCgAAHOAAABzgAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAMAAID/AADB/wAA//8AAA==\\\");\\n}\\n#modal > container {\\n  padding: 1em;\\n}\\nchateau {\\n  width: 100%;\\n  height: 100%;\\n  position: relative;\\n}\\nchateau > word-area {\\n  display: block;\\n  pointer-events: none;\\n  position: absolute;\\n  width: 100%;\\n  height: 100%;\\n}\\nchateau > word-area > words {\\n  border: 1px solid #000;\\n  border-radius: 4px;\\n  background-color: #fff;\\n  padding: 0.5em;\\n  position: absolute;\\n  display: inline-block;\\n}\\nchateau > canvas {\\n  display: block;\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n}\\nchateau > form {\\n  position: absolute;\\n  bottom: 0;\\n}\\nwindow > viewport > chateau {\\n  margin: initial;\\n}\\nwindow > viewport > audio {\\n  width: 100%;\\n}\\nachievement {\\n  color: #fff;\\n  background-color: #00f;\\n  border-radius: 32px;\\n  bottom: -128px;\\n  box-shadow: 2px 2px 10px #000;\\n  display: block;\\n  height: 64px;\\n  left: 0;\\n  margin: auto;\\n  overflow: hidden;\\n  padding: 8px;\\n  position: absolute;\\n  right: 0;\\n  width: 300px;\\n  z-index: 9000;\\n}\\nachievement:after {\\n  animation: slide-left 3s linear 0.75s infinite;\\n  content: \\\"\\\";\\n  background: linear-gradient(50deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0) 40%, rgba(255,255,255,0.95) 50%, rgba(255,255,255,0) 75%, rgba(255,255,255,0) 100%);\\n  height: 100%;\\n  position: absolute;\\n  top: 0;\\n  left: 100%;\\n  width: 100%;\\n}\\nachievement.display {\\n  animation: display-achievement 6s;\\n}\\nachievement > h2 {\\n  font-size: 1.25em;\\n  margin: 0;\\n}\\nachievement > p {\\n  margin-top: 8px;\\n  margin-bottom: 8px;\\n}\\nachievement > icon {\\n  background-color: #fff;\\n  border-radius: 32px;\\n  color: #00f;\\n  display: inline-block;\\n  float: left;\\n  font-size: 35px;\\n  font-family: \\\"Apple Color Emoji\\\", \\\"Segoe UI Emoji\\\", \\\"NotoColorEmoji\\\", \\\"Segoe UI Symbol\\\", \\\"Android Emoji\\\", \\\"EmojiSymbols\\\";\\n  height: 48px;\\n  line-height: 48px;\\n  margin-right: 8px;\\n  text-align: center;\\n  width: 48px;\\n}\\nachievement-badges {\\n  display: block;\\n}\\nachievement-progress {\\n  display: block;\\n}\\nachievement-progress > h2 {\\n  margin-bottom: 4px;\\n}\\nachievement-badge {\\n  background-color: #fff;\\n  border: 1px solid #808080;\\n  color: #808080;\\n  display: inline-block;\\n  font-size: 35px;\\n  font-family: \\\"Apple Color Emoji\\\", \\\"Segoe UI Emoji\\\", \\\"NotoColorEmoji\\\", \\\"Segoe UI Symbol\\\", \\\"Android Emoji\\\", \\\"EmojiSymbols\\\";\\n  height: 48px;\\n  line-height: 48px;\\n  margin-right: 8px;\\n  margin-top: 8px;\\n  text-align: center;\\n  width: 48px;\\n}\\nachievement-badge.achieved {\\n  border: 1px solid #00f;\\n  color: #00f;\\n}\\nversion,\\nsite-url {\\n  color: #fff;\\n  display: block;\\n  font-size: 20px;\\n  font-weight: bold;\\n  pointer-events: none;\\n  position: absolute;\\n  right: 1rem;\\n  text-shadow: 2px 2px 4px #000;\\n  z-index: 1;\\n}\\nversion {\\n  bottom: 1rem;\\n}\\nsite-url {\\n  bottom: 3rem;\\n}\\n@-moz-keyframes display-achievement {\\n  0% {\\n    bottom: -128px;\\n  }\\n  5% {\\n    bottom: 2em;\\n  }\\n  95% {\\n    bottom: 2em;\\n  }\\n  100% {\\n    bottom: -128px;\\n  }\\n}\\n@-webkit-keyframes display-achievement {\\n  0% {\\n    bottom: -128px;\\n  }\\n  5% {\\n    bottom: 2em;\\n  }\\n  95% {\\n    bottom: 2em;\\n  }\\n  100% {\\n    bottom: -128px;\\n  }\\n}\\n@-o-keyframes display-achievement {\\n  0% {\\n    bottom: -128px;\\n  }\\n  5% {\\n    bottom: 2em;\\n  }\\n  95% {\\n    bottom: 2em;\\n  }\\n  100% {\\n    bottom: -128px;\\n  }\\n}\\n@keyframes display-achievement {\\n  0% {\\n    bottom: -128px;\\n  }\\n  5% {\\n    bottom: 2em;\\n  }\\n  95% {\\n    bottom: 2em;\\n  }\\n  100% {\\n    bottom: -128px;\\n  }\\n}\\n@-moz-keyframes slide-left {\\n  0% {\\n    left: 100%;\\n  }\\n  25% {\\n    left: 0;\\n  }\\n  50% {\\n    left: -100%;\\n  }\\n  100% {\\n    left: -100%;\\n  }\\n}\\n@-webkit-keyframes slide-left {\\n  0% {\\n    left: 100%;\\n  }\\n  25% {\\n    left: 0;\\n  }\\n  50% {\\n    left: -100%;\\n  }\\n  100% {\\n    left: -100%;\\n  }\\n}\\n@-o-keyframes slide-left {\\n  0% {\\n    left: 100%;\\n  }\\n  25% {\\n    left: 0;\\n  }\\n  50% {\\n    left: -100%;\\n  }\\n  100% {\\n    left: -100%;\\n  }\\n}\\n@keyframes slide-left {\\n  0% {\\n    left: 100%;\\n  }\\n  25% {\\n    left: 0;\\n  }\\n  50% {\\n    left: -100%;\\n  }\\n  100% {\\n    left: -100%;\\n  }\\n}\\n\";",
      "type": "blob"
    },
    "system": {
      "path": "system",
      "content": "(function() {\n  var Achievement, Ajax, Associations, DexieFS, DexieFSDB, Model, MountFS, SystemModule, Template, UI, endsWith, fileSeparator, invokeBefore, normalizePath, readTree, uniq, _ref;\n\n  _ref = require(\"./util\"), endsWith = _ref.endsWith, fileSeparator = _ref.fileSeparator, normalizePath = _ref.normalizePath, readTree = _ref.readTree;\n\n  DexieFSDB = function(dbName) {\n    var db;\n    if (dbName == null) {\n      dbName = 'fs';\n    }\n    db = new Dexie(dbName);\n    db.version(1).stores({\n      files: 'path, blob, size, type, createdAt, updatedAt'\n    });\n    return db;\n  };\n\n  DexieFS = require(\"./lib/dexie-fs\");\n\n  MountFS = require(\"./lib/mount-fs\");\n\n  uniq = function(array) {\n    return Array.from(new Set(array));\n  };\n\n  Ajax = require(\"ajax\");\n\n  Model = require(\"model\");\n\n  Achievement = require(\"./system/achievement\");\n\n  Associations = require(\"./system/associations\");\n\n  SystemModule = require(\"./system/module\");\n\n  Template = require(\"./system/template\");\n\n  UI = require(\"ui\");\n\n  module.exports = function(dbName) {\n    var fs, self, title, version, _ref1;\n    if (dbName == null) {\n      dbName = 'zine-os';\n    }\n    self = Model();\n    fs = MountFS();\n    fs.mount(\"/\", DexieFS(DexieFSDB(dbName)));\n    self.include(Achievement, Associations, SystemModule, Template);\n    title = require(\"./pixie\").title;\n    _ref1 = title.split('-'), version = _ref1[_ref1.length - 1];\n    self.extend({\n      ajax: Ajax(),\n      fs: fs,\n      version: function() {\n        return version;\n      },\n      require: require,\n      stylus: require(\"./lib/stylus.min\"),\n      moveFile: function(oldPath, newPath) {\n        oldPath = normalizePath(oldPath);\n        newPath = normalizePath(newPath);\n        if (oldPath === newPath) {\n          return Promise.resolve();\n        }\n        return self.copyFile(oldPath, newPath).then(function() {\n          return self.deleteFile(oldPath);\n        });\n      },\n      copyFile: function(oldPath, newPath) {\n        if (oldPath === newPath) {\n          return Promise.resolve();\n        }\n        return self.readFile(oldPath).then(function(blob) {\n          return self.writeFile(newPath, blob);\n        });\n      },\n      moveFileSelection: function(selectionData, destinationPath) {\n        return Promise.resolve().then(function() {\n          var files, sourcePath;\n          sourcePath = selectionData.sourcePath, files = selectionData.files;\n          if (sourcePath === destinationPath) {\n\n          } else {\n            return Promise.all(files.map(function(_arg) {\n              var relativePath;\n              relativePath = _arg.relativePath;\n              if (relativePath.match(/\\/$/)) {\n                return self.readTree(\"\" + sourcePath + relativePath).then(function(files) {\n                  return Promise.all(files.map(function(file) {\n                    var targetPath;\n                    targetPath = file.path.replace(sourcePath, destinationPath);\n                    return self.moveFile(file.path, targetPath);\n                  }));\n                });\n              } else {\n                return self.moveFile(\"\" + sourcePath + relativePath, \"\" + destinationPath + relativePath);\n              }\n            }));\n          }\n        });\n      },\n      readFile: function(path, userEvent) {\n        if (userEvent) {\n          self.Achievement.unlock(\"Load a file\");\n        }\n        path = normalizePath(\"/\" + path);\n        return fs.read(path);\n      },\n      readTree: function(directoryPath) {\n        return readTree(fs, directoryPath);\n      },\n      writeFile: function(path, blob, userEvent) {\n        if (userEvent) {\n          self.Achievement.unlock(\"Save a file\");\n        }\n        path = normalizePath(\"/\" + path);\n        return fs.write(path, blob);\n      },\n      deleteFile: function(path) {\n        path = normalizePath(\"/\" + path);\n        return fs[\"delete\"](path);\n      },\n      updateFile: function(path, changes) {\n        path = normalizePath(\"/\" + path);\n        return fs.update(path, changes);\n      },\n      urlForPath: function(path) {\n        return fs.read(path).then(URL.createObjectURL);\n      },\n      launchIssue: function(date) {\n        return require(\"./issues/\" + date)();\n      },\n      installModulePrompt: function() {\n        return UI.Modal.prompt(\"url\", \"https://danielx.net/editor/master.json\").then(function(url) {\n          var baseName, blobRequest, pathPrompt;\n          if (!url) {\n            throw new Error(\"No url given\");\n          }\n          baseName = url.replace(/^https:\\/\\/(.*)/, \"$1\").replace(/(\\.json)?$/, \"💾\");\n          pathPrompt = UI.Modal.prompt(\"path\", \"/lib/\" + baseName).then(function(path) {\n            if (!path) {\n              throw new Error(\"No path given\");\n            }\n            return path;\n          });\n          blobRequest = fetch(url).then(function(result) {\n            return result.blob();\n          });\n          return Promise.all([blobRequest, pathPrompt]).then(function(_arg) {\n            var blob, path;\n            path = _arg[0], blob = _arg[1];\n            return self.writeFile(path, blob);\n          });\n        });\n      },\n      installModule: function(url, path) {\n        if (path == null) {\n          path = url.replace(/^https:\\/\\/(.*)/, \"/lib/$1\").replace(/(\\.json)?$/, \"💾\");\n        }\n        return fetch(url).then(function(result) {\n          return result.blob();\n        }).then(function(blob) {\n          return self.writeFile(path, blob);\n        });\n      },\n      execJS: function(path) {\n        return self.readFile(path).then(function(file) {\n          return file.readAsText();\n        }).then(function(programText) {\n          return Function(programText)();\n        });\n      },\n      Observable: UI.Observable,\n      UI: UI,\n      dumpModules: function() {\n        var src;\n        src = PACKAGE.source;\n        return Object.keys(src).forEach(function(path) {\n          var blob, file;\n          file = src[path];\n          blob = new Blob([file.content]);\n          return self.writeFile(\"System/\" + path, blob);\n        });\n      },\n      dumpPackage: function() {\n        return self.writeFile(\"System 💾\", JSON.toBlob(PACKAGE));\n      },\n      _appData: null,\n      launchAppByAppData: function(datum, path) {\n        var app, height, icon, name, src, width;\n        name = datum.name, icon = datum.icon, width = datum.width, height = datum.height, src = datum.src;\n        app = self.iframeApp({\n          title: name,\n          emojiIcon: icon,\n          width: width,\n          height: height,\n          src: src\n        });\n        if (path) {\n          self.readFile(path).then(function(blob) {\n            return app.loadFile(blob, path);\n          });\n        }\n        return self.attachApplication(app);\n      },\n      launchAppByName: function(name, path) {\n        var datum;\n        datum = self._appData.filter(function(datum) {\n          return datum.name === name;\n        })[0];\n        if (datum) {\n          return self.launchAppByAppData(datum, path);\n        }\n      },\n      initAppSettings: function() {\n        return self.readFile(\"System/apps.json\").then(function(blob) {\n          if (blob) {\n            return blob.readAsJSON();\n          } else {\n            return [];\n          }\n        }).then(function(data) {\n          self._appData = data;\n          return data.forEach(function(datum) {\n            self.installAppHandler(datum);\n            if (datum.launchAtStartup) {\n              return launchAppByAppData(datum);\n            }\n          });\n        });\n      },\n      removeApp: function(name, noPersist) {\n        self._appData = (self._appData || []).filter(function(datum) {\n          if (datum.name !== name) {\n            return true;\n          } else {\n            self.removeHandler(datum.handler);\n            return false;\n          }\n        });\n        if (!noPersist) {\n          return self.writeFile(\"System/apps.json\", JSON.toBlob(self._appData));\n        }\n      },\n      installApp: function(appData) {\n        console.log(\"install\", appData);\n        self.removeApp(appData.name, true);\n        self._appData = self._appData.concat([appData]);\n        self.installAppHandler(appData);\n        return self.writeFile(\"System/apps.json\", JSON.toBlob(self._appData));\n      },\n      installAppHandler: function(datum) {\n        var associations, name;\n        name = datum.name, associations = datum.associations;\n        associations = [].concat(associations || []);\n        datum.handler = {\n          name: name,\n          filter: function(_arg) {\n            var path;\n            path = _arg.path;\n            return associations.some(function(association) {\n              return endsWith(path, association);\n            });\n          },\n          fn: function(file) {\n            return self.launchAppByName(name, file != null ? file.path : void 0);\n          }\n        };\n        return self.registerHandler(datum.handler);\n      }\n    });\n    invokeBefore(UI.Modal, \"hide\", function() {\n      return self.Achievement.unlock(\"Dismiss modal\");\n    });\n    return self;\n  };\n\n  invokeBefore = function(receiver, method, fn) {\n    var oldFn;\n    oldFn = receiver[method];\n    return receiver[method] = function() {\n      fn();\n      return oldFn.apply(receiver, arguments);\n    };\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "system/achievement": {
      "path": "system/achievement",
      "content": "(function() {\n  var Achievement, AchievementProgressPresenter, Observable, UI, achievementData, emptyElement, groupBy, persist, restore;\n\n  Achievement = require(\"../lib/achievement\");\n\n  Observable = (UI = require(\"ui\")).Observable;\n\n  emptyElement = require(\"../util\").emptyElement;\n\n  achievementData = [\n    {\n      text: \"Issue 1\",\n      icon: \"📰\",\n      group: \"Issue 1\",\n      description: \"View Issue 1\"\n    }, {\n      text: \"Cover-2-cover\",\n      icon: \"📗\",\n      group: \"Issue 1\",\n      description: \"Read the entire issue\"\n    }, {\n      text: \"No rush\",\n      icon: \"⏳\",\n      group: \"Issue 1\",\n      description: \"Patience is a virtue\"\n    }, {\n      text: \"Issue 2\",\n      icon: \"📰\",\n      group: \"Issue 2\",\n      description: \"View Issue 2\"\n    }, {\n      text: \"Lol wut\",\n      icon: \"😂\",\n      group: \"Issue 2\",\n      description: \"Did you know Windows Vista had a magazine?\"\n    }, {\n      text: \"Cover-2-cover 2: 2 cover 2 furious\",\n      icon: \"📗\",\n      group: \"Issue 2\",\n      description: \"Read the entire issue\"\n    }, {\n      text: \"Feeling the frog\",\n      icon: \"🐸\",\n      group: \"Issue 2\",\n      description: \"Visit frogfeels.com\"\n    }, {\n      text: \"The dungeon is in our heart\",\n      icon: \"😭\",\n      group: \"Issue 2\",\n      description: \"Played dungeon of sadness\"\n    }, {\n      text: \"Issue 3\",\n      icon: \"📰\",\n      group: \"Issue 3\",\n      description: \"View Issue 3\"\n    }, {\n      text: \"Cover-2-cover 3: Tokyo Drift\",\n      icon: \"📗\",\n      group: \"Issue 3\",\n      description: \"Read the entire issue\"\n    }, {\n      text: \"Blue light special\",\n      icon: \"🈹\",\n      group: \"Issue 3\",\n      description: \"Read 'Blue Light Special'\"\n    }, {\n      text: \"Issue 4\",\n      icon: \"📰\",\n      group: \"Issue 4\",\n      description: \"View Issue 4\"\n    }, {\n      text: \"Cover-2-cover 4: Fast & Furious\",\n      icon: \"📗\",\n      group: \"Issue 4\",\n      description: \"Read the entire issue\"\n    }, {\n      text: \"Izzy\",\n      icon: \"🈹\",\n      group: \"Issue 4\",\n      description: \"Read 'Izzy'\"\n    }, {\n      text: \"Residue\",\n      icon: \"🈹\",\n      group: \"Issue 4\",\n      description: \"Read 'Residue'\"\n    }, {\n      text: \"Issue 5\",\n      icon: \"📰\",\n      group: \"Issue 5\",\n      description: \"View Issue 5\"\n    }, {\n      text: \"Issue 6\",\n      icon: \"🐝\",\n      group: \"Issue 6\",\n      description: \"View Issue 6\"\n    }, {\n      text: \"Bee afraid\",\n      icon: \"🐝\",\n      group: \"Issue 6\",\n      description: \"Learn the truth about 'Bee Movie'\"\n    }, {\n      text: \"Tree story\",\n      icon: \"🐝\",\n      group: \"Issue 6\",\n      description: \"Read Tree\"\n    }, {\n      text: \"Notepad.exe\",\n      icon: \"📝\",\n      group: \"App\",\n      description: \"Launch a text editor\"\n    }, {\n      text: \"Pump up the jam\",\n      icon: \"🎶\",\n      group: \"App\",\n      description: \"Launch audio application\"\n    }, {\n      text: \"Microsoft Access 97\",\n      icon: \"🔞\",\n      group: \"App\",\n      description: \"Launch a spreadsheet application\"\n    }, {\n      text: \"Look at that\",\n      icon: \"🖼️\",\n      group: \"App\",\n      description: \"Open the image viewer\"\n    }, {\n      text: \"Pixel perfect\",\n      icon: \"◼️️\",\n      group: \"App\",\n      description: \"Open the pixel editor\"\n    }, {\n      text: \"Check yo' self\",\n      icon: \"😉\",\n      group: \"App\",\n      description: \"Check your achievement status\"\n    }, {\n      text: \"Oh no, my files!\",\n      icon: \"💼\",\n      group: \"App\",\n      description: \"Opened 'My Briefcase'\"\n    }, {\n      text: \"Save a file\",\n      icon: \"💾\",\n      group: \"OS\",\n      description: \"Write to the file system\"\n    }, {\n      text: \"Load a file\",\n      icon: \"💽\",\n      group: \"OS\",\n      description: \"Read from the file system\"\n    }, {\n      text: \"Execute code\",\n      icon: \"🖥️\",\n      group: \"OS\",\n      description: \"Some people like to live dangerously\"\n    }, {\n      text: \"Dismiss modal\",\n      icon: \"💃\",\n      group: \"OS\",\n      description: \"Dismiss a modal without even reading it\"\n    }, {\n      text: \"I AM ERROR\",\n      icon: \"🐛\",\n      group: \"OS\",\n      description: \"Encountered a JavaScript error\"\n    }, {\n      text: \"Shut Down\",\n      icon: \"🔌\",\n      group: \"OS\",\n      description: \"ZineOS cannot be stopped\"\n    }, {\n      text: \"Do you 'like' like me?\",\n      icon: \"💕\",\n      group: \"Social\",\n      description: \"Have fine taste\"\n    }, {\n      text: \"We value your input\",\n      icon: \"📩\",\n      group: \"Social\",\n      description: \"View feedback form\"\n    }, {\n      text: \"Enter the Chateau\",\n      icon: \"🏡\",\n      group: \"Chateau\",\n      description: \"Enter the Chateau\"\n    }, {\n      text: \"Puttin' on the Ritz\",\n      icon: \"🐭\",\n      group: \"Chateau\",\n      description: \"Upload custom avatar\"\n    }, {\n      text: \"Paint the town red\",\n      icon: \"🌆\",\n      group: \"Chateau\",\n      description: \"Upload a custom background\"\n    }, {\n      text: \"Poutine on the Ritz\",\n      icon: \"🍘\",\n      group: \"Chateau\",\n      description: \"Put poutine on a Ritz cracker\"\n    }, {\n      text: \"It's in the cloud\",\n      icon: \"☁️️\",\n      group: \"Chateau\",\n      description: \"Upload a file\"\n    }, {\n      text: \"Rawr\",\n      icon: \"🐉\",\n      group: \"Contrasaurus\",\n      description: \"Played Contrasaurus\"\n    }\n  ];\n\n  restore = function() {\n    var storedAchieved, storedCheevos;\n    storedCheevos = [];\n    try {\n      storedCheevos = JSON.parse(localStorage.cheevos);\n    } catch (_error) {}\n    storedAchieved = {};\n    storedCheevos.forEach(function(_arg) {\n      var achieved, text;\n      achieved = _arg.achieved, text = _arg.text;\n      return storedAchieved[text] = achieved;\n    });\n    return achievementData.forEach(function(cheevo) {\n      var text;\n      text = cheevo.text;\n      if (storedAchieved[text]) {\n        return cheevo.achieved = true;\n      }\n    });\n  };\n\n  persist = function() {\n    return localStorage.cheevos = JSON.stringify(achievementData);\n  };\n\n  AchievementProgressPresenter = require(\"../presenters/achievement-group-progress\");\n\n  groupBy = function(xs, key) {\n    return xs.reduce(function(rv, x) {\n      var _name;\n      (rv[_name = x[key]] != null ? rv[_name] : rv[_name] = []).push(x);\n      return rv;\n    }, {});\n  };\n\n  module.exports = function(I, self) {\n    var updateStatus;\n    restore();\n    Object.assign(self, {\n      Achievement: {\n        groupData: Observable({}),\n        unlock: function(name) {\n          var opts;\n          opts = achievementData.find(function(_arg) {\n            var text;\n            text = _arg.text;\n            return text === name;\n          });\n          if (opts && !opts.achieved) {\n            opts.achieved = true;\n            persist();\n            updateStatus();\n            return Achievement.display(opts);\n          }\n        },\n        progressView: function() {\n          var content;\n          content = document.createElement(\"content\");\n          Observable(function() {\n            var data, elements;\n            data = self.Achievement.groupData();\n            elements = Object.keys(data).map(function(group) {\n              return AchievementProgressPresenter({\n                name: group,\n                achievements: data[group]\n              });\n            });\n            emptyElement(content);\n            return elements.forEach(function(element) {\n              return content.appendChild(element);\n            });\n          });\n          return content;\n        }\n      }\n    });\n    updateStatus = function() {\n      return self.Achievement.groupData(groupBy(achievementData, \"group\"));\n    };\n    updateStatus();\n    return self;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "system/associations": {
      "path": "system/associations",
      "content": "(function() {\n  var AppDrop, AudioBro, CodeEditor, DSad, Explorer, Filter, Markdown, MyBriefcase, Notepad, PixelEditor, PkgFS, Spreadsheet, extensionFor, openWith;\n\n  AppDrop = require(\"../lib/app-drop\");\n\n  AudioBro = require(\"../apps/audio-bro\");\n\n  Filter = require(\"../apps/filter\");\n\n  Notepad = require(\"../apps/notepad\");\n\n  CodeEditor = require(\"../apps/text-editor\");\n\n  Explorer = require(\"../apps/explorer\");\n\n  Spreadsheet = require(\"../apps/spreadsheet\");\n\n  PixelEditor = require(\"../apps/pixel\");\n\n  Markdown = require(\"../apps/markdown\");\n\n  DSad = require(\"../apps/dungeon-of-sadness\");\n\n  MyBriefcase = require(\"../apps/my-briefcase\");\n\n  PkgFS = require(\"../lib/pkg-fs\");\n\n  extensionFor = require(\"../util\").extensionFor;\n\n  openWith = function(App) {\n    return function(file) {\n      var app, path;\n      app = App();\n      if (file) {\n        path = file.path;\n        system.readFile(path).then(function(blob) {\n          return app.loadFile(blob, path);\n        });\n      }\n      return system.attachApplication(app);\n    };\n  };\n\n  module.exports = function(I, self) {\n    var handle, handlers, mimes;\n    handlers = [\n      {\n        name: \"Markdown\",\n        filter: function(file) {\n          return file.path.match(/\\.md$/) || file.path.match(/\\.html$/);\n        },\n        fn: openWith(Markdown)\n      }, {\n        name: \"Run\",\n        filter: function(file) {\n          return file.type === \"application/javascript\" || file.path.match(/\\.js$/) || file.path.match(/\\.coffee$/);\n        },\n        fn: function(file) {\n          return self.executeInIFrame(file.path);\n        }\n      }, {\n        name: \"Exec\",\n        filter: function(file) {\n          return file.type === \"application/javascript\" || file.path.match(/\\.js$/) || file.path.match(/\\.coffee$/);\n        },\n        fn: function(file) {\n          return self.execute(file.path);\n        }\n      }, {\n        name: \"Explore\",\n        filter: function(file) {\n          return file.path.match(/💾$/) || file.path.match(/\\.json$/);\n        },\n        fn: function(file) {\n          return system.readFile(file.path).then(function(blob) {\n            return blob.readAsJSON();\n          }).then(function(pkg) {\n            var element, fs, mountPath, windowView;\n            mountPath = file.path + \"/\";\n            fs = PkgFS(pkg, file.path);\n            system.fs.mount(mountPath, fs);\n            element = Explorer({\n              path: mountPath\n            });\n            windowView = system.UI.Window({\n              title: mountPath,\n              content: element,\n              menuBar: null,\n              width: 640,\n              height: 480,\n              iconEmoji: \"📂\"\n            });\n            return document.body.appendChild(windowView.element);\n          });\n        }\n      }, {\n        name: \"Ace Editor\",\n        filter: function(file) {\n          return file.path.match(/\\.coffee$/) || file.path.match(/\\.cson$/) || file.path.match(/\\.html$/) || file.path.match(/\\.jadelet$/) || file.path.match(/\\.js$/) || file.path.match(/\\.json$/) || file.path.match(/\\.md$/) || file.path.match(/\\.styl$/);\n        },\n        fn: openWith(CodeEditor)\n      }, {\n        name: \"Run\",\n        filter: function(file) {\n          return file.path.match(/💾$/);\n        },\n        fn: function(file) {\n          return system.execPathWithFile(file.path, null);\n        }\n      }, {\n        name: \"Publish\",\n        filter: function(file) {\n          return file.path.match(/💾$/);\n        },\n        fn: function(file) {\n          return system.readFile(file.path).then(function(blob) {\n            return blob.readAsJSON();\n          }).then(function(pkg) {\n            return system.UI.Modal.prompt(\"Path\", \"/My Briefcase/public/somefolder\").then(function(path) {\n              var blob;\n              blob = new Blob([system.htmlForPackage(pkg)], {\n                type: \"text/html; charset=utf-8\"\n              });\n              return system.writeFile(path + \"/index.html\", blob);\n            });\n          });\n        }\n      }, {\n        name: \"Run Link\",\n        filter: function(file) {\n          return file.path.match(/🔗$|\\.link$/);\n        },\n        fn: function(file) {\n          return system.execPathWithFile(file.path, null);\n        }\n      }, {\n        name: \"Edit Link\",\n        filter: function(file) {\n          return file.path.match(/🔗$|\\.link$/);\n        },\n        fn: openWith(CodeEditor)\n      }, {\n        name: \"Sys Exec\",\n        filter: function(file) {\n          return false;\n          return file.type === \"application/javascript\" || file.path.match(/\\.js$/) || file.path.match(/\\.coffee$/);\n        },\n        fn: function(file) {\n          return self.execute(file.path);\n        }\n      }, {\n        name: \"Notepad\",\n        filter: function(file) {\n          return file.type.match(/^text\\//) || file.type.match(/^application\\/javascript/);\n        },\n        fn: openWith(Notepad)\n      }, {\n        name: \"Spreadsheet\",\n        filter: function(file) {\n          return file.type.match(/^application\\/json/);\n        },\n        fn: openWith(Spreadsheet)\n      }, {\n        name: \"Image Viewer\",\n        filter: function(file) {\n          return file.type.match(/^image\\//);\n        },\n        fn: openWith(Filter)\n      }, {\n        name: \"Pixel Editor\",\n        filter: function(file) {\n          return file.type.match(/^image\\//);\n        },\n        fn: openWith(PixelEditor)\n      }, {\n        name: \"PDF Viewer\",\n        filter: function(file) {\n          return file.path.match(/\\.pdf$/);\n        },\n        fn: function(file) {\n          return file.blob.getURL().then(function(url) {\n            var app;\n            app = system.iframeApp({\n              src: url,\n              title: file.path\n            });\n            return system.attachApplication(app);\n          });\n        }\n      }, {\n        name: \"Audio Bro\",\n        filter: function(file) {\n          return file.type.match(/^audio\\//);\n        },\n        fn: openWith(AudioBro)\n      }, {\n        name: \"dsad.exe\",\n        filter: function(file) {\n          return file.path.match(/dsad\\.exe$/);\n        },\n        fn: function() {\n          var app;\n          app = DSad();\n          return system.attachApplication(app);\n        }\n      }, {\n        name: \"zine1.exe\",\n        filter: function(file) {\n          return file.path.match(/zine1\\.exe$/);\n        },\n        fn: function() {\n          return require(\"../issues/2016-12\")();\n        }\n      }, {\n        name: \"zine2.exe\",\n        filter: function(file) {\n          return file.path.match(/zine2\\.exe$/);\n        },\n        fn: function() {\n          return require(\"../issues/2017-02\")();\n        }\n      }, {\n        name: \"zine3.exe\",\n        filter: function(file) {\n          return file.path.match(/zine3\\.exe$/);\n        },\n        fn: function() {\n          return require(\"../issues/2017-03\")();\n        }\n      }, {\n        name: \"zine4.exe\",\n        filter: function(file) {\n          return file.path.match(/zine4\\.exe$/);\n        },\n        fn: function() {\n          return require(\"../issues/2017-04\")();\n        }\n      }, {\n        name: \"feedback.exe\",\n        filter: function(file) {\n          return file.path.match(/feedback\\.exe$/);\n        },\n        fn: function() {\n          return require(\"../feedback\")();\n        }\n      }, {\n        name: \"My Briefcase\",\n        filter: function(_arg) {\n          var path;\n          path = _arg.path;\n          return path.match(/My Briefcase$/);\n        },\n        fn: function() {\n          var app;\n          app = MyBriefcase();\n          return system.attachApplication(app);\n        }\n      }\n    ];\n    handle = function(file) {\n      var handler;\n      handler = handlers.find(function(_arg) {\n        var filter;\n        filter = _arg.filter;\n        return filter(file);\n      });\n      if (handler) {\n        return handler.fn(file);\n      } else {\n        throw new Error(\"No handler for files of type \" + file.type);\n      }\n    };\n    mimes = {\n      html: \"text/html\",\n      js: \"application/javascript\",\n      json: \"application/json\",\n      md: \"text/markdown\"\n    };\n    Object.assign(self, {\n      iframeApp: require(\"../lib/iframe-app\"),\n      open: function(file) {\n        return handle(file);\n      },\n      openPath: function(path) {\n        return self.readFile(path).then(self.open);\n      },\n      openersFor: function(file) {\n        return handlers.filter(function(handler) {\n          return handler.filter(file);\n        });\n      },\n      registerHandler: function(handler, position) {\n        if (position == null) {\n          position = 0;\n        }\n        return handlers.splice(position, 0, handler);\n      },\n      removeHandler: function(handler) {\n        var position;\n        position = handlers.indexOf(handler);\n        if (position >= 0) {\n          handlers.splice(position, 1);\n          return handler;\n        }\n      },\n      handlers: function() {\n        return handlers.slice();\n      },\n      attachApplication: function(app, options) {\n        if (options == null) {\n          options = {};\n        }\n        AppDrop(app);\n        return document.body.appendChild(app.element);\n      },\n      pathAsApp: function(path) {\n        if (path.match(/💾$/)) {\n          return system.readFile(path).then(function(blob) {\n            return blob.readAsJSON();\n          }).then(function(pkg) {\n            return function() {\n              return self.executePackageInIFrame(pkg);\n            };\n          });\n        } else if (path.match(/🔗$|\\.link$/)) {\n          return system.readFile(path).then(function(blob) {\n            return blob.readAsText();\n          }).then(system.evalCSON).then(function(data) {\n            return function() {\n              return system.iframeApp(data);\n            };\n          });\n        } else if (path.match(/\\.js$|\\.coffee$/)) {\n          return self.packageProgram(path).then(function(pkg) {\n            return function() {\n              return self.executePackageInIFrame(pkg);\n            };\n          });\n        } else {\n          return Promise.reject(new Error(\"Could not launch \" + path));\n        }\n      },\n      execPathWithFile: function(path, file) {\n        return self.pathAsApp(path).then(function(App) {\n          return openWith(App)(file);\n        });\n      },\n      mimeTypeFor: function(path) {\n        return mimes[extensionFor(path)] || \"text/plain\";\n      }\n    });\n    return self;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "system/module": {
      "path": "system/module",
      "content": "(function() {\n  var IFrameApp, Jadelet, absolutizePath, annotateSourceURL, compilers, evalCSON, fileSeparator, htmlForPackage, isAbsolutePath, isRelativePath, normalizePath, stringifyExport, _ref,\n    __slice = [].slice;\n\n  IFrameApp = require(\"../lib/iframe-app\");\n\n  _ref = require(\"../util\"), absolutizePath = _ref.absolutizePath, evalCSON = _ref.evalCSON, fileSeparator = _ref.fileSeparator, normalizePath = _ref.normalizePath, isAbsolutePath = _ref.isAbsolutePath, isRelativePath = _ref.isRelativePath, htmlForPackage = _ref.htmlForPackage;\n\n  Jadelet = require(\"../lib/jadelet.min\");\n\n  module.exports = function(I, self) {\n\n    /*\n    Load a module from a file in the file system.\n    \n    Additional properties such as a reference to the global object and some metadata\n    are exposed.\n    \n    Returns a promise that is fulfilled when the module assigns its exports, or\n    rejected on error.\n    \n    Caches modules so mutual includes don't get re-run per include root.\n    \n    Circular includes will never reslove\n     * TODO: Fail early on circular includes, challenging because of async\n    \n     * Currently can require\n     * js, coffee, jadelet, json, cson\n    \n     * Requiring other file types returns a Blob\n     */\n    var findDependencies, loadModule, rewriteRequires;\n    findDependencies = function(sourceProgram) {\n      var count, match, requireMatcher, results;\n      requireMatcher = /[^.]require\\(['\"]([^'\"]+)['\"]\\)/g;\n      results = [];\n      count = 0;\n      while (true) {\n        match = requireMatcher.exec(sourceProgram);\n        if (match) {\n          results.push(match[1]);\n        } else {\n          break;\n        }\n        count += 1;\n        if (count > 256) {\n          break;\n        }\n      }\n      return results;\n    };\n    rewriteRequires = function(program) {\n      var id, namePrefix, requirePaths, requires, rewrittenProgram, tmpVars;\n      id = 0;\n      namePrefix = \"__req\";\n      requires = {};\n      rewrittenProgram = program.replace(/[^.]require\\(['\"]([^'\"]+)['\"]\\)/g, function(match, key) {\n        var tmpVar;\n        if (requires[key]) {\n          tmpVar = requires[key];\n        } else {\n          tmpVar = \"\" + namePrefix + id;\n          id += 1;\n          requires[key] = tmpVar;\n        }\n        return tmpVar;\n      });\n      tmpVars = Object.keys(requires).map(function(name) {\n        return requires[name];\n      });\n      requirePaths = Object.keys(requires);\n      requirePaths = requirePaths;\n      return \"return system.vivifyPrograms(\" + (JSON.stringify(requirePaths)) + \")\\n.then(function(__reqResults) {\\n(function(\" + (tmpVars.join(', ')) + \"){\\n\" + rewrittenProgram + \"\\n}).apply(this, __reqResults);\\n});\";\n    };\n    loadModule = function(content, path, state) {\n      return new Promise(function(resolve, reject) {\n        var args, context, dirname, exports, hasExports, localSystem, module, program, values;\n        program = annotateSourceURL(rewriteRequires(content), path);\n        dirname = path.split(fileSeparator).slice(0, -1).join(fileSeparator) || fileSeparator;\n        module = {\n          path: dirname\n        };\n        exports = {};\n        Object.defineProperty(module, \"exports\", {\n          get: function() {\n            return exports;\n          },\n          set: function(newValue) {\n            exports = newValue;\n            return resolve(module);\n          }\n        });\n        localSystem = Object.assign({}, self, {\n          vivifyPrograms: function(moduleIdentifiers) {\n            var absoluteIdentifiers;\n            absoluteIdentifiers = moduleIdentifiers.map(function(identifier) {\n              if (isAbsolutePath(identifier)) {\n                return absolutizePath(\"/\", identifier);\n              } else if (isRelativePath(identifier)) {\n                return absolutizePath(dirname, identifier);\n              } else {\n                return identifier;\n              }\n            });\n            return self.vivifyPrograms(absoluteIdentifiers, state);\n          }\n        });\n        context = {\n          system: localSystem,\n          global: global,\n          module: module,\n          exports: module.exports,\n          __filename: path,\n          __dirname: dirname\n        };\n        args = Object.keys(context);\n        values = args.map(function(name) {\n          return context[name];\n        });\n        Promise.resolve().then(function() {\n          return Function.apply(null, __slice.call(args).concat([program])).apply(module, values);\n        })[\"catch\"](reject);\n        hasExports = program.match(/module\\.exports/);\n        if (!hasExports) {\n          return setTimeout(function() {\n            return resolve(module);\n          }, 0);\n        }\n      });\n    };\n    return Object.assign(self, {\n      autoboot: function() {\n        return self.fs.list(\"/System/Boot/\").then(function(files) {\n          var bootablePaths;\n          bootablePaths = files.filter(function(_arg) {\n            var blob;\n            blob = _arg.blob;\n            return blob != null;\n          }).map(function(_arg) {\n            var path;\n            path = _arg.path;\n            return path;\n          });\n          return self.vivifyPrograms(bootablePaths);\n        });\n      },\n      createPackageFromPixie: function(pixiePath) {\n        var basePath, pkg, _ref1;\n        basePath = ((_ref1 = pixiePath.match(/^.*\\//)) != null ? _ref1[0] : void 0) || \"\";\n        pkg = {\n          distribution: {}\n        };\n        return self.loadProgram(pixiePath).then(function(config) {\n          return pkg.config = config;\n        }).then(function() {\n          return self.readTree(basePath);\n        }).then(function(files) {\n          return Promise.all(files.map(function(_arg) {\n            var blob, path;\n            path = _arg.path, blob = _arg.blob;\n            return (blob instanceof Blob ? self.compileFile(blob) : self.readFile(path).then(self.compileFile)).then(function(result) {\n              return [path, result];\n            });\n          })).then(function(results) {\n            results.forEach(function(_arg) {\n              var path, pkgPath, result;\n              path = _arg[0], result = _arg[1];\n              pkgPath = path.replace(basePath, \"\").replace(/\\.[^.]*$/, \"\");\n              if (typeof result === \"string\") {\n                return pkg.distribution[pkgPath] = {\n                  content: result\n                };\n              } else {\n                return console.warn(\"Can't package files like \" + path + \" yet\");\n              }\n            });\n            return pkg;\n          });\n        });\n      },\n      packageProgram: function(absolutePath, state) {\n        var basePath, configPath, pkg, pkgPath, _ref1;\n        if (state == null) {\n          state = {};\n        }\n        state.cache = {};\n        state.pkg = {};\n        basePath = ((_ref1 = absolutePath.match(/^.*\\//)) != null ? _ref1[0] : void 0) || \"\";\n        state.basePath = basePath;\n        state.pkgPath = function(path) {\n          return path.replace(state.basePath, \"\").replace(/\\.[^.]*$/, \"\");\n        };\n        pkgPath = state.pkgPath(absolutePath);\n        pkg = state.pkg;\n        if (pkg.distribution == null) {\n          pkg.distribution = {};\n        }\n        if (!state.loadConfigPromise) {\n          configPath = absolutizePath(basePath, \"pixie.cson\");\n          state.loadConfigPromise = self.loadProgram(configPath).then(function(configSource) {\n            var module;\n            module = {};\n            Function(\"module\", configSource)(module);\n            return module.exports;\n          }).then(function(config) {\n            var entryPoint, path;\n            entryPoint = config.entryPoint;\n            return (entryPoint ? (path = absolutizePath(basePath, entryPoint), self.loadProgramIntoPackage(path, state)) : Promise.resolve()).then(function() {\n              debugger;\n              pkg.remoteDependencies = config.remoteDependencies;\n              return pkg.config = config;\n            });\n          })[\"catch\"](function(e) {\n            if (e.message.match(/File not found/i)) {\n              return pkg.config = {};\n            } else {\n              throw e;\n            }\n          });\n        }\n        return self.loadProgramIntoPackage(absolutePath, state).then(function() {\n          return state.loadConfigPromise;\n        }).then(function() {\n          pkg.remoteDependencies = pkg.config.remoteDependencies;\n          if (pkg.config.entryPoint) {\n            pkg.entryPoint = pkg.config.entryPoint;\n          } else {\n            if (pkg.entryPoint == null) {\n              pkg.entryPoint = pkgPath;\n            }\n          }\n          return pkg;\n        });\n      },\n      loadProgramIntoPackage: function(absolutePath, state) {\n        var basePath, pkg, pkgPath, relativeRoot, _base;\n        basePath = state.basePath, pkg = state.pkg;\n        pkgPath = state.pkgPath(absolutePath);\n        relativeRoot = absolutePath.replace(/\\/[^/]*$/, \"\");\n        return (_base = state.cache)[absolutePath] != null ? _base[absolutePath] : _base[absolutePath] = self.loadProgram(absolutePath).then(function(sourceProgram) {\n          var depPaths;\n          if (typeof sourceProgram === \"string\") {\n            pkg.distribution[pkgPath] = {\n              content: sourceProgram\n            };\n            depPaths = findDependencies(sourceProgram);\n            return Promise.all(depPaths.map(function(depPath) {\n              return Promise.resolve().then(function() {\n                var depPkg, path;\n                if (isRelativePath(depPath)) {\n                  path = absolutizePath(relativeRoot, depPath);\n                  return self.loadProgramIntoPackage(path, state);\n                } else if (isAbsolutePath(depPath)) {\n                  throw new Error(\"Absolute paths not supported yet\");\n                } else {\n                  depPkg = PACKAGE.dependencies[depPath];\n                  if (depPkg) {\n                    if (pkg.dependencies == null) {\n                      pkg.dependencies = {};\n                    }\n                    return pkg.dependencies[depPath] = depPkg;\n                  } else {\n                    throw new Error(\"Package '\" + depPath + \"' not found\");\n                  }\n                }\n              });\n            }));\n          } else {\n            throw new Error(\"TODO: Can't package files like \" + absolutePath + \" yet\");\n          }\n        });\n      },\n      vivifyPrograms: function(absolutePaths, state) {\n        if (state == null) {\n          state = {};\n        }\n        if (state.cache == null) {\n          state.cache = {};\n        }\n        return Promise.all(absolutePaths.map(function(absolutePath) {\n          var _base;\n          return (_base = state.cache)[absolutePath] != null ? _base[absolutePath] : _base[absolutePath] = self.loadProgram(absolutePath).then(function(sourceProgram) {\n            if (typeof sourceProgram === \"string\") {\n              return loadModule(sourceProgram, absolutePath, state);\n            } else {\n              return {\n                exports: sourceProgram\n              };\n            }\n          }).then(function(module) {\n            return module.exports;\n          });\n        }));\n      },\n      loadProgram: function(path, basePath) {\n        if (basePath == null) {\n          basePath = \"/\";\n        }\n        return self.readForRequire(path, basePath).then(self.compileFile);\n      },\n      compileFile: function(file) {\n        var compiler;\n        if (!(file instanceof Blob)) {\n          return file;\n        }\n        compiler = compilers.filter(function(_arg) {\n          var filter;\n          filter = _arg.filter;\n          return filter(file);\n        })[0];\n        if (compiler) {\n          return compiler.fn(file);\n        } else {\n          return file;\n        }\n      },\n      loadModule: function() {\n        var args;\n        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        self.Achievement.unlock(\"Execute code\");\n        return loadModule.apply(null, args);\n      },\n      spawn: function() {\n        var args;\n        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        return loadModule.apply(null, args).then(function(_arg) {\n          var exports, result;\n          exports = _arg.exports;\n          if (typeof exports === \"function\" && exports.length === 0) {\n            result = exports();\n            if (result.element) {\n              return document.body.appendChild(result.element);\n            }\n          }\n        });\n      },\n      execute: function(absolutePath) {\n        return self.vivifyPrograms([absolutePath]).then(function(_arg) {\n          var exports, result;\n          exports = _arg[0].exports;\n          if (typeof exports === \"function\" && exports.length === 0) {\n            result = exports();\n            if (result.element) {\n              return document.body.appendChild(result.element);\n            }\n          }\n        });\n      },\n      executeInIFrame: function(absolutePath) {\n        return self.packageProgram(absolutePath).then(function(pkg) {\n          return self.executePackageInIFrame(pkg);\n        });\n      },\n      executePackageInIFrame: function(pkg) {\n        var app, _ref1;\n        app = IFrameApp({\n          pkg: pkg,\n          title: (_ref1 = pkg.config) != null ? _ref1.title : void 0,\n          packageOptions: {\n            script: \"var ZINEOS = \" + (JSON.stringify(system.version())) + \";\\n\" + PACKAGE.distribution[\"lib/system-client\"].content + \";\"\n          },\n          sandbox: \"allow-scripts allow-forms\"\n        });\n        document.body.appendChild(app.element);\n        return app;\n      },\n      readForRequire: function(path, basePath) {\n        var absolutePath, isModule, p, suffixes;\n        isModule = !path.match(/^.?.?\\//);\n        if (isModule) {\n          return Promise.resolve().then(function() {\n            return require(path);\n          });\n        }\n        absolutePath = absolutizePath(basePath, path);\n        suffixes = [\"\", \".coffee\", \".coffee.md\", \".litcoffee\", \".jadelet\", \".js\", \".styl\"];\n        p = suffixes.reduce(function(promise, suffix) {\n          return promise.then(function(file) {\n            var filePath;\n            if (file) {\n              return file;\n            }\n            filePath = \"\" + absolutePath + suffix;\n            return self.readFile(filePath)[\"catch\"](function() {});\n          });\n        }, Promise.resolve());\n        return p.then(function(file) {\n          var tries;\n          if (!file) {\n            tries = suffixes.map(function(suffix) {\n              return \"\" + absolutePath + suffix;\n            });\n            throw new Error(\"File not found at path: \" + absolutePath + \". Tried \" + tries);\n          }\n          return file;\n        });\n      },\n      htmlForPackage: htmlForPackage,\n      evalCSON: evalCSON\n    });\n  };\n\n  compilers = [\n    {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.js$/);\n      },\n      fn: function(blob) {\n        return blob.readAsText();\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.coffee.md$/) || path.match(/\\.litcoffee$/);\n      },\n      fn: function(blob) {\n        return blob.readAsText().then(function(coffeeSource) {\n          return CoffeeScript.compile(coffeeSource, {\n            bare: true,\n            literate: true\n          });\n        });\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.coffee$/);\n      },\n      fn: function(blob) {\n        return blob.readAsText().then(function(coffeeSource) {\n          return CoffeeScript.compile(coffeeSource, {\n            bare: true\n          });\n        });\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.jadelet$/);\n      },\n      fn: function(blob) {\n        return blob.readAsText().then(function(jadeletSource) {\n          return Jadelet.compile(jadeletSource, {\n            compiler: CoffeeScript,\n            mode: \"jade\",\n            runtime: \"require('_SYS_jadelet')\"\n          });\n        });\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.styl$/);\n      },\n      fn: function(blob) {\n        return blob.readAsText().then(function(source) {\n          return system.stylus(source).render();\n        }).then(stringifyExport);\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.json$/);\n      },\n      fn: function(blob) {\n        return blob.readAsJSON().then(stringifyExport);\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.cson$/);\n      },\n      fn: function(blob) {\n        debugger;\n        return blob.readAsText().then(evalCSON).then(stringifyExport);\n      }\n    }, {\n      filter: function(_arg) {\n        var path;\n        path = _arg.path;\n        return path.match(/\\.te?xt$/);\n      },\n      fn: function(blob) {\n        return blob.readAsText().then(stringifyExport);\n      }\n    }\n  ];\n\n  stringifyExport = function(data) {\n    return \"module.exports = \" + (JSON.stringify(data));\n  };\n\n  annotateSourceURL = function(program, path) {\n    return \"\" + program + \"\\n//# sourceURL=\" + path;\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "system/template": {
      "path": "system/template",
      "content": "(function() {\n  module.exports = function(I, self) {\n    return self.extend({\n      compileTemplate: function(source) {\n        var templateSource;\n        templateSource = Jadelet.compile(source, {\n          compiler: CoffeeScript,\n          runtime: \"Jadelet\",\n          exports: false\n        });\n        return Function(\"return \" + templateSource)();\n      }\n    });\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "templates/achievement-badge": {
      "path": "templates/achievement-badge",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"achievement-badge\", this, {\n      \"class\": [this[\"class\"]],\n      \"title\": this.description\n    }, function(__root) {\n      __root.buffer(this.icon);\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/achievement-progress": {
      "path": "templates/achievement-progress",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"achievement-progress\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"h2\", this, {}, function(__root) {\n        __root.buffer(this.name);\n      }));\n      __root.buffer(__root.element(\"progress\", this, {\n        \"value\": this.value\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"span\", this, {}, function(__root) {\n        __root.buffer(this.fraction);\n      }));\n      __root.buffer(__root.element(\"achievement-badges\", this, {}, function(__root) {\n        __root.buffer(this.badges);\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/achievement": {
      "path": "templates/achievement",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"achievement\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"icon\", this, {}, function(__root) {\n        __root.buffer(this.icon);\n      }));\n      __root.buffer(__root.element(\"h2\", this, {}, function(__root) {\n        __root.buffer(this.title);\n      }));\n      __root.buffer(__root.element(\"p\", this, {}, function(__root) {\n        __root.buffer(this.text);\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/chateau": {
      "path": "templates/chateau",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"chateau\", this, {}, function(__root) {\n      __root.buffer(this.canvas);\n      __root.buffer(__root.element(\"word-area\", this, {}, function(__root) {\n        __root.buffer(this.words);\n      }));\n      __root.buffer(__root.element(\"form\", this, {\n        \"submit\": this.submit\n      }, function(__root) {\n        __root.buffer(__root.element(\"input\", this, {}, function(__root) {}));\n        __root.buffer(__root.element(\"button\", this, {}, function(__root) {\n          __root.buffer(\"Speak\\n\");\n        }));\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/file": {
      "path": "templates/file",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"file\", this, {\n      \"draggable\": \"true\",\n      \"dragstart\": this.dragstart,\n      \"dblclick\": this.dblclick,\n      \"contextmenu\": this.contextmenu,\n      \"path\": this.path,\n      \"type\": this.type\n    }, function(__root) {\n      __root.buffer(__root.element(\"icon\", this, {}, function(__root) {}));\n      __root.buffer(__root.element(\"label\", this, {}, function(__root) {\n        __root.buffer(this.displayName);\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/folder": {
      "path": "templates/folder",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"folder\", this, {\n      \"draggable\": \"true\",\n      \"dragstart\": this.dragstart,\n      \"dblclick\": this.dblclick,\n      \"contextmenu\": this.contextmenu,\n      \"path\": this.path\n    }, function(__root) {\n      __root.buffer(__root.element(\"icon\", this, {}, function(__root) {}));\n      __root.buffer(__root.element(\"label\", this, {}, function(__root) {\n        __root.buffer(this.displayName);\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/home-button": {
      "path": "templates/home-button",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"button\", this, {\n      \"class\": [\"home\"],\n      \"click\": this.click\n    }, function(__root) {\n      __root.buffer(\"🏡 Start\\n\");\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/input": {
      "path": "templates/input",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"input\", this, {\n      \"value\": this.value,\n      \"type\": this.type,\n      \"min\": this.min,\n      \"max\": this.max,\n      \"checked\": this.checked\n    }, function(__root) {}));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/site-url": {
      "path": "templates/site-url",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"site-url\", this, {}, function(__root) {\n      __root.buffer(\"https://whimsy.space\\n\");\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "templates/version": {
      "path": "templates/version",
      "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"version\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"span\", this, {}, function(__root) {\n        __root.buffer(this.version);\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
      "type": "blob"
    },
    "test/system/module": {
      "path": "test/system/module",
      "content": "(function() {\n  var Associations, Model, SystemModule, makeSystemFS;\n\n  require(\"../../extensions\");\n\n  Model = require(\"model\");\n\n  Associations = require(\"../../system/associations\");\n\n  SystemModule = require(\"../../system/module\");\n\n  global.Hamlet = require(\"../../lib/hamlet\");\n\n  mocha.setup({\n    globals: ['amazon']\n  });\n\n  makeSystemFS = function(files) {\n    var model;\n    model = Model();\n    model.include(SystemModule, Associations);\n    Object.assign(model, {\n      readFile: function(path) {\n        return Promise.resolve().then(function() {\n          var blob, content;\n          content = files[path];\n          if (content == null) {\n            throw new Error(\"File not found: \" + path);\n          }\n          blob = new Blob([content]);\n          blob.path = path;\n          return blob;\n        });\n      }\n    });\n    return model;\n  };\n\n  describe(\"System Module\", function() {\n    it(\"should vivifyPrograms in files asynchronously\", function() {\n      var model;\n      model = makeSystemFS({\n        \"/test.js\": \"module.exports = 'yo';\",\n        \"/root.js\": \"var test = require('./test.js');\\nvar test2 = require(\\\"./folder/nested.js\\\");\\nmodule.exports = test + \\\" 2 rad \\\" + test2;\",\n        \"/folder/nested.js\": \"module.exports = \\\"hella\\\";\",\n        \"/wat.js\": \"module.exports = \\\"wat\\\";\",\n        \"/rand.js\": \"module.exports = Math.random();\"\n      });\n      return model.vivifyPrograms([\"/root.js\", \"/wat.js\", \"/rand.js\", \"/rand.js\"]).then(function(_arg) {\n        var r1, r2, root, wat;\n        root = _arg[0], wat = _arg[1], r1 = _arg[2], r2 = _arg[3];\n        console.log(root, wat, r1, r2);\n        assert.equal(r1, r2);\n        return assert.equal(root, 'yo 2 rad hella');\n      });\n    });\n    it(\"should throw an error when requiring a file that doesn't exist\", function(done) {\n      var model;\n      model = makeSystemFS({\n        \"/a.js\": \"module.exports = require(\\\"./b.js\\\")\"\n      });\n      return model.vivifyPrograms([\"/a.js\"])[\"catch\"](function(e) {\n        return done();\n      });\n    });\n    it(\"should throw an error when requiring a file that throws an error\", function(done) {\n      var model;\n      this.timeout(250);\n      model = makeSystemFS({\n        \"/a.js\": \"throw new Error(\\\"I am error\\\")\"\n      });\n      return model.vivifyPrograms([\"/a.js\"])[\"catch\"](function(e) {\n        return done();\n      });\n    });\n    it(\"should require valid json\", function() {\n      var model;\n      this.timeout(250);\n      model = makeSystemFS({\n        \"/a.json\": \"{\\n  \\\"yolo\\\": \\\"wat\\\"\\n}\"\n      });\n      return model.vivifyPrograms([\"/a.json\"]).then(function(_arg) {\n        var json;\n        json = _arg[0];\n        return assert.equal(json.yolo, \"wat\");\n      });\n    });\n    it(\"should throw an error when requiring invalid json\", function(done) {\n      var model;\n      this.timeout(250);\n      model = makeSystemFS({\n        \"/a.json\": \"yolo: 'wat'\"\n      });\n      return model.vivifyPrograms([\"/a.json\"])[\"catch\"](function(e) {\n        return done();\n      });\n    });\n    it(\"should wait forever when resolving circular requires\", function(done) {\n      var model;\n      model = makeSystemFS({\n        \"/a.js\": \"module.exports = require(\\\"./b.js\\\")\",\n        \"/b.js\": \"module.exports = require(\\\"./a.js\\\")\"\n      });\n      model.vivifyPrograms([\"/a.js\"]).then(function(_arg) {\n        var a;\n        a = _arg[0];\n        return assert(false);\n      });\n      return setTimeout(function() {\n        return done();\n      }, 100);\n    });\n    it(\"should work even if the file doesn't assign to module.exports\", function() {\n      var model;\n      model = makeSystemFS({\n        \"/wat.js\": \"exports.yolo = \\\"wat\\\";\"\n      });\n      return model.vivifyPrograms([\"/wat.js\"]).then(function(_arg) {\n        var wat;\n        wat = _arg[0];\n        return assert.equal(wat.yolo, \"wat\");\n      });\n    });\n    it(\"should work with relative paths in subfolders\", function() {\n      var model;\n      model = makeSystemFS({\n        \"/main.js\": \"module.exports = require(\\\"./folder/a.js\\\");\",\n        \"/folder/a.js\": \"module.exports = require(\\\"./b.js\\\");\",\n        \"/folder/b.js\": \"module.exports = \\\"b\\\";\"\n      });\n      return model.vivifyPrograms([\"/main.js\"]).then(function(_arg) {\n        var main;\n        main = _arg[0];\n        return assert.equal(main, \"b\");\n      });\n    });\n    it(\"should work with absolute paths in subfolders\", function() {\n      var model;\n      model = makeSystemFS({\n        \"/main.js\": \"module.exports = require(\\\"./folder/a.js\\\");\",\n        \"/folder/a.js\": \"module.exports = require(\\\"/b.js\\\");\",\n        \"/b.js\": \"module.exports = \\\"b\\\";\"\n      });\n      return model.vivifyPrograms([\"/main.js\"]).then(function(_arg) {\n        var main;\n        main = _arg[0];\n        return assert.equal(main, \"b\");\n      });\n    });\n    return it(\"should require .jadelet sources\", function() {\n      var model;\n      model = makeSystemFS({\n        \"/main.coffee\": \"template = require \\\"./button.jadelet\\\"\\n\\nmodule.exports =\\n  buttonTemplate: template\",\n        \"/button.jadelet\": \"button(@click)= @text\"\n      });\n      return model.vivifyPrograms([\"/main.coffee\"]).then(function(_arg) {\n        var main;\n        main = _arg[0];\n        return assert(typeof main.buttonTemplate === \"function\");\n      });\n    });\n  });\n\n}).call(this);\n",
      "type": "blob"
    },
    "util": {
      "path": "util",
      "content": "(function() {\n  var Util, absolutizePath, dependencyScripts, extensionFor, fileSeparator, htmlForPackage, makeScript, metaTag, normalizePath, readTree,\n    __slice = [].slice;\n\n  fileSeparator = \"/\";\n\n  normalizePath = function(path) {\n    return path.replace(/\\/+/g, fileSeparator).replace(/\\/[^/]*\\/\\.\\./g, \"\").replace(/\\/\\.\\//g, fileSeparator);\n  };\n\n  absolutizePath = function(base, relativePath) {\n    return normalizePath(\"/\" + base + \"/\" + relativePath);\n  };\n\n  makeScript = function(src) {\n    return \"<script src=\" + (JSON.stringify(src)) + \"><\\/script>\";\n  };\n\n  dependencyScripts = function(remoteDependencies) {\n    if (remoteDependencies == null) {\n      remoteDependencies = [];\n    }\n    return remoteDependencies.map(makeScript).join(\"\\n\");\n  };\n\n  metaTag = function(name, content) {\n    return \"<meta name=\" + (JSON.stringify(name)) + \" content=\" + (JSON.stringify(content)) + \">\";\n  };\n\n  htmlForPackage = function(pkg, opts) {\n    var code, config, description, metas, progenitor, script, title, url, _base, _base1, _ref;\n    if (opts == null) {\n      opts = {};\n    }\n    script = opts.script;\n    if (script == null) {\n      script = \"\";\n    }\n    metas = ['<meta charset=\"utf-8\">'];\n    config = pkg.config, progenitor = pkg.progenitor;\n    if (config == null) {\n      config = {};\n    }\n    title = config.title, description = config.description;\n    if (title) {\n      metas.push(\"<title>\" + title + \"</title>\");\n    }\n    if (description) {\n      metas.push(metaTag(\"description\", description.replace(\"\\n\", \" \")));\n    }\n    url = (_ref = pkg.progenitor) != null ? _ref.url : void 0;\n    if (url) {\n      metas.push(\"<link rel=\\\"Progenitor\\\" href=\" + (JSON.stringify(url)) + \">\");\n    }\n    if (pkg.dependencies == null) {\n      pkg.dependencies = {};\n    }\n    if ((_base = pkg.dependencies)._SYS_postmaster == null) {\n      _base._SYS_postmaster = PACKAGE.dependencies.postmaster;\n    }\n    if ((_base1 = pkg.dependencies)._SYS_ui == null) {\n      _base1._SYS_ui = PACKAGE.dependencies.ui;\n    }\n    code = \"\" + script + \";\\nrequire('./\" + pkg.entryPoint + \"');\";\n    return \"<!DOCTYPE html>\\n<html>\\n  <head>\\n    \" + (metas.join(\"\\n    \")) + \"\\n    \" + (dependencyScripts(pkg.remoteDependencies)) + \"\\n  </head>\\n  <body>\\n    <script>\\n      \" + (require.packageWrapper(pkg, code)) + \"\\n    <\\/script>\\n  </body>\\n</html>\";\n  };\n\n  extensionFor = function(path) {\n    var result;\n    result = path.match(/\\.([^.]+)$/);\n    if (result) {\n      return result[1];\n    }\n  };\n\n  readTree = function(fs, directoryPath) {\n    return fs.list(directoryPath).then(function(files) {\n      return Promise.all(files.map(function(file) {\n        if (file.folder) {\n          return readTree(fs, file.path);\n        } else {\n          return file;\n        }\n      }));\n    }).then(function(filesAndFolderFiles) {\n      return filesAndFolderFiles.reduce(function(a, b) {\n        return a.concat(b);\n      }, []);\n    });\n  };\n\n  module.exports = Util = {\n    emptyElement: function(element) {\n      var _results;\n      _results = [];\n      while (element.lastChild) {\n        _results.push(element.removeChild(element.lastChild));\n      }\n      return _results;\n    },\n    extensionFor: extensionFor,\n    fileSeparator: fileSeparator,\n    htmlForPackage: htmlForPackage,\n    normalizePath: normalizePath,\n    absolutizePath: absolutizePath,\n    isAbsolutePath: function(path) {\n      return path.match(/^\\//);\n    },\n    isRelativePath: function(path) {\n      return path.match(/^.?.\\//);\n    },\n    parentElementOfType: function(tagname, element) {\n      tagname = tagname.toLowerCase();\n      if (element.nodeName.toLowerCase() === tagname) {\n        return element;\n      }\n      while (element = element.parentNode) {\n        if (element.nodeName.toLowerCase() === tagname) {\n          return element;\n        }\n      }\n    },\n    pinvoke: function() {\n      var method, object, params;\n      object = arguments[0], method = arguments[1], params = 3 <= arguments.length ? __slice.call(arguments, 2) : [];\n      return new Promise(function(resolve, reject) {\n        return object[method].apply(object, __slice.call(params).concat([function(err, result) {\n          if (err) {\n            reject(err);\n            return;\n          }\n          return resolve(result);\n        }]));\n      });\n    },\n    startsWith: function(str, prefix) {\n      return str.lastIndexOf(prefix, 0) === 0;\n    },\n    endsWith: function(str, suffix) {\n      return str.indexOf(suffix, str.length - suffix.length) !== -1;\n    },\n    evalCSON: function(coffeeSource) {\n      return Promise.resolve().then(function() {\n        return CoffeeScript.compile(coffeeSource, {\n          bare: true\n        });\n      }).then(function(jsCode) {\n        return Function(\"return \" + jsCode)();\n      });\n    },\n    generalType: function(type) {\n      if (type == null) {\n        type = \"\";\n      }\n      return type.replace(/^application\\/|\\/.*$/, \"\").replace(/;.*$/, \"\");\n    },\n    readTree: readTree,\n\n    /*\n    Get the first file from a drop event. Does nothing if the event has had\n    defaultPrevented. Calls preventDefault if we handle the drop.\n    \n    We also handle the special case of dragging and dropping files from the system\n    explorer.\n    \n    Returns a promise that is fulfilled with the file.\n     */\n    fileFromDropEvent: function(e) {\n      var data, fileSelectionData, files, selectedFile;\n      if (e.defaultPrevented) {\n        return;\n      }\n      fileSelectionData = e.dataTransfer.getData(\"zineos/file-selection\");\n      if (fileSelectionData) {\n        e.preventDefault();\n        data = JSON.parse(fileSelectionData);\n        selectedFile = data.files[0];\n        return system.readFile(selectedFile.path);\n      }\n      files = e.dataTransfer.files;\n      if (files.length) {\n        e.preventDefault();\n        return Promise.resolve(files[0]);\n      }\n      return Promise.resolve();\n    }\n  };\n\n}).call(this);\n",
      "type": "blob"
    },
    "lib/hamlet-runtime": {
      "path": "lib/hamlet-runtime",
      "content": "(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.HamletRuntime = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  \"use strict\";\n  var Observable, Runtime, bindEvent, bindObservable, bufferTo, classes, createElement, empty, eventNames, get, id, isEvent, isFragment, makeElement, observeAttribute, observeAttributes, observeContent, specialBindings, valueBind, valueIndexOf;\n\n  Observable = require(\"o_0\");\n\n  eventNames = \"abort\\nblur\\nchange\\nclick\\ncontextmenu\\ndblclick\\ndrag\\ndragend\\ndragenter\\ndragexit\\ndragleave\\ndragover\\ndragstart\\ndrop\\nerror\\nfocus\\ninput\\nkeydown\\nkeypress\\nkeyup\\nload\\nmousedown\\nmousemove\\nmouseout\\nmouseover\\nmouseup\\nreset\\nresize\\nscroll\\nselect\\nsubmit\\ntouchcancel\\ntouchend\\ntouchenter\\ntouchleave\\ntouchmove\\ntouchstart\\nunload\".split(\"\\n\");\n\n  isEvent = function(name) {\n    return eventNames.indexOf(name) !== -1;\n  };\n\n  isFragment = function(node) {\n    return (node != null ? node.nodeType : void 0) === 11;\n  };\n\n  valueBind = function(element, value, context) {\n    Observable(function() {\n      var update;\n      value = Observable(value, context);\n      switch (element.nodeName) {\n        case \"SELECT\":\n          element.oninput = element.onchange = function() {\n            var optionValue, _ref, _value;\n            _ref = this.children[this.selectedIndex], optionValue = _ref.value, _value = _ref._value;\n            return value(_value || optionValue);\n          };\n          update = function(newValue) {\n            var options;\n            element._value = newValue;\n            if ((options = element._options)) {\n              if (newValue.value != null) {\n                return element.value = (typeof newValue.value === \"function\" ? newValue.value() : void 0) || newValue.value;\n              } else {\n                return element.selectedIndex = valueIndexOf(options, newValue);\n              }\n            } else {\n              return element.value = newValue;\n            }\n          };\n          return bindObservable(element, value, context, update);\n        default:\n          element.oninput = element.onchange = function() {\n            return value(element.value);\n          };\n          if (typeof element.attachEvent === \"function\") {\n            element.attachEvent(\"onkeydown\", function() {\n              return setTimeout(function() {\n                return value(element.value);\n              }, 0);\n            });\n          }\n          return bindObservable(element, value, context, function(newValue) {\n            if (element.value !== newValue) {\n              return element.value = newValue;\n            }\n          });\n      }\n    });\n  };\n\n  specialBindings = {\n    INPUT: {\n      checked: function(element, value, context) {\n        element.onchange = function() {\n          return typeof value === \"function\" ? value(element.checked) : void 0;\n        };\n        return bindObservable(element, value, context, function(newValue) {\n          return element.checked = newValue;\n        });\n      }\n    },\n    SELECT: {\n      options: function(element, values, context) {\n        var updateValues;\n        values = Observable(values, context);\n        updateValues = function(values) {\n          empty(element);\n          element._options = values;\n          return values.map(function(value, index) {\n            var option, optionName, optionValue;\n            option = createElement(\"option\");\n            option._value = value;\n            if (typeof value === \"object\") {\n              optionValue = (value != null ? value.value : void 0) || index;\n            } else {\n              optionValue = value.toString();\n            }\n            bindObservable(option, optionValue, value, function(newValue) {\n              return option.value = newValue;\n            });\n            optionName = (value != null ? value.name : void 0) || value;\n            bindObservable(option, optionName, value, function(newValue) {\n              return option.textContent = option.innerText = newValue;\n            });\n            element.appendChild(option);\n            if (value === element._value) {\n              element.selectedIndex = index;\n            }\n            return option;\n          });\n        };\n        return bindObservable(element, values, context, updateValues);\n      }\n    }\n  };\n\n  observeAttribute = function(element, context, name, value) {\n    var binding, nodeName, _ref;\n    nodeName = element.nodeName;\n    if (name === \"value\") {\n      valueBind(element, value);\n    } else if (binding = (_ref = specialBindings[nodeName]) != null ? _ref[name] : void 0) {\n      binding(element, value, context);\n    } else if (name.match(/^on/) && isEvent(name.substr(2))) {\n      bindEvent(element, name, value, context);\n    } else if (isEvent(name)) {\n      bindEvent(element, \"on\" + name, value, context);\n    } else {\n      bindObservable(element, value, context, function(newValue) {\n        if ((newValue != null) && newValue !== false) {\n          return element.setAttribute(name, newValue);\n        } else {\n          return element.removeAttribute(name);\n        }\n      });\n    }\n    return element;\n  };\n\n  observeAttributes = function(element, context, attributes) {\n    return Object.keys(attributes).forEach(function(name) {\n      var value;\n      value = attributes[name];\n      return observeAttribute(element, context, name, value);\n    });\n  };\n\n  bindObservable = function(element, value, context, update) {\n    var observable, observe, unobserve;\n    observable = Observable(value, context);\n    observe = function() {\n      observable.observe(update);\n      return update(observable());\n    };\n    unobserve = function() {\n      return observable.stopObserving(update);\n    };\n    observe();\n    return element;\n  };\n\n  bindEvent = function(element, name, fn, context) {\n    return element[name] = function() {\n      return fn.apply(context, arguments);\n    };\n  };\n\n  id = function(element, context, sources) {\n    var lastId, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(newId) {\n      return element.id = newId;\n    };\n    lastId = function() {\n      return value.last();\n    };\n    return bindObservable(element, lastId, context, update);\n  };\n\n  classes = function(element, context, sources) {\n    var classNames, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(classNames) {\n      return element.className = classNames;\n    };\n    classNames = function() {\n      return value.join(\" \");\n    };\n    return bindObservable(element, classNames, context, update);\n  };\n\n  createElement = function(name) {\n    return document.createElement(name);\n  };\n\n  observeContent = function(element, context, contentFn) {\n    var append, contents, update;\n    contents = [];\n    contentFn.call(context, {\n      buffer: bufferTo(context, contents),\n      element: makeElement\n    });\n    append = function(item) {\n      if (item == null) {\n\n      } else if (typeof item === \"string\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"number\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"boolean\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item.each === \"function\") {\n        return item.each(append);\n      } else if (typeof item.forEach === \"function\") {\n        return item.forEach(append);\n      } else {\n        return element.appendChild(item);\n      }\n    };\n    update = function(contents) {\n      empty(element);\n      return contents.forEach(append);\n    };\n    return update(contents);\n  };\n\n  bufferTo = function(context, collection) {\n    return function(content) {\n      if (typeof content === 'function') {\n        content = Observable(content, context);\n      }\n      collection.push(content);\n      return content;\n    };\n  };\n\n  makeElement = function(name, context, attributes, fn) {\n    var element;\n    if (attributes == null) {\n      attributes = {};\n    }\n    element = createElement(name);\n    Observable(function() {\n      if (attributes.id != null) {\n        id(element, context, attributes.id);\n        return delete attributes.id;\n      }\n    });\n    Observable(function() {\n      if (attributes[\"class\"] != null) {\n        classes(element, context, attributes[\"class\"]);\n        return delete attributes[\"class\"];\n      }\n    });\n    Observable(function() {\n      return observeAttributes(element, context, attributes);\n    }, context);\n    if (element.nodeName !== \"SELECT\") {\n      Observable(function() {\n        return observeContent(element, context, fn);\n      }, context);\n    }\n    return element;\n  };\n\n  Runtime = function(context) {\n    var self;\n    self = {\n      buffer: function(content) {\n        if (self.root) {\n          throw \"Cannot have multiple root elements\";\n        }\n        return self.root = content;\n      },\n      element: makeElement,\n      filter: function(name, content) {}\n    };\n    return self;\n  };\n\n  Runtime.VERSION = require(\"../package.json\").version;\n\n  Runtime.Observable = Observable;\n\n  module.exports = Runtime;\n\n  empty = function(node) {\n    var child, _results;\n    _results = [];\n    while (child = node.firstChild) {\n      _results.push(node.removeChild(child));\n    }\n    return _results;\n  };\n\n  valueIndexOf = function(options, value) {\n    if (typeof value === \"object\") {\n      return options.indexOf(value);\n    } else {\n      return options.map(function(option) {\n        return option.toString();\n      }).indexOf(value.toString());\n    }\n  };\n\n  get = function(x) {\n    if (typeof x === 'function') {\n      return x();\n    } else {\n      return x;\n    }\n  };\n\n}).call(this);\n\n},{\"../package.json\":3,\"o_0\":2}],2:[function(require,module,exports){\n(function (global){\n// Generated by CoffeeScript 1.8.0\n(function() {\n  var Observable, PROXY_LENGTH, computeDependencies, copy, extend, flatten, get, last, magicDependency, remove, splat, tryCallWithFinallyPop,\n    __slice = [].slice;\n\n  module.exports = Observable = function(value, context) {\n    var changed, fn, listeners, notify, notifyReturning, self;\n    if (typeof (value != null ? value.observe : void 0) === \"function\") {\n      return value;\n    }\n    listeners = [];\n    notify = function(newValue) {\n      return copy(listeners).forEach(function(listener) {\n        return listener(newValue);\n      });\n    };\n    if (typeof value === 'function') {\n      fn = value;\n      self = function() {\n        magicDependency(self);\n        return value;\n      };\n      changed = function() {\n        value = computeDependencies(self, fn, changed, context);\n        return notify(value);\n      };\n      changed();\n    } else {\n      self = function(newValue) {\n        if (arguments.length > 0) {\n          if (value !== newValue) {\n            value = newValue;\n            notify(newValue);\n          }\n        } else {\n          magicDependency(self);\n        }\n        return value;\n      };\n    }\n    self.each = function(callback) {\n      magicDependency(self);\n      if (value != null) {\n        [value].forEach(function(item) {\n          return callback.call(item, item);\n        });\n      }\n      return self;\n    };\n    if (Array.isArray(value)) {\n      [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"reduce\", \"reduceRight\", \"slice\", \"some\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          magicDependency(self);\n          return value[method].apply(value, args);\n        };\n      });\n      [\"pop\", \"push\", \"reverse\", \"shift\", \"splice\", \"sort\", \"unshift\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          return notifyReturning(value[method].apply(value, args));\n        };\n      });\n      if (PROXY_LENGTH) {\n        Object.defineProperty(self, 'length', {\n          get: function() {\n            magicDependency(self);\n            return value.length;\n          },\n          set: function(length) {\n            value.length = length;\n            return notifyReturning(value.length);\n          }\n        });\n      }\n      notifyReturning = function(returnValue) {\n        notify(value);\n        return returnValue;\n      };\n      extend(self, {\n        each: function(callback) {\n          self.forEach(function(item, index) {\n            return callback.call(item, item, index, self);\n          });\n          return self;\n        },\n        remove: function(object) {\n          var index;\n          index = value.indexOf(object);\n          if (index >= 0) {\n            return notifyReturning(value.splice(index, 1)[0]);\n          }\n        },\n        get: function(index) {\n          magicDependency(self);\n          return value[index];\n        },\n        first: function() {\n          magicDependency(self);\n          return value[0];\n        },\n        last: function() {\n          magicDependency(self);\n          return value[value.length - 1];\n        },\n        size: function() {\n          magicDependency(self);\n          return value.length;\n        }\n      });\n    }\n    extend(self, {\n      listeners: listeners,\n      observe: function(listener) {\n        return listeners.push(listener);\n      },\n      stopObserving: function(fn) {\n        return remove(listeners, fn);\n      },\n      toggle: function() {\n        return self(!value);\n      },\n      increment: function(n) {\n        return self(value + n);\n      },\n      decrement: function(n) {\n        return self(value - n);\n      },\n      toString: function() {\n        return \"Observable(\" + value + \")\";\n      }\n    });\n    return self;\n  };\n\n  Observable.concat = function() {\n    var arg, args, collection, i, o, _i, _len;\n    args = new Array(arguments.length);\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      arg = arguments[i];\n      args[i] = arguments[i];\n    }\n    collection = Observable(args);\n    o = Observable(function() {\n      return flatten(collection.map(splat));\n    });\n    o.push = collection.push;\n    return o;\n  };\n\n  extend = function(target) {\n    var i, name, source, _i, _len;\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      source = arguments[i];\n      if (i > 0) {\n        for (name in source) {\n          target[name] = source[name];\n        }\n      }\n    }\n    return target;\n  };\n\n  global.OBSERVABLE_ROOT_HACK = [];\n\n  magicDependency = function(self) {\n    var observerSet;\n    observerSet = last(global.OBSERVABLE_ROOT_HACK);\n    if (observerSet) {\n      return observerSet.add(self);\n    }\n  };\n\n  tryCallWithFinallyPop = function(fn, context) {\n    try {\n      return fn.call(context);\n    } finally {\n      global.OBSERVABLE_ROOT_HACK.pop();\n    }\n  };\n\n  computeDependencies = function(self, fn, update, context) {\n    var deps, value, _ref;\n    deps = new Set;\n    global.OBSERVABLE_ROOT_HACK.push(deps);\n    value = tryCallWithFinallyPop(fn, context);\n    if ((_ref = self._deps) != null) {\n      _ref.forEach(function(observable) {\n        return observable.stopObserving(update);\n      });\n    }\n    self._deps = deps;\n    deps.forEach(function(observable) {\n      return observable.observe(update);\n    });\n    return value;\n  };\n\n  try {\n    Object.defineProperty((function() {}), 'length', {\n      get: function() {},\n      set: function() {}\n    });\n    PROXY_LENGTH = true;\n  } catch (_error) {\n    PROXY_LENGTH = false;\n  }\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n  copy = function(array) {\n    return array.concat([]);\n  };\n\n  get = function(arg) {\n    if (typeof arg === \"function\") {\n      return arg();\n    } else {\n      return arg;\n    }\n  };\n\n  splat = function(item) {\n    var result, results;\n    results = [];\n    if (item == null) {\n      return results;\n    }\n    if (typeof item.forEach === \"function\") {\n      item.forEach(function(i) {\n        return results.push(i);\n      });\n    } else {\n      result = get(item);\n      if (result != null) {\n        results.push(result);\n      }\n    }\n    return results;\n  };\n\n  last = function(array) {\n    return array[array.length - 1];\n  };\n\n  flatten = function(array) {\n    return array.reduce(function(a, b) {\n      return a.concat(b);\n    }, []);\n  };\n\n}).call(this);\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],3:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"hamlet.coffee\",\n  \"version\": \"0.7.6\",\n  \"description\": \"Truly amazing templating!\",\n  \"devDependencies\": {\n    \"browserify\": \"^12.0.1\",\n    \"coffee-script\": \"~1.7.1\",\n    \"jsdom\": \"^7.2.0\",\n    \"mocha\": \"^2.3.3\"\n  },\n  \"dependencies\": {\n    \"hamlet-compiler\": \"0.7.0\",\n    \"o_0\": \"0.3.8\"\n  },\n  \"homepage\": \"hamlet.coffee\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/dr-coffee-labs/hamlet.git\"\n  },\n  \"scripts\": {\n    \"prepublish\": \"script/prepublish\",\n    \"test\": \"script/test\"\n  },\n  \"files\": [\n    \"dist/\"\n  ],\n  \"main\": \"dist/runtime.js\"\n}\n\n},{}]},{},[1])(1)\n});",
      "type": "blob"
    }
  },
  "progenitor": {
    "url": "https://danielx.net/editor/"
  },
  "config": {
    "title": "Whimsy Space - ZineOS v0.420.950a ⌊ALPHA⌉",
    "version": "0.420.950a",
    "description": "When the bombs drop, and it's OS against OS, you're gonna wish you could view source",
    "dependencies": {
      "ajax": "distri/ajax:master",
      "analytics": "distri/google-analytics:master",
      "base64": "distri/base64:v0.9.2",
      "bindable": "distri/bindable:master",
      "model": "distri/model:master",
      "postmaster": "distri/postmaster:v0.5.3",
      "ui": "STRd6/ui:master"
    },
    "remoteDependencies": [
      "https://cdnjs.cloudflare.com/ajax/libs/dexie/2.0.0-beta.7/dexie.min.js",
      "https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ace.js",
      "https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ext-language_tools.js",
      "https://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.7.1/coffee-script.min.js",
      "https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js",
      "https://sdk.amazonaws.com/js/aws-sdk-2.7.20.min.js",
      "https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"
    ]
  },
  "version": "0.420.950a",
  "entryPoint": "main",
  "remoteDependencies": [
    "https://cdnjs.cloudflare.com/ajax/libs/dexie/2.0.0-beta.7/dexie.min.js",
    "https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ace.js",
    "https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ext-language_tools.js",
    "https://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.7.1/coffee-script.min.js",
    "https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js",
    "https://sdk.amazonaws.com/js/aws-sdk-2.7.20.min.js",
    "https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"
  ],
  "repository": {
    "branch": "master",
    "default_branch": "master",
    "full_name": "STRd6/zine",
    "homepage": null,
    "description": "DIY E-Zine and Operating System",
    "html_url": "https://github.com/STRd6/zine",
    "url": "https://api.github.com/repos/STRd6/zine",
    "publishBranch": "gh-pages"
  },
  "dependencies": {
    "ajax": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "The MIT License (MIT)\n\nCopyright (c) 2016 \n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n",
          "mode": "100644",
          "type": "blob"
        },
        "README.md": {
          "path": "README.md",
          "content": "# ajax\n\nA Promise returning wrapper for XMLHttpRequest\n\nThis aims to be a very small and very direct wrapper for XMLHttpRequest. We\nreturn a native promise and configure the requets via an options object.\n\n\n",
          "mode": "100644",
          "type": "blob"
        },
        "main.coffee": {
          "path": "main.coffee",
          "content": "require \"./shims\"\n\nmodule.exports = ->\n  ajax = (options={}) ->\n    {data, headers, method, overrideMimeType, password, url, responseType, timeout, user, withCredentials} = options\n    data ?= \"\"\n    method ?= \"GET\"\n    password ?= \"\"\n    responseType ?= \"\"\n    timeout ?= 0\n    user ?= \"\"\n    withCredentials ?= false\n\n    new ProgressPromise (resolve, reject, progress) ->\n      xhr = new XMLHttpRequest()\n      xhr.open(method, url, true, user, password)\n      xhr.responseType = responseType\n      xhr.timeout = timeout\n      xhr.withCredentialls = withCredentials\n\n      if headers\n        Object.keys(headers).forEach (header) ->\n          value = headers[header]\n          xhr.setRequestHeader header, value\n\n      if overrideMimeType\n        xhr.overrideMimeType overrideMimeType\n\n      xhr.onload = (e) ->\n        if (200 <= this.status < 300) or this.status is 304\n          resolve this.response\n          complete e, xhr, options\n        else\n          reject xhr\n          complete e, xhr, options\n\n      xhr.onerror = (e) ->\n        reject xhr\n        complete e, xhr, options\n\n      xhr.onprogress = progress\n\n      xhr.send(data)\n\n  complete = (args...) ->\n    completeHandlers.forEach (handler) ->\n      handler args...\n\n  configure = (optionDefaults) ->\n    (url, options={}) ->\n      if typeof url is \"object\"\n        options = url\n      else\n        options.url = url\n\n      defaults options, optionDefaults\n\n      ajax(options)\n\n  completeHandlers = []\n\n  Object.assign ajax,\n    ajax: configure {}\n    complete: (handler) ->\n      completeHandlers.push handler\n\n    getJSON: configure\n      responseType: \"json\"\n\n    getBlob: configure\n      responseType: \"blob\"\n\ndefaults = (target, objects...) ->\n  for object in objects\n    for name of object\n      unless target.hasOwnProperty(name)\n        target[name] = object[name]\n\n  return target\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "version: \"0.1.5-pre.0\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "shims.coffee": {
          "path": "shims.coffee",
          "content": "# Extend promises with `finally`\n# From: https://github.com/domenic/promises-unwrapping/issues/18\nPromise.prototype.finally ?= (callback) ->\n  # We don’t invoke the callback in here,\n  # because we want then() to handle its exceptions\n  this.then(\n    # Callback fulfills: pass on predecessor settlement\n    # Callback rejects: pass on rejection (=omit 2nd arg.)\n    (value) ->\n      Promise.resolve(callback())\n      .then -> return value\n    (reason) ->\n      Promise.resolve(callback())\n      .then -> throw reason\n  )\n\n# HACK: I really would prefer not to modify the native Promise prototype, but I\n# know no other way...\n\nPromise.prototype._notify ?= (event) ->\n  @_progressHandlers.forEach (handler) ->\n    try\n      handler(event)\n\nPromise.prototype.progress ?= (handler) ->\n  @_progressHandlers ?= []\n  @_progressHandlers.push handler\n\n  return this\n\nglobal.ProgressPromise = (fn) ->\n  p = new Promise (resolve, reject) ->\n    notify = ->\n      p._progressHandlers?.forEach (handler) ->\n        try\n          handler(event)\n\n    fn(resolve, reject, notify)\n\n  p.then = (onFulfilled, onRejected) ->\n    result = Promise.prototype.then.call(p, onFulfilled, onRejected)\n    # Pass progress through\n    p.progress result._notify.bind(result)\n\n    return result\n\n  return p\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/test.coffee": {
          "path": "test/test.coffee",
          "content": "Ajax = require \"../main\"\n\ndescribe \"Ajax\", ->\n  it \"should provide progress\", (done) ->\n    ajax = Ajax()\n\n    ajax\n      url: \"https://api.github.com/users\"\n      responseType: \"json\"\n    .progress (e) ->\n      console.log e\n    .then (data) ->\n      assert data[0].id is 1\n      done()\n\n  it \"should getJSON\", (done) ->\n    ajax = Ajax()\n\n    ajax\n      url: \"https://api.github.com/users\"\n      responseType: \"json\"\n    .then (data) ->\n      assert data[0].id is 1\n      assert data[0].login is \"mojombo\"\n\n      done()\n\n  it \"should have complete handlers\", (done) ->\n    ajax = Ajax()\n\n    ajax.complete (e, xhr, options) ->\n      done()\n\n    ajax.getJSON(\"https://api.github.com/users\")\n\n\n  it \"should work with options only\", (done) ->\n    ajax = Ajax()\n\n    ajax.getJSON(url: \"https://api.github.com/users\")\n    .then (data) ->\n      assert data[0].id is 1\n      assert data[0].login is \"mojombo\"\n\n      done()\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "main": {
          "path": "main",
          "content": "(function() {\n  var defaults,\n    __slice = [].slice;\n\n  require(\"./shims\");\n\n  module.exports = function() {\n    var ajax, complete, completeHandlers, configure;\n    ajax = function(options) {\n      var data, headers, method, overrideMimeType, password, responseType, timeout, url, user, withCredentials;\n      if (options == null) {\n        options = {};\n      }\n      data = options.data, headers = options.headers, method = options.method, overrideMimeType = options.overrideMimeType, password = options.password, url = options.url, responseType = options.responseType, timeout = options.timeout, user = options.user, withCredentials = options.withCredentials;\n      if (data == null) {\n        data = \"\";\n      }\n      if (method == null) {\n        method = \"GET\";\n      }\n      if (password == null) {\n        password = \"\";\n      }\n      if (responseType == null) {\n        responseType = \"\";\n      }\n      if (timeout == null) {\n        timeout = 0;\n      }\n      if (user == null) {\n        user = \"\";\n      }\n      if (withCredentials == null) {\n        withCredentials = false;\n      }\n      return new ProgressPromise(function(resolve, reject, progress) {\n        var xhr;\n        xhr = new XMLHttpRequest();\n        xhr.open(method, url, true, user, password);\n        xhr.responseType = responseType;\n        xhr.timeout = timeout;\n        xhr.withCredentialls = withCredentials;\n        if (headers) {\n          Object.keys(headers).forEach(function(header) {\n            var value;\n            value = headers[header];\n            return xhr.setRequestHeader(header, value);\n          });\n        }\n        if (overrideMimeType) {\n          xhr.overrideMimeType(overrideMimeType);\n        }\n        xhr.onload = function(e) {\n          var _ref;\n          if (((200 <= (_ref = this.status) && _ref < 300)) || this.status === 304) {\n            resolve(this.response);\n            return complete(e, xhr, options);\n          } else {\n            reject(xhr);\n            return complete(e, xhr, options);\n          }\n        };\n        xhr.onerror = function(e) {\n          reject(xhr);\n          return complete(e, xhr, options);\n        };\n        xhr.onprogress = progress;\n        return xhr.send(data);\n      });\n    };\n    complete = function() {\n      var args;\n      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n      return completeHandlers.forEach(function(handler) {\n        return handler.apply(null, args);\n      });\n    };\n    configure = function(optionDefaults) {\n      return function(url, options) {\n        if (options == null) {\n          options = {};\n        }\n        if (typeof url === \"object\") {\n          options = url;\n        } else {\n          options.url = url;\n        }\n        defaults(options, optionDefaults);\n        return ajax(options);\n      };\n    };\n    completeHandlers = [];\n    return Object.assign(ajax, {\n      ajax: configure({}),\n      complete: function(handler) {\n        return completeHandlers.push(handler);\n      },\n      getJSON: configure({\n        responseType: \"json\"\n      }),\n      getBlob: configure({\n        responseType: \"blob\"\n      })\n    });\n  };\n\n  defaults = function() {\n    var name, object, objects, target, _i, _len;\n    target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n    for (_i = 0, _len = objects.length; _i < _len; _i++) {\n      object = objects[_i];\n      for (name in object) {\n        if (!target.hasOwnProperty(name)) {\n          target[name] = object[name];\n        }\n      }\n    }\n    return target;\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"version\":\"0.1.5-pre.0\"};",
          "type": "blob"
        },
        "shims": {
          "path": "shims",
          "content": "(function() {\n  var _base, _base1, _base2;\n\n  if ((_base = Promise.prototype)[\"finally\"] == null) {\n    _base[\"finally\"] = function(callback) {\n      return this.then(function(value) {\n        return Promise.resolve(callback()).then(function() {\n          return value;\n        });\n      }, function(reason) {\n        return Promise.resolve(callback()).then(function() {\n          throw reason;\n        });\n      });\n    };\n  }\n\n  if ((_base1 = Promise.prototype)._notify == null) {\n    _base1._notify = function(event) {\n      return this._progressHandlers.forEach(function(handler) {\n        try {\n          return handler(event);\n        } catch (_error) {}\n      });\n    };\n  }\n\n  if ((_base2 = Promise.prototype).progress == null) {\n    _base2.progress = function(handler) {\n      if (this._progressHandlers == null) {\n        this._progressHandlers = [];\n      }\n      this._progressHandlers.push(handler);\n      return this;\n    };\n  }\n\n  global.ProgressPromise = function(fn) {\n    var p;\n    p = new Promise(function(resolve, reject) {\n      var notify;\n      notify = function() {\n        var _ref;\n        return (_ref = p._progressHandlers) != null ? _ref.forEach(function(handler) {\n          try {\n            return handler(event);\n          } catch (_error) {}\n        }) : void 0;\n      };\n      return fn(resolve, reject, notify);\n    });\n    p.then = function(onFulfilled, onRejected) {\n      var result;\n      result = Promise.prototype.then.call(p, onFulfilled, onRejected);\n      p.progress(result._notify.bind(result));\n      return result;\n    };\n    return p;\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "test/test": {
          "path": "test/test",
          "content": "(function() {\n  var Ajax;\n\n  Ajax = require(\"../main\");\n\n  describe(\"Ajax\", function() {\n    it(\"should provide progress\", function(done) {\n      var ajax;\n      ajax = Ajax();\n      return ajax({\n        url: \"https://api.github.com/users\",\n        responseType: \"json\"\n      }).progress(function(e) {\n        return console.log(e);\n      }).then(function(data) {\n        assert(data[0].id === 1);\n        return done();\n      });\n    });\n    it(\"should getJSON\", function(done) {\n      var ajax;\n      ajax = Ajax();\n      return ajax({\n        url: \"https://api.github.com/users\",\n        responseType: \"json\"\n      }).then(function(data) {\n        assert(data[0].id === 1);\n        assert(data[0].login === \"mojombo\");\n        return done();\n      });\n    });\n    it(\"should have complete handlers\", function(done) {\n      var ajax;\n      ajax = Ajax();\n      ajax.complete(function(e, xhr, options) {\n        return done();\n      });\n      return ajax.getJSON(\"https://api.github.com/users\");\n    });\n    return it(\"should work with options only\", function(done) {\n      var ajax;\n      ajax = Ajax();\n      return ajax.getJSON({\n        url: \"https://api.github.com/users\"\n      }).then(function(data) {\n        assert(data[0].id === 1);\n        assert(data[0].login === \"mojombo\");\n        return done();\n      });\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "config": {
        "version": "0.1.5-pre.0"
      },
      "version": "0.1.5-pre.0",
      "entryPoint": "main",
      "repository": {
        "branch": "master",
        "default_branch": "master",
        "full_name": "distri/ajax",
        "homepage": null,
        "description": "Promise returning Ajax lib",
        "html_url": "https://github.com/distri/ajax",
        "url": "https://api.github.com/repos/distri/ajax",
        "publishBranch": "gh-pages"
      },
      "dependencies": {}
    },
    "analytics": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "The MIT License (MIT)\n\nCopyright (c) 2014 \n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.",
          "mode": "100644",
          "type": "blob"
        },
        "README.md": {
          "path": "README.md",
          "content": "google-analytics\n================\n\nGoogle analytics for distri apps\n",
          "mode": "100644",
          "type": "blob"
        },
        "lib/analytics.js": {
          "path": "lib/analytics.js",
          "content": "(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n",
          "mode": "100644",
          "type": "blob"
        },
        "main.coffee": {
          "path": "main.coffee",
          "content": "module.exports =\n  init: (id) ->\n    require \"./lib/analytics\"\n\n    global.ga('create', id, 'auto')\n    global.ga('send', 'pageview')\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "version: \"0.1.2\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/main.coffee": {
          "path": "test/main.coffee",
          "content": "mocha.globals(\"ga\")\n\ndescribe \"analytics\", ->\n  it \"should put analytics on the page\", ->\n    GA = require \"../main\"\n\n    GA.init(\"UA-XXXX-Y\")\n\n  it \"should be a chill bro\", ->\n    ga(\"send\", \"duder\")\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "lib/analytics": {
          "path": "lib/analytics",
          "content": "(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n",
          "type": "blob"
        },
        "main": {
          "path": "main",
          "content": "(function() {\n  module.exports = {\n    init: function(id) {\n      require(\"./lib/analytics\");\n      global.ga('create', id, 'auto');\n      return global.ga('send', 'pageview');\n    }\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"version\":\"0.1.2\"};",
          "type": "blob"
        },
        "test/main": {
          "path": "test/main",
          "content": "(function() {\n  mocha.globals(\"ga\");\n\n  describe(\"analytics\", function() {\n    it(\"should put analytics on the page\", function() {\n      var GA;\n      GA = require(\"../main\");\n      return GA.init(\"UA-XXXX-Y\");\n    });\n    return it(\"should be a chill bro\", function() {\n      return ga(\"send\", \"duder\");\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "version": "0.1.2",
      "entryPoint": "main",
      "repository": {
        "branch": "master",
        "default_branch": "master",
        "full_name": "distri/google-analytics",
        "homepage": null,
        "description": "Google analytics for distri apps",
        "html_url": "https://github.com/distri/google-analytics",
        "url": "https://api.github.com/repos/distri/google-analytics",
        "publishBranch": "gh-pages"
      },
      "dependencies": {}
    },
    "base64": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "The MIT License (MIT)\n\nCopyright (c) 2014 distri\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
          "mode": "100644",
          "type": "blob"
        },
        "README.md": {
          "path": "README.md",
          "content": "Base64\n======\n\nBase64 to UTF8 encoding and decoding, wrapping up \n[TextEncoderLite](https://github.com/coolaj86/TextEncoderLite) and\n[base64-js](https://github.com/beatgammit/base64-js)\n",
          "mode": "100644",
          "type": "blob"
        },
        "lib/base64-js.js": {
          "path": "lib/base64-js.js",
          "content": "'use strict'\n\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nfunction init () {\n  var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n  for (var i = 0, len = code.length; i < len; ++i) {\n    lookup[i] = code[i]\n    revLookup[code.charCodeAt(i)] = i\n  }\n\n  revLookup['-'.charCodeAt(0)] = 62\n  revLookup['_'.charCodeAt(0)] = 63\n}\n\ninit()\n\nfunction toByteArray (b64) {\n  var i, j, l, tmp, placeHolders, arr\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // the number of equal signs (place holders)\n  // if there are two placeholders, than the two characters before it\n  // represent one byte\n  // if there is only one, then the three characters before it represent 2 bytes\n  // this is just a cheap hack to not do indexOf twice\n  placeHolders = b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0\n\n  // base64 is 4/3 + up to two characters of the original data\n  arr = new Arr(len * 3 / 4 - placeHolders)\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  l = placeHolders > 0 ? len - 4 : len\n\n  var L = 0\n\n  for (i = 0, j = 0; i < l; i += 4, j += 3) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]\n    arr[L++] = (tmp >> 16) & 0xFF\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  if (placeHolders === 2) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[L++] = tmp & 0xFF\n  } else if (placeHolders === 1) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var output = ''\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    output += lookup[tmp >> 2]\n    output += lookup[(tmp << 4) & 0x3F]\n    output += '=='\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])\n    output += lookup[tmp >> 10]\n    output += lookup[(tmp >> 4) & 0x3F]\n    output += lookup[(tmp << 2) & 0x3F]\n    output += '='\n  }\n\n  parts.push(output)\n\n  return parts.join('')\n}",
          "mode": "100644",
          "type": "blob"
        },
        "lib/text-encoder.js": {
          "path": "lib/text-encoder.js",
          "content": "function TextEncoderLite() {\n}\nfunction TextDecoderLite() {\n}\n\nmodule.exports = {\n  encoder: TextEncoderLite,\n  decoder: TextDecoderLite\n};\n\n(function () {\n'use strict';\n\n// Taken from https://github.com/feross/buffer/blob/master/index.js\n// Thanks Feross et al! :-)\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n  var i = 0\n\n  for (; i < length; i++) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (leadSurrogate) {\n        // 2 leads in a row\n        if (codePoint < 0xDC00) {\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          leadSurrogate = codePoint\n          continue\n        } else {\n          // valid surrogate pair\n          codePoint = leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00 | 0x10000\n          leadSurrogate = null\n        }\n      } else {\n        // no lead yet\n\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else {\n          // valid lead\n          leadSurrogate = codePoint\n          continue\n        }\n      }\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n      leadSurrogate = null\n    }\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x200000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction utf8Slice (buf, start, end) {\n  var res = ''\n  var tmp = ''\n  end = Math.min(buf.length, end || Infinity)\n  start = start || 0;\n\n  for (var i = start; i < end; i++) {\n    if (buf[i] <= 0x7F) {\n      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])\n      tmp = ''\n    } else {\n      tmp += '%' + buf[i].toString(16)\n    }\n  }\n\n  return res + decodeUtf8Char(tmp)\n}\n\nfunction decodeUtf8Char (str) {\n  try {\n    return decodeURIComponent(str)\n  } catch (err) {\n    return String.fromCharCode(0xFFFD) // UTF 8 invalid char\n  }\n}\n\nTextEncoderLite.prototype.encode = function (str) {\n  var result;\n\n  if ('undefined' === typeof Uint8Array) {\n    result = utf8ToBytes(str);\n  } else {\n    result = new Uint8Array(utf8ToBytes(str));\n  }\n\n  return result;\n};\n\nTextDecoderLite.prototype.decode = function (bytes) {\n  return utf8Slice(bytes, 0, bytes.length);\n}\n\n}());",
          "mode": "100644",
          "type": "blob"
        },
        "main.coffee": {
          "path": "main.coffee",
          "content": "Base64Js = require \"../lib/base64-js\"\n{decoder:Decoder, encoder:Encoder} = require \"../lib/text-encoder\"\n\nencoder = new Encoder('utf-8')\ndecoder = new Decoder('utf-8')\n\nmodule.exports =\n  encode: (s) ->\n    Base64Js.fromByteArray encoder.encode(s)\n\n  decode: (b64string) ->\n    decoder.decode Base64Js.toByteArray(b64string.replace(/\\n/g, ''))\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "version: \"0.9.2\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/base64.coffee": {
          "path": "test/base64.coffee",
          "content": "Base64 = require \"../main\"\nBase64Js = require \"../lib/base64-js\"\n{decoder:Decoder} = require \"../lib/text-encoder\"\n\ndescribe \"Base64\", ->\n  it \"should encode\", ->\n    assert.equal Base64.encode(\"hello\"), \"aGVsbG8=\"\n\n  it \"should decode\", ->\n    assert.equal Base64.decode(\"aGVsbG8=\"), \"hello\"\n\n  it \"should work with utf-8\", ->\n    assert.equal Base64.decode(\"ZMO8ZGVy\"), \"düder\"\n\n  it \"should work with utf-8\", ->\n    assert.equal Base64.encode(\"düder\"), \"ZMO8ZGVy\"\n\n  it \"should work with astral emojis\", ->\n    decoder = new Decoder('utf8')\n    result = decoder.decode(Base64Js.toByteArray(\"8J+NlAo=\"))\n    burger = \"\\uD83C\\uDF54\\n\"\n\n    assert.equal result, burger\n\n  it \"should decode long strings\", ->\n    encoded = \"\"\"\n      VE9ETwotLS0tCkJ1bmRsZWQgRGVwZW5kZW5jaWVzCi0gQnVpbGQgYnVuZGxl\n      ZCBkZXBlbmRlbmNpZXMgaW50byBwdWJsaXNoZWQgc2NyaXB0Ci0gRGVwZW5k\n      ZW5jeSBzb3VyY2Ugc2hvdWxkIG5vdCBiZSBpbiByZXZpc2lvbiBjb250cm9s\n      Ci0gcmVxdWlyZXMgYW5kIG1vZHVsZS5leHBvcnRzCi0gaW50ZXItY29tcG9u\n      ZW50IGFuZCBpbnRyYS1jb21wb25lbnQgZGVwZW5kZW5jaWVzCi0gT25lIGRh\n      eSB3ZSdsbCBuZWVkIHRvIGltcGxlbWVudCBhIGJ1bmRsZXJlc3F1ZSBzeXN0\n      ZW0sIGJ1dCBub3QgdG9kYXkKCkxpdmUgVXBkYXRlIERlbW8KLSBIb3QgcmVs\n      b2FkIGNzcwotIERpc3BsYXkgRGVtbyBSdW50aW1lIEVycm9ycyBpbiBjb25z\n      b2xlCgpPcGVuIHB1Ymxpc2hlZCBwYWdlIGluIGVkaXRvciBhbmQgcnVuIGxp\n      dmUgZGVtbyB3aXRoIHNhbWUgc3RhdGUgYXMgd2hlbiBlZGl0b3Igd2FzIG9w\n      ZW5lZAotIFBhc3MgZ2l0IHJlcG8vYnJhbmNoIG1ldGFkYXRhIHRvIHB1Ymxp\n      c2hlZCBwYWdlIGZvciB1c2UgaW4gZWRpdG9yCgpQZXJzaXN0IHN0YXRlIGFj\n      cm9zcyBkZW1vIHJlbG9hZHMKCk9yZ2FuaXplIEZpbGUgdHJlZSBieSB0eXBl\n      CkZpbGUgaWNvbnMKCkRpc3BsYXkgRGlmZnMKCkZpcnN0IGF1dGggZG9lc24n\n      dCBkaXNwbGF5IGluIGJhcgoKQ2FjaGUgR2l0IHRyZWVzIGFuZCBmaWxlcyBp\n      biBzb21lIGZvcm0gb2YgbG9jYWwgc3RvcmFnZQoKU29tZXRpbWVzIGVkaXRv\n      ciBhcHBlYXJzIGJsYW5rIHdoZW4gc3dpdGNoaW5nIGZpbGVzCgpFZGl0b3Ig\n      cGx1Z2lucwotIHN0YXRpYyBhbmFseXNpcwotIGZpbmQgaW4gZmlsZXMKLSBz\n      b3VyY2UgZmlsZSBoeWdpZW5lCg==\n    \"\"\"\n\n    decoded = \"\"\"\n      TODO\n      ----\n      Bundled Dependencies\n      - Build bundled dependencies into published script\n      - Dependency source should not be in revision control\n      - requires and module.exports\n      - inter-component and intra-component dependencies\n      - One day we'll need to implement a bundleresque system, but not today\n\n      Live Update Demo\n      - Hot reload css\n      - Display Demo Runtime Errors in console\n\n      Open published page in editor and run live demo with same state as when editor was opened\n      - Pass git repo/branch metadata to published page for use in editor\n\n      Persist state across demo reloads\n\n      Organize File tree by type\n      File icons\n\n      Display Diffs\n\n      First auth doesn't display in bar\n\n      Cache Git trees and files in some form of local storage\n\n      Sometimes editor appears blank when switching files\n\n      Editor plugins\n      - static analysis\n      - find in files\n      - source file hygiene\n\n    \"\"\"\n\n    assert.equal Base64.decode(encoded), decoded\n\n  it \"should encode long strings\", ->\n    encoded = \"\"\"\n      VE9ETwotLS0tCkJ1bmRsZWQgRGVwZW5kZW5jaWVzCi0gQnVpbGQgYnVuZGxl\n      ZCBkZXBlbmRlbmNpZXMgaW50byBwdWJsaXNoZWQgc2NyaXB0Ci0gRGVwZW5k\n      ZW5jeSBzb3VyY2Ugc2hvdWxkIG5vdCBiZSBpbiByZXZpc2lvbiBjb250cm9s\n      Ci0gcmVxdWlyZXMgYW5kIG1vZHVsZS5leHBvcnRzCi0gaW50ZXItY29tcG9u\n      ZW50IGFuZCBpbnRyYS1jb21wb25lbnQgZGVwZW5kZW5jaWVzCi0gT25lIGRh\n      eSB3ZSdsbCBuZWVkIHRvIGltcGxlbWVudCBhIGJ1bmRsZXJlc3F1ZSBzeXN0\n      ZW0sIGJ1dCBub3QgdG9kYXkKCkxpdmUgVXBkYXRlIERlbW8KLSBIb3QgcmVs\n      b2FkIGNzcwotIERpc3BsYXkgRGVtbyBSdW50aW1lIEVycm9ycyBpbiBjb25z\n      b2xlCgpPcGVuIHB1Ymxpc2hlZCBwYWdlIGluIGVkaXRvciBhbmQgcnVuIGxp\n      dmUgZGVtbyB3aXRoIHNhbWUgc3RhdGUgYXMgd2hlbiBlZGl0b3Igd2FzIG9w\n      ZW5lZAotIFBhc3MgZ2l0IHJlcG8vYnJhbmNoIG1ldGFkYXRhIHRvIHB1Ymxp\n      c2hlZCBwYWdlIGZvciB1c2UgaW4gZWRpdG9yCgpQZXJzaXN0IHN0YXRlIGFj\n      cm9zcyBkZW1vIHJlbG9hZHMKCk9yZ2FuaXplIEZpbGUgdHJlZSBieSB0eXBl\n      CkZpbGUgaWNvbnMKCkRpc3BsYXkgRGlmZnMKCkZpcnN0IGF1dGggZG9lc24n\n      dCBkaXNwbGF5IGluIGJhcgoKQ2FjaGUgR2l0IHRyZWVzIGFuZCBmaWxlcyBp\n      biBzb21lIGZvcm0gb2YgbG9jYWwgc3RvcmFnZQoKU29tZXRpbWVzIGVkaXRv\n      ciBhcHBlYXJzIGJsYW5rIHdoZW4gc3dpdGNoaW5nIGZpbGVzCgpFZGl0b3Ig\n      cGx1Z2lucwotIHN0YXRpYyBhbmFseXNpcwotIGZpbmQgaW4gZmlsZXMKLSBz\n      b3VyY2UgZmlsZSBoeWdpZW5lCg==\n    \"\"\"\n\n    decoded = \"\"\"\n      TODO\n      ----\n      Bundled Dependencies\n      - Build bundled dependencies into published script\n      - Dependency source should not be in revision control\n      - requires and module.exports\n      - inter-component and intra-component dependencies\n      - One day we'll need to implement a bundleresque system, but not today\n\n      Live Update Demo\n      - Hot reload css\n      - Display Demo Runtime Errors in console\n\n      Open published page in editor and run live demo with same state as when editor was opened\n      - Pass git repo/branch metadata to published page for use in editor\n\n      Persist state across demo reloads\n\n      Organize File tree by type\n      File icons\n\n      Display Diffs\n\n      First auth doesn't display in bar\n\n      Cache Git trees and files in some form of local storage\n\n      Sometimes editor appears blank when switching files\n\n      Editor plugins\n      - static analysis\n      - find in files\n      - source file hygiene\n\n    \"\"\"\n\n    # Note: loses new lines\n    assert.equal Base64.encode(decoded), encoded.replace(/\\n/g, \"\")\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "lib/base64-js": {
          "path": "lib/base64-js",
          "content": "'use strict'\n\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nfunction init () {\n  var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n  for (var i = 0, len = code.length; i < len; ++i) {\n    lookup[i] = code[i]\n    revLookup[code.charCodeAt(i)] = i\n  }\n\n  revLookup['-'.charCodeAt(0)] = 62\n  revLookup['_'.charCodeAt(0)] = 63\n}\n\ninit()\n\nfunction toByteArray (b64) {\n  var i, j, l, tmp, placeHolders, arr\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // the number of equal signs (place holders)\n  // if there are two placeholders, than the two characters before it\n  // represent one byte\n  // if there is only one, then the three characters before it represent 2 bytes\n  // this is just a cheap hack to not do indexOf twice\n  placeHolders = b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0\n\n  // base64 is 4/3 + up to two characters of the original data\n  arr = new Arr(len * 3 / 4 - placeHolders)\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  l = placeHolders > 0 ? len - 4 : len\n\n  var L = 0\n\n  for (i = 0, j = 0; i < l; i += 4, j += 3) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]\n    arr[L++] = (tmp >> 16) & 0xFF\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  if (placeHolders === 2) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[L++] = tmp & 0xFF\n  } else if (placeHolders === 1) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var output = ''\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    output += lookup[tmp >> 2]\n    output += lookup[(tmp << 4) & 0x3F]\n    output += '=='\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])\n    output += lookup[tmp >> 10]\n    output += lookup[(tmp >> 4) & 0x3F]\n    output += lookup[(tmp << 2) & 0x3F]\n    output += '='\n  }\n\n  parts.push(output)\n\n  return parts.join('')\n}",
          "type": "blob"
        },
        "lib/text-encoder": {
          "path": "lib/text-encoder",
          "content": "function TextEncoderLite() {\n}\nfunction TextDecoderLite() {\n}\n\nmodule.exports = {\n  encoder: TextEncoderLite,\n  decoder: TextDecoderLite\n};\n\n(function () {\n'use strict';\n\n// Taken from https://github.com/feross/buffer/blob/master/index.js\n// Thanks Feross et al! :-)\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n  var i = 0\n\n  for (; i < length; i++) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (leadSurrogate) {\n        // 2 leads in a row\n        if (codePoint < 0xDC00) {\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          leadSurrogate = codePoint\n          continue\n        } else {\n          // valid surrogate pair\n          codePoint = leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00 | 0x10000\n          leadSurrogate = null\n        }\n      } else {\n        // no lead yet\n\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else {\n          // valid lead\n          leadSurrogate = codePoint\n          continue\n        }\n      }\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n      leadSurrogate = null\n    }\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x200000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction utf8Slice (buf, start, end) {\n  var res = ''\n  var tmp = ''\n  end = Math.min(buf.length, end || Infinity)\n  start = start || 0;\n\n  for (var i = start; i < end; i++) {\n    if (buf[i] <= 0x7F) {\n      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])\n      tmp = ''\n    } else {\n      tmp += '%' + buf[i].toString(16)\n    }\n  }\n\n  return res + decodeUtf8Char(tmp)\n}\n\nfunction decodeUtf8Char (str) {\n  try {\n    return decodeURIComponent(str)\n  } catch (err) {\n    return String.fromCharCode(0xFFFD) // UTF 8 invalid char\n  }\n}\n\nTextEncoderLite.prototype.encode = function (str) {\n  var result;\n\n  if ('undefined' === typeof Uint8Array) {\n    result = utf8ToBytes(str);\n  } else {\n    result = new Uint8Array(utf8ToBytes(str));\n  }\n\n  return result;\n};\n\nTextDecoderLite.prototype.decode = function (bytes) {\n  return utf8Slice(bytes, 0, bytes.length);\n}\n\n}());",
          "type": "blob"
        },
        "main": {
          "path": "main",
          "content": "(function() {\n  var Base64Js, Decoder, Encoder, decoder, encoder, _ref;\n\n  Base64Js = require(\"../lib/base64-js\");\n\n  _ref = require(\"../lib/text-encoder\"), Decoder = _ref.decoder, Encoder = _ref.encoder;\n\n  encoder = new Encoder('utf-8');\n\n  decoder = new Decoder('utf-8');\n\n  module.exports = {\n    encode: function(s) {\n      return Base64Js.fromByteArray(encoder.encode(s));\n    },\n    decode: function(b64string) {\n      return decoder.decode(Base64Js.toByteArray(b64string.replace(/\\n/g, '')));\n    }\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"version\":\"0.9.2\"};",
          "type": "blob"
        },
        "test/base64": {
          "path": "test/base64",
          "content": "(function() {\n  var Base64, Base64Js, Decoder;\n\n  Base64 = require(\"../main\");\n\n  Base64Js = require(\"../lib/base64-js\");\n\n  Decoder = require(\"../lib/text-encoder\").decoder;\n\n  describe(\"Base64\", function() {\n    it(\"should encode\", function() {\n      return assert.equal(Base64.encode(\"hello\"), \"aGVsbG8=\");\n    });\n    it(\"should decode\", function() {\n      return assert.equal(Base64.decode(\"aGVsbG8=\"), \"hello\");\n    });\n    it(\"should work with utf-8\", function() {\n      return assert.equal(Base64.decode(\"ZMO8ZGVy\"), \"düder\");\n    });\n    it(\"should work with utf-8\", function() {\n      return assert.equal(Base64.encode(\"düder\"), \"ZMO8ZGVy\");\n    });\n    it(\"should work with astral emojis\", function() {\n      var burger, decoder, result;\n      decoder = new Decoder('utf8');\n      result = decoder.decode(Base64Js.toByteArray(\"8J+NlAo=\"));\n      burger = \"\\uD83C\\uDF54\\n\";\n      return assert.equal(result, burger);\n    });\n    it(\"should decode long strings\", function() {\n      var decoded, encoded;\n      encoded = \"VE9ETwotLS0tCkJ1bmRsZWQgRGVwZW5kZW5jaWVzCi0gQnVpbGQgYnVuZGxl\\nZCBkZXBlbmRlbmNpZXMgaW50byBwdWJsaXNoZWQgc2NyaXB0Ci0gRGVwZW5k\\nZW5jeSBzb3VyY2Ugc2hvdWxkIG5vdCBiZSBpbiByZXZpc2lvbiBjb250cm9s\\nCi0gcmVxdWlyZXMgYW5kIG1vZHVsZS5leHBvcnRzCi0gaW50ZXItY29tcG9u\\nZW50IGFuZCBpbnRyYS1jb21wb25lbnQgZGVwZW5kZW5jaWVzCi0gT25lIGRh\\neSB3ZSdsbCBuZWVkIHRvIGltcGxlbWVudCBhIGJ1bmRsZXJlc3F1ZSBzeXN0\\nZW0sIGJ1dCBub3QgdG9kYXkKCkxpdmUgVXBkYXRlIERlbW8KLSBIb3QgcmVs\\nb2FkIGNzcwotIERpc3BsYXkgRGVtbyBSdW50aW1lIEVycm9ycyBpbiBjb25z\\nb2xlCgpPcGVuIHB1Ymxpc2hlZCBwYWdlIGluIGVkaXRvciBhbmQgcnVuIGxp\\ndmUgZGVtbyB3aXRoIHNhbWUgc3RhdGUgYXMgd2hlbiBlZGl0b3Igd2FzIG9w\\nZW5lZAotIFBhc3MgZ2l0IHJlcG8vYnJhbmNoIG1ldGFkYXRhIHRvIHB1Ymxp\\nc2hlZCBwYWdlIGZvciB1c2UgaW4gZWRpdG9yCgpQZXJzaXN0IHN0YXRlIGFj\\ncm9zcyBkZW1vIHJlbG9hZHMKCk9yZ2FuaXplIEZpbGUgdHJlZSBieSB0eXBl\\nCkZpbGUgaWNvbnMKCkRpc3BsYXkgRGlmZnMKCkZpcnN0IGF1dGggZG9lc24n\\ndCBkaXNwbGF5IGluIGJhcgoKQ2FjaGUgR2l0IHRyZWVzIGFuZCBmaWxlcyBp\\nbiBzb21lIGZvcm0gb2YgbG9jYWwgc3RvcmFnZQoKU29tZXRpbWVzIGVkaXRv\\nciBhcHBlYXJzIGJsYW5rIHdoZW4gc3dpdGNoaW5nIGZpbGVzCgpFZGl0b3Ig\\ncGx1Z2lucwotIHN0YXRpYyBhbmFseXNpcwotIGZpbmQgaW4gZmlsZXMKLSBz\\nb3VyY2UgZmlsZSBoeWdpZW5lCg==\";\n      decoded = \"TODO\\n----\\nBundled Dependencies\\n- Build bundled dependencies into published script\\n- Dependency source should not be in revision control\\n- requires and module.exports\\n- inter-component and intra-component dependencies\\n- One day we'll need to implement a bundleresque system, but not today\\n\\nLive Update Demo\\n- Hot reload css\\n- Display Demo Runtime Errors in console\\n\\nOpen published page in editor and run live demo with same state as when editor was opened\\n- Pass git repo/branch metadata to published page for use in editor\\n\\nPersist state across demo reloads\\n\\nOrganize File tree by type\\nFile icons\\n\\nDisplay Diffs\\n\\nFirst auth doesn't display in bar\\n\\nCache Git trees and files in some form of local storage\\n\\nSometimes editor appears blank when switching files\\n\\nEditor plugins\\n- static analysis\\n- find in files\\n- source file hygiene\\n\";\n      return assert.equal(Base64.decode(encoded), decoded);\n    });\n    return it(\"should encode long strings\", function() {\n      var decoded, encoded;\n      encoded = \"VE9ETwotLS0tCkJ1bmRsZWQgRGVwZW5kZW5jaWVzCi0gQnVpbGQgYnVuZGxl\\nZCBkZXBlbmRlbmNpZXMgaW50byBwdWJsaXNoZWQgc2NyaXB0Ci0gRGVwZW5k\\nZW5jeSBzb3VyY2Ugc2hvdWxkIG5vdCBiZSBpbiByZXZpc2lvbiBjb250cm9s\\nCi0gcmVxdWlyZXMgYW5kIG1vZHVsZS5leHBvcnRzCi0gaW50ZXItY29tcG9u\\nZW50IGFuZCBpbnRyYS1jb21wb25lbnQgZGVwZW5kZW5jaWVzCi0gT25lIGRh\\neSB3ZSdsbCBuZWVkIHRvIGltcGxlbWVudCBhIGJ1bmRsZXJlc3F1ZSBzeXN0\\nZW0sIGJ1dCBub3QgdG9kYXkKCkxpdmUgVXBkYXRlIERlbW8KLSBIb3QgcmVs\\nb2FkIGNzcwotIERpc3BsYXkgRGVtbyBSdW50aW1lIEVycm9ycyBpbiBjb25z\\nb2xlCgpPcGVuIHB1Ymxpc2hlZCBwYWdlIGluIGVkaXRvciBhbmQgcnVuIGxp\\ndmUgZGVtbyB3aXRoIHNhbWUgc3RhdGUgYXMgd2hlbiBlZGl0b3Igd2FzIG9w\\nZW5lZAotIFBhc3MgZ2l0IHJlcG8vYnJhbmNoIG1ldGFkYXRhIHRvIHB1Ymxp\\nc2hlZCBwYWdlIGZvciB1c2UgaW4gZWRpdG9yCgpQZXJzaXN0IHN0YXRlIGFj\\ncm9zcyBkZW1vIHJlbG9hZHMKCk9yZ2FuaXplIEZpbGUgdHJlZSBieSB0eXBl\\nCkZpbGUgaWNvbnMKCkRpc3BsYXkgRGlmZnMKCkZpcnN0IGF1dGggZG9lc24n\\ndCBkaXNwbGF5IGluIGJhcgoKQ2FjaGUgR2l0IHRyZWVzIGFuZCBmaWxlcyBp\\nbiBzb21lIGZvcm0gb2YgbG9jYWwgc3RvcmFnZQoKU29tZXRpbWVzIGVkaXRv\\nciBhcHBlYXJzIGJsYW5rIHdoZW4gc3dpdGNoaW5nIGZpbGVzCgpFZGl0b3Ig\\ncGx1Z2lucwotIHN0YXRpYyBhbmFseXNpcwotIGZpbmQgaW4gZmlsZXMKLSBz\\nb3VyY2UgZmlsZSBoeWdpZW5lCg==\";\n      decoded = \"TODO\\n----\\nBundled Dependencies\\n- Build bundled dependencies into published script\\n- Dependency source should not be in revision control\\n- requires and module.exports\\n- inter-component and intra-component dependencies\\n- One day we'll need to implement a bundleresque system, but not today\\n\\nLive Update Demo\\n- Hot reload css\\n- Display Demo Runtime Errors in console\\n\\nOpen published page in editor and run live demo with same state as when editor was opened\\n- Pass git repo/branch metadata to published page for use in editor\\n\\nPersist state across demo reloads\\n\\nOrganize File tree by type\\nFile icons\\n\\nDisplay Diffs\\n\\nFirst auth doesn't display in bar\\n\\nCache Git trees and files in some form of local storage\\n\\nSometimes editor appears blank when switching files\\n\\nEditor plugins\\n- static analysis\\n- find in files\\n- source file hygiene\\n\";\n      return assert.equal(Base64.encode(decoded), encoded.replace(/\\n/g, \"\"));\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "config": {
        "version": "0.9.2"
      },
      "version": "0.9.2",
      "entryPoint": "main",
      "repository": {
        "branch": "v0.9.2",
        "default_branch": "master",
        "full_name": "distri/base64",
        "homepage": null,
        "description": null,
        "html_url": "https://github.com/distri/base64",
        "url": "https://api.github.com/repos/distri/base64",
        "publishBranch": "gh-pages"
      },
      "dependencies": {}
    },
    "bindable": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "The MIT License (MIT)\n\nCopyright (c) 2014 distri\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
          "mode": "100644",
          "type": "blob"
        },
        "README.coffee.md": {
          "path": "README.coffee.md",
          "content": "Bindable\n========\n\nAdd event binding to objects.\n\n>     bindable = Bindable()\n>     bindable.on \"greet\", ->\n>       console.log \"yo!\"\n>     bindable.trigger \"greet\"\n>     #=> \"yo!\" is printed to log\n\nUse as a mixin.\n\n>    self.include Bindable\n\n    module.exports = (I={}, self={}) ->\n      eventCallbacks = {}\n\nAdds a function as an event listener.\n\nThis will call `coolEventHandler` after `yourObject.trigger \"someCustomEvent\"`\nis called.\n\n>     yourObject.on \"someCustomEvent\", coolEventHandler\n\nHandlers can be attached to namespaces as well. The namespaces are only used\nfor finer control of targeting event removal. For example if you are making a\ncustom drawing system you could unbind `\".Drawable\"` events and add your own.\n\n>     yourObject.on \"\"\n\n      self.on = (namespacedEvent, callback) ->\n        [event, namespace] = namespacedEvent.split(\".\")\n\n        # HACK: Here we annotate the callback function with namespace metadata\n        # This will probably lead to some strange edge cases, but should work fine\n        # for simple cases.\n        if namespace\n          callback.__PIXIE ||= {}\n          callback.__PIXIE[namespace] = true\n\n        eventCallbacks[event] ||= []\n        eventCallbacks[event].push(callback)\n\n        return self\n\nRemoves a specific event listener, or all event listeners if\nno specific listener is given.\n\nRemoves the handler coolEventHandler from the event `\"someCustomEvent\"` while\nleaving the other events intact.\n\n>     yourObject.off \"someCustomEvent\", coolEventHandler\n\nRemoves all handlers attached to `\"anotherCustomEvent\"`\n\n>     yourObject.off \"anotherCustomEvent\"\n\nRemove all handlers from the `\".Drawable\" namespace`\n\n>     yourObject.off \".Drawable\"\n\n      self.off = (namespacedEvent, callback) ->\n        [event, namespace] = namespacedEvent.split(\".\")\n\n        if event\n          eventCallbacks[event] ||= []\n\n          if namespace\n            # Select only the callbacks that do not have this namespace metadata\n            eventCallbacks[event] = eventCallbacks.filter (callback) ->\n              !callback.__PIXIE?[namespace]?\n\n          else\n            if callback\n              remove eventCallbacks[event], callback\n            else\n              eventCallbacks[event] = []\n        else if namespace\n          # No event given\n          # Select only the callbacks that do not have this namespace metadata\n          # for any events bound\n          for key, callbacks of eventCallbacks\n            eventCallbacks[key] = callbacks.filter (callback) ->\n              !callback.__PIXIE?[namespace]?\n\n        return self\n\nCalls all listeners attached to the specified event.\n\n>     # calls each event handler bound to \"someCustomEvent\"\n>     yourObject.trigger \"someCustomEvent\"\n\nAdditional parameters can be passed to the handlers.\n\n>     yourObject.trigger \"someEvent\", \"hello\", \"anotherParameter\"\n\n      self.trigger = (event, parameters...) ->\n        callbacks = eventCallbacks[event]\n\n        if callbacks\n          callbacks.forEach (callback) ->\n            callback.apply(self, parameters)\n\n        return self\n\n      return self\n\nHelpers\n-------\n\nRemove a value from an array.\n\n    remove = (array, value) ->\n      index = array.indexOf(value)\n\n      if index >= 0\n        array.splice(index, 1)[0]\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "entryPoint: \"README\"\nversion: \"0.2.0\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/bindable.coffee": {
          "path": "test/bindable.coffee",
          "content": "test = it\nok = assert\nequal = assert.equal\n\nBindable = require \"../README\"\n\ndescribe \"Bindable\", ->\n\n  test \"#bind and #trigger\", ->\n    o = Bindable()\n\n    o.on(\"test\", -> ok true)\n\n    o.trigger(\"test\")\n\n  test \"Multiple bindings\", ->\n    o = Bindable()\n\n    o.on(\"test\", -> ok true)\n    o.on(\"test\", -> ok true)\n\n    o.trigger(\"test\")\n\n  test \"#trigger arguments\", ->\n    o = Bindable()\n\n    param1 = \"the message\"\n    param2 = 3\n\n    o.on \"test\", (p1, p2) ->\n      equal(p1, param1)\n      equal(p2, param2)\n\n    o.trigger \"test\", param1, param2\n\n  test \"#unbind\", ->\n    o = Bindable()\n\n    callback = ->\n      ok false\n\n    o.on \"test\", callback\n    # Unbind specific event\n    o.off \"test\", callback\n    o.trigger \"test\"\n\n    o.on \"test\", callback\n    # Unbind all events\n    o.off \"test\"\n    o.trigger \"test\"\n\n  test \"#trigger namespace\", ->\n    o = Bindable()\n    o.on \"test.TestNamespace\", ->\n      ok true\n\n    o.trigger \"test\"\n\n    o.off \".TestNamespace\"\n    o.trigger \"test\"\n\n  test \"#unbind namespaced\", ->\n    o = Bindable()\n\n    o.on \"test.TestNamespace\", ->\n      ok true\n\n    o.trigger \"test\"\n\n    o.off \".TestNamespace\", ->\n    o.trigger \"test\"\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "README": {
          "path": "README",
          "content": "(function() {\n  var remove,\n    __slice = [].slice;\n\n  module.exports = function(I, self) {\n    var eventCallbacks;\n    if (I == null) {\n      I = {};\n    }\n    if (self == null) {\n      self = {};\n    }\n    eventCallbacks = {};\n    self.on = function(namespacedEvent, callback) {\n      var event, namespace, _ref;\n      _ref = namespacedEvent.split(\".\"), event = _ref[0], namespace = _ref[1];\n      if (namespace) {\n        callback.__PIXIE || (callback.__PIXIE = {});\n        callback.__PIXIE[namespace] = true;\n      }\n      eventCallbacks[event] || (eventCallbacks[event] = []);\n      eventCallbacks[event].push(callback);\n      return self;\n    };\n    self.off = function(namespacedEvent, callback) {\n      var callbacks, event, key, namespace, _ref;\n      _ref = namespacedEvent.split(\".\"), event = _ref[0], namespace = _ref[1];\n      if (event) {\n        eventCallbacks[event] || (eventCallbacks[event] = []);\n        if (namespace) {\n          eventCallbacks[event] = eventCallbacks.filter(function(callback) {\n            var _ref1;\n            return ((_ref1 = callback.__PIXIE) != null ? _ref1[namespace] : void 0) == null;\n          });\n        } else {\n          if (callback) {\n            remove(eventCallbacks[event], callback);\n          } else {\n            eventCallbacks[event] = [];\n          }\n        }\n      } else if (namespace) {\n        for (key in eventCallbacks) {\n          callbacks = eventCallbacks[key];\n          eventCallbacks[key] = callbacks.filter(function(callback) {\n            var _ref1;\n            return ((_ref1 = callback.__PIXIE) != null ? _ref1[namespace] : void 0) == null;\n          });\n        }\n      }\n      return self;\n    };\n    self.trigger = function() {\n      var callbacks, event, parameters;\n      event = arguments[0], parameters = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      callbacks = eventCallbacks[event];\n      if (callbacks) {\n        callbacks.forEach(function(callback) {\n          return callback.apply(self, parameters);\n        });\n      }\n      return self;\n    };\n    return self;\n  };\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"entryPoint\":\"README\",\"version\":\"0.2.0\"};",
          "type": "blob"
        },
        "test/bindable": {
          "path": "test/bindable",
          "content": "(function() {\n  var Bindable, equal, ok, test;\n\n  test = it;\n\n  ok = assert;\n\n  equal = assert.equal;\n\n  Bindable = require(\"../README\");\n\n  describe(\"Bindable\", function() {\n    test(\"#bind and #trigger\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test\", function() {\n        return ok(true);\n      });\n      return o.trigger(\"test\");\n    });\n    test(\"Multiple bindings\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test\", function() {\n        return ok(true);\n      });\n      o.on(\"test\", function() {\n        return ok(true);\n      });\n      return o.trigger(\"test\");\n    });\n    test(\"#trigger arguments\", function() {\n      var o, param1, param2;\n      o = Bindable();\n      param1 = \"the message\";\n      param2 = 3;\n      o.on(\"test\", function(p1, p2) {\n        equal(p1, param1);\n        return equal(p2, param2);\n      });\n      return o.trigger(\"test\", param1, param2);\n    });\n    test(\"#unbind\", function() {\n      var callback, o;\n      o = Bindable();\n      callback = function() {\n        return ok(false);\n      };\n      o.on(\"test\", callback);\n      o.off(\"test\", callback);\n      o.trigger(\"test\");\n      o.on(\"test\", callback);\n      o.off(\"test\");\n      return o.trigger(\"test\");\n    });\n    test(\"#trigger namespace\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test.TestNamespace\", function() {\n        return ok(true);\n      });\n      o.trigger(\"test\");\n      o.off(\".TestNamespace\");\n      return o.trigger(\"test\");\n    });\n    return test(\"#unbind namespaced\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test.TestNamespace\", function() {\n        return ok(true);\n      });\n      o.trigger(\"test\");\n      o.off(\".TestNamespace\", function() {});\n      return o.trigger(\"test\");\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "version": "0.2.0",
      "entryPoint": "README",
      "repository": {
        "branch": "master",
        "default_branch": "master",
        "full_name": "distri/bindable",
        "homepage": null,
        "description": "Event binding",
        "html_url": "https://github.com/distri/bindable",
        "url": "https://api.github.com/repos/distri/bindable",
        "publishBranch": "gh-pages"
      },
      "dependencies": {}
    },
    "model": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "The MIT License (MIT)\n\nCopyright (c) 2014 Daniel X Moore\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
          "mode": "100644",
          "type": "blob"
        },
        "README.md": {
          "path": "README.md",
          "content": "Model\n=====\n\nThe `Model` module provides helper methods to compose nested data models.\n\nModels uses [Observable](/observable/docs) to keep the internal data in sync.\n",
          "mode": "100644",
          "type": "blob"
        },
        "core.coffee.md": {
          "path": "core.coffee.md",
          "content": "Core\n====\n\nThe Core module is used to add extended functionality to objects without\nextending `Object.prototype` directly.\n\n    Core = (I={}, self={}) ->\n      Object.assign self,\n\nExternal access to instance variables. Use of this property should be avoided\nin general, but can come in handy from time to time.\n\n>     #! example\n>     I =\n>       r: 255\n>       g: 0\n>       b: 100\n>\n>     myObject = Core(I)\n>\n>     [myObject.I.r, myObject.I.g, myObject.I.b]\n\n        I: I\n\nGenerates a public jQuery style getter / setter method for each `String` argument.\n\n>     #! example\n>     myObject = Core\n>       r: 255\n>       g: 0\n>       b: 100\n>\n>     myObject.attrAccessor \"r\", \"g\", \"b\"\n>\n>     myObject.r(254)\n\n        attrAccessor: (attrNames...) ->\n          attrNames.forEach (attrName) ->\n            self[attrName] = (newValue) ->\n              if arguments.length > 0\n                I[attrName] = newValue\n\n                return self\n              else\n                I[attrName]\n\n          return self\n\nGenerates a public jQuery style getter method for each String argument.\n\n>     #! example\n>     myObject = Core\n>       r: 255\n>       g: 0\n>       b: 100\n>\n>     myObject.attrReader \"r\", \"g\", \"b\"\n>\n>     [myObject.r(), myObject.g(), myObject.b()]\n\n        attrReader: (attrNames...) ->\n          attrNames.forEach (attrName) ->\n            self[attrName] = ->\n              I[attrName]\n\n          return self\n\nExtends this object with methods from the passed in object. A shortcut for Object.extend(self, methods)\n\n>     I =\n>       x: 30\n>       y: 40\n>       maxSpeed: 5\n>\n>     # we are using extend to give player\n>     # additional methods that Core doesn't have\n>     player = Core(I).extend\n>       increaseSpeed: ->\n>         I.maxSpeed += 1\n>\n>     player.increaseSpeed()\n\n        extend: (objects...) ->\n          Object.assign self, objects...\n\nIncludes a module in this object. A module is a constructor that takes two parameters, `I` and `self`\n\n>     myObject = Core()\n>     myObject.include(Bindable)\n\n>     # now you can bind handlers to functions\n>     myObject.bind \"someEvent\", ->\n>       alert(\"wow. that was easy.\")\n\n        include: (modules...) ->\n          for Module in modules\n            Module(I, self)\n\n          return self\n\n      return self\n\nExport\n\n    module.exports = Core\n",
          "mode": "100644",
          "type": "blob"
        },
        "main.coffee.md": {
          "path": "main.coffee.md",
          "content": "Model\n=====\n\nThe `Model` module provides helper methods to compose nested data models.\n\nModels uses [Observable](/observable/docs) to keep the internal data in sync.\n\n    Core = require \"./core\"\n    Observable = global.Observable ? require \"observable\"\n\n    module.exports = Model = (I={}, self=Core(I)) ->\n\n      self.extend\n\nBind a data model getter/setter to an attribute. The data model is bound directly to\nthe attribute and must be directly convertible to and from JSON.\n\n        attrData: (name, DataModel) ->\n          I[name] = DataModel(I[name])\n\n          Object.defineProperty self, name,\n            get: ->\n              I[name]\n            set: (value) ->\n              I[name] = DataModel(value)\n\nObserve any number of attributes as observables. For each attribute name passed in we expose a public getter/setter method and listen to changes when the value is set.\n\n        attrObservable: (names...) ->\n          names.forEach (name) ->\n            self[name] = Observable(I[name])\n\n            self[name].observe (newValue) ->\n              I[name] = newValue\n\n          return self\n\nObserve an attribute as a model. Treats the attribute given as an Observable\nmodel instance exposing a getter/setter method of the same name. The Model\nconstructor must be passed explicitly.\n\n        attrModel: (name, Model) ->\n          model = Model(I[name])\n\n          self[name] = Observable(model)\n\n          self[name].observe (newValue) ->\n            I[name] = newValue.I\n\n          return self\n\nObserve an attribute as an array of sub-models. This is the same as `attrModel`\nexcept the attribute is expected to be an array of models rather than a single one.\n\n        attrModels: (name, Model) ->\n          models = (I[name] or []).map (x) ->\n            Model(x)\n\n          self[name] = Observable(models)\n\n          self[name].observe (newValue) ->\n            I[name] = newValue.map (instance) ->\n              instance.I\n\n          return self\n\n        delegate: (names..., {to}) ->\n          names.forEach (name) ->\n            console.log \"delegating #{name} to #{to}\"\n            Object.defineProperty self, name,\n              get: ->\n                receiver = getValue self, to\n                receiver[name]\n              set: (value) ->\n                receiver = getValue self, to\n                setValue receiver, name, value\n\nThe JSON representation is kept up to date via the observable properites and resides in `I`.\n\n        toJSON: ->\n          I\n\nReturn our public object.\n\n      return self\n\n    isFn = (x) ->\n      typeof x is 'function'\n\n    getValue = (receiver, property) ->\n      if isFn receiver[property]\n        receiver[property]()\n      else\n        receiver[property]\n\n    setValue = (receiver, property, value) ->\n      target = receiver[property]\n\n      if isFn target\n        target.call(receiver, value)\n      else\n        receiver[property] = value\n\n    {defaults, extend} = require \"./util\"\n    Object.assign Model, {Core, Observable, defaults, extend}\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "version: \"0.2.0-pre.4\"\ndependencies:\n  observable: \"distri/observable:v0.3.8\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/core.coffee": {
          "path": "test/core.coffee",
          "content": "Core = require \"../core\"\n\nok = assert\nequals = assert.equal\ntest = it\n\ndescribe \"Core\", ->\n\n  test \"#extend\", ->\n    o = Core()\n\n    o.extend\n      test: \"jawsome\"\n\n    equals o.test, \"jawsome\"\n\n  test \"#attrAccessor\", ->\n    o = Core\n      test: \"my_val\"\n\n    o.attrAccessor(\"test\")\n\n    equals o.test(), \"my_val\"\n    equals o.test(\"new_val\"), o\n    equals o.test(), \"new_val\"\n\n  test \"#attrReader\", ->\n    o = Core\n      test: \"my_val\"\n\n    o.attrReader(\"test\")\n\n    equals o.test(), \"my_val\"\n    equals o.test(\"new_val\"), \"my_val\"\n    equals o.test(), \"my_val\"\n\n  test \"#include\", ->\n    o = Core\n      test: \"my_val\"\n\n    M = (I, self) ->\n      self.attrReader \"test\"\n\n      self.extend\n        test2: \"cool\"\n\n    ret = o.include M\n\n    equals ret, o, \"Should return self\"\n\n    equals o.test(), \"my_val\"\n    equals o.test2, \"cool\"\n\n  test \"#include multiple\", ->\n    o = Core\n      test: \"my_val\"\n\n    M = (I, self) ->\n      self.attrReader \"test\"\n\n      self.extend\n        test2: \"cool\"\n\n    M2 = (I, self) ->\n      self.extend\n        test2: \"coolio\"\n\n    o.include M, M2\n\n    equals o.test2, \"coolio\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/model.coffee": {
          "path": "test/model.coffee",
          "content": "Model = require \"../main\"\n\ndescribe 'Model', ->\n  # Association Testing model\n  Person = (I) ->\n    person = Model(I)\n\n    person.attrAccessor(\n      'firstName'\n      'lastName'\n      'suffix'\n    )\n\n    person.fullName = ->\n      \"#{@firstName()} #{@lastName()} #{@suffix()}\"\n\n    return person\n\n  describe \"#attrData\", ->\n    pointProto =\n      add: ({x, y}) ->\n        @x += x\n        @y += y\n\n    Point = ({x, y}) ->\n      Object.create pointProto,\n        x:\n          value: x\n        y:\n          value: y\n\n    it \"should expose a property mapping to the instance data\", ->\n      model = Model\n        position:\n          x: 5\n          y: 5\n\n      model.attrData \"position\", Point\n\n      assert model.position.add\n\n      model.position.x = 12\n      assert.equal model.position.x, model.I.position.x\n\n      model.position =\n        x: 9\n        y: 6\n\n      assert.equal model.position.y, 6\n      assert.equal model.I.position.x, 9\n\n  describe \"#attrObservable\", ->\n    it 'should allow for observing of attributes', ->\n      model = Model\n        name: \"Duder\"\n\n      model.attrObservable \"name\"\n\n      model.name(\"Dudeman\")\n\n      assert.equal model.name(), \"Dudeman\"\n\n    it 'should bind properties to observable attributes', ->\n      model = Model\n        name: \"Duder\"\n\n      model.attrObservable \"name\"\n\n      model.name(\"Dudeman\")\n\n      assert.equal model.name(), \"Dudeman\"\n      assert.equal model.name(), model.I.name\n\n  describe \"#attrModel\", ->\n    it \"should be a model instance\", ->\n      model = Model\n        person:\n          firstName: \"Duder\"\n          lastName: \"Mannington\"\n          suffix: \"Jr.\"\n\n      model.attrModel(\"person\", Person)\n\n      assert.equal model.person().fullName(), \"Duder Mannington Jr.\"\n\n    it \"should allow setting the associated model\", ->\n      model = Model\n        person:\n          firstName: \"Duder\"\n          lastName: \"Mannington\"\n          suffix: \"Jr.\"\n\n      model.attrModel(\"person\", Person)\n\n      otherPerson = Person\n        firstName: \"Mr.\"\n        lastName: \"Man\"\n\n      model.person(otherPerson)\n\n      assert.equal model.person().firstName(), \"Mr.\"\n\n    it \"shouldn't update the instance properties after it's been replaced\", ->\n      model = Model\n        person:\n          firstName: \"Duder\"\n          lastName: \"Mannington\"\n          suffix: \"Jr.\"\n\n      model.attrModel(\"person\", Person)\n\n      duder = model.person()\n\n      otherPerson = Person\n        firstName: \"Mr.\"\n        lastName: \"Man\"\n\n      model.person(otherPerson)\n\n      duder.firstName(\"Joe\")\n\n      assert.equal duder.I.firstName, \"Joe\"\n      assert.equal model.I.person.firstName, \"Mr.\"\n\n  describe \"#attrModels\", ->\n    it \"should have an array of model instances\", ->\n      model = Model\n        people: [{\n          firstName: \"Duder\"\n          lastName: \"Mannington\"\n          suffix: \"Jr.\"\n        }, {\n          firstName: \"Mr.\"\n          lastName: \"Mannington\"\n          suffix: \"Sr.\"\n        }]\n\n      model.attrModels(\"people\", Person)\n\n      assert.equal model.people()[0].fullName(), \"Duder Mannington Jr.\"\n\n    it \"should track pushes\", ->\n      model = Model\n        people: [{\n          firstName: \"Duder\"\n          lastName: \"Mannington\"\n          suffix: \"Jr.\"\n        }, {\n          firstName: \"Mr.\"\n          lastName: \"Mannington\"\n          suffix: \"Sr.\"\n        }]\n\n      model.attrModels(\"people\", Person)\n\n      model.people.push Person\n        firstName: \"JoJo\"\n        lastName: \"Loco\"\n\n      assert.equal model.people().length, 3\n      assert.equal model.I.people.length, 3\n\n    it \"should track pops\", ->\n      model = Model\n        people: [{\n          firstName: \"Duder\"\n          lastName: \"Mannington\"\n          suffix: \"Jr.\"\n        }, {\n          firstName: \"Mr.\"\n          lastName: \"Mannington\"\n          suffix: \"Sr.\"\n        }]\n\n      model.attrModels(\"people\", Person)\n\n      model.people.pop()\n\n      assert.equal model.people().length, 1\n      assert.equal model.I.people.length, 1\n\n  describe \"#delegate\", ->\n    it \"should delegate to another method\", ->\n      model = Model\n        position:\n          x: 1\n          y: 2\n          z: 3\n\n      model.attrReader \"position\"\n\n      model.delegate \"x\", \"y\", \"z\", to: \"position\"\n\n      assert.equal model.x, 1\n      assert.equal model.y, 2\n      assert.equal model.z, 3\n\n      model.x = 5\n\n      assert.equal model.position().x, 5\n      assert.equal model.I.position.x, 5\n\n    it \"should delegate to another property\", ->\n      model = Model\n        position:\n          x: 1\n          y: 2\n          z: 3\n\n      model.position = model.I.position\n\n      model.delegate \"x\", \"y\", \"z\", to: \"position\"\n\n      assert.equal model.x, 1\n      assert.equal model.y, 2\n      assert.equal model.z, 3\n\n      model.x = 5\n\n      assert.equal model.position.x, 5\n      assert.equal model.I.position.x, 5\n\n    it \"should delegate to methods just fine\", ->\n      model = Model\n        size:\n          width: 10\n          height: 20\n\n      model.attrData \"size\", ({width, height}) ->\n        width: -> width\n        height: -> height\n\n      model.delegate \"width\", \"height\", to: \"size\"\n\n      assert.equal model.width(), 10\n      assert.equal model.height(), 20\n\n  describe \"#toJSON\", ->\n    it \"should return an object appropriate for JSON serialization\", ->\n      model = Model\n        test: true\n\n      assert model.toJSON().test\n\n  describe \"#observeAll\", ->\n    it \"should observe all attributes of a simple model\"\n    ->  # TODO\n      model = Model\n        test: true\n        yolo: \"4life\"\n\n      model.observeAll()\n\n      assert model.test()\n      assert.equal model.yolo(), \"4life\"\n\n    it \"should camel case underscored names\"\n\n  describe \".defaults\", ->\n    it \"should expose defaults method\", ->\n      assert Model.defaults\n\n  describe \".extend\", ->\n    it \"should expose extend method\", ->\n      assert Model.extend\n",
          "mode": "100644",
          "type": "blob"
        },
        "util.coffee": {
          "path": "util.coffee",
          "content": "module.exports =\n  defaults: (target, objects...) ->\n    for object in objects\n      for name of object\n        unless target.hasOwnProperty(name)\n          target[name] = object[name]\n\n    return target\n\n  extend: Object.assign\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "core": {
          "path": "core",
          "content": "(function() {\n  var Core,\n    __slice = [].slice;\n\n  Core = function(I, self) {\n    if (I == null) {\n      I = {};\n    }\n    if (self == null) {\n      self = {};\n    }\n    Object.assign(self, {\n      I: I,\n      attrAccessor: function() {\n        var attrNames;\n        attrNames = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        attrNames.forEach(function(attrName) {\n          return self[attrName] = function(newValue) {\n            if (arguments.length > 0) {\n              I[attrName] = newValue;\n              return self;\n            } else {\n              return I[attrName];\n            }\n          };\n        });\n        return self;\n      },\n      attrReader: function() {\n        var attrNames;\n        attrNames = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        attrNames.forEach(function(attrName) {\n          return self[attrName] = function() {\n            return I[attrName];\n          };\n        });\n        return self;\n      },\n      extend: function() {\n        var objects;\n        objects = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        return Object.assign.apply(Object, [self].concat(__slice.call(objects)));\n      },\n      include: function() {\n        var Module, modules, _i, _len;\n        modules = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        for (_i = 0, _len = modules.length; _i < _len; _i++) {\n          Module = modules[_i];\n          Module(I, self);\n        }\n        return self;\n      }\n    });\n    return self;\n  };\n\n  module.exports = Core;\n\n}).call(this);\n",
          "type": "blob"
        },
        "main": {
          "path": "main",
          "content": "(function() {\n  var Core, Model, Observable, defaults, extend, getValue, isFn, setValue, _ref, _ref1,\n    __slice = [].slice;\n\n  Core = require(\"./core\");\n\n  Observable = (_ref = global.Observable) != null ? _ref : require(\"observable\");\n\n  module.exports = Model = function(I, self) {\n    if (I == null) {\n      I = {};\n    }\n    if (self == null) {\n      self = Core(I);\n    }\n    self.extend({\n      attrData: function(name, DataModel) {\n        I[name] = DataModel(I[name]);\n        return Object.defineProperty(self, name, {\n          get: function() {\n            return I[name];\n          },\n          set: function(value) {\n            return I[name] = DataModel(value);\n          }\n        });\n      },\n      attrObservable: function() {\n        var names;\n        names = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        names.forEach(function(name) {\n          self[name] = Observable(I[name]);\n          return self[name].observe(function(newValue) {\n            return I[name] = newValue;\n          });\n        });\n        return self;\n      },\n      attrModel: function(name, Model) {\n        var model;\n        model = Model(I[name]);\n        self[name] = Observable(model);\n        self[name].observe(function(newValue) {\n          return I[name] = newValue.I;\n        });\n        return self;\n      },\n      attrModels: function(name, Model) {\n        var models;\n        models = (I[name] || []).map(function(x) {\n          return Model(x);\n        });\n        self[name] = Observable(models);\n        self[name].observe(function(newValue) {\n          return I[name] = newValue.map(function(instance) {\n            return instance.I;\n          });\n        });\n        return self;\n      },\n      delegate: function() {\n        var names, to, _arg, _i;\n        names = 2 <= arguments.length ? __slice.call(arguments, 0, _i = arguments.length - 1) : (_i = 0, []), _arg = arguments[_i++];\n        to = _arg.to;\n        return names.forEach(function(name) {\n          console.log(\"delegating \" + name + \" to \" + to);\n          return Object.defineProperty(self, name, {\n            get: function() {\n              var receiver;\n              receiver = getValue(self, to);\n              return receiver[name];\n            },\n            set: function(value) {\n              var receiver;\n              receiver = getValue(self, to);\n              return setValue(receiver, name, value);\n            }\n          });\n        });\n      },\n      toJSON: function() {\n        return I;\n      }\n    });\n    return self;\n  };\n\n  isFn = function(x) {\n    return typeof x === 'function';\n  };\n\n  getValue = function(receiver, property) {\n    if (isFn(receiver[property])) {\n      return receiver[property]();\n    } else {\n      return receiver[property];\n    }\n  };\n\n  setValue = function(receiver, property, value) {\n    var target;\n    target = receiver[property];\n    if (isFn(target)) {\n      return target.call(receiver, value);\n    } else {\n      return receiver[property] = value;\n    }\n  };\n\n  _ref1 = require(\"./util\"), defaults = _ref1.defaults, extend = _ref1.extend;\n\n  Object.assign(Model, {\n    Core: Core,\n    Observable: Observable,\n    defaults: defaults,\n    extend: extend\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"version\":\"0.2.0-pre.4\",\"dependencies\":{\"observable\":\"distri/observable:v0.3.8\"}};",
          "type": "blob"
        },
        "test/core": {
          "path": "test/core",
          "content": "(function() {\n  var Core, equals, ok, test;\n\n  Core = require(\"../core\");\n\n  ok = assert;\n\n  equals = assert.equal;\n\n  test = it;\n\n  describe(\"Core\", function() {\n    test(\"#extend\", function() {\n      var o;\n      o = Core();\n      o.extend({\n        test: \"jawsome\"\n      });\n      return equals(o.test, \"jawsome\");\n    });\n    test(\"#attrAccessor\", function() {\n      var o;\n      o = Core({\n        test: \"my_val\"\n      });\n      o.attrAccessor(\"test\");\n      equals(o.test(), \"my_val\");\n      equals(o.test(\"new_val\"), o);\n      return equals(o.test(), \"new_val\");\n    });\n    test(\"#attrReader\", function() {\n      var o;\n      o = Core({\n        test: \"my_val\"\n      });\n      o.attrReader(\"test\");\n      equals(o.test(), \"my_val\");\n      equals(o.test(\"new_val\"), \"my_val\");\n      return equals(o.test(), \"my_val\");\n    });\n    test(\"#include\", function() {\n      var M, o, ret;\n      o = Core({\n        test: \"my_val\"\n      });\n      M = function(I, self) {\n        self.attrReader(\"test\");\n        return self.extend({\n          test2: \"cool\"\n        });\n      };\n      ret = o.include(M);\n      equals(ret, o, \"Should return self\");\n      equals(o.test(), \"my_val\");\n      return equals(o.test2, \"cool\");\n    });\n    return test(\"#include multiple\", function() {\n      var M, M2, o;\n      o = Core({\n        test: \"my_val\"\n      });\n      M = function(I, self) {\n        self.attrReader(\"test\");\n        return self.extend({\n          test2: \"cool\"\n        });\n      };\n      M2 = function(I, self) {\n        return self.extend({\n          test2: \"coolio\"\n        });\n      };\n      o.include(M, M2);\n      return equals(o.test2, \"coolio\");\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "test/model": {
          "path": "test/model",
          "content": "(function() {\n  var Model;\n\n  Model = require(\"../main\");\n\n  describe('Model', function() {\n    var Person;\n    Person = function(I) {\n      var person;\n      person = Model(I);\n      person.attrAccessor('firstName', 'lastName', 'suffix');\n      person.fullName = function() {\n        return \"\" + (this.firstName()) + \" \" + (this.lastName()) + \" \" + (this.suffix());\n      };\n      return person;\n    };\n    describe(\"#attrData\", function() {\n      var Point, pointProto;\n      pointProto = {\n        add: function(_arg) {\n          var x, y;\n          x = _arg.x, y = _arg.y;\n          this.x += x;\n          return this.y += y;\n        }\n      };\n      Point = function(_arg) {\n        var x, y;\n        x = _arg.x, y = _arg.y;\n        return Object.create(pointProto, {\n          x: {\n            value: x\n          },\n          y: {\n            value: y\n          }\n        });\n      };\n      return it(\"should expose a property mapping to the instance data\", function() {\n        var model;\n        model = Model({\n          position: {\n            x: 5,\n            y: 5\n          }\n        });\n        model.attrData(\"position\", Point);\n        assert(model.position.add);\n        model.position.x = 12;\n        assert.equal(model.position.x, model.I.position.x);\n        model.position = {\n          x: 9,\n          y: 6\n        };\n        assert.equal(model.position.y, 6);\n        return assert.equal(model.I.position.x, 9);\n      });\n    });\n    describe(\"#attrObservable\", function() {\n      it('should allow for observing of attributes', function() {\n        var model;\n        model = Model({\n          name: \"Duder\"\n        });\n        model.attrObservable(\"name\");\n        model.name(\"Dudeman\");\n        return assert.equal(model.name(), \"Dudeman\");\n      });\n      return it('should bind properties to observable attributes', function() {\n        var model;\n        model = Model({\n          name: \"Duder\"\n        });\n        model.attrObservable(\"name\");\n        model.name(\"Dudeman\");\n        assert.equal(model.name(), \"Dudeman\");\n        return assert.equal(model.name(), model.I.name);\n      });\n    });\n    describe(\"#attrModel\", function() {\n      it(\"should be a model instance\", function() {\n        var model;\n        model = Model({\n          person: {\n            firstName: \"Duder\",\n            lastName: \"Mannington\",\n            suffix: \"Jr.\"\n          }\n        });\n        model.attrModel(\"person\", Person);\n        return assert.equal(model.person().fullName(), \"Duder Mannington Jr.\");\n      });\n      it(\"should allow setting the associated model\", function() {\n        var model, otherPerson;\n        model = Model({\n          person: {\n            firstName: \"Duder\",\n            lastName: \"Mannington\",\n            suffix: \"Jr.\"\n          }\n        });\n        model.attrModel(\"person\", Person);\n        otherPerson = Person({\n          firstName: \"Mr.\",\n          lastName: \"Man\"\n        });\n        model.person(otherPerson);\n        return assert.equal(model.person().firstName(), \"Mr.\");\n      });\n      return it(\"shouldn't update the instance properties after it's been replaced\", function() {\n        var duder, model, otherPerson;\n        model = Model({\n          person: {\n            firstName: \"Duder\",\n            lastName: \"Mannington\",\n            suffix: \"Jr.\"\n          }\n        });\n        model.attrModel(\"person\", Person);\n        duder = model.person();\n        otherPerson = Person({\n          firstName: \"Mr.\",\n          lastName: \"Man\"\n        });\n        model.person(otherPerson);\n        duder.firstName(\"Joe\");\n        assert.equal(duder.I.firstName, \"Joe\");\n        return assert.equal(model.I.person.firstName, \"Mr.\");\n      });\n    });\n    describe(\"#attrModels\", function() {\n      it(\"should have an array of model instances\", function() {\n        var model;\n        model = Model({\n          people: [\n            {\n              firstName: \"Duder\",\n              lastName: \"Mannington\",\n              suffix: \"Jr.\"\n            }, {\n              firstName: \"Mr.\",\n              lastName: \"Mannington\",\n              suffix: \"Sr.\"\n            }\n          ]\n        });\n        model.attrModels(\"people\", Person);\n        return assert.equal(model.people()[0].fullName(), \"Duder Mannington Jr.\");\n      });\n      it(\"should track pushes\", function() {\n        var model;\n        model = Model({\n          people: [\n            {\n              firstName: \"Duder\",\n              lastName: \"Mannington\",\n              suffix: \"Jr.\"\n            }, {\n              firstName: \"Mr.\",\n              lastName: \"Mannington\",\n              suffix: \"Sr.\"\n            }\n          ]\n        });\n        model.attrModels(\"people\", Person);\n        model.people.push(Person({\n          firstName: \"JoJo\",\n          lastName: \"Loco\"\n        }));\n        assert.equal(model.people().length, 3);\n        return assert.equal(model.I.people.length, 3);\n      });\n      return it(\"should track pops\", function() {\n        var model;\n        model = Model({\n          people: [\n            {\n              firstName: \"Duder\",\n              lastName: \"Mannington\",\n              suffix: \"Jr.\"\n            }, {\n              firstName: \"Mr.\",\n              lastName: \"Mannington\",\n              suffix: \"Sr.\"\n            }\n          ]\n        });\n        model.attrModels(\"people\", Person);\n        model.people.pop();\n        assert.equal(model.people().length, 1);\n        return assert.equal(model.I.people.length, 1);\n      });\n    });\n    describe(\"#delegate\", function() {\n      it(\"should delegate to another method\", function() {\n        var model;\n        model = Model({\n          position: {\n            x: 1,\n            y: 2,\n            z: 3\n          }\n        });\n        model.attrReader(\"position\");\n        model.delegate(\"x\", \"y\", \"z\", {\n          to: \"position\"\n        });\n        assert.equal(model.x, 1);\n        assert.equal(model.y, 2);\n        assert.equal(model.z, 3);\n        model.x = 5;\n        assert.equal(model.position().x, 5);\n        return assert.equal(model.I.position.x, 5);\n      });\n      it(\"should delegate to another property\", function() {\n        var model;\n        model = Model({\n          position: {\n            x: 1,\n            y: 2,\n            z: 3\n          }\n        });\n        model.position = model.I.position;\n        model.delegate(\"x\", \"y\", \"z\", {\n          to: \"position\"\n        });\n        assert.equal(model.x, 1);\n        assert.equal(model.y, 2);\n        assert.equal(model.z, 3);\n        model.x = 5;\n        assert.equal(model.position.x, 5);\n        return assert.equal(model.I.position.x, 5);\n      });\n      return it(\"should delegate to methods just fine\", function() {\n        var model;\n        model = Model({\n          size: {\n            width: 10,\n            height: 20\n          }\n        });\n        model.attrData(\"size\", function(_arg) {\n          var height, width;\n          width = _arg.width, height = _arg.height;\n          return {\n            width: function() {\n              return width;\n            },\n            height: function() {\n              return height;\n            }\n          };\n        });\n        model.delegate(\"width\", \"height\", {\n          to: \"size\"\n        });\n        assert.equal(model.width(), 10);\n        return assert.equal(model.height(), 20);\n      });\n    });\n    describe(\"#toJSON\", function() {\n      return it(\"should return an object appropriate for JSON serialization\", function() {\n        var model;\n        model = Model({\n          test: true\n        });\n        return assert(model.toJSON().test);\n      });\n    });\n    describe(\"#observeAll\", function() {\n      it(\"should observe all attributes of a simple model\");\n      (function() {\n        var model;\n        model = Model({\n          test: true,\n          yolo: \"4life\"\n        });\n        model.observeAll();\n        assert(model.test());\n        return assert.equal(model.yolo(), \"4life\");\n      });\n      return it(\"should camel case underscored names\");\n    });\n    describe(\".defaults\", function() {\n      return it(\"should expose defaults method\", function() {\n        return assert(Model.defaults);\n      });\n    });\n    return describe(\".extend\", function() {\n      return it(\"should expose extend method\", function() {\n        return assert(Model.extend);\n      });\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "util": {
          "path": "util",
          "content": "(function() {\n  var __slice = [].slice;\n\n  module.exports = {\n    defaults: function() {\n      var name, object, objects, target, _i, _len;\n      target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      for (_i = 0, _len = objects.length; _i < _len; _i++) {\n        object = objects[_i];\n        for (name in object) {\n          if (!target.hasOwnProperty(name)) {\n            target[name] = object[name];\n          }\n        }\n      }\n      return target;\n    },\n    extend: Object.assign\n  };\n\n}).call(this);\n",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "config": {
        "version": "0.2.0-pre.4",
        "dependencies": {
          "observable": "distri/observable:v0.3.8"
        }
      },
      "version": "0.2.0-pre.4",
      "entryPoint": "main",
      "repository": {
        "branch": "master",
        "default_branch": "master",
        "full_name": "distri/model",
        "homepage": null,
        "description": null,
        "html_url": "https://github.com/distri/model",
        "url": "https://api.github.com/repos/distri/model",
        "publishBranch": "gh-pages"
      },
      "dependencies": {
        "observable": {
          "source": {
            "LICENSE": {
              "path": "LICENSE",
              "content": "The MIT License (MIT)\n\nCopyright (c) 2014 distri\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
              "mode": "100644",
              "type": "blob"
            },
            "README.md": {
              "path": "README.md",
              "content": "[![Build Status](https://travis-ci.org/distri/observable.svg?branch=npm)](https://travis-ci.org/distri/observable)\n\nObservable\n==========\n\nInstallation\n------------\n\nNode\n\n    npm install o_0\n\nUsage\n-----\n\n    Observable = require \"o_0\"\n\nGet notified when the value changes.\n\n    observable = Observable 5\n\n    observable() # 5\n\n    observable.observe (newValue) ->\n      console.log newValue\n\n    observable 10 # logs 10 to console\n\nArrays\n------\n\nProxy array methods.\n\n    observable = Observable [1, 2, 3]\n\n    observable.forEach (value) ->\n      # 1, 2, 3\n\nFunctions\n---------\n\nAutomagically compute dependencies for observable functions.\n\n    firstName = Observable \"Duder\"\n    lastName = Observable \"Man\"\n\n    o = Observable ->\n      \"#{firstName()} #{lastName()}\"\n\n    o.observe (newValue) ->\n      assert.equal newValue, \"Duder Bro\"\n\n    lastName \"Bro\"\n",
              "mode": "100644",
              "type": "blob"
            },
            "main.coffee.md": {
              "path": "main.coffee.md",
              "content": "Observable\n==========\n\n`Observable` allows for observing arrays, functions, and objects.\n\nFunction dependencies are automagically observed.\n\nStandard array methods are proxied through to the underlying array.\n\n    module.exports = Observable = (value, context) ->\n\nReturn the object if it is already an observable object.\n\n      return value if typeof value?.observe is \"function\"\n\nMaintain a set of listeners to observe changes and provide a helper to notify each observer.\n\n      listeners = []\n\n      notify = (newValue) ->\n        copy(listeners).forEach (listener) ->\n          listener(newValue)\n\nOur observable function is stored as a reference to `self`.\n\nIf `value` is a function compute dependencies and listen to observables that it depends on.\n\n      if typeof value is 'function'\n        fn = value\n\nOur return function is a function that holds only a cached value which is updated\nwhen it's dependencies change.\n\nThe `magicDependency` call is so other functions can depend on this computed function the\nsame way we depend on other types of observables.\n\n        self = ->\n          # Automagic dependency observation\n          magicDependency(self)\n\n          return value\n\n        changed = ->\n          value = computeDependencies(self, fn, changed, context)\n          notify(value)\n\n        changed()\n\n      else\n\nWhen called with zero arguments it is treated as a getter. When called with one argument it is treated as a setter.\n\nChanges to the value will trigger notifications.\n\nThe value is always returned.\n\n        self = (newValue) ->\n          if arguments.length > 0\n            if value != newValue\n              value = newValue\n\n              notify(newValue)\n          else\n            # Automagic dependency observation\n            magicDependency(self)\n\n          return value\n\nThis `each` iterator is similar to [the Maybe monad](http://en.wikipedia.org/wiki/Monad_&#40;functional_programming&#41;#The_Maybe_monad) in that our observable may contain a single value or nothing at all.\n\n      self.each = (callback) ->\n        magicDependency(self)\n\n        if value?\n          [value].forEach (item) ->\n            callback.call(item, item)\n\n        return self\n\nIf the value is an array then proxy array methods and add notifications to mutation events.\n\n      if Array.isArray(value)\n        [\n          \"concat\"\n          \"every\"\n          \"filter\"\n          \"forEach\"\n          \"indexOf\"\n          \"join\"\n          \"lastIndexOf\"\n          \"map\"\n          \"reduce\"\n          \"reduceRight\"\n          \"slice\"\n          \"some\"\n        ].forEach (method) ->\n          self[method] = (args...) ->\n            magicDependency(self)\n            value[method](args...)\n\n        [\n          \"pop\"\n          \"push\"\n          \"reverse\"\n          \"shift\"\n          \"splice\"\n          \"sort\"\n          \"unshift\"\n        ].forEach (method) ->\n          self[method] = (args...) ->\n            notifyReturning value[method](args...)\n\n        # Provide length on a best effort basis because older browsers choke\n        if PROXY_LENGTH\n          Object.defineProperty self, 'length',\n            get: ->\n              magicDependency(self)\n              value.length\n            set: (length) ->\n              value.length = length\n              notifyReturning(value.length)\n\n        notifyReturning = (returnValue) ->\n          notify(value)\n\n          return returnValue\n\nAdd some extra helpful methods to array observables.\n\n        extend self,\n          each: (callback) ->\n            self.forEach (item, index) ->\n              callback.call(item, item, index, self)\n\n            return self\n\nRemove an element from the array and notify observers of changes.\n\n          remove: (object) ->\n            index = value.indexOf(object)\n\n            if index >= 0\n              notifyReturning value.splice(index, 1)[0]\n\n          get: (index) ->\n            magicDependency(self)\n            value[index]\n\n          first: ->\n            magicDependency(self)\n            value[0]\n\n          last: ->\n            magicDependency(self)\n            value[value.length-1]\n\n          size: ->\n            magicDependency(self)\n            value.length\n\n      extend self,\n        listeners: listeners\n\n        observe: (listener) ->\n          listeners.push listener\n\n        stopObserving: (fn) ->\n          remove listeners, fn\n\n        toggle: ->\n          self !value\n\n        increment: (n) ->\n          self value + n\n\n        decrement: (n) ->\n          self value - n\n\n        toString: ->\n          \"Observable(#{value})\"\n\n      return self\n\n    Observable.concat = ->\n      # Optimization: Manually copy arguments to an array\n      args = new Array(arguments.length)\n      for arg, i in arguments\n        args[i] = arguments[i]\n\n      collection = Observable(args)\n\n      o = Observable ->\n        flatten collection.map(splat)\n\n      o.push = collection.push\n\n      return o\n\nAppendix\n--------\n\nThe extend method adds one object's properties to another.\n\n    extend = (target) ->\n      # Optimization: iterate through arguments manually rather than pass to slice to create an array\n      for source, i in arguments\n        # The first argument is target, so skip it\n        if i > 0\n          for name of source\n            target[name] = source[name]\n\n      return target\n\nSuper hax for computing dependencies. This needs to be a shared global so that\ndifferent bundled versions of observable libraries can interoperate.\n\n    global.OBSERVABLE_ROOT_HACK = []\n\n    magicDependency = (self) ->\n      observerSet = last(global.OBSERVABLE_ROOT_HACK)\n      if observerSet\n        observerSet.add self\n\nOptimization: Keep the function containing the try-catch as small as possible.\n\n    tryCallWithFinallyPop = (fn, context) ->\n      try\n        fn.call(context)\n      finally\n        global.OBSERVABLE_ROOT_HACK.pop()\n\nAutomagically compute dependencies.\n\n    computeDependencies = (self, fn, update, context) ->\n      deps = new Set\n\n      global.OBSERVABLE_ROOT_HACK.push(deps)\n\n      value = tryCallWithFinallyPop fn, context\n\n      self._deps?.forEach (observable) ->\n        observable.stopObserving update\n\n      self._deps = deps\n\n      deps.forEach (observable) ->\n        observable.observe update\n\n      return value\n\nCheck if we can proxy function length property.\n\n    try\n      Object.defineProperty (->), 'length',\n        get: ->\n        set: ->\n\n      PROXY_LENGTH = true\n    catch\n      PROXY_LENGTH = false\n\nRemove a value from an array.\n\n    remove = (array, value) ->\n      index = array.indexOf(value)\n\n      if index >= 0\n        array.splice(index, 1)[0]\n\n    copy = (array) ->\n      array.concat([])\n\n    get = (arg) ->\n      if typeof arg is \"function\"\n        arg()\n      else\n        arg\n\n    splat = (item) ->\n      results = []\n\n      return results unless item?\n\n      if typeof item.forEach is \"function\"\n        item.forEach (i) ->\n          results.push i\n      else\n        result = get item\n\n        results.push result if result?\n\n      results\n\n    last = (array) ->\n      array[array.length - 1]\n\n    flatten = (array) ->\n      array.reduce (a, b) ->\n        a.concat(b)\n      , []\n",
              "mode": "100644",
              "type": "blob"
            },
            "pixie.cson": {
              "path": "pixie.cson",
              "content": "version: \"0.3.8\"\n",
              "mode": "100644",
              "type": "blob"
            },
            "test/observable.coffee": {
              "path": "test/observable.coffee",
              "content": "global.Observable = require \"../main\"\n\ndescribe 'Observable', ->\n  it 'should create an observable for an object', ->\n    n = 5\n\n    observable = Observable(n)\n\n    assert.equal(observable(), n)\n\n  it 'should fire events when setting', ->\n    string = \"yolo\"\n\n    observable = Observable(string)\n    observable.observe (newValue) ->\n      assert.equal newValue, \"4life\"\n\n    observable(\"4life\")\n\n  it \"should not fire when setting to the same value\", ->\n    o = Observable 5\n\n    o.observe ->\n      assert false\n\n    o(5)\n\n  it 'should be idempotent', ->\n    o = Observable(5)\n\n    assert.equal o, Observable(o)\n\n  describe \"#each\", ->\n    it \"should be invoked once if there is an observable\", ->\n      o = Observable(5)\n      called = 0\n\n      o.each (value) ->\n        called += 1\n        assert.equal value, 5\n\n      assert.equal called, 1\n\n    it \"should not be invoked if observable is null\", ->\n      o = Observable(null)\n      called = 0\n\n      o.each (value) ->\n        called += 1\n\n      assert.equal called, 0\n\n    it \"should have the correct `this` scope for items\", (done) ->\n      o = Observable 5\n\n      o.each ->\n        assert.equal this, 5\n        done()\n\n    it \"should have the correct `this` scope for items in observable arrays\", ->\n      scopes = []\n\n      o = Observable [\"I'm\", \"an\", \"array\"]\n\n      o.each ->\n        scopes.push this\n\n      assert.equal scopes[0], \"I'm\"\n      assert.equal scopes[1], \"an\"\n      assert.equal scopes[2], \"array\"\n\n  it \"should allow for stopping observation\", ->\n    observable = Observable(\"string\")\n\n    called = 0\n    fn = (newValue) ->\n      called += 1\n      assert.equal newValue, \"4life\"\n\n    observable.observe fn\n\n    observable(\"4life\")\n\n    observable.stopObserving fn\n\n    observable(\"wat\")\n\n    assert.equal called, 1\n\n  it \"should increment\", ->\n    observable = Observable 1\n\n    observable.increment(5)\n\n    assert.equal observable(), 6\n\n  it \"should decremnet\", ->\n    observable = Observable 1\n\n    observable.decrement 5\n\n    assert.equal observable(), -4\n\n  it \"should toggle\", ->\n    observable = Observable false\n\n    observable.toggle()\n    assert.equal observable(), true\n\n    observable.toggle()\n    assert.equal observable(), false\n\n  it \"should trigger when toggling\", (done) ->\n    observable = Observable true\n    observable.observe (v) ->\n      assert.equal v, false\n      done()\n\n    observable.toggle()\n\n  it \"should have a nice toString\", ->\n    observable = Observable 5\n\n    assert.equal observable.toString(), \"Observable(5)\"\n\ndescribe \"Observable Array\", ->\n  it \"should proxy array methods\", ->\n    o = Observable [5]\n\n    o.map (n) ->\n      assert.equal n, 5\n\n  it \"should notify on mutation methods\", (done) ->\n    o = Observable []\n\n    o.observe (newValue) ->\n      assert.equal newValue[0], 1\n\n    o.push 1\n\n    done()\n\n  it \"should have an each method\", ->\n    o = Observable []\n\n    assert o.each\n\n  it \"#get\", ->\n    o = Observable [0, 1, 2, 3]\n\n    assert.equal o.get(2), 2\n\n  it \"#first\", ->\n    o = Observable [0, 1, 2, 3]\n\n    assert.equal o.first(), 0\n\n  it \"#last\", ->\n    o = Observable [0, 1, 2, 3]\n\n    assert.equal o.last(), 3\n\n  it \"#remove\", (done) ->\n    o = Observable [0, 1, 2, 3]\n\n    o.observe (newValue) ->\n      assert.equal newValue.length, 3\n      setTimeout ->\n        done()\n      , 0\n\n    assert.equal o.remove(2), 2\n\n  it \"#remove non-existent element\", ->\n    o = Observable [1, 2, 3]\n\n    assert.equal o.remove(0), undefined\n\n  it \"should proxy the length property\", ->\n    o = Observable [1, 2, 3]\n\n    assert.equal o.length, 3\n\n    called = false\n    o.observe (value) ->\n      assert.equal value[0], 1\n      assert.equal value[1], undefined\n      called = true\n\n    o.length = 1\n    assert.equal o.length, 1\n    assert.equal called, true\n\n  it \"should auto detect conditionals of length as a dependency\", ->\n    observableArray = Observable [1, 2, 3]\n\n    o = Observable ->\n      if observableArray.length > 5\n        true\n      else\n        false\n\n    assert.equal o(), false\n\n    called = 0\n    o.observe ->\n      called += 1\n\n    observableArray.push 4, 5, 6\n\n    assert.equal called, 1\n\ndescribe \"Observable functions\", ->\n  it \"should compute dependencies\", (done) ->\n    firstName = Observable \"Duder\"\n    lastName = Observable \"Man\"\n\n    o = Observable ->\n      \"#{firstName()} #{lastName()}\"\n\n    o.observe (newValue) ->\n      assert.equal newValue, \"Duder Bro\"\n\n      done()\n\n    lastName \"Bro\"\n\n  it \"should compute array#get as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.get(0)\n\n    assert.equal observableFn(), 0\n\n    observableArray([5])\n\n    assert.equal observableFn(), 5\n\n  it \"should compute array#first as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.first() + 1\n\n    assert.equal observableFn(), 1\n\n    observableArray([5])\n\n    assert.equal observableFn(), 6\n\n  it \"should compute array#last as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.last()\n\n    assert.equal observableFn(), 2\n\n    observableArray.pop()\n\n    assert.equal observableFn(), 1\n\n    observableArray([5])\n\n    assert.equal observableFn(), 5\n\n  it \"should compute array#size as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.size() * 2\n\n    assert.equal observableFn(), 6\n\n    observableArray.pop()\n    assert.equal observableFn(), 4\n    observableArray.shift()\n    assert.equal observableFn(), 2\n\n  it \"should allow double nesting\", (done) ->\n    bottom = Observable \"rad\"\n    middle = Observable ->\n      bottom()\n    top = Observable ->\n      middle()\n\n    top.observe (newValue) ->\n      assert.equal newValue, \"wat\"\n      assert.equal top(), newValue\n      assert.equal middle(), newValue\n\n      done()\n\n    bottom(\"wat\")\n\n  it \"should work with dynamic dependencies\", ->\n    observableArray = Observable []\n\n    dynamicObservable = Observable ->\n      observableArray.filter (item) ->\n        item.age() > 3\n\n    assert.equal dynamicObservable().length, 0\n\n    observableArray.push\n      age: Observable 1\n\n    observableArray()[0].age 5\n    assert.equal dynamicObservable().length, 1\n\n  it \"should work with context\", ->\n    model =\n      a: Observable \"Hello\"\n      b: Observable \"there\"\n\n    model.c = Observable ->\n      \"#{@a()} #{@b()}\"\n    , model\n\n    assert.equal model.c(), \"Hello there\"\n\n    model.b \"world\"\n\n    assert.equal model.c(), \"Hello world\"\n\n  it \"should be ok even if the function throws an exception\", ->\n    assert.throws ->\n      t = Observable ->\n        throw \"wat\"\n\n    # TODO: Should be able to find a test case that is affected by this rather that\n    # checking it directly\n    assert.equal global.OBSERVABLE_ROOT_HACK.length, 0\n\n  it \"should have an each method\", ->\n    o = Observable ->\n\n    assert o.each()\n\n  it \"should not invoke when returning undefined\", ->\n    o = Observable ->\n\n    o.each ->\n      assert false\n\n  it \"should invoke when returning any defined value\", (done) ->\n    o = Observable -> 5\n\n    o.each (n) ->\n      assert.equal n, 5\n      done()\n\n  it \"should work on an array dependency\", ->\n    oA = Observable [1, 2, 3]\n\n    o = Observable ->\n      oA()[0]\n\n    last = Observable ->\n      oA()[oA().length-1]\n\n    assert.equal o(), 1\n\n    oA.unshift 0\n\n    assert.equal o(), 0\n\n    oA.push 4\n\n    assert.equal last(), 4, \"Last should be 4\"\n\n  it \"should work with multiple dependencies\", ->\n    letter = Observable \"A\"\n    checked = ->\n      l = letter()\n      @name().indexOf(l) is 0\n\n    first = {name: Observable(\"Andrew\")}\n    first.checked = Observable checked, first\n\n    second = {name: Observable(\"Benjamin\")}\n    second.checked = Observable checked, second\n\n    assert.equal first.checked(), true\n    assert.equal second.checked(), false\n\n    assert.equal letter.listeners.length, 2\n\n    letter \"B\"\n\n    assert.equal first.checked(), false\n    assert.equal second.checked(), true\n\n  it \"shouldn't double count dependencies\", ->\n    dep = Observable \"yo\"\n\n    o = Observable ->\n      dep()\n      dep()\n      dep()\n\n    count = 0\n    o.observe ->\n      count += 1\n\n    dep('heyy')\n\n    assert.equal count, 1\n\n  it \"should work with nested observable construction\", ->\n    gen = Observable ->\n      Observable \"Duder\"\n\n    o = gen()\n\n    assert.equal o(), \"Duder\"\n\n    o(\"wat\")\n\n    assert.equal o(), \"wat\"\n\n  describe \"Scoping\", ->\n    it \"should be scoped to optional context\", (done) ->\n      model =\n        firstName: Observable \"Duder\"\n        lastName: Observable \"Man\"\n\n      model.name = Observable ->\n        \"#{@firstName()} #{@lastName()}\"\n      , model\n\n      model.name.observe (newValue) ->\n        assert.equal newValue, \"Duder Bro\"\n\n        done()\n\n      model.lastName \"Bro\"\n\n  describe \"concat\", ->\n    it \"should work with a single observable\", ->\n      observable = Observable \"something\"\n      observableArray = Observable.concat observable\n      assert.equal observableArray.last(), \"something\"\n\n      observable \"something else\"\n      assert.equal observableArray.last(), \"something else\"\n\n    it \"should work with an undefined observable\", ->\n      observable = Observable undefined\n      observableArray = Observable.concat observable\n      assert.equal observableArray.size(), 0\n\n      observable \"defined\"\n      assert.equal observableArray.size(), 1\n\n    it \"should work with undefined\", ->\n      observableArray = Observable.concat undefined\n      assert.equal observableArray.size(), 0\n\n    it \"should work with []\", ->\n      observableArray = Observable.concat []\n      assert.equal observableArray.size(), 0\n\n    it \"should return an observable array that changes based on changes in inputs\", ->\n      numbers = Observable [1, 2, 3]\n      letters = Observable [\"a\", \"b\", \"c\"]\n      item = Observable({})\n      nullable = Observable null\n\n      observableArray = Observable.concat numbers, \"literal\", letters, item, nullable\n\n      assert.equal observableArray().length, 3 + 1 + 3 + 1\n\n      assert.equal observableArray()[0], 1\n      assert.equal observableArray()[3], \"literal\"\n      assert.equal observableArray()[4], \"a\"\n      assert.equal observableArray()[7], item()\n\n      numbers.push 4\n\n      assert.equal observableArray().length, 9\n\n      nullable \"cool\"\n\n      assert.equal observableArray().length, 10\n\n    it \"should work with observable functions that return arrays\", ->\n      item = Observable(\"wat\")\n\n      computedArray = Observable ->\n        [item()]\n\n      observableArray = Observable.concat computedArray, computedArray\n\n      assert.equal observableArray().length, 2\n\n      assert.equal observableArray()[1], \"wat\"\n\n      item \"yolo\"\n\n      assert.equal observableArray()[1], \"yolo\"\n\n    it \"should have a push method\", ->\n      observableArray = Observable.concat()\n\n      observable = Observable \"hey\"\n\n      observableArray.push observable\n\n      assert.equal observableArray()[0], \"hey\"\n\n      observable \"wat\"\n\n      assert.equal observableArray()[0], \"wat\"\n\n      observableArray.push \"cool\"\n      observableArray.push \"radical\"\n\n      assert.equal observableArray().length, 3\n\n    it \"should be observable\", (done) ->\n      observableArray = Observable.concat()\n\n      observableArray.observe (items) ->\n        assert.equal items.length, 3\n        done()\n\n      observableArray.push [\"A\", \"B\", \"C\"]\n\n    it \"should have an each method\", ->\n      observableArray = Observable.concat([\"A\", \"B\", \"C\"])\n\n      n = 0\n      observableArray.each () ->\n        n += 1\n\n      assert.equal n, 3\n\n  describe \"nesting dependencies\", ->\n    it \"should update the correct observable\", ->\n      a = Observable \"a\"\n      b = Observable \"b\"\n\n      results = Observable ->\n        r = Observable.concat()\n\n        r.push a\n        r.push b\n\n        r\n\n      # TODO: Should this just be\n      #     results.first()\n      assert.equal results().first(), \"a\"\n\n      a(\"newA\")\n\n      assert.equal results().first(), \"newA\"\n",
              "mode": "100644",
              "type": "blob"
            }
          },
          "distribution": {
            "main": {
              "path": "main",
              "content": "(function() {\n  var Observable, PROXY_LENGTH, computeDependencies, copy, extend, flatten, get, last, magicDependency, remove, splat, tryCallWithFinallyPop,\n    __slice = [].slice;\n\n  module.exports = Observable = function(value, context) {\n    var changed, fn, listeners, notify, notifyReturning, self;\n    if (typeof (value != null ? value.observe : void 0) === \"function\") {\n      return value;\n    }\n    listeners = [];\n    notify = function(newValue) {\n      return copy(listeners).forEach(function(listener) {\n        return listener(newValue);\n      });\n    };\n    if (typeof value === 'function') {\n      fn = value;\n      self = function() {\n        magicDependency(self);\n        return value;\n      };\n      changed = function() {\n        value = computeDependencies(self, fn, changed, context);\n        return notify(value);\n      };\n      changed();\n    } else {\n      self = function(newValue) {\n        if (arguments.length > 0) {\n          if (value !== newValue) {\n            value = newValue;\n            notify(newValue);\n          }\n        } else {\n          magicDependency(self);\n        }\n        return value;\n      };\n    }\n    self.each = function(callback) {\n      magicDependency(self);\n      if (value != null) {\n        [value].forEach(function(item) {\n          return callback.call(item, item);\n        });\n      }\n      return self;\n    };\n    if (Array.isArray(value)) {\n      [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"reduce\", \"reduceRight\", \"slice\", \"some\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          magicDependency(self);\n          return value[method].apply(value, args);\n        };\n      });\n      [\"pop\", \"push\", \"reverse\", \"shift\", \"splice\", \"sort\", \"unshift\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          return notifyReturning(value[method].apply(value, args));\n        };\n      });\n      if (PROXY_LENGTH) {\n        Object.defineProperty(self, 'length', {\n          get: function() {\n            magicDependency(self);\n            return value.length;\n          },\n          set: function(length) {\n            value.length = length;\n            return notifyReturning(value.length);\n          }\n        });\n      }\n      notifyReturning = function(returnValue) {\n        notify(value);\n        return returnValue;\n      };\n      extend(self, {\n        each: function(callback) {\n          self.forEach(function(item, index) {\n            return callback.call(item, item, index, self);\n          });\n          return self;\n        },\n        remove: function(object) {\n          var index;\n          index = value.indexOf(object);\n          if (index >= 0) {\n            return notifyReturning(value.splice(index, 1)[0]);\n          }\n        },\n        get: function(index) {\n          magicDependency(self);\n          return value[index];\n        },\n        first: function() {\n          magicDependency(self);\n          return value[0];\n        },\n        last: function() {\n          magicDependency(self);\n          return value[value.length - 1];\n        },\n        size: function() {\n          magicDependency(self);\n          return value.length;\n        }\n      });\n    }\n    extend(self, {\n      listeners: listeners,\n      observe: function(listener) {\n        return listeners.push(listener);\n      },\n      stopObserving: function(fn) {\n        return remove(listeners, fn);\n      },\n      toggle: function() {\n        return self(!value);\n      },\n      increment: function(n) {\n        return self(value + n);\n      },\n      decrement: function(n) {\n        return self(value - n);\n      },\n      toString: function() {\n        return \"Observable(\" + value + \")\";\n      }\n    });\n    return self;\n  };\n\n  Observable.concat = function() {\n    var arg, args, collection, i, o, _i, _len;\n    args = new Array(arguments.length);\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      arg = arguments[i];\n      args[i] = arguments[i];\n    }\n    collection = Observable(args);\n    o = Observable(function() {\n      return flatten(collection.map(splat));\n    });\n    o.push = collection.push;\n    return o;\n  };\n\n  extend = function(target) {\n    var i, name, source, _i, _len;\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      source = arguments[i];\n      if (i > 0) {\n        for (name in source) {\n          target[name] = source[name];\n        }\n      }\n    }\n    return target;\n  };\n\n  global.OBSERVABLE_ROOT_HACK = [];\n\n  magicDependency = function(self) {\n    var observerSet;\n    observerSet = last(global.OBSERVABLE_ROOT_HACK);\n    if (observerSet) {\n      return observerSet.add(self);\n    }\n  };\n\n  tryCallWithFinallyPop = function(fn, context) {\n    try {\n      return fn.call(context);\n    } finally {\n      global.OBSERVABLE_ROOT_HACK.pop();\n    }\n  };\n\n  computeDependencies = function(self, fn, update, context) {\n    var deps, value, _ref;\n    deps = new Set;\n    global.OBSERVABLE_ROOT_HACK.push(deps);\n    value = tryCallWithFinallyPop(fn, context);\n    if ((_ref = self._deps) != null) {\n      _ref.forEach(function(observable) {\n        return observable.stopObserving(update);\n      });\n    }\n    self._deps = deps;\n    deps.forEach(function(observable) {\n      return observable.observe(update);\n    });\n    return value;\n  };\n\n  try {\n    Object.defineProperty((function() {}), 'length', {\n      get: function() {},\n      set: function() {}\n    });\n    PROXY_LENGTH = true;\n  } catch (_error) {\n    PROXY_LENGTH = false;\n  }\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n  copy = function(array) {\n    return array.concat([]);\n  };\n\n  get = function(arg) {\n    if (typeof arg === \"function\") {\n      return arg();\n    } else {\n      return arg;\n    }\n  };\n\n  splat = function(item) {\n    var result, results;\n    results = [];\n    if (item == null) {\n      return results;\n    }\n    if (typeof item.forEach === \"function\") {\n      item.forEach(function(i) {\n        return results.push(i);\n      });\n    } else {\n      result = get(item);\n      if (result != null) {\n        results.push(result);\n      }\n    }\n    return results;\n  };\n\n  last = function(array) {\n    return array[array.length - 1];\n  };\n\n  flatten = function(array) {\n    return array.reduce(function(a, b) {\n      return a.concat(b);\n    }, []);\n  };\n\n}).call(this);\n",
              "type": "blob"
            },
            "pixie": {
              "path": "pixie",
              "content": "module.exports = {\"version\":\"0.3.8\"};",
              "type": "blob"
            },
            "test/observable": {
              "path": "test/observable",
              "content": "(function() {\n  global.Observable = require(\"../main\");\n\n  describe('Observable', function() {\n    it('should create an observable for an object', function() {\n      var n, observable;\n      n = 5;\n      observable = Observable(n);\n      return assert.equal(observable(), n);\n    });\n    it('should fire events when setting', function() {\n      var observable, string;\n      string = \"yolo\";\n      observable = Observable(string);\n      observable.observe(function(newValue) {\n        return assert.equal(newValue, \"4life\");\n      });\n      return observable(\"4life\");\n    });\n    it(\"should not fire when setting to the same value\", function() {\n      var o;\n      o = Observable(5);\n      o.observe(function() {\n        return assert(false);\n      });\n      return o(5);\n    });\n    it('should be idempotent', function() {\n      var o;\n      o = Observable(5);\n      return assert.equal(o, Observable(o));\n    });\n    describe(\"#each\", function() {\n      it(\"should be invoked once if there is an observable\", function() {\n        var called, o;\n        o = Observable(5);\n        called = 0;\n        o.each(function(value) {\n          called += 1;\n          return assert.equal(value, 5);\n        });\n        return assert.equal(called, 1);\n      });\n      it(\"should not be invoked if observable is null\", function() {\n        var called, o;\n        o = Observable(null);\n        called = 0;\n        o.each(function(value) {\n          return called += 1;\n        });\n        return assert.equal(called, 0);\n      });\n      it(\"should have the correct `this` scope for items\", function(done) {\n        var o;\n        o = Observable(5);\n        return o.each(function() {\n          assert.equal(this, 5);\n          return done();\n        });\n      });\n      return it(\"should have the correct `this` scope for items in observable arrays\", function() {\n        var o, scopes;\n        scopes = [];\n        o = Observable([\"I'm\", \"an\", \"array\"]);\n        o.each(function() {\n          return scopes.push(this);\n        });\n        assert.equal(scopes[0], \"I'm\");\n        assert.equal(scopes[1], \"an\");\n        return assert.equal(scopes[2], \"array\");\n      });\n    });\n    it(\"should allow for stopping observation\", function() {\n      var called, fn, observable;\n      observable = Observable(\"string\");\n      called = 0;\n      fn = function(newValue) {\n        called += 1;\n        return assert.equal(newValue, \"4life\");\n      };\n      observable.observe(fn);\n      observable(\"4life\");\n      observable.stopObserving(fn);\n      observable(\"wat\");\n      return assert.equal(called, 1);\n    });\n    it(\"should increment\", function() {\n      var observable;\n      observable = Observable(1);\n      observable.increment(5);\n      return assert.equal(observable(), 6);\n    });\n    it(\"should decremnet\", function() {\n      var observable;\n      observable = Observable(1);\n      observable.decrement(5);\n      return assert.equal(observable(), -4);\n    });\n    it(\"should toggle\", function() {\n      var observable;\n      observable = Observable(false);\n      observable.toggle();\n      assert.equal(observable(), true);\n      observable.toggle();\n      return assert.equal(observable(), false);\n    });\n    it(\"should trigger when toggling\", function(done) {\n      var observable;\n      observable = Observable(true);\n      observable.observe(function(v) {\n        assert.equal(v, false);\n        return done();\n      });\n      return observable.toggle();\n    });\n    return it(\"should have a nice toString\", function() {\n      var observable;\n      observable = Observable(5);\n      return assert.equal(observable.toString(), \"Observable(5)\");\n    });\n  });\n\n  describe(\"Observable Array\", function() {\n    it(\"should proxy array methods\", function() {\n      var o;\n      o = Observable([5]);\n      return o.map(function(n) {\n        return assert.equal(n, 5);\n      });\n    });\n    it(\"should notify on mutation methods\", function(done) {\n      var o;\n      o = Observable([]);\n      o.observe(function(newValue) {\n        return assert.equal(newValue[0], 1);\n      });\n      o.push(1);\n      return done();\n    });\n    it(\"should have an each method\", function() {\n      var o;\n      o = Observable([]);\n      return assert(o.each);\n    });\n    it(\"#get\", function() {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      return assert.equal(o.get(2), 2);\n    });\n    it(\"#first\", function() {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      return assert.equal(o.first(), 0);\n    });\n    it(\"#last\", function() {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      return assert.equal(o.last(), 3);\n    });\n    it(\"#remove\", function(done) {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      o.observe(function(newValue) {\n        assert.equal(newValue.length, 3);\n        return setTimeout(function() {\n          return done();\n        }, 0);\n      });\n      return assert.equal(o.remove(2), 2);\n    });\n    it(\"#remove non-existent element\", function() {\n      var o;\n      o = Observable([1, 2, 3]);\n      return assert.equal(o.remove(0), void 0);\n    });\n    it(\"should proxy the length property\", function() {\n      var called, o;\n      o = Observable([1, 2, 3]);\n      assert.equal(o.length, 3);\n      called = false;\n      o.observe(function(value) {\n        assert.equal(value[0], 1);\n        assert.equal(value[1], void 0);\n        return called = true;\n      });\n      o.length = 1;\n      assert.equal(o.length, 1);\n      return assert.equal(called, true);\n    });\n    return it(\"should auto detect conditionals of length as a dependency\", function() {\n      var called, o, observableArray;\n      observableArray = Observable([1, 2, 3]);\n      o = Observable(function() {\n        if (observableArray.length > 5) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      assert.equal(o(), false);\n      called = 0;\n      o.observe(function() {\n        return called += 1;\n      });\n      observableArray.push(4, 5, 6);\n      return assert.equal(called, 1);\n    });\n  });\n\n  describe(\"Observable functions\", function() {\n    it(\"should compute dependencies\", function(done) {\n      var firstName, lastName, o;\n      firstName = Observable(\"Duder\");\n      lastName = Observable(\"Man\");\n      o = Observable(function() {\n        return \"\" + (firstName()) + \" \" + (lastName());\n      });\n      o.observe(function(newValue) {\n        assert.equal(newValue, \"Duder Bro\");\n        return done();\n      });\n      return lastName(\"Bro\");\n    });\n    it(\"should compute array#get as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.get(0);\n      });\n      assert.equal(observableFn(), 0);\n      observableArray([5]);\n      return assert.equal(observableFn(), 5);\n    });\n    it(\"should compute array#first as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.first() + 1;\n      });\n      assert.equal(observableFn(), 1);\n      observableArray([5]);\n      return assert.equal(observableFn(), 6);\n    });\n    it(\"should compute array#last as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.last();\n      });\n      assert.equal(observableFn(), 2);\n      observableArray.pop();\n      assert.equal(observableFn(), 1);\n      observableArray([5]);\n      return assert.equal(observableFn(), 5);\n    });\n    it(\"should compute array#size as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.size() * 2;\n      });\n      assert.equal(observableFn(), 6);\n      observableArray.pop();\n      assert.equal(observableFn(), 4);\n      observableArray.shift();\n      return assert.equal(observableFn(), 2);\n    });\n    it(\"should allow double nesting\", function(done) {\n      var bottom, middle, top;\n      bottom = Observable(\"rad\");\n      middle = Observable(function() {\n        return bottom();\n      });\n      top = Observable(function() {\n        return middle();\n      });\n      top.observe(function(newValue) {\n        assert.equal(newValue, \"wat\");\n        assert.equal(top(), newValue);\n        assert.equal(middle(), newValue);\n        return done();\n      });\n      return bottom(\"wat\");\n    });\n    it(\"should work with dynamic dependencies\", function() {\n      var dynamicObservable, observableArray;\n      observableArray = Observable([]);\n      dynamicObservable = Observable(function() {\n        return observableArray.filter(function(item) {\n          return item.age() > 3;\n        });\n      });\n      assert.equal(dynamicObservable().length, 0);\n      observableArray.push({\n        age: Observable(1)\n      });\n      observableArray()[0].age(5);\n      return assert.equal(dynamicObservable().length, 1);\n    });\n    it(\"should work with context\", function() {\n      var model;\n      model = {\n        a: Observable(\"Hello\"),\n        b: Observable(\"there\")\n      };\n      model.c = Observable(function() {\n        return \"\" + (this.a()) + \" \" + (this.b());\n      }, model);\n      assert.equal(model.c(), \"Hello there\");\n      model.b(\"world\");\n      return assert.equal(model.c(), \"Hello world\");\n    });\n    it(\"should be ok even if the function throws an exception\", function() {\n      assert.throws(function() {\n        var t;\n        return t = Observable(function() {\n          throw \"wat\";\n        });\n      });\n      return assert.equal(global.OBSERVABLE_ROOT_HACK.length, 0);\n    });\n    it(\"should have an each method\", function() {\n      var o;\n      o = Observable(function() {});\n      return assert(o.each());\n    });\n    it(\"should not invoke when returning undefined\", function() {\n      var o;\n      o = Observable(function() {});\n      return o.each(function() {\n        return assert(false);\n      });\n    });\n    it(\"should invoke when returning any defined value\", function(done) {\n      var o;\n      o = Observable(function() {\n        return 5;\n      });\n      return o.each(function(n) {\n        assert.equal(n, 5);\n        return done();\n      });\n    });\n    it(\"should work on an array dependency\", function() {\n      var last, o, oA;\n      oA = Observable([1, 2, 3]);\n      o = Observable(function() {\n        return oA()[0];\n      });\n      last = Observable(function() {\n        return oA()[oA().length - 1];\n      });\n      assert.equal(o(), 1);\n      oA.unshift(0);\n      assert.equal(o(), 0);\n      oA.push(4);\n      return assert.equal(last(), 4, \"Last should be 4\");\n    });\n    it(\"should work with multiple dependencies\", function() {\n      var checked, first, letter, second;\n      letter = Observable(\"A\");\n      checked = function() {\n        var l;\n        l = letter();\n        return this.name().indexOf(l) === 0;\n      };\n      first = {\n        name: Observable(\"Andrew\")\n      };\n      first.checked = Observable(checked, first);\n      second = {\n        name: Observable(\"Benjamin\")\n      };\n      second.checked = Observable(checked, second);\n      assert.equal(first.checked(), true);\n      assert.equal(second.checked(), false);\n      assert.equal(letter.listeners.length, 2);\n      letter(\"B\");\n      assert.equal(first.checked(), false);\n      return assert.equal(second.checked(), true);\n    });\n    it(\"shouldn't double count dependencies\", function() {\n      var count, dep, o;\n      dep = Observable(\"yo\");\n      o = Observable(function() {\n        dep();\n        dep();\n        return dep();\n      });\n      count = 0;\n      o.observe(function() {\n        return count += 1;\n      });\n      dep('heyy');\n      return assert.equal(count, 1);\n    });\n    it(\"should work with nested observable construction\", function() {\n      var gen, o;\n      gen = Observable(function() {\n        return Observable(\"Duder\");\n      });\n      o = gen();\n      assert.equal(o(), \"Duder\");\n      o(\"wat\");\n      return assert.equal(o(), \"wat\");\n    });\n    describe(\"Scoping\", function() {\n      return it(\"should be scoped to optional context\", function(done) {\n        var model;\n        model = {\n          firstName: Observable(\"Duder\"),\n          lastName: Observable(\"Man\")\n        };\n        model.name = Observable(function() {\n          return \"\" + (this.firstName()) + \" \" + (this.lastName());\n        }, model);\n        model.name.observe(function(newValue) {\n          assert.equal(newValue, \"Duder Bro\");\n          return done();\n        });\n        return model.lastName(\"Bro\");\n      });\n    });\n    describe(\"concat\", function() {\n      it(\"should work with a single observable\", function() {\n        var observable, observableArray;\n        observable = Observable(\"something\");\n        observableArray = Observable.concat(observable);\n        assert.equal(observableArray.last(), \"something\");\n        observable(\"something else\");\n        return assert.equal(observableArray.last(), \"something else\");\n      });\n      it(\"should work with an undefined observable\", function() {\n        var observable, observableArray;\n        observable = Observable(void 0);\n        observableArray = Observable.concat(observable);\n        assert.equal(observableArray.size(), 0);\n        observable(\"defined\");\n        return assert.equal(observableArray.size(), 1);\n      });\n      it(\"should work with undefined\", function() {\n        var observableArray;\n        observableArray = Observable.concat(void 0);\n        return assert.equal(observableArray.size(), 0);\n      });\n      it(\"should work with []\", function() {\n        var observableArray;\n        observableArray = Observable.concat([]);\n        return assert.equal(observableArray.size(), 0);\n      });\n      it(\"should return an observable array that changes based on changes in inputs\", function() {\n        var item, letters, nullable, numbers, observableArray;\n        numbers = Observable([1, 2, 3]);\n        letters = Observable([\"a\", \"b\", \"c\"]);\n        item = Observable({});\n        nullable = Observable(null);\n        observableArray = Observable.concat(numbers, \"literal\", letters, item, nullable);\n        assert.equal(observableArray().length, 3 + 1 + 3 + 1);\n        assert.equal(observableArray()[0], 1);\n        assert.equal(observableArray()[3], \"literal\");\n        assert.equal(observableArray()[4], \"a\");\n        assert.equal(observableArray()[7], item());\n        numbers.push(4);\n        assert.equal(observableArray().length, 9);\n        nullable(\"cool\");\n        return assert.equal(observableArray().length, 10);\n      });\n      it(\"should work with observable functions that return arrays\", function() {\n        var computedArray, item, observableArray;\n        item = Observable(\"wat\");\n        computedArray = Observable(function() {\n          return [item()];\n        });\n        observableArray = Observable.concat(computedArray, computedArray);\n        assert.equal(observableArray().length, 2);\n        assert.equal(observableArray()[1], \"wat\");\n        item(\"yolo\");\n        return assert.equal(observableArray()[1], \"yolo\");\n      });\n      it(\"should have a push method\", function() {\n        var observable, observableArray;\n        observableArray = Observable.concat();\n        observable = Observable(\"hey\");\n        observableArray.push(observable);\n        assert.equal(observableArray()[0], \"hey\");\n        observable(\"wat\");\n        assert.equal(observableArray()[0], \"wat\");\n        observableArray.push(\"cool\");\n        observableArray.push(\"radical\");\n        return assert.equal(observableArray().length, 3);\n      });\n      it(\"should be observable\", function(done) {\n        var observableArray;\n        observableArray = Observable.concat();\n        observableArray.observe(function(items) {\n          assert.equal(items.length, 3);\n          return done();\n        });\n        return observableArray.push([\"A\", \"B\", \"C\"]);\n      });\n      return it(\"should have an each method\", function() {\n        var n, observableArray;\n        observableArray = Observable.concat([\"A\", \"B\", \"C\"]);\n        n = 0;\n        observableArray.each(function() {\n          return n += 1;\n        });\n        return assert.equal(n, 3);\n      });\n    });\n    return describe(\"nesting dependencies\", function() {\n      return it(\"should update the correct observable\", function() {\n        var a, b, results;\n        a = Observable(\"a\");\n        b = Observable(\"b\");\n        results = Observable(function() {\n          var r;\n          r = Observable.concat();\n          r.push(a);\n          r.push(b);\n          return r;\n        });\n        assert.equal(results().first(), \"a\");\n        a(\"newA\");\n        return assert.equal(results().first(), \"newA\");\n      });\n    });\n  });\n\n}).call(this);\n",
              "type": "blob"
            }
          },
          "progenitor": {
            "url": "https://danielx.net/editor/"
          },
          "config": {
            "version": "0.3.8"
          },
          "version": "0.3.8",
          "entryPoint": "main",
          "repository": {
            "branch": "v0.3.8",
            "default_branch": "master",
            "full_name": "distri/observable",
            "homepage": "http://observable.us",
            "description": null,
            "html_url": "https://github.com/distri/observable",
            "url": "https://api.github.com/repos/distri/observable",
            "publishBranch": "gh-pages"
          },
          "dependencies": {}
        }
      }
    },
    "postmaster": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "The MIT License (MIT)\n\nCopyright (c) 2013 distri\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
          "mode": "100644",
          "type": "blob"
        },
        "README.md": {
          "path": "README.md",
          "content": "postmaster\n==========\n\nSend and receive `postMessage` commands using promises to handle the results.\n",
          "mode": "100644",
          "type": "blob"
        },
        "main.coffee": {
          "path": "main.coffee",
          "content": "###\n\nPostmaster wraps the `postMessage` API with promises.\n\n###\n\ndefaultReceiver = self\nackTimeout = 1000\n\nmodule.exports = Postmaster = (self={}) ->\n  send = (data) ->\n    target = self.remoteTarget()\n\n    if !target\n      throw new Error \"No remote target\"\n    else if !Worker? or target instanceof Worker\n      target.postMessage data\n    else\n      target.postMessage data, \"*\"\n\n    return\n\n  dominant = Postmaster.dominant()\n  self.remoteTarget ?= -> dominant\n  self.receiver ?= -> defaultReceiver\n  self.ackTimeout ?= -> ackTimeout\n  self.delegate ?= self\n\n  self.receiver().addEventListener \"message\", (event) ->\n    # Only listening to messages from `opener`\n    if event.source is self.remoteTarget() or !event.source\n      data = event.data\n      {type, method, params, id} = data\n\n      switch type\n        when \"ack\"\n          pendingResponses[id]?.ack = true\n        when \"response\"\n          pendingResponses[id].resolve data.result\n        when \"error\"\n          pendingResponses[id].reject data.error\n        when \"message\"\n          Promise.resolve()\n          .then ->\n            send\n              type: \"ack\"\n              id: id\n          .then ->\n            if typeof self.delegate[method] is \"function\"\n              self.delegate[method](params...)\n            else\n              throw new Error \"`#{method}` is not a function\"\n          .then (result) ->\n            send\n              type: \"response\"\n              id: id\n              result: result\n          .catch (error) ->\n            if typeof error is \"string\"\n              message = error\n            else\n              message = error.message\n\n            send\n              type: \"error\"\n              id: id\n              error:\n                message: message\n                stack: error.stack\n\n  pendingResponses = {}\n  remoteId = 0\n\n  clear = (id) ->\n    clearTimeout pendingResponses[id].timeout\n    delete pendingResponses[id]\n\n  self.invokeRemote = (method, params...) ->\n    new Promise (resolve, reject) ->\n      id = remoteId++\n\n      try\n        send\n          type: \"message\"\n          method: method\n          params: params\n          id: id\n      catch e\n        reject(e)\n        return\n\n      ackWait = self.ackTimeout()\n      timeout = setTimeout ->\n        pendingResponse = pendingResponses[id]\n        if pendingResponse and !pendingResponse.ack\n          clear(id)\n          reject new Error \"No ack received within #{ackWait}\"\n      , ackWait\n\n      pendingResponses[id] =\n        timeout: timeout\n        resolve: (result) ->\n          clear(id)\n          resolve(result)\n        reject: (error) ->\n          clear(id)\n          reject(error)\n\n  return self\n\nPostmaster.dominant = ->\n  if window? # iframe or child window context\n    opener or ((parent != window) and parent) or undefined\n  else # Web Worker Context\n    self\n\nreturn Postmaster\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "version: \"0.5.3\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/postmaster.coffee": {
          "path": "test/postmaster.coffee",
          "content": "Postmaster = require \"../main\"\n\nscriptContent = ->\n  fn = ->\n    pm = Postmaster()\n    pm.echo = (value) ->\n      return value\n    pm.throws = ->\n      throw new Error(\"This always throws\")\n    pm.promiseFail = ->\n      Promise.reject new Error \"This is a failed promise\"\n\n  \"\"\"\n    var module = {};\n    Postmaster = #{PACKAGE.distribution.main.content};\n    (#{fn.toString()})();\n  \"\"\"\n\ninitWindow = (targetWindow) ->\n  targetWindow.document.write \"<script>#{scriptContent()}<\\/script>\"\n\ndescribe \"Postmaster\", ->\n  it \"should work with openened windows\", (done) ->\n    childWindow = open(\"\", null, \"width=200,height=200\")\n\n    initWindow(childWindow)\n\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.invokeRemote \"echo\", 5\n    .then (result) ->\n      assert.equal result, 5\n    .then ->\n      done()\n    , (error) ->\n      done(error)\n    .then ->\n      childWindow.close()\n\n  it \"should work with iframes\", (done) ->\n    iframe = document.createElement('iframe')\n    document.body.appendChild(iframe)\n\n    childWindow = iframe.contentWindow\n    initWindow(childWindow)\n\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.invokeRemote \"echo\", 17\n    .then (result) ->\n      assert.equal result, 17\n    .then ->\n      done()\n    , (error) ->\n      done(error)\n    .then ->\n      iframe.remove()\n\n  it \"should handle the remote call throwing errors\", (done) ->\n    iframe = document.createElement('iframe')\n    document.body.appendChild(iframe)\n\n    childWindow = iframe.contentWindow\n    initWindow(childWindow)\n\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.invokeRemote \"throws\"\n    .catch (error) ->\n      done()\n    .then ->\n      iframe.remove()\n\n    return\n\n  it \"should throwing a useful error when the remote doesn't define the function\", (done) ->\n    iframe = document.createElement('iframe')\n    document.body.appendChild(iframe)\n\n    childWindow = iframe.contentWindow\n    initWindow(childWindow)\n\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.invokeRemote \"someUndefinedFunction\"\n    .catch (error) ->\n      done()\n    .then ->\n      iframe.remove()\n\n    return\n\n  it \"should handle the remote call returning failed promises\", (done) ->\n    iframe = document.createElement('iframe')\n    document.body.appendChild(iframe)\n\n    childWindow = iframe.contentWindow\n    initWindow(childWindow)\n\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.invokeRemote \"promiseFail\"\n    .catch (error) ->\n      done()\n    .then ->\n      iframe.remove()\n\n    return\n\n  it \"should be able to go around the world\", (done) ->\n    iframe = document.createElement('iframe')\n    document.body.appendChild(iframe)\n\n    childWindow = iframe.contentWindow\n    initWindow(childWindow)\n\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.yolo = (txt) ->\n      \"heyy #{txt}\"\n    postmaster.invokeRemote \"invokeRemote\", \"yolo\", \"cool\"\n    .then (result) ->\n      assert.equal result, \"heyy cool\"\n    .then ->\n      done()\n    , (error) ->\n      done(error)\n    .then ->\n      iframe.remove()\n\n    return\n\n  it \"should work with web workers\", (done) ->\n    blob = new Blob [scriptContent()]\n    jsUrl = URL.createObjectURL(blob)\n\n    worker = new Worker(jsUrl)\n\n    base =\n      remoteTarget: -> worker\n      receiver: -> worker\n\n    postmaster = Postmaster(base)\n    postmaster.invokeRemote \"echo\", 17\n    .then (result) ->\n      assert.equal result, 17\n    .then ->\n      done()\n    , (error) ->\n      done(error)\n    .then ->\n      worker.terminate()\n\n    return\n\n  it \"should fail quickly when contacting a window that doesn't support Postmaster\", (done) ->\n    iframe = document.createElement('iframe')\n    document.body.appendChild(iframe)\n\n    childWindow = iframe.contentWindow\n    postmaster = Postmaster()\n    postmaster.remoteTarget = -> childWindow\n    postmaster.invokeRemote \"echo\", 5\n    .catch (e) ->\n      if e.message.match /no ack/i\n        done()\n      else\n        done(1)\n    .then ->\n      iframe.remove()\n\n    return\n\n  it \"should return a rejected promise when unable to send to the target\", (done) ->\n    postmaster = Postmaster\n      remoteTarget: -> null\n\n    postmaster.invokeRemote \"yo\"\n    .catch (e) ->\n      assert.equal e.message, \"Cannot read property 'postMessage' of null\"\n      done()\n\n    return\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "main": {
          "path": "main",
          "content": "\n/*\n\nPostmaster wraps the `postMessage` API with promises.\n */\n\n(function() {\n  var Postmaster, ackTimeout, defaultReceiver,\n    __slice = [].slice;\n\n  defaultReceiver = self;\n\n  ackTimeout = 1000;\n\n  module.exports = Postmaster = function(self) {\n    var clear, dominant, pendingResponses, remoteId, send;\n    if (self == null) {\n      self = {};\n    }\n    send = function(data) {\n      var target;\n      target = self.remoteTarget();\n      if (!target) {\n        throw new Error(\"No remote target\");\n      } else if ((typeof Worker === \"undefined\" || Worker === null) || target instanceof Worker) {\n        target.postMessage(data);\n      } else {\n        target.postMessage(data, \"*\");\n      }\n    };\n    dominant = Postmaster.dominant();\n    if (self.remoteTarget == null) {\n      self.remoteTarget = function() {\n        return dominant;\n      };\n    }\n    if (self.receiver == null) {\n      self.receiver = function() {\n        return defaultReceiver;\n      };\n    }\n    if (self.ackTimeout == null) {\n      self.ackTimeout = function() {\n        return ackTimeout;\n      };\n    }\n    if (self.delegate == null) {\n      self.delegate = self;\n    }\n    self.receiver().addEventListener(\"message\", function(event) {\n      var data, id, method, params, type, _ref;\n      if (event.source === self.remoteTarget() || !event.source) {\n        data = event.data;\n        type = data.type, method = data.method, params = data.params, id = data.id;\n        switch (type) {\n          case \"ack\":\n            return (_ref = pendingResponses[id]) != null ? _ref.ack = true : void 0;\n          case \"response\":\n            return pendingResponses[id].resolve(data.result);\n          case \"error\":\n            return pendingResponses[id].reject(data.error);\n          case \"message\":\n            return Promise.resolve().then(function() {\n              return send({\n                type: \"ack\",\n                id: id\n              });\n            }).then(function() {\n              var _ref1;\n              if (typeof self.delegate[method] === \"function\") {\n                return (_ref1 = self.delegate)[method].apply(_ref1, params);\n              } else {\n                throw new Error(\"`\" + method + \"` is not a function\");\n              }\n            }).then(function(result) {\n              return send({\n                type: \"response\",\n                id: id,\n                result: result\n              });\n            })[\"catch\"](function(error) {\n              var message;\n              if (typeof error === \"string\") {\n                message = error;\n              } else {\n                message = error.message;\n              }\n              return send({\n                type: \"error\",\n                id: id,\n                error: {\n                  message: message,\n                  stack: error.stack\n                }\n              });\n            });\n        }\n      }\n    });\n    pendingResponses = {};\n    remoteId = 0;\n    clear = function(id) {\n      clearTimeout(pendingResponses[id].timeout);\n      return delete pendingResponses[id];\n    };\n    self.invokeRemote = function() {\n      var method, params;\n      method = arguments[0], params = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      return new Promise(function(resolve, reject) {\n        var ackWait, e, id, timeout;\n        id = remoteId++;\n        try {\n          send({\n            type: \"message\",\n            method: method,\n            params: params,\n            id: id\n          });\n        } catch (_error) {\n          e = _error;\n          reject(e);\n          return;\n        }\n        ackWait = self.ackTimeout();\n        timeout = setTimeout(function() {\n          var pendingResponse;\n          pendingResponse = pendingResponses[id];\n          if (pendingResponse && !pendingResponse.ack) {\n            clear(id);\n            return reject(new Error(\"No ack received within \" + ackWait));\n          }\n        }, ackWait);\n        return pendingResponses[id] = {\n          timeout: timeout,\n          resolve: function(result) {\n            clear(id);\n            return resolve(result);\n          },\n          reject: function(error) {\n            clear(id);\n            return reject(error);\n          }\n        };\n      });\n    };\n    return self;\n  };\n\n  Postmaster.dominant = function() {\n    if (typeof window !== \"undefined\" && window !== null) {\n      return opener || ((parent !== window) && parent) || void 0;\n    } else {\n      return self;\n    }\n  };\n\n  return Postmaster;\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"version\":\"0.5.3\"};",
          "type": "blob"
        },
        "test/postmaster": {
          "path": "test/postmaster",
          "content": "(function() {\n  var Postmaster, initWindow, scriptContent;\n\n  Postmaster = require(\"../main\");\n\n  scriptContent = function() {\n    var fn;\n    fn = function() {\n      var pm;\n      pm = Postmaster();\n      pm.echo = function(value) {\n        return value;\n      };\n      pm.throws = function() {\n        throw new Error(\"This always throws\");\n      };\n      return pm.promiseFail = function() {\n        return Promise.reject(new Error(\"This is a failed promise\"));\n      };\n    };\n    return \"var module = {};\\nPostmaster = \" + PACKAGE.distribution.main.content + \";\\n(\" + (fn.toString()) + \")();\";\n  };\n\n  initWindow = function(targetWindow) {\n    return targetWindow.document.write(\"<script>\" + (scriptContent()) + \"<\\/script>\");\n  };\n\n  describe(\"Postmaster\", function() {\n    it(\"should work with openened windows\", function(done) {\n      var childWindow, postmaster;\n      childWindow = open(\"\", null, \"width=200,height=200\");\n      initWindow(childWindow);\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      return postmaster.invokeRemote(\"echo\", 5).then(function(result) {\n        return assert.equal(result, 5);\n      }).then(function() {\n        return done();\n      }, function(error) {\n        return done(error);\n      }).then(function() {\n        return childWindow.close();\n      });\n    });\n    it(\"should work with iframes\", function(done) {\n      var childWindow, iframe, postmaster;\n      iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      childWindow = iframe.contentWindow;\n      initWindow(childWindow);\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      return postmaster.invokeRemote(\"echo\", 17).then(function(result) {\n        return assert.equal(result, 17);\n      }).then(function() {\n        return done();\n      }, function(error) {\n        return done(error);\n      }).then(function() {\n        return iframe.remove();\n      });\n    });\n    it(\"should handle the remote call throwing errors\", function(done) {\n      var childWindow, iframe, postmaster;\n      iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      childWindow = iframe.contentWindow;\n      initWindow(childWindow);\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      postmaster.invokeRemote(\"throws\")[\"catch\"](function(error) {\n        return done();\n      }).then(function() {\n        return iframe.remove();\n      });\n    });\n    it(\"should throwing a useful error when the remote doesn't define the function\", function(done) {\n      var childWindow, iframe, postmaster;\n      iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      childWindow = iframe.contentWindow;\n      initWindow(childWindow);\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      postmaster.invokeRemote(\"someUndefinedFunction\")[\"catch\"](function(error) {\n        return done();\n      }).then(function() {\n        return iframe.remove();\n      });\n    });\n    it(\"should handle the remote call returning failed promises\", function(done) {\n      var childWindow, iframe, postmaster;\n      iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      childWindow = iframe.contentWindow;\n      initWindow(childWindow);\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      postmaster.invokeRemote(\"promiseFail\")[\"catch\"](function(error) {\n        return done();\n      }).then(function() {\n        return iframe.remove();\n      });\n    });\n    it(\"should be able to go around the world\", function(done) {\n      var childWindow, iframe, postmaster;\n      iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      childWindow = iframe.contentWindow;\n      initWindow(childWindow);\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      postmaster.yolo = function(txt) {\n        return \"heyy \" + txt;\n      };\n      postmaster.invokeRemote(\"invokeRemote\", \"yolo\", \"cool\").then(function(result) {\n        return assert.equal(result, \"heyy cool\");\n      }).then(function() {\n        return done();\n      }, function(error) {\n        return done(error);\n      }).then(function() {\n        return iframe.remove();\n      });\n    });\n    it(\"should work with web workers\", function(done) {\n      var base, blob, jsUrl, postmaster, worker;\n      blob = new Blob([scriptContent()]);\n      jsUrl = URL.createObjectURL(blob);\n      worker = new Worker(jsUrl);\n      base = {\n        remoteTarget: function() {\n          return worker;\n        },\n        receiver: function() {\n          return worker;\n        }\n      };\n      postmaster = Postmaster(base);\n      postmaster.invokeRemote(\"echo\", 17).then(function(result) {\n        return assert.equal(result, 17);\n      }).then(function() {\n        return done();\n      }, function(error) {\n        return done(error);\n      }).then(function() {\n        return worker.terminate();\n      });\n    });\n    it(\"should fail quickly when contacting a window that doesn't support Postmaster\", function(done) {\n      var childWindow, iframe, postmaster;\n      iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      childWindow = iframe.contentWindow;\n      postmaster = Postmaster();\n      postmaster.remoteTarget = function() {\n        return childWindow;\n      };\n      postmaster.invokeRemote(\"echo\", 5)[\"catch\"](function(e) {\n        if (e.message.match(/no ack/i)) {\n          return done();\n        } else {\n          return done(1);\n        }\n      }).then(function() {\n        return iframe.remove();\n      });\n    });\n    return it(\"should return a rejected promise when unable to send to the target\", function(done) {\n      var postmaster;\n      postmaster = Postmaster({\n        remoteTarget: function() {\n          return null;\n        }\n      });\n      postmaster.invokeRemote(\"yo\")[\"catch\"](function(e) {\n        assert.equal(e.message, \"Cannot read property 'postMessage' of null\");\n        return done();\n      });\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "config": {
        "version": "0.5.3"
      },
      "version": "0.5.3",
      "entryPoint": "main",
      "repository": {
        "branch": "v0.5.3",
        "default_branch": "master",
        "full_name": "distri/postmaster",
        "homepage": null,
        "description": "Send and receive postMessage commands.",
        "html_url": "https://github.com/distri/postmaster",
        "url": "https://api.github.com/repos/distri/postmaster",
        "publishBranch": "gh-pages"
      },
      "dependencies": {}
    },
    "ui": {
      "source": {
        "LICENSE": {
          "path": "LICENSE",
          "content": "MIT License\n\nCopyright (c) 2016 Daniel X Moore\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n",
          "mode": "100644",
          "type": "blob"
        },
        "NOTES.md": {
          "path": "NOTES.md",
          "content": "Notes\n=====\n\nWrapping simple promise returning handlers around the modal should make it easy\nto prompt.\n",
          "mode": "100644",
          "type": "blob"
        },
        "README.md": {
          "path": "README.md",
          "content": "UI\n===\n\nArtisanal User Interface\n\nMenus\n-----\n\n- Context Menu\n- Menu Bar\n- Nested submenus\n\nSimple DSL for creating menus and binding to handlers.\n\n```\n{ContextMenu} = require \"ui\"\n\ncontextMenu = ContextMenu()\ndocument.body.appendChild contextMenu.element\n```\n\nModals\n------\n\n- Alert\n- Confirm\n- Prompt\n\nPromise returning prompts, confirms, etc.\n\nActions\n-------\n\nHotkeys, help text, icons, enabled/disabled states.\n\nZ-Indexes\n---------\n\nIs there a sane way to do z-indexes? Right now I'm just listing them.\n\nModal: 1000\nContext Menu: 2000\n",
          "mode": "100644",
          "type": "blob"
        },
        "TODO.md": {
          "path": "TODO.md",
          "content": "TODO\n====\n\nModals\n  ✔️Alert\n  ✔️Prompt\n  ✔Confirm\n  ✔General\n\nMenus\n  ✔️Menu Bar\n  ✔️Context Menu\n  ✔️Keyboard Navigation (Up, Down, Left, Right)\n  ✔️Accelerator Keys\n  ✔️Display Hotkeys\n  ✔️Indicate Enabled/Disabled\n  ✔️Nested Submenus\n\nToaster/Popup Notifications\n  Animations\n  Native notifications?\n\nGlobal Hotkeys\n\nLoader / Progress\n\nDocumentation\n  Modals\n  Menus\n  Context Menus\n  Hotkeys\n  Windows\n\nExamples\n  Modal Progress Bar\n\nWindows\n  ✔Draggable\n  ✔Resizable (Need to add invisible overlay when moving the mouse so iframes don't jank up the resize)\n  ✔Close\n  Maximize\n  ✔Z-Index\n  Option Menu\n\nTOMAYBE\n=======\n\nTile Windows\n\nForms\n\nTables/Grids\n\nLists\n\nFile Trees\n",
          "mode": "100644",
          "type": "blob"
        },
        "action.coffee": {
          "path": "action.coffee",
          "content": "###\nAction\n======\n\nActions have a function to call, a hotkey, and a function that determines\nwhether or not they are disabled. This is so we can present them in the UI for\nmenus.\n\nThe hotkey is for display purposes only and needs to be listened to by a\nseparate mechanism to perform. [TODO] The action can be executed like a regular\nfunction (instead of needing to use call).\n\nActions may have icons and help text as well.\n\n###\n\nObservable = require \"observable\"\n\n# TODO: This is just a test for toggling disabled state\nmodule.exports = (fn, hotkey) ->\n  disabled = Observable false\n  setInterval ->\n    disabled.toggle()\n  , 1000\n\n  disabled: disabled\n  hotkey: ->\n    hotkey\n  call: (args...) ->\n    fn.call(args...)\n",
          "mode": "100644",
          "type": "blob"
        },
        "demo.coffee": {
          "path": "demo.coffee",
          "content": "{ContextMenu, MenuBar, Modal, Observable, Util:{parseMenu}, Progress, Style, Table, Window} = require \"./export\"\n\n{o} = require \"./util\"\n\nnotepadMenuText = require \"./samples/notepad-menu\"\nnotepadMenuParsed = parseMenu notepadMenuText\n\nFormSampleTemplate = require \"./samples/test-form\"\n\nstyle = document.createElement \"style\"\nstyle.innerHTML = Style.all\ndocument.head.appendChild style\n\nsampleMenuParsed = parseMenu \"\"\"\n  [M]odal\n    [A]lert\n    [C]onfirm\n    [P]rompt\n    [F]orm\n    P[r]ogress\n  [T]est Nesting\n    Test[1]\n      Hello\n      Wat\n    Test[2]\n      [N]ested\n      -----\n      [R]ad\n        So Rad\n        =====\n        Hella\n          Hecka\n            Super Hecka\n              Wicked\n          ---\n          -\n          -\n          ==\n  [W]indow\n    New [I]mage -> newImage\n    New [P]ixel -> newPixel\n    New [T]ext -> newText\n    New [S]preadsheet -> newSheet\n\"\"\"\n{element} = MenuBar\n  items: sampleMenuParsed,\n  handlers:\n    alert: ->\n      Modal.alert \"yolo\"\n    prompt: ->\n      Modal.prompt \"Pretty cool, eh?\", \"Yeah!\"\n      .then console.log\n    confirm: ->\n      Modal.confirm \"Jawsome!\"\n      .then console.log\n    form: ->\n      Modal.form FormSampleTemplate()\n      .then console.log\n    progress: ->\n      initialMessage = \"Reticulating splines\"\n      progressView = Progress\n        value: 0\n        max: 2\n        message: initialMessage\n\n      Modal.show progressView.element,\n        cancellable: false\n\n      intervalId = setInterval ->\n        newValue = progressView.value() + 1/60\n        ellipsesCount = Math.floor(newValue * 4) % 4\n        ellipses = [0...ellipsesCount].map ->\n          \".\"\n        .join(\"\")\n        progressView.value(newValue)\n        progressView.message(initialMessage + ellipses)\n        if newValue > 2\n          clearInterval intervalId\n          Modal.hide()\n      , 15\n    newImage: ->\n      img = document.createElement \"img\"\n      img.src = \"https://s3.amazonaws.com/whimsyspace-databucket-1g3p6d9lcl6x1/danielx/data/pI1mvEvxcXJk4mNHNUW-kZsNJsrPDXcAtgguyYETRXQ\"\n\n      addWindow\n        title: \"Yoo\"\n        content: img\n        iconEmoji: \"💼\"\n\n    newPixel: ->\n      frame = document.createElement \"iframe\"\n      frame.src = \"https://danielx.net/pixel-editor/embedded/\"\n\n      addWindow\n        title: \"Pixel\"\n        content: frame\n\n    newText: ->\n      textarea = document.createElement \"textarea\"\n\n      addWindow\n        title: \"Notepad.exe\"\n        content: textarea\n\n    newSheet: ->\n      data = [0...5].map (i) ->\n        id: i\n        name: \"yolo\"\n        color: \"#FF0000\"\n\n      InputTemplate = require \"./templates/input\"\n      RowElement = (datum) ->\n        tr = document.createElement \"tr\"\n        types = [\n          \"number\"\n          \"text\"\n          \"color\"\n        ]\n\n        Object.keys(datum).forEach (key, i) ->\n          td = document.createElement \"td\"\n          td.appendChild InputTemplate\n            value: o datum, key\n            type: types[i]\n\n          tr.appendChild td\n\n        return tr\n\n      {element} = tableView = Table {\n        data\n        RowElement\n      }\n\n      menuBar = MenuBar\n        items: parseMenu \"\"\"\n          Insert\n            Row -> insertRow\n          Help\n            About\n        \"\"\"\n        handlers:\n          about: ->\n            Modal.alert \"Spreadsheet v0.0.1 by Daniel X Moore\"\n          insertRow: ->\n            data.push\n              id: 50\n              name: \"new\"\n              color: \"#FF00FF\"\n\n            tableView.render()\n\n      addWindow\n        title: \"Spreadsheet [DEMO VERSION]\"\n        content: element\n        menuBar: menuBar.element\n\ndocument.body.appendChild element\n\ndesktop = document.createElement \"desktop\"\ndocument.body.appendChild desktop\n\ncontextMenu = ContextMenu\n  items: sampleMenuParsed[1][1]\n  handlers: {}\n\ndesktop.addEventListener \"contextmenu\", (e) ->\n  if e.target is desktop\n    e.preventDefault()\n\n    contextMenu.display\n      inElement: document.body\n      x: e.pageX\n      y: e.pageY\n\naddWindow = (params) ->\n  windowView = Window params\n\n  desktop.appendChild windowView.element\n\n  return windowView\n",
          "mode": "100644",
          "type": "blob"
        },
        "export.coffee": {
          "path": "export.coffee",
          "content": "Action = require \"./action\"\nContextMenuView = require \"./views/context-menu\"\nModal = require \"./modal\"\nMenuView = require \"./views/menu\"\nMenuBarView = require \"./views/menu-bar\"\nMenuItemView = require \"./views/menu-item\"\nObservable = require \"observable\"\nProgressView = require \"./views/progress\"\nStyle = require \"./style\"\nTableView = require \"./views/table\"\nWindowView = require \"./views/window\"\n\nmodule.exports = {\n  Action: Action\n  Bindable: require \"bindable\"\n  ContextMenu: ContextMenuView\n  Modal\n  Menu: MenuView\n  MenuBar: MenuBarView\n  MenuItem: MenuItemView\n  Observable: Observable\n  Progress: ProgressView\n  Style\n  Table: TableView\n  Util:\n    parseMenu: require \"./lib/indent-parse\"\n  Window: WindowView\n}\n",
          "mode": "100644",
          "type": "blob"
        },
        "hotkeys.coffee": {
          "path": "hotkeys.coffee",
          "content": "###\nHotkeys\n=======\n\nBind hotkeys\n\n    Hotkey = require \"hotkey\"\n\n    Hotkey \"ctrl+r\", ->\n      alert \"radical!\"\n\nWe'd like to be able to generate a list of hotkeys with descriptions.\n\nQuestions\n---------\n\nShould we just use Mousetrap?\n\nMaybe, but it may have different semantics with preventDefault/defaultPrevented.\n\nShould we allow binding to specific elements?\n\nImagine a windowing OS where non-iframe apps are inside draggable windows. We'd\nlike to have each 'app' able to have its own hotkeys and at the same time have\nglobal OS level hotkeys.\n\nShould `defaultPrevented` prevent executing the hotkey action? Yes\n\nShould executing a hotkey preventDefault? Yes\n\n###\n\n# TODO: This is just a rough outline\nmodule.exports = (element) ->\n  handlers = {}\n\n  handle = (event) ->\n    {key} = event\n\n    modifiersActive = [\"alt\", \"ctrl\", \"meta\", \"shift\"].filter (modifier) ->\n      event[\"#{modifier}Key\"]\n\n    combo = modifiersActive.concat(key).join(\"+\")\n\n    # TODO: Don't trigger \"plain\" events in input/text fields\n\n    handlers[combo]?(e)\n",
          "mode": "100644",
          "type": "blob"
        },
        "lib/assert.coffee": {
          "path": "lib/assert.coffee",
          "content": "module.exports = (condition, message) ->\n  throw new Error message unless condition\n",
          "mode": "100644",
          "type": "blob"
        },
        "lib/indent-parse.coffee": {
          "path": "lib/indent-parse.coffee",
          "content": "top = (stack) ->\n  stack[stack.length - 1]\n\nparse = (source) ->\n  stack = [[]]\n  indentation = /^(  )*/\n  depth = 0\n\n  source.split(\"\\n\").forEach (line, lineNumber) ->\n    match = line.match(indentation)[0]\n    text = line.replace(match, \"\")\n    newDepth = match.length / 2\n\n    return unless text.trim().length\n    current = text\n\n    if newDepth > depth\n      unless newDepth is depth + 1\n        throw new Error \"Unexpected indentation on line #{lineNumber}\"\n      # We're one level further in\n      # Convert the simple string to a [label, items] pair\n      items = []\n      prev = top(stack)\n      prev.push [prev.pop(), items]\n      stack.push items\n    else if newDepth < depth\n      # Pop stack to correct depth\n      stack = stack.slice(0, newDepth + 1)\n\n    depth = newDepth\n\n    top(stack).push current\n\n  return stack[0]\n\nmodule.exports = parse\n",
          "mode": "100644",
          "type": "blob"
        },
        "main.coffee": {
          "path": "main.coffee",
          "content": "if PACKAGE.name is \"ROOT\"\n  require \"./demo\"\nelse\n  module.exports = require \"./export\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "modal.coffee": {
          "path": "modal.coffee",
          "content": "###\nModal\n\nDisplay modal alerts or dialogs.\n\nModal has promise returning equivalents of the native browser:\n\n- Alert\n- Confirm\n- Prompt\n\nThese accept the same arguments and return a promise fulfilled with\nthe same return value as the native methods.\n\nYou can display any element in the modal:\n\n    modal.show myElement\n\n###\n\n{formDataToObject, handle, empty} = require \"./util\"\n\nPromptTemplate = require \"./templates/modal/prompt\"\nModalTemplate = require \"./templates/modal\"\n\nmodal = ModalTemplate()\n\ncancellable = true\nmodal.onclick = (e) ->\n  if e.target is modal and cancellable\n    Modal.hide()\n\ndocument.addEventListener \"keydown\", (e) ->\n  unless e.defaultPrevented\n    if e.key is \"Escape\" and cancellable\n      e.preventDefault()\n      Modal.hide()\n\ndocument.body.appendChild modal\n\ncloseHandler = null\n\nprompt = (params) ->\n  new Promise (resolve) ->\n    element = PromptTemplate params\n\n    Modal.show element,\n      cancellable: false\n      closeHandler: resolve\n    element.querySelector(params.focus)?.focus()\n\nmodule.exports = Modal =\n  show: (element, options) ->\n    if typeof options is \"function\"\n      closeHandler = options\n    else\n      closeHandler = options?.closeHandler\n      if options?.cancellable?\n        cancellable = options.cancellable\n\n    empty(modal).appendChild(element)\n    modal.classList.add \"active\"\n\n  hide: (dataForHandler) ->\n    closeHandler?(dataForHandler)\n    modal.classList.remove \"active\"\n    cancellable = true\n    empty(modal)\n\n  alert: (message) ->\n    prompt\n      title: \"Alert\"\n      message: message\n      focus: \"button\"\n      confirm: handle ->\n        Modal.hide()\n\n  prompt: (message, defaultValue=\"\") ->\n    prompt\n      title: \"Prompt\"\n      message: message\n      focus: \"input\"\n      defaultValue: defaultValue\n      cancel: handle ->\n        Modal.hide(null)\n      confirm: handle ->\n        Modal.hide modal.querySelector(\"input\").value\n\n  confirm: (message) ->\n    prompt\n      title: \"Confirm\"\n      message: message\n      focus: \"button\"\n      cancel: handle ->\n        Modal.hide(false)\n      confirm: handle ->\n        Modal.hide(true)\n\n  form: (formElement) ->\n    new Promise (resolve) ->\n      submitHandler = handle (e) ->\n        formData = new FormData(formElement)\n        result = formDataToObject(formData)\n        Modal.hide(result)\n\n      formElement.addEventListener \"submit\", submitHandler\n\n      Modal.show formElement, (result) ->\n        formElement.removeEventListener \"submit\", submitHandler\n        resolve(result)\n",
          "mode": "100644",
          "type": "blob"
        },
        "pixie.cson": {
          "path": "pixie.cson",
          "content": "version: \"0.1.9\"\nentryPoint: \"main\"\nremoteDependencies: [\n]\ndependencies:\n  observable: \"distri/observable:master\"\n  bindable: \"distri/bindable:master\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "samples/notepad-menu.coffee": {
          "path": "samples/notepad-menu.coffee",
          "content": "module.exports = \"\"\"\n  [F]ile\n    [N]ew\n    [O]pen\n    [S]ave\n    Save [A]s\n    -\n    Page Set[u]p\n    [P]rint\n    -\n    E[x]it\n  [E]dit\n    [U]ndo\n    Redo\n    -\n    Cu[t]\n    [C]opy\n    [P]aste\n    De[l]ete\n    -\n    [F]ind\n    Find [N]ext\n    [R]eplace\n    [G]o To\n    -\n    Select [A]ll\n    Time/[D]ate\n  F[o]rmat\n    [W]ord Wrap\n    [F]ont...\n  [V]iew\n    [S]tatus Bar\n  [H]elp\n    View [H]elp\n    -\n    [A]bout Notepad\n\"\"\"\n",
          "mode": "100644",
          "type": "blob"
        },
        "samples/test-form.jadelet": {
          "path": "samples/test-form.jadelet",
          "content": "form\n  h1 Cool Form Bro\n  p\n    a(href=\"https://yolo.biz\") Yolo\n  input(name=\"yolo\")\n  input(name=\"x\" value=\"Lorem\")\n  input(name=\"y\" value=\"florem\")\n  input(name=\"z\" type=\"number\" value=5)\n  input(name=\"file\" type=\"file\")\n  textarea(name=\"text\")\n  button Submit\n",
          "mode": "100644",
          "type": "blob"
        },
        "style.coffee": {
          "path": "style.coffee",
          "content": "styles = {}\n\nall = \"\"\"\n  main\n  loader\n  menu\n  modal\n  table\n  window\n\"\"\".split(\"\\n\").map (stylePath) ->\n  content = require \"./style/#{stylePath}\"\n  styles[stylePath] = content\n\n  return content\n.join(\"\\n\")\n\nstyles.all = all\n\nmodule.exports = styles\n",
          "mode": "100644",
          "type": "blob"
        },
        "style/loader.styl": {
          "path": "style/loader.styl",
          "content": "// Loader\nloader\n  display: block\n  padding: 1em\n\n  > p:empty\n    margin: 0\n\n  > progress\n    display: block\n",
          "mode": "100644",
          "type": "blob"
        },
        "style/main.styl": {
          "path": "style/main.styl",
          "content": "*\n  box-sizing: border-box\n\nbody\n  display: flex\n  flex-direction: column\n  font-family: Sans-Serif\n  font-size: 14px\n  line-height: 18px\n  margin: 0\n\nbody, html\n  height: 100%\n\ninput, textarea, keygen, select, button\n  font-size: inherit\n  font-family: inherit\n",
          "mode": "100644",
          "type": "blob"
        },
        "style/menu.styl": {
          "path": "style/menu.styl",
          "content": "// Menus\nno-select()\n  user-select: none\n  -moz-user-select: none\n  -webkit-user-select: none\n  -ms-user-select: none\n\nmenu\n  no-select()\n\n  background-color: lightgrey\n  border-bottom: 1px solid rgba(0, 0, 0, 0.5)\n  margin: 0\n  z-index: 1\n\n  &:focus\n    outline: none\n\nmenu.context\n  z-index: 2000\n\nmenu-item\n  display: block\n  list-style-type: none\n\n  &.active\n    background-color: #000080\n    color: white\n\n  > label\n    display: flex\n    padding: 0 0.25em\n    white-space: nowrap\n\n    > *\n      flex: 1 1 auto\n\n    > span.hotkey\n      margin-left: 1em\n\n      &:empty\n        margin-left: 0\n\n    > .decoration\n      align-self: center\n      flex: 0 1 auto\n      line-height: 1em\n      text-align: right\n      margin-left: 0.5em\n      padding-bottom: 0.125em\n\n      &:empty\n        margin-left: 0\n\n  &[disabled]\n    color: gray\n\n    &.active\n      background-color: rgba(0, 0, 0, 0.125)\n\nmenu.options\n  border-top: 1px solid rgba(255, 255, 255, 0.5)\n  border-left: 1px solid rgba(255, 255, 255, 0.5)\n  border-right: 1px solid rgba(0, 0, 0, 0.5)\n\n  box-shadow: 2px 2px 1px rgba(0, 0, 0, 0.5)\n\n  display: none\n\n  padding: 2px\n  padding-bottom: 3px\n  position: absolute\n\n  &.active\n    display: block\n\n  // Submenu\n  > menu-item.menu\n    position: relative\n\n    > menu\n      position: absolute\n      left: 100%\n      top: -3px\n      margin-left: 1px\n\nmenu-item.menu.active\n  > menu\n    background-color: lightgrey\n    color: black\n    display: block\n\nmenu.bar\n  display: block\n  flex: 0 0 auto\n  margin: 0\n  padding: 0\n  position: initial\n  white-space: nowrap\n  overflow: hidden\n\n  > menu-item\n    display: inline-block\n    > label > .decoration\n      display: none\n\n  &.accelerator-active\n    span.accelerator\n      text-decoration: underline\n\n// For context menus starting from the bottom of the screen\nmenu.options.bottoms-up menu-item.menu > menu\n  top: initial\n  bottom: -4px\n",
          "mode": "100644",
          "type": "blob"
        },
        "style/modal.styl": {
          "path": "style/modal.styl",
          "content": "#modal\n  align-items: center\n  background-color: rgba(0, 0, 0, 0.25)\n  display: none\n  justify-content: center\n  position: absolute\n  z-index: 1000\n  top: 0\n  width: 100%\n  height: 100%\n\n  &.active\n    display: flex\n\n  > *\n    background-color: white\n    border: 1px solid rgba(0, 0, 0, 0.5)\n    box-shadow: 2px 2px 6px rgb(0, 0, 0, 0.5)\n    max-width: 90%\n    max-height: 90%\n\n  > form\n    display: block\n    padding: 1em\n\n    > h1\n      font-size: 1.5em\n      margin: 0\n\n    > input, textarea\n      display: block\n      margin-bottom: 1em\n      width: 100%\n\n    > button\n      margin-right: 1em\n      &:last-child\n        margin-right: 0\n",
          "mode": "100644",
          "type": "blob"
        },
        "style/table.styl": {
          "path": "style/table.styl",
          "content": "container\n  display: block\n  height: 100%\n  overflow: auto\n  width: 100%\n\ntable\n  border-collapse: collapse\n  width: 100%\n\nth\n  text-align: left\n\nthead\n  border-bottom: 1px solid black\n\ntd > input\n  border: none\n  background-color: transparent\n  width: 100%\n  height: 100%\n  padding: 0\n\ntr:nth-child(even)\n  background-color: #EEE\n",
          "mode": "100644",
          "type": "blob"
        },
        "style/window.styl": {
          "path": "style/window.styl",
          "content": "no-select()\n  user-select: none\n  -moz-user-select: none\n  -webkit-user-select: none\n  -ms-user-select: none\n\ndesktop\n  no-select()\n\n  display: block\n  flex: 1 0 auto\n\nborder-color = rgba(0, 0, 0, 0.87)\n\nwindow\n  no-select()\n\n  background-color: lightgrey\n  border: 4px double border-color\n  border-radius: 4px\n  display: flex\n  flex-direction: column\n  position: absolute\n\n  > header\n    background-color: #000080\n    border-bottom: 1px solid border-color\n    cursor: default\n    display: flex\n    flex: 0 0 auto\n\n    > icon\n      background-position: 50%\n      background-repeat: no-repeat\n      background-size: 16px\n      color: white\n      display: inline-block\n      flex: 0 0 auto\n      text-align: center\n      width: 0\n\n    > control\n      background-color: lightgrey\n      color: white\n      display: inline-block\n      flex: 0 0 auto\n      font-family: monospace\n      width: 18px\n      text-shadow: 1px 0px 0px #000, -1px 0px 0px #000, 0px -1px 0px #000, 0px 1px 0px #000, 1px 1px 0px #808080\n      text-align: center\n\n      border-left: 1px solid border-color\n      &:first-child\n        border-left: none\n\n      &.close\n        &::before\n          content: \"X\"\n\n      &.maximize\n        &::before\n          content: \"⏫\"\n\n      &.minimize\n        &::before\n          content: \"-\"\n\n      &.restore\n        display: none\n        &::before\n          content: \"⏬\"\n\n    > title-bar\n      color: white\n      display: inline-block\n      flex: 1 1 auto\n      overflow: hidden\n      padding: 0 1rem 0 6px\n      text-overflow: ellipsis\n      white-space: nowrap\n\n  > viewport\n    background-color: white\n    display: flex\n    height: 100%\n    overflow: auto\n    position: relative\n    z-index: 0\n\n    > *\n      margin: auto\n\n    > textarea\n      border: none\n      font-family: monospace\n      height: 100%\n      padding: 2px 4px\n      resize: none\n      width: 100%\n\n    > iframe\n      border: none\n      height: 100%\n      width: 100%\n      position: absolute\n\n  > resize\n    display: block\n    position: absolute\n\n    &.e, &.w\n      cursor: ew-resize\n\n    &.n, &.s\n      cursor: ns-resize\n\n    &.h\n      height: 4px\n      width: 100%\n\n    &.v\n      height: 100%\n      width: 4px\n\n    &.w\n      left: -4px\n    &.e\n      right: -4px\n    &.n\n      top: -4px\n    &.s\n      bottom: -4px\n\n    &.n.w\n      cursor: nw-resize\n\n    &.n.e\n      cursor: ne-resize\n\n    &.s.e\n      cursor: se-resize\n\n    &.s.w\n      cursor: sw-resize\n\n    &.n.v\n      border-bottom: 1px solid black\n      height: 23px\n\n    &.s.v\n      border-top: 1px solid black\n      height: 23px\n\n    &.e.h\n      border-left: 1px solid black\n      width: 22px\n\n    &.w.h\n      border-right: 1px solid black\n      width: 22px\n\n  &.minimized\n    > header\n      border-bottom: none\n\n      > control\n        display: none\n\n        &.minimize\n          border-right: none\n          display: inline-block\n          &::before\n            content: \"+\"\n\n    > menu, > resize, > viewport\n      display: none\n\n  &.maximized\n    border: none\n    border-radius: 0\n    height: 100%\n    width: 100%\n\n    > resize\n      display: none\n\n    > header\n      > control\n        display: none\n\n        &.restore, &.close\n          display: inline-block\n\nframe-guard\n  display: block\n  height: 100%\n  pointer-events: none\n  position: absolute\n  width: 100%\n  z-index: 100000\n\n  &.active\n    pointer-events: auto\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/input.jadelet": {
          "path": "templates/input.jadelet",
          "content": "input(@value @type)\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/menu-item.jadelet": {
          "path": "templates/menu-item.jadelet",
          "content": "menu-item(@class @click @mousemove @disabled)\n  label\n    = @title\n    span.hotkey= @hotkey\n    span.decoration= @decoration\n  = @content\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/menu-separator.jadelet": {
          "path": "templates/menu-separator.jadelet",
          "content": "menu-item\n  hr\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/menu.jadelet": {
          "path": "templates/menu.jadelet",
          "content": "menu(@class @click @style)= @items\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/modal.jadelet": {
          "path": "templates/modal.jadelet",
          "content": "#modal\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/modal/prompt.jadelet": {
          "path": "templates/modal/prompt.jadelet",
          "content": "form(submit=@confirm tabindex=-1)\n  h1= @title\n  p= @message\n  - if @defaultValue?\n    input(type=\"text\" value=@defaultValue)\n  button OK\n  - if @cancel\n    button(click=@cancel) Cancel\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/progress.jadelet": {
          "path": "templates/progress.jadelet",
          "content": "loader\n  p= @message\n  progress(@class @value @max)\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/table.jadelet": {
          "path": "templates/table.jadelet",
          "content": "container\n  table(@keydown)\n    thead\n      tr\n        - @headers.forEach (header) ->\n          th= header\n    tbody\n",
          "mode": "100644",
          "type": "blob"
        },
        "templates/window.jadelet": {
          "path": "templates/window.jadelet",
          "content": "window(@class)\n  resize.n.h\n  resize.e.v\n  resize.s.h\n  resize.w.v\n  resize.n.e.h\n  resize.n.e.v\n  resize.n.w.h\n  resize.n.w.v\n  resize.s.e.h\n  resize.s.e.v\n  resize.s.w.h\n  resize.s.w.v\n  header\n    icon(style=@iconStyle)= @iconEmoji\n    title-bar= @title\n    control.minimize(click=@minimize)\n    control.maximize(click=@maximize)\n    control.restore(click=@restore)\n    control.close(click=@close)\n  = @menuBar\n  viewport\n    = @content\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/menu-item.coffee": {
          "path": "test/menu-item.coffee",
          "content": "MenuItemView = require \"../views/menu-item\"\nObservable = require \"observable\"\n\ndescribe \"MenuItem\", ->\n  # TODO: Make context root optional\n\n  it \"should have correct custom action names\", ->\n    called = false\n\n    menuItem = MenuItemView\n      label: \"Cool -> Super Cool\"\n      contextRoot:\n        activeItem: ->\n        handlers:\n          \"Super Cool\": ->\n            called = true\n\n    assert !called\n    menuItem.click()\n    assert called\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/menu-parser.coffee": {
          "path": "test/menu-parser.coffee",
          "content": "parse = require \"../lib/indent-parse\"\n\ndescribe \"Menu Parser\", ->\n  it \"should parse menus into lists\", ->\n    data = \"\"\"\n      File\n    \"\"\"\n\n    results = parse(data)\n    assert.deepEqual [\"File\"], results\n\n  it \"should parse empty\", ->\n    data = \"\"\"\n    \"\"\"\n\n    assert.deepEqual [], parse(data)\n\n  it \"should deal with nesting ok\", ->\n    data = \"\"\"\n      File\n        Open\n        Save\n      Edit\n        Copy\n        Paste\n      Help\n    \"\"\"\n\n    results = parse(data)\n    assert.deepEqual [\n      [\"File\", [\"Open\", \"Save\"]]\n      [\"Edit\", [\"Copy\", \"Paste\"]]\n      \"Help\"\n    ], results\n\n  it \"should parse big ol' menus\", ->\n    results = parse \"\"\"\n      File\n        New\n        Open\n        Save\n        Save As\n      Edit\n        Undo\n        Redo\n        -\n        Cut\n        Copy\n        Paste\n        Delete\n        -\n        Find\n        Find Next\n        Replace\n        Go To\n        -\n        Select All\n        Time/Date\n      Format\n        Word Wrap\n        Font...\n      View\n        Status Bar\n      Help\n        View Help\n        -\n        About Notepad\n    \"\"\"\n\n    assert.deepEqual [\n      [\"File\", [\"New\", \"Open\", \"Save\", \"Save As\"]]\n      [\"Edit\", [\"Undo\", \"Redo\", \"-\", \"Cut\", \"Copy\", \"Paste\", \"Delete\", \"-\", \"Find\", \"Find Next\", \"Replace\", \"Go To\", \"-\", \"Select All\", \"Time/Date\"]]\n      [\"Format\", [\"Word Wrap\", \"Font...\"]]\n      [\"View\", [\"Status Bar\"]]\n      [\"Help\", [\"View Help\", \"-\", \"About Notepad\"]]\n    ], results\n\n  it \"should parse hella nested menus\", ->\n    results = parse \"\"\"\n      File\n        Special\n          Nested\n            Super\n              Awesome\n    \"\"\"\n\n    assert.deepEqual [\n      [\"File\", [\n        [\"Special\", [\n          [\"Nested\", [\n            [\"Super\", [\n              \"Awesome\"\n            ]]\n          ]]\n        ]]\n      ]]\n    ], results\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/menu.coffee": {
          "path": "test/menu.coffee",
          "content": "MenuView = require \"../views/menu\"\nObservable = require \"observable\"\n\ndescribe \"Menu\", ->\n  # TODO: Make context root optional\n\n  it \"should work with plain ol' items\", ->\n    menu = MenuView\n      items: [\n        \"Cool\"\n        \"Rad\"\n      ]\n      contextRoot:\n        activeItem: Observable null\n        handlers: {}\n\n    assert.equal menu.items().length, 2\n\n  it \"should allow observable items\", ->\n    items = Observable [\n      \"Cool\"\n      [\"Rad\", [\"2rad\", \"2Furious\"]]\n    ]\n\n    menu = MenuView\n      items: items\n      contextRoot:\n        activeItem: Observable null\n        handlers: {}\n\n    assert.equal menu.items().length, 2\n\n    items [\n      \"New Stuff\"\n    ]\n\n    assert.equal menu.items().length, 1\n",
          "mode": "100644",
          "type": "blob"
        },
        "test/modal.coffee": {
          "path": "test/modal.coffee",
          "content": "PACKAGE.name = \"test\"\n\n{Modal} = require \"../main\"\n\ndescribe \"Modal\", ->\n  it \"shoud be totally chill\", ->\n    element = document.createElement \"p\"\n\n    called = false\n    handler = (value) ->\n      called = true\n      assert.equal value, \"yolo\"\n\n    Modal.show(element, handler)\n    Modal.hide('yolo')\n\n    assert called\n",
          "mode": "100644",
          "type": "blob"
        },
        "util.coffee": {
          "path": "util.coffee",
          "content": "Observable = require \"observable\"\n\nA = (attr) ->\n  (x) -> x[attr]\n\nF = (methodName) ->\n  (x) -> x[methodName]()\n\nget = (x, context) ->\n  if typeof x is 'function'\n    x.call(context)\n  else\n    x\n\n# Observable attribute helper\no = (object, name) ->\n  attribute = Observable(object[name])\n\n  attribute.observe (newValue) ->\n    object[name] = newValue\n\n  return attribute\n\n# Handle events by preventing the default action\nhandle = (fn) ->\n  (e) ->\n    return if e?.defaultPrevented\n    e?.preventDefault()\n    fn.call(this, e)\n\n# I hope I don't hate myself for this later\n# S for Safe invoke, invoke the method of the object, if it exists and is a\n# function, otherwise return the provided default value\nS = (object, method, defaultValue) ->\n  ->\n    if typeof object?[method] is 'function'\n      object[method]()\n    else\n      defaultValue\n\nasElement = A('element')\n\naccelerateItem = (items, key) ->\n  [acceleratedItem] = items.filter (item) ->\n    item.accelerator is key\n\n  if acceleratedItem\n    # TODO: should there be some kind of exec rather than click action?\n    acceleratedItem.click()\n\nisDescendant = (element, ancestor) ->\n  return unless element\n\n  while (parent = element.parentElement)\n    return true if element is ancestor\n    element = parent\n\nadvance = (list, amount) ->\n  [currentItem] = list.filter (item) ->\n    item.active()\n\n  activeItemIndex = list.indexOf(currentItem) + amount\n\n  if activeItemIndex < 0\n    activeItemIndex = list.length - 1\n  else if activeItemIndex >= list.length\n    activeItemIndex = 0\n\n  list[activeItemIndex]\n\n# TODO: Nested objects?\n# TODO: Convert keys ending in [] to array entries?\n# Just keeping it simple and crushing duplicate names\nformDataToObject = (formData) ->\n  Array.from(formData.entries()).reduce (object, [key, value]) ->\n    object[key] = value\n\n    object\n  , {}\n\n# Get the view associated with a dom element\n# This will let us use the dom tree rather than manage a separate tree\n# to dispatch events at the view level\n# the assumption is that a .view property is written to the root element in the\n# view when rendering a view's template element\nelementView = (element) ->\n  return unless element\n  return element.view if element.view\n  elementView element.parentElement\n\n# Remove all children from a dom node\nempty = (node) ->\n  while node.hasChildNodes()\n    node.removeChild(node.lastChild)\n\n  return node\n\nmodule.exports =\n  htmlEscape: (string) ->\n    String(string).replace /[&<>\"'\\/]/g, (s) ->\n      entityMap[s]\n\n  A: A\n  F: F\n  S: S\n  o: o\n\n  advance: advance\n  asElement: asElement\n  accelerateItem: accelerateItem\n  elementView: elementView\n  empty: empty\n  formDataToObject: formDataToObject\n  get: get\n  handle: handle\n  isDescendant: isDescendant\n\nentityMap =\n  \"&\": \"&amp;\"\n  \"<\": \"&lt;\"\n  \">\": \"&gt;\"\n  '\"': '&quot;'\n  \"'\": '&#39;'\n  \"/\": '&#x2F;'\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/context-menu.coffee": {
          "path": "views/context-menu.coffee",
          "content": "###\nContextMenu\n\nDisplay a context menu!\n\nQuestions:\n\nShould we be able to update the options in the menu after creation?\n\n###\n\n\nObservable = require \"observable\"\n\nMenuView = require \"./menu\"\n\n{isDescendant} = require \"../util\"\n\nmodule.exports = ({items, classes, handlers}) ->\n  activeItem = Observable null\n  classes ?= []\n  top = Observable \"\"\n  left = Observable \"\"\n\n  contextRoot =\n    activeItem: activeItem\n    handlers: handlers\n\n  self = MenuView\n    items: items\n    contextRoot: contextRoot\n    classes: -> [\"context\", \"options\"].concat(classes)\n    style: ->\n      \"top: #{top()}px; left: #{left()}px\"\n\n  element = self.element\n  element.view = self\n\n  self.contextRoot = contextRoot\n  self.display = ({inElement, x, y}) ->\n    top(y)\n    left(x)\n\n    # The element must be added to the dom before it can be activated\n    # it must be visible before it can be focused\n    (inElement or document.body).appendChild element\n    activeItem self\n    element.focus()\n\n  # This must be attached to the document body so we can de-activate when\n  # a person presses the mouse outside of our menu\n  # TODO: How should we clean up this global listener?\n  document.addEventListener \"mousedown\", (e) ->\n    unless isDescendant(e.target, element)\n      activeItem null\n\n  element.setAttribute(\"tabindex\", \"-1\")\n  element.addEventListener \"keydown\", (e) ->\n    {key} = e\n\n    switch key\n      when \"ArrowLeft\", \"ArrowUp\", \"ArrowRight\", \"ArrowDown\"\n        e.preventDefault()\n        direction = key.replace(\"Arrow\", \"\")\n\n        currentItem = activeItem()\n\n        if currentItem\n          currentItem.cursor(direction)\n\n      when \"Escape\"\n        activeItem null\n\n  return self\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/menu-bar.coffee": {
          "path": "views/menu-bar.coffee",
          "content": "# The MenuBar is a list MenuItems arranged in a bar across the top of a page or\n# window.\n\nObservable = require \"observable\"\n\nMenuView = require \"./menu\"\n\n{isDescendant, advance} = require \"../util\"\n\nmodule.exports = ({items, handlers}) ->\n  acceleratorActive = Observable false\n  # Track active menus and item for navigation\n  activeItem = Observable null\n  previouslyFocusedElement = null\n\n  contextRoot =\n    activeItem: activeItem\n    handlers: handlers\n\n  self = MenuView\n    classes: ->\n      [\n        \"bar\"\n        \"accelerator-active\" if acceleratorActive()\n      ]\n    items: items\n    contextRoot: contextRoot\n\n  element = self.element\n\n  # Redefine cursor movement\n  self.cursor = (direction) ->\n    switch direction\n      when \"Right\"\n        self.advance(1)\n      when \"Left\"\n        self.advance(-1)\n\n  # Redefine expand to down and not right on menu items\n  self.items.forEach (item) ->\n    item.horizontal = true\n    item.cursor = (direction) ->\n      console.log \"Item\", direction\n      if direction is \"Down\"\n        item.submenu?.advance(1)\n      else if direction is \"Up\"\n        item.submenu?.advance(-1)\n      else\n        item.parent.cursor direction\n\n  deactivate = ->\n    activeItem null\n    acceleratorActive false\n    # De-activate menu and focus previously focused element\n    previouslyFocusedElement?.focus()\n\n  document.addEventListener \"mousedown\", (e) ->\n    unless isDescendant(e.target, element)\n      acceleratorActive false\n      activeItem null\n\n  document.addEventListener \"keydown\", (e) ->\n    {key} = e\n    switch key\n      when \"Enter\"\n        activeItem()?.click()\n      when \"Alt\"\n        menuIsActive = false\n        if acceleratorActive() or menuIsActive\n          deactivate()\n        else\n          # Store previously focused element\n          # Get menu ready for accelerating!\n          previouslyFocusedElement = document.activeElement\n          element.focus()\n          activeItem self unless activeItem()\n          acceleratorActive true\n\n  # Dispatch the key to the active menu element\n  accelerateIfActive = (key) ->\n    if acceleratorActive()\n      activeItem()?.accelerate(key)\n\n  # We need to be able to focus the menu to receive keyboard events on it\n  element.setAttribute(\"tabindex\", \"-1\")\n  element.addEventListener \"keydown\", (e) ->\n    {key} = e\n\n    switch key\n      when \"ArrowLeft\", \"ArrowUp\", \"ArrowRight\", \"ArrowDown\"\n        e.preventDefault()\n        direction = key.replace(\"Arrow\", \"\")\n\n        currentItem = activeItem()\n\n        if currentItem\n          currentItem.cursor(direction)\n\n      when \"Escape\"\n        deactivate()\n      else\n        # Only prevent default if we successfully accelerated?\n        accelerated = accelerateIfActive(key.toLowerCase())\n        if accelerated?\n          e.preventDefault()\n\n  return self\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/menu-item.coffee": {
          "path": "views/menu-item.coffee",
          "content": "{advance, htmlEscape, asElement, F, S, isDescendant, accelerateItem, handle} = require \"../util\"\n\nMenuItemTemplate = require \"../templates/menu-item\"\n\n# MenuItemView\n# An item that appears in menus\nmodule.exports = ({label, MenuView, items, contextRoot, parent}) ->\n  self = {}\n\n  {activeItem, handlers} = contextRoot\n  # TODO: This gets called per menu item when the state changes\n  # Could we shift it a little to only be called for the relevant subtree?\n  active = ->\n    isDescendant activeItem()?.element, element\n\n  self.active = active\n\n  if items\n    submenu = MenuView({\n      items\n      contextRoot\n      parent: self\n    })\n    content = submenu.element\n\n  # Hook in to Action objects so we can display hotkeys\n  # and enabled/disabled statuses.\n  [labelText, actionName] = formatAction label\n  [title, accelerator] = formatLabel labelText\n  action = handlers[actionName]\n  disabled = S(action, \"disabled\", false)\n  hotkey = S(action, \"hotkey\", \"\")\n\n  click = (e) ->\n    return if disabled()\n    return if e?.defaultPrevented\n    e?.preventDefault()\n\n    if submenu\n      activeItem submenu\n      return\n\n    console.log \"Handling\", actionName\n\n    action?.call?(handlers)\n\n    # TODO: More cleanup than just clearing the active item, like also we\n    # should clear accelerator state, and maybe return focus to previously\n    # focused element.\n    # contextRoot.finish?\n    activeItem null\n\n  element = MenuItemTemplate\n    class: ->\n      [\n        \"menu\" if items\n        \"active\" if active()\n      ]\n    click: click\n\n    mousemove: (e) ->\n      # Click to activate top level menus unless a menu is already active\n      # then hover to show.\n      return unless activeItem()\n\n      if !e.defaultPrevented and isDescendant(e.target, element)\n        # Note: We're using preventDefault to prevent handling the\n        # activation above the first element that handles it\n        e.preventDefault()\n\n        activeItem self\n\n    title: title\n    content: content\n    decoration: \"▸\" if items\n    hotkey: hotkey\n    disabled: disabled\n\n  Object.assign self,\n    accelerator: accelerator\n    accelerate: (key) ->\n      if submenu\n        submenu.accelerate key\n      else\n        parent.accelerate key\n    click: click\n    parent: parent\n    element: element\n    submenu: submenu\n    cursor: (direction) ->\n      console.log \"Item Cursor\", direction\n      if submenu and direction is \"Right\"\n        # Select the first navigable item of the submenu\n        activeItem submenu.navigableItems[0]\n      else if parent.parent and direction is \"Left\"\n        # parent is the menu,\n        # parent.parent is the item in the menu containing the parent\n        if parent.parent.horizontal\n          parent.parent.cursor(direction)\n        else\n          activeItem parent.parent\n      else\n        parent.cursor(direction)\n\n  return self\n\n# Parse out custom action symbol from entries like:\n#\n#     [F]ont... -> showFont\n#\n# Falling back to formatting the action title\nformatAction = (labelText) ->\n  [title, action] = labelText.split(\"->\").map F(\"trim\")\n\n  unless action\n    action = title.replace(/[^A-Za-z0-9]/g, \"\")\n    action = action.charAt(0).toLowerCase() + action.substring(1)\n\n  return [title, action]\n\nformatLabel = (labelText) ->\n  accelerator = undefined\n  # Parse out accelerator keys for underlining when alt is pressed\n  titleHTML = htmlEscape(labelText).replace /\\[([^\\]]+)\\]/, (match, $1) ->\n    accelerator = $1.toLowerCase()\n    \"<span class=\\\"accelerator\\\">#{$1}</span>\"\n\n  span = document.createElement \"span\"\n  span.innerHTML = titleHTML\n\n  return [span, accelerator]\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/menu-separator.coffee": {
          "path": "views/menu-separator.coffee",
          "content": "MenuSeparatorTemplate = require \"../templates/menu-separator\"\n\nmodule.exports = ->\n  element: MenuSeparatorTemplate()\n  separator: true\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/menu.coffee": {
          "path": "views/menu.coffee",
          "content": "Observable = require \"observable\"\n\nassert = require \"../lib/assert\"\n\n{advance, accelerateItem, asElement, get, F, S, htmlEscape, handle, isDescendant} = require \"../util\"\n\nMenuTemplate = require \"../templates/menu\"\nMenuItemTemplate = require \"../templates/menu-item\"\n\nSeparatorView = require \"./menu-separator\"\nMenuItemView = require \"./menu-item\"\n\n# MenuView\n#\n# items is an array of item data\n# An item datum is either a string\n# or a pair of [label:string, items...]\n#\n# ex. [\n#   \"Cool\"\n#   [\"Submenu\", [\n#     \"Yo\",\n#     \"Wat\"\n#   ]]\n# ]\n#\nmodule.exports = MenuView = ({items, classes, style, contextRoot, parent}) ->\n  self = {}\n\n  classes ?= -> [\"options\"]\n\n  {activeItem} = contextRoot\n\n  # Converts items from the data to the element jazz\n  getItems = Observable ->\n    items.map (item) ->\n      switch\n        when typeof item is \"string\" and item.match(/^[=-]+$/)\n          SeparatorView()\n        when Array.isArray(item)\n          assert item.length is 2\n          [label, submenuItems] = item\n          MenuItemView\n            label: label\n            items: submenuItems\n            MenuView: MenuView\n            contextRoot: contextRoot\n            parent: self\n        else\n          MenuItemView\n            label: item\n            contextRoot: contextRoot\n            parent: self\n\n  navigableItems = Observable ->\n    getItems().filter (item) ->\n      !item.separator\n\n  # TODO: This gets called per menu item when the state changes\n  # Could we shift it a little to only be called for the relevant subtree?\n  # Possible solution: find the common ancestor of the new active and the previous\n  # active and only update the necessary ones\n  active = ->\n    isDescendant activeItem()?.element, self.element\n\n  Object.assign self,\n    accelerate: (key) ->\n      accelerateItem(getItems(), key)\n    cursor: (direction) ->\n      switch direction\n        when \"Up\"\n          self.advance(-1)\n        when \"Down\"\n          self.advance(1)\n        else\n          parent.parent?.cursor(direction)\n    parent: parent\n    items: getItems\n    advance: (n) ->\n      activeItem advance(navigableItems(), n)\n    navigableItems: navigableItems\n    element: MenuTemplate\n      style: style\n      class: ->\n        [\n          \"active\" if active()\n        ].concat classes()\n      click: handle (e) ->\n        activeItem self\n      items: ->\n        getItems().map asElement\n\n  return self\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/progress.coffee": {
          "path": "views/progress.coffee",
          "content": "Template = require \"../templates/progress\"\n\nObservable = require \"observable\"\n\nmodule.exports = (params={}) ->\n  {value, max, message} = params\n  value = Observable value or 0\n  max = Observable max\n  message = Observable message\n\n  element = Template\n    value: value\n    max: max\n    message: message\n\n  element: element\n  value: value\n  message: message\n  max: max\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/table.coffee": {
          "path": "views/table.coffee",
          "content": "{empty} = require \"../util\"\n\nTableTemplate = require \"../templates/table\"\n\n# Focus same cell in next row\nadvanceRow = (path, prev) ->\n  [td] = path.filter (element) ->\n    element.tagName is \"TD\"\n  return unless td\n\n  tr = td.parentElement\n  cellIndex = Array::indexOf.call(tr.children, td)\n  if prev\n    nextRowElement = tr.previousSibling\n  else\n    nextRowElement = tr.nextSibling\n\n  if nextRowElement\n    input = nextRowElement.children[cellIndex].querySelector('input')\n    input?.focus()\n\n# The table view takes source data and a constructor that returns a row element\n# for each source datum\n\n# The view will have the ability to filter/sort the data.\n\nTableView = ({data, headers, RowElement}) ->\n  headers ?= Object.keys data[0]\n\n  containerElement = TableTemplate\n    headers: headers\n    keydown: (event) ->\n      {key, path} = event\n      switch key\n        when \"Enter\", \"ArrowDown\"\n          event.preventDefault()\n          advanceRow path\n        when \"ArrowUp\"\n          event.preventDefault()\n          advanceRow path, true\n        # TODO: Left and Right\n        # Left and Right are trickier because you may want to navigate within a text input\n        # ... actually up and down get trickier too if we imagine text areas or\n        # even fancier inputs that may have their own controls...\n\n  tableBody = containerElement.querySelector('tbody')\n\n  filterFn = (datum) ->\n    true\n\n  filterAndSort = (data, filterFn, sortFn) ->\n    filterFn ?= -> true\n    filteredData = data.filter(filterFn)\n\n    if sortFn\n      filteredData.sort(sortFn)\n    else\n      filteredData\n\n  rowElements = ->\n    filterAndSort(data, filterFn, null).map RowElement\n\n  update = ->\n    empty tableBody\n    rowElements().forEach (element) ->\n      tableBody.appendChild element\n\n  update()\n\n  element: containerElement\n  render: update\n\nmodule.exports = TableView\n",
          "mode": "100644",
          "type": "blob"
        },
        "views/window.coffee": {
          "path": "views/window.coffee",
          "content": "WindowTemplate = require \"../templates/window\"\n\n{elementView} = require \"../util\"\n\n# We need an invisible full screen overlay to keep iframes from eating our\n# mousemove events\nframeGuard = document.createElement \"frame-guard\"\ndocument.body.appendChild frameGuard\n\ntopIndex = 0\nraiseToTop = (view) ->\n  return unless typeof view.zIndex is 'function'\n  zIndex = view.zIndex()\n  return if zIndex is topIndex\n  topIndex += 1\n\n  view.zIndex(topIndex)\n\n# Drag Handling\nactiveDrag = null\ndragStart = null\ndocument.addEventListener \"mousedown\", (e) ->\n  {target} = e\n\n  view = elementView target\n  if view\n    # TODO: only raise widows?\n    raiseToTop view\n\n  if target.tagName is \"TITLE-BAR\"\n    frameGuard.classList.add(\"active\")\n    dragStart = e\n    activeDrag = view\n\ndocument.addEventListener \"mousemove\", (e) ->\n  if activeDrag\n    {clientX:prevX, clientY:prevY} = dragStart\n    {clientX:x, clientY:y} = e\n\n    if activeDrag.maximized()\n      maximizedX = activeDrag.x()\n      maximizedY = activeDrag.y()\n\n      activeDrag.restore()\n      activeDrag.x x - activeDrag.width() / 2\n      activeDrag.y maximizedY\n\n    dx = x - prevX\n    dy = y - prevY\n\n    activeDrag.x activeDrag.x() + dx\n    activeDrag.y activeDrag.y() + dy\n\n    dragStart = e\n\n# Resize Handling\nactiveResize = null\nresizeStart = null\nresizeInitial = null\ndocument.addEventListener \"mousedown\", (e) ->\n  {target} = e\n\n  if target.tagName is \"RESIZE\"\n    frameGuard.classList.add(\"active\")\n    resizeStart = e\n    activeResize = target\n    {width, height, x, y} = elementView activeResize\n    resizeInitial =\n      width: width()\n      height: height()\n      x: x()\n      y: y()\n\ndocument.addEventListener \"mousemove\", (e) ->\n  if activeResize\n    {clientX:startX, clientY:startY} = resizeStart\n    {clientX:x, clientY:y} = e\n\n    dx = x - startX\n    dy = y - startY\n\n    width = resizeInitial.width\n    height = resizeInitial.height\n\n    if activeResize.classList.contains(\"e\")\n      width += dx\n\n    if activeResize.classList.contains(\"w\")\n      width -= dx\n\n    if activeResize.classList.contains(\"s\")\n      height += dy\n\n    if activeResize.classList.contains(\"n\")\n      height -= dy\n\n    width = Math.max(width, 200)\n    height = Math.max(height, 50)\n\n    actualDeltaX = width - resizeInitial.width\n    actualDeltaY = height - resizeInitial.height\n\n    view = elementView activeResize\n    if activeResize.classList.contains(\"n\")\n      view.y resizeInitial.y- actualDeltaY\n\n    if activeResize.classList.contains(\"w\")\n      view.x resizeInitial.x- actualDeltaX\n\n    view.width width\n    view.height height\n\n    view.trigger \"resize\"\n\ndocument.addEventListener \"mouseup\", ->\n  activeDrag = null\n  activeResize = null\n  frameGuard.classList.remove(\"active\")\n\nBindable = require \"bindable\"\nObservable = require \"observable\"\n\nmodule.exports = (params) ->\n  self = Bindable()\n\n  x = Observable params.x ? 50\n  y = Observable params.y ? 50\n  width = Observable params.width ? 400\n  height = Observable params.height ? 300\n  title = Observable params.title ? \"Untitled\"\n  minimized = Observable false\n  maximized = Observable false\n  prevWidth = Observable null\n  prevHeight = Observable null\n  prevX = Observable null\n  prevY = Observable null\n  iconURL = Observable params.iconURL or \"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3d3dwAAAAj///////////////cAAAAI///////////////3AAAACP///////3d///d39wAAAAj/zMzM//mZ//+Zn/cAAAAI////////l///+X/3AAAACP/MzMzM//l3d3l/9wAAAAj/////////mZmZf/cAAAAI/8zMzMzM//l/+X/3AAAACP//////////l/l/9wAAAAj/zMzMzMzM//l5f/cAAAAI////////////mX/3AAAACP/MzMzMzMzM//n/9wAAAAj///////////////cAAAAI/8zMzMzMzMzMzP/3AAAACP//////////////9wAAAAj/zMzMzMzMzMzM//cAAAAI///////////////3AAAACP8AAAAA/8zMzMz/9wAAAAj/iZD/8P////////cAAAAI/4AAAAD/zMzMzP/3AAAACP+P8Luw////////9wAAAAj/gAC7sP/MzMzM//cAAAAI/4/wu7D////////3AAAACP+P8Luw/////4AAAAAAAAj/j/AAAP////+P94AAAAAI/4/wzMD/////j3gAAAAACP+IiIiA/////4eAAAAAAAj///////////+IAAAAAAAI////////////gAAAAAAACIiIiIiIiIiIiIAAAAAA4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAP4AAAH+AAAD/gAAB/4AAA/+AAAf8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAACHd3d3d3cAAI//////9wAAj8z5//n3AACP//+ZmfcAAI/MzPn59wAAj////5n3AACPzMzM+fcAAI//////9wAAjwAPzMz3AACPmY////cAAI/Pj8zM9wAAj8+P//AAAACPiI//9/gAAI/////3gAAAiIiIiIgAAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIAHAACADwAAgB8AAA==\"\n  iconEmoji = Observable params.iconEmoji or null\n\n  iconStyle = Observable ->\n    if iconEmoji()\n      \"\"\"\n        width: 18px;\n      \"\"\"\n    else\n      \"\"\"\n        background-image: url(#{iconURL()});\n        width: 18px;\n      \"\"\"\n\n  topIndex += 1\n  zIndex = Observable params.zIndex ? topIndex\n\n  element = WindowTemplate\n    iconStyle: iconStyle\n    iconEmoji: iconEmoji\n    title: title\n    menuBar: params.menuBar\n    content: params.content\n    class: ->\n      [\n        \"minimized\" if minimized()\n        \"maximized\" if maximized()\n      ]\n    close: ->\n      self.close()\n    minimize: ->\n      self.minimize()\n    maximize: ->\n      self.maximize()\n    restore: ->\n      self.restore()\n\n  styleBind(y, element, \"top\", \"px\")\n  styleBind(x, element, \"left\", \"px\")\n  styleBind(height, element, \"height\", \"px\")\n  styleBind(width, element, \"width\", \"px\")\n  styleBind(zIndex, element, \"zIndex\")\n\n  restore = ->\n    if prevX()?\n      x prevX()\n\n    if prevY()?\n      y prevY()\n\n    width prevWidth()\n    height prevHeight()\n\n    minimized false\n    maximized false\n\n    self.trigger \"resize\"\n\n  Object.assign self,\n    element: element\n    iconEmoji: iconEmoji\n    iconURL: iconURL\n    title: title\n    x: x\n    y: y\n    width: width\n    height: height\n    zIndex: zIndex\n    close: ->\n      # TODO: Allow prompt to cancel\n      # Maybe we count on people to override this method if they want\n      element.remove()\n\n    maximized: maximized\n    maximize: ->\n      maximized.toggle()\n\n      if maximized()\n        prevWidth width()\n        prevHeight height()\n        prevX x()\n        prevY y()\n\n        width null\n        height null\n        x 0\n        y 0\n\n        self.trigger \"resize\"\n        self.trigger \"maximize\"\n      else\n        restore()\n\n    minimized: minimized\n    minimize: ->\n      minimized.toggle()\n\n      if minimized()\n        prevWidth width()\n        prevHeight height()\n\n        width null\n        height null\n\n        self.trigger \"resize\"\n        self.trigger \"minimize\"\n      else\n        restore()\n\n    restore: ->\n      restore()\n\n    raiseToTop: ->\n      raiseToTop self\n\n  element.view = self\n\n  return self\n\nstyleBind = (observable, element, attr, suffix=\"\") ->\n  update = (newValue) ->\n\n    if newValue? and (newValue = parseInt newValue)?\n      element.style[attr] = \"#{newValue}#{suffix}\"\n    else\n      element.style[attr] = null\n\n  observable.observe update\n\n  update(observable())\n",
          "mode": "100644",
          "type": "blob"
        }
      },
      "distribution": {
        "action": {
          "path": "action",
          "content": "\n/*\nAction\n======\n\nActions have a function to call, a hotkey, and a function that determines\nwhether or not they are disabled. This is so we can present them in the UI for\nmenus.\n\nThe hotkey is for display purposes only and needs to be listened to by a\nseparate mechanism to perform. [TODO] The action can be executed like a regular\nfunction (instead of needing to use call).\n\nActions may have icons and help text as well.\n */\n\n(function() {\n  var Observable,\n    __slice = [].slice;\n\n  Observable = require(\"observable\");\n\n  module.exports = function(fn, hotkey) {\n    var disabled;\n    disabled = Observable(false);\n    setInterval(function() {\n      return disabled.toggle();\n    }, 1000);\n    return {\n      disabled: disabled,\n      hotkey: function() {\n        return hotkey;\n      },\n      call: function() {\n        var args;\n        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        return fn.call.apply(fn, args);\n      }\n    };\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "demo": {
          "path": "demo",
          "content": "(function() {\n  var ContextMenu, FormSampleTemplate, MenuBar, Modal, Observable, Progress, Style, Table, Window, addWindow, contextMenu, desktop, element, notepadMenuParsed, notepadMenuText, o, parseMenu, sampleMenuParsed, style, _ref, _ref1;\n\n  _ref = require(\"./export\"), ContextMenu = _ref.ContextMenu, MenuBar = _ref.MenuBar, Modal = _ref.Modal, Observable = _ref.Observable, (_ref1 = _ref.Util, parseMenu = _ref1.parseMenu), Progress = _ref.Progress, Style = _ref.Style, Table = _ref.Table, Window = _ref.Window;\n\n  o = require(\"./util\").o;\n\n  notepadMenuText = require(\"./samples/notepad-menu\");\n\n  notepadMenuParsed = parseMenu(notepadMenuText);\n\n  FormSampleTemplate = require(\"./samples/test-form\");\n\n  style = document.createElement(\"style\");\n\n  style.innerHTML = Style.all;\n\n  document.head.appendChild(style);\n\n  sampleMenuParsed = parseMenu(\"[M]odal\\n  [A]lert\\n  [C]onfirm\\n  [P]rompt\\n  [F]orm\\n  P[r]ogress\\n[T]est Nesting\\n  Test[1]\\n    Hello\\n    Wat\\n  Test[2]\\n    [N]ested\\n    -----\\n    [R]ad\\n      So Rad\\n      =====\\n      Hella\\n        Hecka\\n          Super Hecka\\n            Wicked\\n        ---\\n        -\\n        -\\n        ==\\n[W]indow\\n  New [I]mage -> newImage\\n  New [P]ixel -> newPixel\\n  New [T]ext -> newText\\n  New [S]preadsheet -> newSheet\");\n\n  element = MenuBar({\n    items: sampleMenuParsed,\n    handlers: {\n      alert: function() {\n        return Modal.alert(\"yolo\");\n      },\n      prompt: function() {\n        return Modal.prompt(\"Pretty cool, eh?\", \"Yeah!\").then(console.log);\n      },\n      confirm: function() {\n        return Modal.confirm(\"Jawsome!\").then(console.log);\n      },\n      form: function() {\n        return Modal.form(FormSampleTemplate()).then(console.log);\n      },\n      progress: function() {\n        var initialMessage, intervalId, progressView;\n        initialMessage = \"Reticulating splines\";\n        progressView = Progress({\n          value: 0,\n          max: 2,\n          message: initialMessage\n        });\n        Modal.show(progressView.element, {\n          cancellable: false\n        });\n        return intervalId = setInterval(function() {\n          var ellipses, ellipsesCount, newValue, _i, _results;\n          newValue = progressView.value() + 1 / 60;\n          ellipsesCount = Math.floor(newValue * 4) % 4;\n          ellipses = (function() {\n            _results = [];\n            for (var _i = 0; 0 <= ellipsesCount ? _i < ellipsesCount : _i > ellipsesCount; 0 <= ellipsesCount ? _i++ : _i--){ _results.push(_i); }\n            return _results;\n          }).apply(this).map(function() {\n            return \".\";\n          }).join(\"\");\n          progressView.value(newValue);\n          progressView.message(initialMessage + ellipses);\n          if (newValue > 2) {\n            clearInterval(intervalId);\n            return Modal.hide();\n          }\n        }, 15);\n      },\n      newImage: function() {\n        var img;\n        img = document.createElement(\"img\");\n        img.src = \"https://s3.amazonaws.com/whimsyspace-databucket-1g3p6d9lcl6x1/danielx/data/pI1mvEvxcXJk4mNHNUW-kZsNJsrPDXcAtgguyYETRXQ\";\n        return addWindow({\n          title: \"Yoo\",\n          content: img,\n          iconEmoji: \"💼\"\n        });\n      },\n      newPixel: function() {\n        var frame;\n        frame = document.createElement(\"iframe\");\n        frame.src = \"https://danielx.net/pixel-editor/embedded/\";\n        return addWindow({\n          title: \"Pixel\",\n          content: frame\n        });\n      },\n      newText: function() {\n        var textarea;\n        textarea = document.createElement(\"textarea\");\n        return addWindow({\n          title: \"Notepad.exe\",\n          content: textarea\n        });\n      },\n      newSheet: function() {\n        var InputTemplate, RowElement, data, menuBar, tableView;\n        data = [0, 1, 2, 3, 4].map(function(i) {\n          return {\n            id: i,\n            name: \"yolo\",\n            color: \"#FF0000\"\n          };\n        });\n        InputTemplate = require(\"./templates/input\");\n        RowElement = function(datum) {\n          var tr, types;\n          tr = document.createElement(\"tr\");\n          types = [\"number\", \"text\", \"color\"];\n          Object.keys(datum).forEach(function(key, i) {\n            var td;\n            td = document.createElement(\"td\");\n            td.appendChild(InputTemplate({\n              value: o(datum, key),\n              type: types[i]\n            }));\n            return tr.appendChild(td);\n          });\n          return tr;\n        };\n        element = (tableView = Table({\n          data: data,\n          RowElement: RowElement\n        })).element;\n        menuBar = MenuBar({\n          items: parseMenu(\"Insert\\n  Row -> insertRow\\nHelp\\n  About\"),\n          handlers: {\n            about: function() {\n              return Modal.alert(\"Spreadsheet v0.0.1 by Daniel X Moore\");\n            },\n            insertRow: function() {\n              data.push({\n                id: 50,\n                name: \"new\",\n                color: \"#FF00FF\"\n              });\n              return tableView.render();\n            }\n          }\n        });\n        return addWindow({\n          title: \"Spreadsheet [DEMO VERSION]\",\n          content: element,\n          menuBar: menuBar.element\n        });\n      }\n    }\n  }).element;\n\n  document.body.appendChild(element);\n\n  desktop = document.createElement(\"desktop\");\n\n  document.body.appendChild(desktop);\n\n  contextMenu = ContextMenu({\n    items: sampleMenuParsed[1][1],\n    handlers: {}\n  });\n\n  desktop.addEventListener(\"contextmenu\", function(e) {\n    if (e.target === desktop) {\n      e.preventDefault();\n      return contextMenu.display({\n        inElement: document.body,\n        x: e.pageX,\n        y: e.pageY\n      });\n    }\n  });\n\n  addWindow = function(params) {\n    var windowView;\n    windowView = Window(params);\n    desktop.appendChild(windowView.element);\n    return windowView;\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "export": {
          "path": "export",
          "content": "(function() {\n  var Action, ContextMenuView, MenuBarView, MenuItemView, MenuView, Modal, Observable, ProgressView, Style, TableView, WindowView;\n\n  Action = require(\"./action\");\n\n  ContextMenuView = require(\"./views/context-menu\");\n\n  Modal = require(\"./modal\");\n\n  MenuView = require(\"./views/menu\");\n\n  MenuBarView = require(\"./views/menu-bar\");\n\n  MenuItemView = require(\"./views/menu-item\");\n\n  Observable = require(\"observable\");\n\n  ProgressView = require(\"./views/progress\");\n\n  Style = require(\"./style\");\n\n  TableView = require(\"./views/table\");\n\n  WindowView = require(\"./views/window\");\n\n  module.exports = {\n    Action: Action,\n    Bindable: require(\"bindable\"),\n    ContextMenu: ContextMenuView,\n    Modal: Modal,\n    Menu: MenuView,\n    MenuBar: MenuBarView,\n    MenuItem: MenuItemView,\n    Observable: Observable,\n    Progress: ProgressView,\n    Style: Style,\n    Table: TableView,\n    Util: {\n      parseMenu: require(\"./lib/indent-parse\")\n    },\n    Window: WindowView\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "hotkeys": {
          "path": "hotkeys",
          "content": "\n/*\nHotkeys\n=======\n\nBind hotkeys\n\n    Hotkey = require \"hotkey\"\n\n    Hotkey \"ctrl+r\", ->\n      alert \"radical!\"\n\nWe'd like to be able to generate a list of hotkeys with descriptions.\n\nQuestions\n---------\n\nShould we just use Mousetrap?\n\nMaybe, but it may have different semantics with preventDefault/defaultPrevented.\n\nShould we allow binding to specific elements?\n\nImagine a windowing OS where non-iframe apps are inside draggable windows. We'd\nlike to have each 'app' able to have its own hotkeys and at the same time have\nglobal OS level hotkeys.\n\nShould `defaultPrevented` prevent executing the hotkey action? Yes\n\nShould executing a hotkey preventDefault? Yes\n */\n\n(function() {\n  module.exports = function(element) {\n    var handle, handlers;\n    handlers = {};\n    return handle = function(event) {\n      var combo, key, modifiersActive;\n      key = event.key;\n      modifiersActive = [\"alt\", \"ctrl\", \"meta\", \"shift\"].filter(function(modifier) {\n        return event[\"\" + modifier + \"Key\"];\n      });\n      combo = modifiersActive.concat(key).join(\"+\");\n      return typeof handlers[combo] === \"function\" ? handlers[combo](e) : void 0;\n    };\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "lib/assert": {
          "path": "lib/assert",
          "content": "(function() {\n  module.exports = function(condition, message) {\n    if (!condition) {\n      throw new Error(message);\n    }\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "lib/indent-parse": {
          "path": "lib/indent-parse",
          "content": "(function() {\n  var parse, top;\n\n  top = function(stack) {\n    return stack[stack.length - 1];\n  };\n\n  parse = function(source) {\n    var depth, indentation, stack;\n    stack = [[]];\n    indentation = /^(  )*/;\n    depth = 0;\n    source.split(\"\\n\").forEach(function(line, lineNumber) {\n      var current, items, match, newDepth, prev, text;\n      match = line.match(indentation)[0];\n      text = line.replace(match, \"\");\n      newDepth = match.length / 2;\n      if (!text.trim().length) {\n        return;\n      }\n      current = text;\n      if (newDepth > depth) {\n        if (newDepth !== depth + 1) {\n          throw new Error(\"Unexpected indentation on line \" + lineNumber);\n        }\n        items = [];\n        prev = top(stack);\n        prev.push([prev.pop(), items]);\n        stack.push(items);\n      } else if (newDepth < depth) {\n        stack = stack.slice(0, newDepth + 1);\n      }\n      depth = newDepth;\n      return top(stack).push(current);\n    });\n    return stack[0];\n  };\n\n  module.exports = parse;\n\n}).call(this);\n",
          "type": "blob"
        },
        "main": {
          "path": "main",
          "content": "(function() {\n  if (PACKAGE.name === \"ROOT\") {\n    require(\"./demo\");\n  } else {\n    module.exports = require(\"./export\");\n  }\n\n}).call(this);\n",
          "type": "blob"
        },
        "modal": {
          "path": "modal",
          "content": "\n/*\nModal\n\nDisplay modal alerts or dialogs.\n\nModal has promise returning equivalents of the native browser:\n\n- Alert\n- Confirm\n- Prompt\n\nThese accept the same arguments and return a promise fulfilled with\nthe same return value as the native methods.\n\nYou can display any element in the modal:\n\n    modal.show myElement\n */\n\n(function() {\n  var Modal, ModalTemplate, PromptTemplate, cancellable, closeHandler, empty, formDataToObject, handle, modal, prompt, _ref;\n\n  _ref = require(\"./util\"), formDataToObject = _ref.formDataToObject, handle = _ref.handle, empty = _ref.empty;\n\n  PromptTemplate = require(\"./templates/modal/prompt\");\n\n  ModalTemplate = require(\"./templates/modal\");\n\n  modal = ModalTemplate();\n\n  cancellable = true;\n\n  modal.onclick = function(e) {\n    if (e.target === modal && cancellable) {\n      return Modal.hide();\n    }\n  };\n\n  document.addEventListener(\"keydown\", function(e) {\n    if (!e.defaultPrevented) {\n      if (e.key === \"Escape\" && cancellable) {\n        e.preventDefault();\n        return Modal.hide();\n      }\n    }\n  });\n\n  document.body.appendChild(modal);\n\n  closeHandler = null;\n\n  prompt = function(params) {\n    return new Promise(function(resolve) {\n      var element, _ref1;\n      element = PromptTemplate(params);\n      Modal.show(element, {\n        cancellable: false,\n        closeHandler: resolve\n      });\n      return (_ref1 = element.querySelector(params.focus)) != null ? _ref1.focus() : void 0;\n    });\n  };\n\n  module.exports = Modal = {\n    show: function(element, options) {\n      if (typeof options === \"function\") {\n        closeHandler = options;\n      } else {\n        closeHandler = options != null ? options.closeHandler : void 0;\n        if ((options != null ? options.cancellable : void 0) != null) {\n          cancellable = options.cancellable;\n        }\n      }\n      empty(modal).appendChild(element);\n      return modal.classList.add(\"active\");\n    },\n    hide: function(dataForHandler) {\n      if (typeof closeHandler === \"function\") {\n        closeHandler(dataForHandler);\n      }\n      modal.classList.remove(\"active\");\n      cancellable = true;\n      return empty(modal);\n    },\n    alert: function(message) {\n      return prompt({\n        title: \"Alert\",\n        message: message,\n        focus: \"button\",\n        confirm: handle(function() {\n          return Modal.hide();\n        })\n      });\n    },\n    prompt: function(message, defaultValue) {\n      if (defaultValue == null) {\n        defaultValue = \"\";\n      }\n      return prompt({\n        title: \"Prompt\",\n        message: message,\n        focus: \"input\",\n        defaultValue: defaultValue,\n        cancel: handle(function() {\n          return Modal.hide(null);\n        }),\n        confirm: handle(function() {\n          return Modal.hide(modal.querySelector(\"input\").value);\n        })\n      });\n    },\n    confirm: function(message) {\n      return prompt({\n        title: \"Confirm\",\n        message: message,\n        focus: \"button\",\n        cancel: handle(function() {\n          return Modal.hide(false);\n        }),\n        confirm: handle(function() {\n          return Modal.hide(true);\n        })\n      });\n    },\n    form: function(formElement) {\n      return new Promise(function(resolve) {\n        var submitHandler;\n        submitHandler = handle(function(e) {\n          var formData, result;\n          formData = new FormData(formElement);\n          result = formDataToObject(formData);\n          return Modal.hide(result);\n        });\n        formElement.addEventListener(\"submit\", submitHandler);\n        return Modal.show(formElement, function(result) {\n          formElement.removeEventListener(\"submit\", submitHandler);\n          return resolve(result);\n        });\n      });\n    }\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "pixie": {
          "path": "pixie",
          "content": "module.exports = {\"version\":\"0.1.9\",\"entryPoint\":\"main\",\"remoteDependencies\":[],\"dependencies\":{\"observable\":\"distri/observable:master\",\"bindable\":\"distri/bindable:master\"}};",
          "type": "blob"
        },
        "samples/notepad-menu": {
          "path": "samples/notepad-menu",
          "content": "(function() {\n  module.exports = \"[F]ile\\n  [N]ew\\n  [O]pen\\n  [S]ave\\n  Save [A]s\\n  -\\n  Page Set[u]p\\n  [P]rint\\n  -\\n  E[x]it\\n[E]dit\\n  [U]ndo\\n  Redo\\n  -\\n  Cu[t]\\n  [C]opy\\n  [P]aste\\n  De[l]ete\\n  -\\n  [F]ind\\n  Find [N]ext\\n  [R]eplace\\n  [G]o To\\n  -\\n  Select [A]ll\\n  Time/[D]ate\\nF[o]rmat\\n  [W]ord Wrap\\n  [F]ont...\\n[V]iew\\n  [S]tatus Bar\\n[H]elp\\n  View [H]elp\\n  -\\n  [A]bout Notepad\";\n\n}).call(this);\n",
          "type": "blob"
        },
        "samples/test-form": {
          "path": "samples/test-form",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"form\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"h1\", this, {}, function(__root) {\n        __root.buffer(\"Cool Form Bro\\n\");\n      }));\n      __root.buffer(__root.element(\"p\", this, {}, function(__root) {\n        __root.buffer(__root.element(\"a\", this, {\n          \"href\": \"https://yolo.biz\"\n        }, function(__root) {\n          __root.buffer(\"Yolo\\n\");\n        }));\n      }));\n      __root.buffer(__root.element(\"input\", this, {\n        \"name\": \"yolo\"\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"input\", this, {\n        \"name\": \"x\",\n        \"value\": \"Lorem\"\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"input\", this, {\n        \"name\": \"y\",\n        \"value\": \"florem\"\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"input\", this, {\n        \"name\": \"z\",\n        \"type\": \"number\",\n        \"value\": 5\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"input\", this, {\n        \"name\": \"file\",\n        \"type\": \"file\"\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"textarea\", this, {\n        \"name\": \"text\"\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"button\", this, {}, function(__root) {\n        __root.buffer(\"Submit\\n\");\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "style": {
          "path": "style",
          "content": "(function() {\n  var all, styles;\n\n  styles = {};\n\n  all = \"main\\nloader\\nmenu\\nmodal\\ntable\\nwindow\".split(\"\\n\").map(function(stylePath) {\n    var content;\n    content = require(\"./style/\" + stylePath);\n    styles[stylePath] = content;\n    return content;\n  }).join(\"\\n\");\n\n  styles.all = all;\n\n  module.exports = styles;\n\n}).call(this);\n",
          "type": "blob"
        },
        "style/loader": {
          "path": "style/loader",
          "content": "module.exports = \"loader {\\n  display: block;\\n  padding: 1em;\\n}\\nloader > p:empty {\\n  margin: 0;\\n}\\nloader > progress {\\n  display: block;\\n}\\n\";",
          "type": "blob"
        },
        "style/main": {
          "path": "style/main",
          "content": "module.exports = \"* {\\n  box-sizing: border-box;\\n}\\nbody {\\n  display: flex;\\n  flex-direction: column;\\n  font-family: Sans-Serif;\\n  font-size: 14px;\\n  line-height: 18px;\\n  margin: 0;\\n}\\nbody,\\nhtml {\\n  height: 100%;\\n}\\ninput,\\ntextarea,\\nkeygen,\\nselect,\\nbutton {\\n  font-size: inherit;\\n  font-family: inherit;\\n}\\n\";",
          "type": "blob"
        },
        "style/menu": {
          "path": "style/menu",
          "content": "module.exports = \"menu {\\n  user-select: none;\\n  -moz-user-select: none;\\n  -webkit-user-select: none;\\n  -ms-user-select: none;\\n  background-color: #d3d3d3;\\n  border-bottom: 1px solid rgba(0,0,0,0.5);\\n  margin: 0;\\n  z-index: 1;\\n}\\nmenu:focus {\\n  outline: none;\\n}\\nmenu.context {\\n  z-index: 2000;\\n}\\nmenu-item {\\n  display: block;\\n  list-style-type: none;\\n}\\nmenu-item.active {\\n  background-color: #000080;\\n  color: #fff;\\n}\\nmenu-item > label {\\n  display: flex;\\n  padding: 0 0.25em;\\n  white-space: nowrap;\\n}\\nmenu-item > label > * {\\n  flex: 1 1 auto;\\n}\\nmenu-item > label > span.hotkey {\\n  margin-left: 1em;\\n}\\nmenu-item > label > span.hotkey:empty {\\n  margin-left: 0;\\n}\\nmenu-item > label > .decoration {\\n  align-self: center;\\n  flex: 0 1 auto;\\n  line-height: 1em;\\n  text-align: right;\\n  margin-left: 0.5em;\\n  padding-bottom: 0.125em;\\n}\\nmenu-item > label > .decoration:empty {\\n  margin-left: 0;\\n}\\nmenu-item[disabled] {\\n  color: #808080;\\n}\\nmenu-item[disabled].active {\\n  background-color: rgba(0,0,0,0.125);\\n}\\nmenu.options {\\n  border-top: 1px solid rgba(255,255,255,0.5);\\n  border-left: 1px solid rgba(255,255,255,0.5);\\n  border-right: 1px solid rgba(0,0,0,0.5);\\n  box-shadow: 2px 2px 1px rgba(0,0,0,0.5);\\n  display: none;\\n  padding: 2px;\\n  padding-bottom: 3px;\\n  position: absolute;\\n}\\nmenu.options.active {\\n  display: block;\\n}\\nmenu.options > menu-item.menu {\\n  position: relative;\\n}\\nmenu.options > menu-item.menu > menu {\\n  position: absolute;\\n  left: 100%;\\n  top: -3px;\\n  margin-left: 1px;\\n}\\nmenu-item.menu.active > menu {\\n  background-color: #d3d3d3;\\n  color: #000;\\n  display: block;\\n}\\nmenu.bar {\\n  display: block;\\n  flex: 0 0 auto;\\n  margin: 0;\\n  padding: 0;\\n  position: initial;\\n  white-space: nowrap;\\n  overflow: hidden;\\n}\\nmenu.bar > menu-item {\\n  display: inline-block;\\n}\\nmenu.bar > menu-item > label > .decoration {\\n  display: none;\\n}\\nmenu.bar.accelerator-active span.accelerator {\\n  text-decoration: underline;\\n}\\nmenu.options.bottoms-up menu-item.menu > menu {\\n  top: initial;\\n  bottom: -4px;\\n}\\n\";",
          "type": "blob"
        },
        "style/modal": {
          "path": "style/modal",
          "content": "module.exports = \"#modal {\\n  align-items: center;\\n  background-color: rgba(0,0,0,0.25);\\n  display: none;\\n  justify-content: center;\\n  position: absolute;\\n  z-index: 1000;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n}\\n#modal.active {\\n  display: flex;\\n}\\n#modal > * {\\n  background-color: #fff;\\n  border: 1px solid rgba(0,0,0,0.5);\\n  box-shadow: 2px 2px 6px #000;\\n  max-width: 90%;\\n  max-height: 90%;\\n}\\n#modal > form {\\n  display: block;\\n  padding: 1em;\\n}\\n#modal > form > h1 {\\n  font-size: 1.5em;\\n  margin: 0;\\n}\\n#modal > form > input,\\n#modal > form textarea {\\n  display: block;\\n  margin-bottom: 1em;\\n  width: 100%;\\n}\\n#modal > form > button {\\n  margin-right: 1em;\\n}\\n#modal > form > button:last-child {\\n  margin-right: 0;\\n}\\n\";",
          "type": "blob"
        },
        "style/table": {
          "path": "style/table",
          "content": "module.exports = \"container {\\n  display: block;\\n  height: 100%;\\n  overflow: auto;\\n  width: 100%;\\n}\\ntable {\\n  border-collapse: collapse;\\n  width: 100%;\\n}\\nth {\\n  text-align: left;\\n}\\nthead {\\n  border-bottom: 1px solid #000;\\n}\\ntd > input {\\n  border: none;\\n  background-color: transparent;\\n  width: 100%;\\n  height: 100%;\\n  padding: 0;\\n}\\ntr:nth-child(even) {\\n  background-color: #eee;\\n}\\n\";",
          "type": "blob"
        },
        "style/window": {
          "path": "style/window",
          "content": "module.exports = \"desktop {\\n  user-select: none;\\n  -moz-user-select: none;\\n  -webkit-user-select: none;\\n  -ms-user-select: none;\\n  display: block;\\n  flex: 1 0 auto;\\n}\\nwindow {\\n  user-select: none;\\n  -moz-user-select: none;\\n  -webkit-user-select: none;\\n  -ms-user-select: none;\\n  background-color: #d3d3d3;\\n  border: 4px double rgba(0,0,0,0.87);\\n  border-radius: 4px;\\n  display: flex;\\n  flex-direction: column;\\n  position: absolute;\\n}\\nwindow > header {\\n  background-color: #000080;\\n  border-bottom: 1px solid rgba(0,0,0,0.87);\\n  cursor: default;\\n  display: flex;\\n  flex: 0 0 auto;\\n}\\nwindow > header > icon {\\n  background-position: 50%;\\n  background-repeat: no-repeat;\\n  background-size: 16px;\\n  color: #fff;\\n  display: inline-block;\\n  flex: 0 0 auto;\\n  text-align: center;\\n  width: 0;\\n}\\nwindow > header > control {\\n  background-color: #d3d3d3;\\n  color: #fff;\\n  display: inline-block;\\n  flex: 0 0 auto;\\n  font-family: monospace;\\n  width: 18px;\\n  text-shadow: 1px 0px 0px #000, -1px 0px 0px #000, 0px -1px 0px #000, 0px 1px 0px #000, 1px 1px 0px #808080;\\n  text-align: center;\\n  border-left: 1px solid rgba(0,0,0,0.87);\\n}\\nwindow > header > control:first-child {\\n  border-left: none;\\n}\\nwindow > header > control.close::before {\\n  content: \\\"X\\\";\\n}\\nwindow > header > control.maximize::before {\\n  content: \\\"⏫\\\";\\n}\\nwindow > header > control.minimize::before {\\n  content: \\\"-\\\";\\n}\\nwindow > header > control.restore {\\n  display: none;\\n}\\nwindow > header > control.restore::before {\\n  content: \\\"⏬\\\";\\n}\\nwindow > header > title-bar {\\n  color: #fff;\\n  display: inline-block;\\n  flex: 1 1 auto;\\n  overflow: hidden;\\n  padding: 0 1rem 0 6px;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n}\\nwindow > viewport {\\n  background-color: #fff;\\n  display: flex;\\n  height: 100%;\\n  overflow: auto;\\n  position: relative;\\n  z-index: 0;\\n}\\nwindow > viewport > * {\\n  margin: auto;\\n}\\nwindow > viewport > textarea {\\n  border: none;\\n  font-family: monospace;\\n  height: 100%;\\n  padding: 2px 4px;\\n  resize: none;\\n  width: 100%;\\n}\\nwindow > viewport > iframe {\\n  border: none;\\n  height: 100%;\\n  width: 100%;\\n  position: absolute;\\n}\\nwindow > resize {\\n  display: block;\\n  position: absolute;\\n}\\nwindow > resize.e,\\nwindow > resize.w {\\n  cursor: ew-resize;\\n}\\nwindow > resize.n,\\nwindow > resize.s {\\n  cursor: ns-resize;\\n}\\nwindow > resize.h {\\n  height: 4px;\\n  width: 100%;\\n}\\nwindow > resize.v {\\n  height: 100%;\\n  width: 4px;\\n}\\nwindow > resize.w {\\n  left: -4px;\\n}\\nwindow > resize.e {\\n  right: -4px;\\n}\\nwindow > resize.n {\\n  top: -4px;\\n}\\nwindow > resize.s {\\n  bottom: -4px;\\n}\\nwindow > resize.n.w {\\n  cursor: nw-resize;\\n}\\nwindow > resize.n.e {\\n  cursor: ne-resize;\\n}\\nwindow > resize.s.e {\\n  cursor: se-resize;\\n}\\nwindow > resize.s.w {\\n  cursor: sw-resize;\\n}\\nwindow > resize.n.v {\\n  border-bottom: 1px solid #000;\\n  height: 23px;\\n}\\nwindow > resize.s.v {\\n  border-top: 1px solid #000;\\n  height: 23px;\\n}\\nwindow > resize.e.h {\\n  border-left: 1px solid #000;\\n  width: 22px;\\n}\\nwindow > resize.w.h {\\n  border-right: 1px solid #000;\\n  width: 22px;\\n}\\nwindow.minimized > header {\\n  border-bottom: none;\\n}\\nwindow.minimized > header > control {\\n  display: none;\\n}\\nwindow.minimized > header > control.minimize {\\n  border-right: none;\\n  display: inline-block;\\n}\\nwindow.minimized > header > control.minimize::before {\\n  content: \\\"+\\\";\\n}\\nwindow.minimized > menu,\\nwindow.minimized > resize,\\nwindow.minimized > viewport {\\n  display: none;\\n}\\nwindow.maximized {\\n  border: none;\\n  border-radius: 0;\\n  height: 100%;\\n  width: 100%;\\n}\\nwindow.maximized > resize {\\n  display: none;\\n}\\nwindow.maximized > header > control {\\n  display: none;\\n}\\nwindow.maximized > header > control.restore,\\nwindow.maximized > header > control.close {\\n  display: inline-block;\\n}\\nframe-guard {\\n  display: block;\\n  height: 100%;\\n  pointer-events: none;\\n  position: absolute;\\n  width: 100%;\\n  z-index: 100000;\\n}\\nframe-guard.active {\\n  pointer-events: auto;\\n}\\n\";",
          "type": "blob"
        },
        "templates/input": {
          "path": "templates/input",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"input\", this, {\n      \"value\": this.value,\n      \"type\": this.type\n    }, function(__root) {}));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/menu-item": {
          "path": "templates/menu-item",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"menu-item\", this, {\n      \"class\": [this[\"class\"]],\n      \"click\": this.click,\n      \"mousemove\": this.mousemove,\n      \"disabled\": this.disabled\n    }, function(__root) {\n      __root.buffer(__root.element(\"label\", this, {}, function(__root) {\n        __root.buffer(this.title);\n        __root.buffer(__root.element(\"span\", this, {\n          \"class\": [\"hotkey\"]\n        }, function(__root) {\n          __root.buffer(this.hotkey);\n        }));\n        __root.buffer(__root.element(\"span\", this, {\n          \"class\": [\"decoration\"]\n        }, function(__root) {\n          __root.buffer(this.decoration);\n        }));\n      }));\n      __root.buffer(this.content);\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/menu-separator": {
          "path": "templates/menu-separator",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"menu-item\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"hr\", this, {}, function(__root) {}));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/menu": {
          "path": "templates/menu",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"menu\", this, {\n      \"class\": [this[\"class\"]],\n      \"click\": this.click,\n      \"style\": this.style\n    }, function(__root) {\n      __root.buffer(this.items);\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/modal": {
          "path": "templates/modal",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"div\", this, {\n      id: [\"modal\"]\n    }, function(__root) {}));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/modal/prompt": {
          "path": "templates/modal/prompt",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"form\", this, {\n      \"submit\": this.confirm,\n      \"tabindex\": -1\n    }, function(__root) {\n      __root.buffer(__root.element(\"h1\", this, {}, function(__root) {\n        __root.buffer(this.title);\n      }));\n      __root.buffer(__root.element(\"p\", this, {}, function(__root) {\n        __root.buffer(this.message);\n      }));\n      if (this.defaultValue != null) {\n        __root.buffer(__root.element(\"input\", this, {\n          \"type\": \"text\",\n          \"value\": this.defaultValue\n        }, function(__root) {}));\n      }\n      __root.buffer(__root.element(\"button\", this, {}, function(__root) {\n        __root.buffer(\"OK\\n\");\n      }));\n      if (this.cancel) {\n        __root.buffer(__root.element(\"button\", this, {\n          \"click\": this.cancel\n        }, function(__root) {\n          __root.buffer(\"Cancel\\n\");\n        }));\n      }\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/progress": {
          "path": "templates/progress",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"loader\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"p\", this, {}, function(__root) {\n        __root.buffer(this.message);\n      }));\n      __root.buffer(__root.element(\"progress\", this, {\n        \"class\": [this[\"class\"]],\n        \"value\": this.value,\n        \"max\": this.max\n      }, function(__root) {}));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/table": {
          "path": "templates/table",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"container\", this, {}, function(__root) {\n      __root.buffer(__root.element(\"table\", this, {\n        \"keydown\": this.keydown\n      }, function(__root) {\n        __root.buffer(__root.element(\"thead\", this, {}, function(__root) {\n          __root.buffer(__root.element(\"tr\", this, {}, function(__root) {\n            this.headers.forEach(function(header) {\n              return __root.buffer(__root.element(\"th\", this, {}, function(__root) {\n                __root.buffer(header);\n              }));\n            });\n          }));\n        }));\n        __root.buffer(__root.element(\"tbody\", this, {}, function(__root) {}));\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "templates/window": {
          "path": "templates/window",
          "content": "module.exports = function(data) {\n  \"use strict\";\n  return (function() {\n    var __root;\n    __root = require(\"/lib/hamlet-runtime\")(this);\n    __root.buffer(__root.element(\"window\", this, {\n      \"class\": [this[\"class\"]]\n    }, function(__root) {\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"n\", \"h\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"e\", \"v\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"s\", \"h\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"w\", \"v\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"n\", \"e\", \"h\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"n\", \"e\", \"v\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"n\", \"w\", \"h\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"n\", \"w\", \"v\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"s\", \"e\", \"h\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"s\", \"e\", \"v\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"s\", \"w\", \"h\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"resize\", this, {\n        \"class\": [\"s\", \"w\", \"v\"]\n      }, function(__root) {}));\n      __root.buffer(__root.element(\"header\", this, {}, function(__root) {\n        __root.buffer(__root.element(\"icon\", this, {\n          \"style\": this.iconStyle\n        }, function(__root) {\n          __root.buffer(this.iconEmoji);\n        }));\n        __root.buffer(__root.element(\"title-bar\", this, {}, function(__root) {\n          __root.buffer(this.title);\n        }));\n        __root.buffer(__root.element(\"control\", this, {\n          \"class\": [\"minimize\"],\n          \"click\": this.minimize\n        }, function(__root) {}));\n        __root.buffer(__root.element(\"control\", this, {\n          \"class\": [\"maximize\"],\n          \"click\": this.maximize\n        }, function(__root) {}));\n        __root.buffer(__root.element(\"control\", this, {\n          \"class\": [\"restore\"],\n          \"click\": this.restore\n        }, function(__root) {}));\n        __root.buffer(__root.element(\"control\", this, {\n          \"class\": [\"close\"],\n          \"click\": this.close\n        }, function(__root) {}));\n      }));\n      __root.buffer(this.menuBar);\n      __root.buffer(__root.element(\"viewport\", this, {}, function(__root) {\n        __root.buffer(this.content);\n      }));\n    }));\n    return __root.root;\n  }).call(data);\n};\n",
          "type": "blob"
        },
        "test/menu-item": {
          "path": "test/menu-item",
          "content": "(function() {\n  var MenuItemView, Observable;\n\n  MenuItemView = require(\"../views/menu-item\");\n\n  Observable = require(\"observable\");\n\n  describe(\"MenuItem\", function() {\n    return it(\"should have correct custom action names\", function() {\n      var called, menuItem;\n      called = false;\n      menuItem = MenuItemView({\n        label: \"Cool -> Super Cool\",\n        contextRoot: {\n          activeItem: function() {},\n          handlers: {\n            \"Super Cool\": function() {\n              return called = true;\n            }\n          }\n        }\n      });\n      assert(!called);\n      menuItem.click();\n      return assert(called);\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "test/menu-parser": {
          "path": "test/menu-parser",
          "content": "(function() {\n  var parse;\n\n  parse = require(\"../lib/indent-parse\");\n\n  describe(\"Menu Parser\", function() {\n    it(\"should parse menus into lists\", function() {\n      var data, results;\n      data = \"File\";\n      results = parse(data);\n      return assert.deepEqual([\"File\"], results);\n    });\n    it(\"should parse empty\", function() {\n      var data;\n      data = \"\";\n      return assert.deepEqual([], parse(data));\n    });\n    it(\"should deal with nesting ok\", function() {\n      var data, results;\n      data = \"File\\n  Open\\n  Save\\nEdit\\n  Copy\\n  Paste\\nHelp\";\n      results = parse(data);\n      return assert.deepEqual([[\"File\", [\"Open\", \"Save\"]], [\"Edit\", [\"Copy\", \"Paste\"]], \"Help\"], results);\n    });\n    it(\"should parse big ol' menus\", function() {\n      var results;\n      results = parse(\"File\\n  New\\n  Open\\n  Save\\n  Save As\\nEdit\\n  Undo\\n  Redo\\n  -\\n  Cut\\n  Copy\\n  Paste\\n  Delete\\n  -\\n  Find\\n  Find Next\\n  Replace\\n  Go To\\n  -\\n  Select All\\n  Time/Date\\nFormat\\n  Word Wrap\\n  Font...\\nView\\n  Status Bar\\nHelp\\n  View Help\\n  -\\n  About Notepad\");\n      return assert.deepEqual([[\"File\", [\"New\", \"Open\", \"Save\", \"Save As\"]], [\"Edit\", [\"Undo\", \"Redo\", \"-\", \"Cut\", \"Copy\", \"Paste\", \"Delete\", \"-\", \"Find\", \"Find Next\", \"Replace\", \"Go To\", \"-\", \"Select All\", \"Time/Date\"]], [\"Format\", [\"Word Wrap\", \"Font...\"]], [\"View\", [\"Status Bar\"]], [\"Help\", [\"View Help\", \"-\", \"About Notepad\"]]], results);\n    });\n    return it(\"should parse hella nested menus\", function() {\n      var results;\n      results = parse(\"File\\n  Special\\n    Nested\\n      Super\\n        Awesome\");\n      return assert.deepEqual([[\"File\", [[\"Special\", [[\"Nested\", [[\"Super\", [\"Awesome\"]]]]]]]]], results);\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "test/menu": {
          "path": "test/menu",
          "content": "(function() {\n  var MenuView, Observable;\n\n  MenuView = require(\"../views/menu\");\n\n  Observable = require(\"observable\");\n\n  describe(\"Menu\", function() {\n    it(\"should work with plain ol' items\", function() {\n      var menu;\n      menu = MenuView({\n        items: [\"Cool\", \"Rad\"],\n        contextRoot: {\n          activeItem: Observable(null),\n          handlers: {}\n        }\n      });\n      return assert.equal(menu.items().length, 2);\n    });\n    return it(\"should allow observable items\", function() {\n      var items, menu;\n      items = Observable([\"Cool\", [\"Rad\", [\"2rad\", \"2Furious\"]]]);\n      menu = MenuView({\n        items: items,\n        contextRoot: {\n          activeItem: Observable(null),\n          handlers: {}\n        }\n      });\n      assert.equal(menu.items().length, 2);\n      items([\"New Stuff\"]);\n      return assert.equal(menu.items().length, 1);\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "test/modal": {
          "path": "test/modal",
          "content": "(function() {\n  var Modal;\n\n  PACKAGE.name = \"test\";\n\n  Modal = require(\"../main\").Modal;\n\n  describe(\"Modal\", function() {\n    return it(\"shoud be totally chill\", function() {\n      var called, element, handler;\n      element = document.createElement(\"p\");\n      called = false;\n      handler = function(value) {\n        called = true;\n        return assert.equal(value, \"yolo\");\n      };\n      Modal.show(element, handler);\n      Modal.hide('yolo');\n      return assert(called);\n    });\n  });\n\n}).call(this);\n",
          "type": "blob"
        },
        "util": {
          "path": "util",
          "content": "(function() {\n  var A, F, Observable, S, accelerateItem, advance, asElement, elementView, empty, entityMap, formDataToObject, get, handle, isDescendant, o;\n\n  Observable = require(\"observable\");\n\n  A = function(attr) {\n    return function(x) {\n      return x[attr];\n    };\n  };\n\n  F = function(methodName) {\n    return function(x) {\n      return x[methodName]();\n    };\n  };\n\n  get = function(x, context) {\n    if (typeof x === 'function') {\n      return x.call(context);\n    } else {\n      return x;\n    }\n  };\n\n  o = function(object, name) {\n    var attribute;\n    attribute = Observable(object[name]);\n    attribute.observe(function(newValue) {\n      return object[name] = newValue;\n    });\n    return attribute;\n  };\n\n  handle = function(fn) {\n    return function(e) {\n      if (e != null ? e.defaultPrevented : void 0) {\n        return;\n      }\n      if (e != null) {\n        e.preventDefault();\n      }\n      return fn.call(this, e);\n    };\n  };\n\n  S = function(object, method, defaultValue) {\n    return function() {\n      if (typeof (object != null ? object[method] : void 0) === 'function') {\n        return object[method]();\n      } else {\n        return defaultValue;\n      }\n    };\n  };\n\n  asElement = A('element');\n\n  accelerateItem = function(items, key) {\n    var acceleratedItem;\n    acceleratedItem = items.filter(function(item) {\n      return item.accelerator === key;\n    })[0];\n    if (acceleratedItem) {\n      return acceleratedItem.click();\n    }\n  };\n\n  isDescendant = function(element, ancestor) {\n    var parent;\n    if (!element) {\n      return;\n    }\n    while ((parent = element.parentElement)) {\n      if (element === ancestor) {\n        return true;\n      }\n      element = parent;\n    }\n  };\n\n  advance = function(list, amount) {\n    var activeItemIndex, currentItem;\n    currentItem = list.filter(function(item) {\n      return item.active();\n    })[0];\n    activeItemIndex = list.indexOf(currentItem) + amount;\n    if (activeItemIndex < 0) {\n      activeItemIndex = list.length - 1;\n    } else if (activeItemIndex >= list.length) {\n      activeItemIndex = 0;\n    }\n    return list[activeItemIndex];\n  };\n\n  formDataToObject = function(formData) {\n    return Array.from(formData.entries()).reduce(function(object, _arg) {\n      var key, value;\n      key = _arg[0], value = _arg[1];\n      object[key] = value;\n      return object;\n    }, {});\n  };\n\n  elementView = function(element) {\n    if (!element) {\n      return;\n    }\n    if (element.view) {\n      return element.view;\n    }\n    return elementView(element.parentElement);\n  };\n\n  empty = function(node) {\n    while (node.hasChildNodes()) {\n      node.removeChild(node.lastChild);\n    }\n    return node;\n  };\n\n  module.exports = {\n    htmlEscape: function(string) {\n      return String(string).replace(/[&<>\"'\\/]/g, function(s) {\n        return entityMap[s];\n      });\n    },\n    A: A,\n    F: F,\n    S: S,\n    o: o,\n    advance: advance,\n    asElement: asElement,\n    accelerateItem: accelerateItem,\n    elementView: elementView,\n    empty: empty,\n    formDataToObject: formDataToObject,\n    get: get,\n    handle: handle,\n    isDescendant: isDescendant\n  };\n\n  entityMap = {\n    \"&\": \"&amp;\",\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    \"/\": '&#x2F;'\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/context-menu": {
          "path": "views/context-menu",
          "content": "\n/*\nContextMenu\n\nDisplay a context menu!\n\nQuestions:\n\nShould we be able to update the options in the menu after creation?\n */\n\n(function() {\n  var MenuView, Observable, isDescendant;\n\n  Observable = require(\"observable\");\n\n  MenuView = require(\"./menu\");\n\n  isDescendant = require(\"../util\").isDescendant;\n\n  module.exports = function(_arg) {\n    var activeItem, classes, contextRoot, element, handlers, items, left, self, top;\n    items = _arg.items, classes = _arg.classes, handlers = _arg.handlers;\n    activeItem = Observable(null);\n    if (classes == null) {\n      classes = [];\n    }\n    top = Observable(\"\");\n    left = Observable(\"\");\n    contextRoot = {\n      activeItem: activeItem,\n      handlers: handlers\n    };\n    self = MenuView({\n      items: items,\n      contextRoot: contextRoot,\n      classes: function() {\n        return [\"context\", \"options\"].concat(classes);\n      },\n      style: function() {\n        return \"top: \" + (top()) + \"px; left: \" + (left()) + \"px\";\n      }\n    });\n    element = self.element;\n    element.view = self;\n    self.contextRoot = contextRoot;\n    self.display = function(_arg1) {\n      var inElement, x, y;\n      inElement = _arg1.inElement, x = _arg1.x, y = _arg1.y;\n      top(y);\n      left(x);\n      (inElement || document.body).appendChild(element);\n      activeItem(self);\n      return element.focus();\n    };\n    document.addEventListener(\"mousedown\", function(e) {\n      if (!isDescendant(e.target, element)) {\n        return activeItem(null);\n      }\n    });\n    element.setAttribute(\"tabindex\", \"-1\");\n    element.addEventListener(\"keydown\", function(e) {\n      var currentItem, direction, key;\n      key = e.key;\n      switch (key) {\n        case \"ArrowLeft\":\n        case \"ArrowUp\":\n        case \"ArrowRight\":\n        case \"ArrowDown\":\n          e.preventDefault();\n          direction = key.replace(\"Arrow\", \"\");\n          currentItem = activeItem();\n          if (currentItem) {\n            return currentItem.cursor(direction);\n          }\n          break;\n        case \"Escape\":\n          return activeItem(null);\n      }\n    });\n    return self;\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/menu-bar": {
          "path": "views/menu-bar",
          "content": "(function() {\n  var MenuView, Observable, advance, isDescendant, _ref;\n\n  Observable = require(\"observable\");\n\n  MenuView = require(\"./menu\");\n\n  _ref = require(\"../util\"), isDescendant = _ref.isDescendant, advance = _ref.advance;\n\n  module.exports = function(_arg) {\n    var accelerateIfActive, acceleratorActive, activeItem, contextRoot, deactivate, element, handlers, items, previouslyFocusedElement, self;\n    items = _arg.items, handlers = _arg.handlers;\n    acceleratorActive = Observable(false);\n    activeItem = Observable(null);\n    previouslyFocusedElement = null;\n    contextRoot = {\n      activeItem: activeItem,\n      handlers: handlers\n    };\n    self = MenuView({\n      classes: function() {\n        return [\"bar\", acceleratorActive() ? \"accelerator-active\" : void 0];\n      },\n      items: items,\n      contextRoot: contextRoot\n    });\n    element = self.element;\n    self.cursor = function(direction) {\n      switch (direction) {\n        case \"Right\":\n          return self.advance(1);\n        case \"Left\":\n          return self.advance(-1);\n      }\n    };\n    self.items.forEach(function(item) {\n      item.horizontal = true;\n      return item.cursor = function(direction) {\n        var _ref1, _ref2;\n        console.log(\"Item\", direction);\n        if (direction === \"Down\") {\n          return (_ref1 = item.submenu) != null ? _ref1.advance(1) : void 0;\n        } else if (direction === \"Up\") {\n          return (_ref2 = item.submenu) != null ? _ref2.advance(-1) : void 0;\n        } else {\n          return item.parent.cursor(direction);\n        }\n      };\n    });\n    deactivate = function() {\n      activeItem(null);\n      acceleratorActive(false);\n      return previouslyFocusedElement != null ? previouslyFocusedElement.focus() : void 0;\n    };\n    document.addEventListener(\"mousedown\", function(e) {\n      if (!isDescendant(e.target, element)) {\n        acceleratorActive(false);\n        return activeItem(null);\n      }\n    });\n    document.addEventListener(\"keydown\", function(e) {\n      var key, menuIsActive, _ref1;\n      key = e.key;\n      switch (key) {\n        case \"Enter\":\n          return (_ref1 = activeItem()) != null ? _ref1.click() : void 0;\n        case \"Alt\":\n          menuIsActive = false;\n          if (acceleratorActive() || menuIsActive) {\n            return deactivate();\n          } else {\n            previouslyFocusedElement = document.activeElement;\n            element.focus();\n            if (!activeItem()) {\n              activeItem(self);\n            }\n            return acceleratorActive(true);\n          }\n      }\n    });\n    accelerateIfActive = function(key) {\n      var _ref1;\n      if (acceleratorActive()) {\n        return (_ref1 = activeItem()) != null ? _ref1.accelerate(key) : void 0;\n      }\n    };\n    element.setAttribute(\"tabindex\", \"-1\");\n    element.addEventListener(\"keydown\", function(e) {\n      var accelerated, currentItem, direction, key;\n      key = e.key;\n      switch (key) {\n        case \"ArrowLeft\":\n        case \"ArrowUp\":\n        case \"ArrowRight\":\n        case \"ArrowDown\":\n          e.preventDefault();\n          direction = key.replace(\"Arrow\", \"\");\n          currentItem = activeItem();\n          if (currentItem) {\n            return currentItem.cursor(direction);\n          }\n          break;\n        case \"Escape\":\n          return deactivate();\n        default:\n          accelerated = accelerateIfActive(key.toLowerCase());\n          if (accelerated != null) {\n            return e.preventDefault();\n          }\n      }\n    });\n    return self;\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/menu-item": {
          "path": "views/menu-item",
          "content": "(function() {\n  var F, MenuItemTemplate, S, accelerateItem, advance, asElement, formatAction, formatLabel, handle, htmlEscape, isDescendant, _ref;\n\n  _ref = require(\"../util\"), advance = _ref.advance, htmlEscape = _ref.htmlEscape, asElement = _ref.asElement, F = _ref.F, S = _ref.S, isDescendant = _ref.isDescendant, accelerateItem = _ref.accelerateItem, handle = _ref.handle;\n\n  MenuItemTemplate = require(\"../templates/menu-item\");\n\n  module.exports = function(_arg) {\n    var MenuView, accelerator, action, actionName, active, activeItem, click, content, contextRoot, disabled, element, handlers, hotkey, items, label, labelText, parent, self, submenu, title, _ref1, _ref2;\n    label = _arg.label, MenuView = _arg.MenuView, items = _arg.items, contextRoot = _arg.contextRoot, parent = _arg.parent;\n    self = {};\n    activeItem = contextRoot.activeItem, handlers = contextRoot.handlers;\n    active = function() {\n      var _ref1;\n      return isDescendant((_ref1 = activeItem()) != null ? _ref1.element : void 0, element);\n    };\n    self.active = active;\n    if (items) {\n      submenu = MenuView({\n        items: items,\n        contextRoot: contextRoot,\n        parent: self\n      });\n      content = submenu.element;\n    }\n    _ref1 = formatAction(label), labelText = _ref1[0], actionName = _ref1[1];\n    _ref2 = formatLabel(labelText), title = _ref2[0], accelerator = _ref2[1];\n    action = handlers[actionName];\n    disabled = S(action, \"disabled\", false);\n    hotkey = S(action, \"hotkey\", \"\");\n    click = function(e) {\n      if (disabled()) {\n        return;\n      }\n      if (e != null ? e.defaultPrevented : void 0) {\n        return;\n      }\n      if (e != null) {\n        e.preventDefault();\n      }\n      if (submenu) {\n        activeItem(submenu);\n        return;\n      }\n      console.log(\"Handling\", actionName);\n      if (action != null) {\n        if (typeof action.call === \"function\") {\n          action.call(handlers);\n        }\n      }\n      return activeItem(null);\n    };\n    element = MenuItemTemplate({\n      \"class\": function() {\n        return [items ? \"menu\" : void 0, active() ? \"active\" : void 0];\n      },\n      click: click,\n      mousemove: function(e) {\n        if (!activeItem()) {\n          return;\n        }\n        if (!e.defaultPrevented && isDescendant(e.target, element)) {\n          e.preventDefault();\n          return activeItem(self);\n        }\n      },\n      title: title,\n      content: content,\n      decoration: items ? \"▸\" : void 0,\n      hotkey: hotkey,\n      disabled: disabled\n    });\n    Object.assign(self, {\n      accelerator: accelerator,\n      accelerate: function(key) {\n        if (submenu) {\n          return submenu.accelerate(key);\n        } else {\n          return parent.accelerate(key);\n        }\n      },\n      click: click,\n      parent: parent,\n      element: element,\n      submenu: submenu,\n      cursor: function(direction) {\n        console.log(\"Item Cursor\", direction);\n        if (submenu && direction === \"Right\") {\n          return activeItem(submenu.navigableItems[0]);\n        } else if (parent.parent && direction === \"Left\") {\n          if (parent.parent.horizontal) {\n            return parent.parent.cursor(direction);\n          } else {\n            return activeItem(parent.parent);\n          }\n        } else {\n          return parent.cursor(direction);\n        }\n      }\n    });\n    return self;\n  };\n\n  formatAction = function(labelText) {\n    var action, title, _ref1;\n    _ref1 = labelText.split(\"->\").map(F(\"trim\")), title = _ref1[0], action = _ref1[1];\n    if (!action) {\n      action = title.replace(/[^A-Za-z0-9]/g, \"\");\n      action = action.charAt(0).toLowerCase() + action.substring(1);\n    }\n    return [title, action];\n  };\n\n  formatLabel = function(labelText) {\n    var accelerator, span, titleHTML;\n    accelerator = void 0;\n    titleHTML = htmlEscape(labelText).replace(/\\[([^\\]]+)\\]/, function(match, $1) {\n      accelerator = $1.toLowerCase();\n      return \"<span class=\\\"accelerator\\\">\" + $1 + \"</span>\";\n    });\n    span = document.createElement(\"span\");\n    span.innerHTML = titleHTML;\n    return [span, accelerator];\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/menu-separator": {
          "path": "views/menu-separator",
          "content": "(function() {\n  var MenuSeparatorTemplate;\n\n  MenuSeparatorTemplate = require(\"../templates/menu-separator\");\n\n  module.exports = function() {\n    return {\n      element: MenuSeparatorTemplate(),\n      separator: true\n    };\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/menu": {
          "path": "views/menu",
          "content": "(function() {\n  var F, MenuItemTemplate, MenuItemView, MenuTemplate, MenuView, Observable, S, SeparatorView, accelerateItem, advance, asElement, assert, get, handle, htmlEscape, isDescendant, _ref;\n\n  Observable = require(\"observable\");\n\n  assert = require(\"../lib/assert\");\n\n  _ref = require(\"../util\"), advance = _ref.advance, accelerateItem = _ref.accelerateItem, asElement = _ref.asElement, get = _ref.get, F = _ref.F, S = _ref.S, htmlEscape = _ref.htmlEscape, handle = _ref.handle, isDescendant = _ref.isDescendant;\n\n  MenuTemplate = require(\"../templates/menu\");\n\n  MenuItemTemplate = require(\"../templates/menu-item\");\n\n  SeparatorView = require(\"./menu-separator\");\n\n  MenuItemView = require(\"./menu-item\");\n\n  module.exports = MenuView = function(_arg) {\n    var active, activeItem, classes, contextRoot, getItems, items, navigableItems, parent, self, style;\n    items = _arg.items, classes = _arg.classes, style = _arg.style, contextRoot = _arg.contextRoot, parent = _arg.parent;\n    self = {};\n    if (classes == null) {\n      classes = function() {\n        return [\"options\"];\n      };\n    }\n    activeItem = contextRoot.activeItem;\n    getItems = Observable(function() {\n      return items.map(function(item) {\n        var label, submenuItems;\n        switch (false) {\n          case !(typeof item === \"string\" && item.match(/^[=-]+$/)):\n            return SeparatorView();\n          case !Array.isArray(item):\n            assert(item.length === 2);\n            label = item[0], submenuItems = item[1];\n            return MenuItemView({\n              label: label,\n              items: submenuItems,\n              MenuView: MenuView,\n              contextRoot: contextRoot,\n              parent: self\n            });\n          default:\n            return MenuItemView({\n              label: item,\n              contextRoot: contextRoot,\n              parent: self\n            });\n        }\n      });\n    });\n    navigableItems = Observable(function() {\n      return getItems().filter(function(item) {\n        return !item.separator;\n      });\n    });\n    active = function() {\n      var _ref1;\n      return isDescendant((_ref1 = activeItem()) != null ? _ref1.element : void 0, self.element);\n    };\n    Object.assign(self, {\n      accelerate: function(key) {\n        return accelerateItem(getItems(), key);\n      },\n      cursor: function(direction) {\n        var _ref1;\n        switch (direction) {\n          case \"Up\":\n            return self.advance(-1);\n          case \"Down\":\n            return self.advance(1);\n          default:\n            return (_ref1 = parent.parent) != null ? _ref1.cursor(direction) : void 0;\n        }\n      },\n      parent: parent,\n      items: getItems,\n      advance: function(n) {\n        return activeItem(advance(navigableItems(), n));\n      },\n      navigableItems: navigableItems,\n      element: MenuTemplate({\n        style: style,\n        \"class\": function() {\n          return [active() ? \"active\" : void 0].concat(classes());\n        },\n        click: handle(function(e) {\n          return activeItem(self);\n        }),\n        items: function() {\n          return getItems().map(asElement);\n        }\n      })\n    });\n    return self;\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/progress": {
          "path": "views/progress",
          "content": "(function() {\n  var Observable, Template;\n\n  Template = require(\"../templates/progress\");\n\n  Observable = require(\"observable\");\n\n  module.exports = function(params) {\n    var element, max, message, value;\n    if (params == null) {\n      params = {};\n    }\n    value = params.value, max = params.max, message = params.message;\n    value = Observable(value || 0);\n    max = Observable(max);\n    message = Observable(message);\n    element = Template({\n      value: value,\n      max: max,\n      message: message\n    });\n    return {\n      element: element,\n      value: value,\n      message: message,\n      max: max\n    };\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/table": {
          "path": "views/table",
          "content": "(function() {\n  var TableTemplate, TableView, advanceRow, empty;\n\n  empty = require(\"../util\").empty;\n\n  TableTemplate = require(\"../templates/table\");\n\n  advanceRow = function(path, prev) {\n    var cellIndex, input, nextRowElement, td, tr;\n    td = path.filter(function(element) {\n      return element.tagName === \"TD\";\n    })[0];\n    if (!td) {\n      return;\n    }\n    tr = td.parentElement;\n    cellIndex = Array.prototype.indexOf.call(tr.children, td);\n    if (prev) {\n      nextRowElement = tr.previousSibling;\n    } else {\n      nextRowElement = tr.nextSibling;\n    }\n    if (nextRowElement) {\n      input = nextRowElement.children[cellIndex].querySelector('input');\n      return input != null ? input.focus() : void 0;\n    }\n  };\n\n  TableView = function(_arg) {\n    var RowElement, containerElement, data, filterAndSort, filterFn, headers, rowElements, tableBody, update;\n    data = _arg.data, headers = _arg.headers, RowElement = _arg.RowElement;\n    if (headers == null) {\n      headers = Object.keys(data[0]);\n    }\n    containerElement = TableTemplate({\n      headers: headers,\n      keydown: function(event) {\n        var key, path;\n        key = event.key, path = event.path;\n        switch (key) {\n          case \"Enter\":\n          case \"ArrowDown\":\n            event.preventDefault();\n            return advanceRow(path);\n          case \"ArrowUp\":\n            event.preventDefault();\n            return advanceRow(path, true);\n        }\n      }\n    });\n    tableBody = containerElement.querySelector('tbody');\n    filterFn = function(datum) {\n      return true;\n    };\n    filterAndSort = function(data, filterFn, sortFn) {\n      var filteredData;\n      if (filterFn == null) {\n        filterFn = function() {\n          return true;\n        };\n      }\n      filteredData = data.filter(filterFn);\n      if (sortFn) {\n        return filteredData.sort(sortFn);\n      } else {\n        return filteredData;\n      }\n    };\n    rowElements = function() {\n      return filterAndSort(data, filterFn, null).map(RowElement);\n    };\n    update = function() {\n      empty(tableBody);\n      return rowElements().forEach(function(element) {\n        return tableBody.appendChild(element);\n      });\n    };\n    update();\n    return {\n      element: containerElement,\n      render: update\n    };\n  };\n\n  module.exports = TableView;\n\n}).call(this);\n",
          "type": "blob"
        },
        "views/window": {
          "path": "views/window",
          "content": "(function() {\n  var Bindable, Observable, WindowTemplate, activeDrag, activeResize, dragStart, elementView, frameGuard, raiseToTop, resizeInitial, resizeStart, styleBind, topIndex;\n\n  WindowTemplate = require(\"../templates/window\");\n\n  elementView = require(\"../util\").elementView;\n\n  frameGuard = document.createElement(\"frame-guard\");\n\n  document.body.appendChild(frameGuard);\n\n  topIndex = 0;\n\n  raiseToTop = function(view) {\n    var zIndex;\n    if (typeof view.zIndex !== 'function') {\n      return;\n    }\n    zIndex = view.zIndex();\n    if (zIndex === topIndex) {\n      return;\n    }\n    topIndex += 1;\n    return view.zIndex(topIndex);\n  };\n\n  activeDrag = null;\n\n  dragStart = null;\n\n  document.addEventListener(\"mousedown\", function(e) {\n    var target, view;\n    target = e.target;\n    view = elementView(target);\n    if (view) {\n      raiseToTop(view);\n    }\n    if (target.tagName === \"TITLE-BAR\") {\n      frameGuard.classList.add(\"active\");\n      dragStart = e;\n      return activeDrag = view;\n    }\n  });\n\n  document.addEventListener(\"mousemove\", function(e) {\n    var dx, dy, maximizedX, maximizedY, prevX, prevY, x, y;\n    if (activeDrag) {\n      prevX = dragStart.clientX, prevY = dragStart.clientY;\n      x = e.clientX, y = e.clientY;\n      if (activeDrag.maximized()) {\n        maximizedX = activeDrag.x();\n        maximizedY = activeDrag.y();\n        activeDrag.restore();\n        activeDrag.x(x - activeDrag.width() / 2);\n        activeDrag.y(maximizedY);\n      }\n      dx = x - prevX;\n      dy = y - prevY;\n      activeDrag.x(activeDrag.x() + dx);\n      activeDrag.y(activeDrag.y() + dy);\n      return dragStart = e;\n    }\n  });\n\n  activeResize = null;\n\n  resizeStart = null;\n\n  resizeInitial = null;\n\n  document.addEventListener(\"mousedown\", function(e) {\n    var height, target, width, x, y, _ref;\n    target = e.target;\n    if (target.tagName === \"RESIZE\") {\n      frameGuard.classList.add(\"active\");\n      resizeStart = e;\n      activeResize = target;\n      _ref = elementView(activeResize), width = _ref.width, height = _ref.height, x = _ref.x, y = _ref.y;\n      return resizeInitial = {\n        width: width(),\n        height: height(),\n        x: x(),\n        y: y()\n      };\n    }\n  });\n\n  document.addEventListener(\"mousemove\", function(e) {\n    var actualDeltaX, actualDeltaY, dx, dy, height, startX, startY, view, width, x, y;\n    if (activeResize) {\n      startX = resizeStart.clientX, startY = resizeStart.clientY;\n      x = e.clientX, y = e.clientY;\n      dx = x - startX;\n      dy = y - startY;\n      width = resizeInitial.width;\n      height = resizeInitial.height;\n      if (activeResize.classList.contains(\"e\")) {\n        width += dx;\n      }\n      if (activeResize.classList.contains(\"w\")) {\n        width -= dx;\n      }\n      if (activeResize.classList.contains(\"s\")) {\n        height += dy;\n      }\n      if (activeResize.classList.contains(\"n\")) {\n        height -= dy;\n      }\n      width = Math.max(width, 200);\n      height = Math.max(height, 50);\n      actualDeltaX = width - resizeInitial.width;\n      actualDeltaY = height - resizeInitial.height;\n      view = elementView(activeResize);\n      if (activeResize.classList.contains(\"n\")) {\n        view.y(resizeInitial.y - actualDeltaY);\n      }\n      if (activeResize.classList.contains(\"w\")) {\n        view.x(resizeInitial.x - actualDeltaX);\n      }\n      view.width(width);\n      view.height(height);\n      return view.trigger(\"resize\");\n    }\n  });\n\n  document.addEventListener(\"mouseup\", function() {\n    activeDrag = null;\n    activeResize = null;\n    return frameGuard.classList.remove(\"active\");\n  });\n\n  Bindable = require(\"bindable\");\n\n  Observable = require(\"observable\");\n\n  module.exports = function(params) {\n    var element, height, iconEmoji, iconStyle, iconURL, maximized, minimized, prevHeight, prevWidth, prevX, prevY, restore, self, title, width, x, y, zIndex, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;\n    self = Bindable();\n    x = Observable((_ref = params.x) != null ? _ref : 50);\n    y = Observable((_ref1 = params.y) != null ? _ref1 : 50);\n    width = Observable((_ref2 = params.width) != null ? _ref2 : 400);\n    height = Observable((_ref3 = params.height) != null ? _ref3 : 300);\n    title = Observable((_ref4 = params.title) != null ? _ref4 : \"Untitled\");\n    minimized = Observable(false);\n    maximized = Observable(false);\n    prevWidth = Observable(null);\n    prevHeight = Observable(null);\n    prevX = Observable(null);\n    prevY = Observable(null);\n    iconURL = Observable(params.iconURL || \"data:image/x-icon;base64,AAABAAIAICAQAAEABADoAgAAJgAAABAQEAABAAQAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAACHd3d3d3d3d3d3d3dwAAAAj///////////////cAAAAI///////////////3AAAACP///////3d///d39wAAAAj/zMzM//mZ//+Zn/cAAAAI////////l///+X/3AAAACP/MzMzM//l3d3l/9wAAAAj/////////mZmZf/cAAAAI/8zMzMzM//l/+X/3AAAACP//////////l/l/9wAAAAj/zMzMzMzM//l5f/cAAAAI////////////mX/3AAAACP/MzMzMzMzM//n/9wAAAAj///////////////cAAAAI/8zMzMzMzMzMzP/3AAAACP//////////////9wAAAAj/zMzMzMzMzMzM//cAAAAI///////////////3AAAACP8AAAAA/8zMzMz/9wAAAAj/iZD/8P////////cAAAAI/4AAAAD/zMzMzP/3AAAACP+P8Luw////////9wAAAAj/gAC7sP/MzMzM//cAAAAI/4/wu7D////////3AAAACP+P8Luw/////4AAAAAAAAj/j/AAAP////+P94AAAAAI/4/wzMD/////j3gAAAAACP+IiIiA/////4eAAAAAAAj///////////+IAAAAAAAI////////////gAAAAAAACIiIiIiIiIiIiIAAAAAA4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAP4AAAH+AAAD/gAAB/4AAA/+AAAf8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvwAAvwAAAL+/AL8AAAC/AL8Av78AAMDAwACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAACHd3d3d3cAAI//////9wAAj8z5//n3AACP//+ZmfcAAI/MzPn59wAAj////5n3AACPzMzM+fcAAI//////9wAAjwAPzMz3AACPmY////cAAI/Pj8zM9wAAj8+P//AAAACPiI//9/gAAI/////3gAAAiIiIiIgAAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIADAACAAwAAgAMAAIAHAACADwAAgB8AAA==\");\n    iconEmoji = Observable(params.iconEmoji || null);\n    iconStyle = Observable(function() {\n      if (iconEmoji()) {\n        return \"width: 18px;\";\n      } else {\n        return \"background-image: url(\" + (iconURL()) + \");\\nwidth: 18px;\";\n      }\n    });\n    topIndex += 1;\n    zIndex = Observable((_ref5 = params.zIndex) != null ? _ref5 : topIndex);\n    element = WindowTemplate({\n      iconStyle: iconStyle,\n      iconEmoji: iconEmoji,\n      title: title,\n      menuBar: params.menuBar,\n      content: params.content,\n      \"class\": function() {\n        return [minimized() ? \"minimized\" : void 0, maximized() ? \"maximized\" : void 0];\n      },\n      close: function() {\n        return self.close();\n      },\n      minimize: function() {\n        return self.minimize();\n      },\n      maximize: function() {\n        return self.maximize();\n      },\n      restore: function() {\n        return self.restore();\n      }\n    });\n    styleBind(y, element, \"top\", \"px\");\n    styleBind(x, element, \"left\", \"px\");\n    styleBind(height, element, \"height\", \"px\");\n    styleBind(width, element, \"width\", \"px\");\n    styleBind(zIndex, element, \"zIndex\");\n    restore = function() {\n      if (prevX() != null) {\n        x(prevX());\n      }\n      if (prevY() != null) {\n        y(prevY());\n      }\n      width(prevWidth());\n      height(prevHeight());\n      minimized(false);\n      maximized(false);\n      return self.trigger(\"resize\");\n    };\n    Object.assign(self, {\n      element: element,\n      iconEmoji: iconEmoji,\n      iconURL: iconURL,\n      title: title,\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      zIndex: zIndex,\n      close: function() {\n        return element.remove();\n      },\n      maximized: maximized,\n      maximize: function() {\n        maximized.toggle();\n        if (maximized()) {\n          prevWidth(width());\n          prevHeight(height());\n          prevX(x());\n          prevY(y());\n          width(null);\n          height(null);\n          x(0);\n          y(0);\n          self.trigger(\"resize\");\n          return self.trigger(\"maximize\");\n        } else {\n          return restore();\n        }\n      },\n      minimized: minimized,\n      minimize: function() {\n        minimized.toggle();\n        if (minimized()) {\n          prevWidth(width());\n          prevHeight(height());\n          width(null);\n          height(null);\n          self.trigger(\"resize\");\n          return self.trigger(\"minimize\");\n        } else {\n          return restore();\n        }\n      },\n      restore: function() {\n        return restore();\n      },\n      raiseToTop: function() {\n        return raiseToTop(self);\n      }\n    });\n    element.view = self;\n    return self;\n  };\n\n  styleBind = function(observable, element, attr, suffix) {\n    var update;\n    if (suffix == null) {\n      suffix = \"\";\n    }\n    update = function(newValue) {\n      if ((newValue != null) && ((newValue = parseInt(newValue)) != null)) {\n        return element.style[attr] = \"\" + newValue + suffix;\n      } else {\n        return element.style[attr] = null;\n      }\n    };\n    observable.observe(update);\n    return update(observable());\n  };\n\n}).call(this);\n",
          "type": "blob"
        },
        "lib/hamlet-runtime": {
          "path": "lib/hamlet-runtime",
          "content": "(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.HamletRuntime = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  \"use strict\";\n  var Observable, Runtime, bindEvent, bindObservable, bufferTo, classes, createElement, empty, eventNames, get, id, isEvent, isFragment, makeElement, observeAttribute, observeAttributes, observeContent, specialBindings, valueBind, valueIndexOf;\n\n  Observable = require(\"o_0\");\n\n  eventNames = \"abort\\nblur\\nchange\\nclick\\ncontextmenu\\ndblclick\\ndrag\\ndragend\\ndragenter\\ndragexit\\ndragleave\\ndragover\\ndragstart\\ndrop\\nerror\\nfocus\\ninput\\nkeydown\\nkeypress\\nkeyup\\nload\\nmousedown\\nmousemove\\nmouseout\\nmouseover\\nmouseup\\nreset\\nresize\\nscroll\\nselect\\nsubmit\\ntouchcancel\\ntouchend\\ntouchenter\\ntouchleave\\ntouchmove\\ntouchstart\\nunload\".split(\"\\n\");\n\n  isEvent = function(name) {\n    return eventNames.indexOf(name) !== -1;\n  };\n\n  isFragment = function(node) {\n    return (node != null ? node.nodeType : void 0) === 11;\n  };\n\n  valueBind = function(element, value, context) {\n    Observable(function() {\n      var update;\n      value = Observable(value, context);\n      switch (element.nodeName) {\n        case \"SELECT\":\n          element.oninput = element.onchange = function() {\n            var optionValue, _ref, _value;\n            _ref = this.children[this.selectedIndex], optionValue = _ref.value, _value = _ref._value;\n            return value(_value || optionValue);\n          };\n          update = function(newValue) {\n            var options;\n            element._value = newValue;\n            if ((options = element._options)) {\n              if (newValue.value != null) {\n                return element.value = (typeof newValue.value === \"function\" ? newValue.value() : void 0) || newValue.value;\n              } else {\n                return element.selectedIndex = valueIndexOf(options, newValue);\n              }\n            } else {\n              return element.value = newValue;\n            }\n          };\n          return bindObservable(element, value, context, update);\n        default:\n          element.oninput = element.onchange = function() {\n            return value(element.value);\n          };\n          if (typeof element.attachEvent === \"function\") {\n            element.attachEvent(\"onkeydown\", function() {\n              return setTimeout(function() {\n                return value(element.value);\n              }, 0);\n            });\n          }\n          return bindObservable(element, value, context, function(newValue) {\n            if (element.value !== newValue) {\n              return element.value = newValue;\n            }\n          });\n      }\n    });\n  };\n\n  specialBindings = {\n    INPUT: {\n      checked: function(element, value, context) {\n        element.onchange = function() {\n          return typeof value === \"function\" ? value(element.checked) : void 0;\n        };\n        return bindObservable(element, value, context, function(newValue) {\n          return element.checked = newValue;\n        });\n      }\n    },\n    SELECT: {\n      options: function(element, values, context) {\n        var updateValues;\n        values = Observable(values, context);\n        updateValues = function(values) {\n          empty(element);\n          element._options = values;\n          return values.map(function(value, index) {\n            var option, optionName, optionValue;\n            option = createElement(\"option\");\n            option._value = value;\n            if (typeof value === \"object\") {\n              optionValue = (value != null ? value.value : void 0) || index;\n            } else {\n              optionValue = value.toString();\n            }\n            bindObservable(option, optionValue, value, function(newValue) {\n              return option.value = newValue;\n            });\n            optionName = (value != null ? value.name : void 0) || value;\n            bindObservable(option, optionName, value, function(newValue) {\n              return option.textContent = option.innerText = newValue;\n            });\n            element.appendChild(option);\n            if (value === element._value) {\n              element.selectedIndex = index;\n            }\n            return option;\n          });\n        };\n        return bindObservable(element, values, context, updateValues);\n      }\n    }\n  };\n\n  observeAttribute = function(element, context, name, value) {\n    var binding, nodeName, _ref;\n    nodeName = element.nodeName;\n    if (name === \"value\") {\n      valueBind(element, value);\n    } else if (binding = (_ref = specialBindings[nodeName]) != null ? _ref[name] : void 0) {\n      binding(element, value, context);\n    } else if (name.match(/^on/) && isEvent(name.substr(2))) {\n      bindEvent(element, name, value, context);\n    } else if (isEvent(name)) {\n      bindEvent(element, \"on\" + name, value, context);\n    } else {\n      bindObservable(element, value, context, function(newValue) {\n        if ((newValue != null) && newValue !== false) {\n          return element.setAttribute(name, newValue);\n        } else {\n          return element.removeAttribute(name);\n        }\n      });\n    }\n    return element;\n  };\n\n  observeAttributes = function(element, context, attributes) {\n    return Object.keys(attributes).forEach(function(name) {\n      var value;\n      value = attributes[name];\n      return observeAttribute(element, context, name, value);\n    });\n  };\n\n  bindObservable = function(element, value, context, update) {\n    var observable, observe, unobserve;\n    observable = Observable(value, context);\n    observe = function() {\n      observable.observe(update);\n      return update(observable());\n    };\n    unobserve = function() {\n      return observable.stopObserving(update);\n    };\n    observe();\n    return element;\n  };\n\n  bindEvent = function(element, name, fn, context) {\n    return element[name] = function() {\n      return fn.apply(context, arguments);\n    };\n  };\n\n  id = function(element, context, sources) {\n    var lastId, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(newId) {\n      return element.id = newId;\n    };\n    lastId = function() {\n      return value.last();\n    };\n    return bindObservable(element, lastId, context, update);\n  };\n\n  classes = function(element, context, sources) {\n    var classNames, update, value;\n    value = Observable.concat.apply(Observable, sources.map(function(source) {\n      return Observable(source, context);\n    }));\n    update = function(classNames) {\n      return element.className = classNames;\n    };\n    classNames = function() {\n      return value.join(\" \");\n    };\n    return bindObservable(element, classNames, context, update);\n  };\n\n  createElement = function(name) {\n    return document.createElement(name);\n  };\n\n  observeContent = function(element, context, contentFn) {\n    var append, contents, update;\n    contents = [];\n    contentFn.call(context, {\n      buffer: bufferTo(context, contents),\n      element: makeElement\n    });\n    append = function(item) {\n      if (item == null) {\n\n      } else if (typeof item === \"string\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"number\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item === \"boolean\") {\n        return element.appendChild(document.createTextNode(item));\n      } else if (typeof item.each === \"function\") {\n        return item.each(append);\n      } else if (typeof item.forEach === \"function\") {\n        return item.forEach(append);\n      } else {\n        return element.appendChild(item);\n      }\n    };\n    update = function(contents) {\n      empty(element);\n      return contents.forEach(append);\n    };\n    return update(contents);\n  };\n\n  bufferTo = function(context, collection) {\n    return function(content) {\n      if (typeof content === 'function') {\n        content = Observable(content, context);\n      }\n      collection.push(content);\n      return content;\n    };\n  };\n\n  makeElement = function(name, context, attributes, fn) {\n    var element;\n    if (attributes == null) {\n      attributes = {};\n    }\n    element = createElement(name);\n    Observable(function() {\n      if (attributes.id != null) {\n        id(element, context, attributes.id);\n        return delete attributes.id;\n      }\n    });\n    Observable(function() {\n      if (attributes[\"class\"] != null) {\n        classes(element, context, attributes[\"class\"]);\n        return delete attributes[\"class\"];\n      }\n    });\n    Observable(function() {\n      return observeAttributes(element, context, attributes);\n    }, context);\n    if (element.nodeName !== \"SELECT\") {\n      Observable(function() {\n        return observeContent(element, context, fn);\n      }, context);\n    }\n    return element;\n  };\n\n  Runtime = function(context) {\n    var self;\n    self = {\n      buffer: function(content) {\n        if (self.root) {\n          throw \"Cannot have multiple root elements\";\n        }\n        return self.root = content;\n      },\n      element: makeElement,\n      filter: function(name, content) {}\n    };\n    return self;\n  };\n\n  Runtime.VERSION = require(\"../package.json\").version;\n\n  Runtime.Observable = Observable;\n\n  module.exports = Runtime;\n\n  empty = function(node) {\n    var child, _results;\n    _results = [];\n    while (child = node.firstChild) {\n      _results.push(node.removeChild(child));\n    }\n    return _results;\n  };\n\n  valueIndexOf = function(options, value) {\n    if (typeof value === \"object\") {\n      return options.indexOf(value);\n    } else {\n      return options.map(function(option) {\n        return option.toString();\n      }).indexOf(value.toString());\n    }\n  };\n\n  get = function(x) {\n    if (typeof x === 'function') {\n      return x();\n    } else {\n      return x;\n    }\n  };\n\n}).call(this);\n\n},{\"../package.json\":3,\"o_0\":2}],2:[function(require,module,exports){\n(function (global){\n// Generated by CoffeeScript 1.8.0\n(function() {\n  var Observable, PROXY_LENGTH, computeDependencies, copy, extend, flatten, get, last, magicDependency, remove, splat, tryCallWithFinallyPop,\n    __slice = [].slice;\n\n  module.exports = Observable = function(value, context) {\n    var changed, fn, listeners, notify, notifyReturning, self;\n    if (typeof (value != null ? value.observe : void 0) === \"function\") {\n      return value;\n    }\n    listeners = [];\n    notify = function(newValue) {\n      return copy(listeners).forEach(function(listener) {\n        return listener(newValue);\n      });\n    };\n    if (typeof value === 'function') {\n      fn = value;\n      self = function() {\n        magicDependency(self);\n        return value;\n      };\n      changed = function() {\n        value = computeDependencies(self, fn, changed, context);\n        return notify(value);\n      };\n      changed();\n    } else {\n      self = function(newValue) {\n        if (arguments.length > 0) {\n          if (value !== newValue) {\n            value = newValue;\n            notify(newValue);\n          }\n        } else {\n          magicDependency(self);\n        }\n        return value;\n      };\n    }\n    self.each = function(callback) {\n      magicDependency(self);\n      if (value != null) {\n        [value].forEach(function(item) {\n          return callback.call(item, item);\n        });\n      }\n      return self;\n    };\n    if (Array.isArray(value)) {\n      [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"reduce\", \"reduceRight\", \"slice\", \"some\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          magicDependency(self);\n          return value[method].apply(value, args);\n        };\n      });\n      [\"pop\", \"push\", \"reverse\", \"shift\", \"splice\", \"sort\", \"unshift\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          return notifyReturning(value[method].apply(value, args));\n        };\n      });\n      if (PROXY_LENGTH) {\n        Object.defineProperty(self, 'length', {\n          get: function() {\n            magicDependency(self);\n            return value.length;\n          },\n          set: function(length) {\n            value.length = length;\n            return notifyReturning(value.length);\n          }\n        });\n      }\n      notifyReturning = function(returnValue) {\n        notify(value);\n        return returnValue;\n      };\n      extend(self, {\n        each: function(callback) {\n          self.forEach(function(item, index) {\n            return callback.call(item, item, index, self);\n          });\n          return self;\n        },\n        remove: function(object) {\n          var index;\n          index = value.indexOf(object);\n          if (index >= 0) {\n            return notifyReturning(value.splice(index, 1)[0]);\n          }\n        },\n        get: function(index) {\n          magicDependency(self);\n          return value[index];\n        },\n        first: function() {\n          magicDependency(self);\n          return value[0];\n        },\n        last: function() {\n          magicDependency(self);\n          return value[value.length - 1];\n        },\n        size: function() {\n          magicDependency(self);\n          return value.length;\n        }\n      });\n    }\n    extend(self, {\n      listeners: listeners,\n      observe: function(listener) {\n        return listeners.push(listener);\n      },\n      stopObserving: function(fn) {\n        return remove(listeners, fn);\n      },\n      toggle: function() {\n        return self(!value);\n      },\n      increment: function(n) {\n        return self(value + n);\n      },\n      decrement: function(n) {\n        return self(value - n);\n      },\n      toString: function() {\n        return \"Observable(\" + value + \")\";\n      }\n    });\n    return self;\n  };\n\n  Observable.concat = function() {\n    var arg, args, collection, i, o, _i, _len;\n    args = new Array(arguments.length);\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      arg = arguments[i];\n      args[i] = arguments[i];\n    }\n    collection = Observable(args);\n    o = Observable(function() {\n      return flatten(collection.map(splat));\n    });\n    o.push = collection.push;\n    return o;\n  };\n\n  extend = function(target) {\n    var i, name, source, _i, _len;\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      source = arguments[i];\n      if (i > 0) {\n        for (name in source) {\n          target[name] = source[name];\n        }\n      }\n    }\n    return target;\n  };\n\n  global.OBSERVABLE_ROOT_HACK = [];\n\n  magicDependency = function(self) {\n    var observerSet;\n    observerSet = last(global.OBSERVABLE_ROOT_HACK);\n    if (observerSet) {\n      return observerSet.add(self);\n    }\n  };\n\n  tryCallWithFinallyPop = function(fn, context) {\n    try {\n      return fn.call(context);\n    } finally {\n      global.OBSERVABLE_ROOT_HACK.pop();\n    }\n  };\n\n  computeDependencies = function(self, fn, update, context) {\n    var deps, value, _ref;\n    deps = new Set;\n    global.OBSERVABLE_ROOT_HACK.push(deps);\n    value = tryCallWithFinallyPop(fn, context);\n    if ((_ref = self._deps) != null) {\n      _ref.forEach(function(observable) {\n        return observable.stopObserving(update);\n      });\n    }\n    self._deps = deps;\n    deps.forEach(function(observable) {\n      return observable.observe(update);\n    });\n    return value;\n  };\n\n  try {\n    Object.defineProperty((function() {}), 'length', {\n      get: function() {},\n      set: function() {}\n    });\n    PROXY_LENGTH = true;\n  } catch (_error) {\n    PROXY_LENGTH = false;\n  }\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n  copy = function(array) {\n    return array.concat([]);\n  };\n\n  get = function(arg) {\n    if (typeof arg === \"function\") {\n      return arg();\n    } else {\n      return arg;\n    }\n  };\n\n  splat = function(item) {\n    var result, results;\n    results = [];\n    if (item == null) {\n      return results;\n    }\n    if (typeof item.forEach === \"function\") {\n      item.forEach(function(i) {\n        return results.push(i);\n      });\n    } else {\n      result = get(item);\n      if (result != null) {\n        results.push(result);\n      }\n    }\n    return results;\n  };\n\n  last = function(array) {\n    return array[array.length - 1];\n  };\n\n  flatten = function(array) {\n    return array.reduce(function(a, b) {\n      return a.concat(b);\n    }, []);\n  };\n\n}).call(this);\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],3:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"hamlet.coffee\",\n  \"version\": \"0.7.6\",\n  \"description\": \"Truly amazing templating!\",\n  \"devDependencies\": {\n    \"browserify\": \"^12.0.1\",\n    \"coffee-script\": \"~1.7.1\",\n    \"jsdom\": \"^7.2.0\",\n    \"mocha\": \"^2.3.3\"\n  },\n  \"dependencies\": {\n    \"hamlet-compiler\": \"0.7.0\",\n    \"o_0\": \"0.3.8\"\n  },\n  \"homepage\": \"hamlet.coffee\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/dr-coffee-labs/hamlet.git\"\n  },\n  \"scripts\": {\n    \"prepublish\": \"script/prepublish\",\n    \"test\": \"script/test\"\n  },\n  \"files\": [\n    \"dist/\"\n  ],\n  \"main\": \"dist/runtime.js\"\n}\n\n},{}]},{},[1])(1)\n});",
          "type": "blob"
        }
      },
      "progenitor": {
        "url": "https://danielx.net/editor/"
      },
      "config": {
        "version": "0.1.9",
        "entryPoint": "main",
        "remoteDependencies": [],
        "dependencies": {
          "observable": "distri/observable:master",
          "bindable": "distri/bindable:master"
        }
      },
      "version": "0.1.9",
      "entryPoint": "main",
      "remoteDependencies": [],
      "repository": {
        "branch": "master",
        "default_branch": "master",
        "full_name": "STRd6/ui",
        "homepage": null,
        "description": "Classic User Interface",
        "html_url": "https://github.com/STRd6/ui",
        "url": "https://api.github.com/repos/STRd6/ui",
        "publishBranch": "gh-pages"
      },
      "dependencies": {
        "observable": {
          "source": {
            "LICENSE": {
              "path": "LICENSE",
              "content": "The MIT License (MIT)\n\nCopyright (c) 2014 distri\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
              "mode": "100644",
              "type": "blob"
            },
            "README.md": {
              "path": "README.md",
              "content": "[![Build Status](https://travis-ci.org/distri/observable.svg?branch=npm)](https://travis-ci.org/distri/observable)\n\nObservable\n==========\n\nInstallation\n------------\n\nNode\n\n    npm install o_0\n\nUsage\n-----\n\n    Observable = require \"o_0\"\n\nGet notified when the value changes.\n\n    observable = Observable 5\n\n    observable() # 5\n\n    observable.observe (newValue) ->\n      console.log newValue\n\n    observable 10 # logs 10 to console\n\nArrays\n------\n\nProxy array methods.\n\n    observable = Observable [1, 2, 3]\n\n    observable.forEach (value) ->\n      # 1, 2, 3\n\nFunctions\n---------\n\nAutomagically compute dependencies for observable functions.\n\n    firstName = Observable \"Duder\"\n    lastName = Observable \"Man\"\n\n    o = Observable ->\n      \"#{firstName()} #{lastName()}\"\n\n    o.observe (newValue) ->\n      assert.equal newValue, \"Duder Bro\"\n\n    lastName \"Bro\"\n",
              "mode": "100644",
              "type": "blob"
            },
            "main.coffee.md": {
              "path": "main.coffee.md",
              "content": "Observable\n==========\n\n`Observable` allows for observing arrays, functions, and objects.\n\nFunction dependencies are automagically observed.\n\nStandard array methods are proxied through to the underlying array.\n\n    module.exports = Observable = (value, context) ->\n\nReturn the object if it is already an observable object.\n\n      return value if typeof value?.observe is \"function\"\n\nMaintain a set of listeners to observe changes and provide a helper to notify each observer.\n\n      listeners = []\n\n      notify = (newValue) ->\n        copy(listeners).forEach (listener) ->\n          listener(newValue)\n\nOur observable function is stored as a reference to `self`.\n\nIf `value` is a function compute dependencies and listen to observables that it depends on.\n\n      if typeof value is 'function'\n        fn = value\n\nOur return function is a function that holds only a cached value which is updated\nwhen it's dependencies change.\n\nThe `magicDependency` call is so other functions can depend on this computed function the\nsame way we depend on other types of observables.\n\n        self = ->\n          # Automagic dependency observation\n          magicDependency(self)\n\n          return value\n\n        changed = ->\n          value = computeDependencies(self, fn, changed, context)\n          notify(value)\n\n        changed()\n\n      else\n\nWhen called with zero arguments it is treated as a getter. When called with one argument it is treated as a setter.\n\nChanges to the value will trigger notifications.\n\nThe value is always returned.\n\n        self = (newValue) ->\n          if arguments.length > 0\n            if value != newValue\n              value = newValue\n\n              notify(newValue)\n          else\n            # Automagic dependency observation\n            magicDependency(self)\n\n          return value\n\nThis `each` iterator is similar to [the Maybe monad](http://en.wikipedia.org/wiki/Monad_&#40;functional_programming&#41;#The_Maybe_monad) in that our observable may contain a single value or nothing at all.\n\n      self.each = (callback) ->\n        magicDependency(self)\n\n        if value?\n          [value].forEach (item) ->\n            callback.call(item, item)\n\n        return self\n\nIf the value is an array then proxy array methods and add notifications to mutation events.\n\n      if Array.isArray(value)\n        [\n          \"concat\"\n          \"every\"\n          \"filter\"\n          \"forEach\"\n          \"indexOf\"\n          \"join\"\n          \"lastIndexOf\"\n          \"map\"\n          \"reduce\"\n          \"reduceRight\"\n          \"slice\"\n          \"some\"\n        ].forEach (method) ->\n          self[method] = (args...) ->\n            magicDependency(self)\n            value[method](args...)\n\n        [\n          \"pop\"\n          \"push\"\n          \"reverse\"\n          \"shift\"\n          \"splice\"\n          \"sort\"\n          \"unshift\"\n        ].forEach (method) ->\n          self[method] = (args...) ->\n            notifyReturning value[method](args...)\n\n        # Provide length on a best effort basis because older browsers choke\n        if PROXY_LENGTH\n          Object.defineProperty self, 'length',\n            get: ->\n              magicDependency(self)\n              value.length\n            set: (length) ->\n              value.length = length\n              notifyReturning(value.length)\n\n        notifyReturning = (returnValue) ->\n          notify(value)\n\n          return returnValue\n\nAdd some extra helpful methods to array observables.\n\n        extend self,\n          each: (callback) ->\n            self.forEach (item, index) ->\n              callback.call(item, item, index, self)\n\n            return self\n\nRemove an element from the array and notify observers of changes.\n\n          remove: (object) ->\n            index = value.indexOf(object)\n\n            if index >= 0\n              notifyReturning value.splice(index, 1)[0]\n\n          get: (index) ->\n            magicDependency(self)\n            value[index]\n\n          first: ->\n            magicDependency(self)\n            value[0]\n\n          last: ->\n            magicDependency(self)\n            value[value.length-1]\n\n          size: ->\n            magicDependency(self)\n            value.length\n\n      extend self,\n        listeners: listeners\n\n        observe: (listener) ->\n          listeners.push listener\n\n        stopObserving: (fn) ->\n          remove listeners, fn\n\n        toggle: ->\n          self !value\n\n        increment: (n) ->\n          self value + n\n\n        decrement: (n) ->\n          self value - n\n\n        toString: ->\n          \"Observable(#{value})\"\n\n      return self\n\n    Observable.concat = ->\n      # Optimization: Manually copy arguments to an array\n      args = new Array(arguments.length)\n      for arg, i in arguments\n        args[i] = arguments[i]\n\n      collection = Observable(args)\n\n      o = Observable ->\n        flatten collection.map(splat)\n\n      o.push = collection.push\n\n      return o\n\nAppendix\n--------\n\nThe extend method adds one object's properties to another.\n\n    extend = (target) ->\n      # Optimization: iterate through arguments manually rather than pass to slice to create an array\n      for source, i in arguments\n        # The first argument is target, so skip it\n        if i > 0\n          for name of source\n            target[name] = source[name]\n\n      return target\n\nSuper hax for computing dependencies. This needs to be a shared global so that\ndifferent bundled versions of observable libraries can interoperate.\n\n    global.OBSERVABLE_ROOT_HACK = []\n\n    magicDependency = (self) ->\n      observerSet = last(global.OBSERVABLE_ROOT_HACK)\n      if observerSet\n        observerSet.add self\n\nOptimization: Keep the function containing the try-catch as small as possible.\n\n    tryCallWithFinallyPop = (fn, context) ->\n      try\n        fn.call(context)\n      finally\n        global.OBSERVABLE_ROOT_HACK.pop()\n\nAutomagically compute dependencies.\n\n    computeDependencies = (self, fn, update, context) ->\n      deps = new Set\n\n      global.OBSERVABLE_ROOT_HACK.push(deps)\n\n      value = tryCallWithFinallyPop fn, context\n\n      self._deps?.forEach (observable) ->\n        observable.stopObserving update\n\n      self._deps = deps\n\n      deps.forEach (observable) ->\n        observable.observe update\n\n      return value\n\nCheck if we can proxy function length property.\n\n    try\n      Object.defineProperty (->), 'length',\n        get: ->\n        set: ->\n\n      PROXY_LENGTH = true\n    catch\n      PROXY_LENGTH = false\n\nRemove a value from an array.\n\n    remove = (array, value) ->\n      index = array.indexOf(value)\n\n      if index >= 0\n        array.splice(index, 1)[0]\n\n    copy = (array) ->\n      array.concat([])\n\n    get = (arg) ->\n      if typeof arg is \"function\"\n        arg()\n      else\n        arg\n\n    splat = (item) ->\n      results = []\n\n      return results unless item?\n\n      if typeof item.forEach is \"function\"\n        item.forEach (i) ->\n          results.push i\n      else\n        result = get item\n\n        results.push result if result?\n\n      results\n\n    last = (array) ->\n      array[array.length - 1]\n\n    flatten = (array) ->\n      array.reduce (a, b) ->\n        a.concat(b)\n      , []\n",
              "mode": "100644",
              "type": "blob"
            },
            "pixie.cson": {
              "path": "pixie.cson",
              "content": "version: \"0.3.8\"\n",
              "mode": "100644",
              "type": "blob"
            },
            "test/observable.coffee": {
              "path": "test/observable.coffee",
              "content": "global.Observable = require \"../main\"\n\ndescribe 'Observable', ->\n  it 'should create an observable for an object', ->\n    n = 5\n\n    observable = Observable(n)\n\n    assert.equal(observable(), n)\n\n  it 'should fire events when setting', ->\n    string = \"yolo\"\n\n    observable = Observable(string)\n    observable.observe (newValue) ->\n      assert.equal newValue, \"4life\"\n\n    observable(\"4life\")\n\n  it \"should not fire when setting to the same value\", ->\n    o = Observable 5\n\n    o.observe ->\n      assert false\n\n    o(5)\n\n  it 'should be idempotent', ->\n    o = Observable(5)\n\n    assert.equal o, Observable(o)\n\n  describe \"#each\", ->\n    it \"should be invoked once if there is an observable\", ->\n      o = Observable(5)\n      called = 0\n\n      o.each (value) ->\n        called += 1\n        assert.equal value, 5\n\n      assert.equal called, 1\n\n    it \"should not be invoked if observable is null\", ->\n      o = Observable(null)\n      called = 0\n\n      o.each (value) ->\n        called += 1\n\n      assert.equal called, 0\n\n    it \"should have the correct `this` scope for items\", (done) ->\n      o = Observable 5\n\n      o.each ->\n        assert.equal this, 5\n        done()\n\n    it \"should have the correct `this` scope for items in observable arrays\", ->\n      scopes = []\n\n      o = Observable [\"I'm\", \"an\", \"array\"]\n\n      o.each ->\n        scopes.push this\n\n      assert.equal scopes[0], \"I'm\"\n      assert.equal scopes[1], \"an\"\n      assert.equal scopes[2], \"array\"\n\n  it \"should allow for stopping observation\", ->\n    observable = Observable(\"string\")\n\n    called = 0\n    fn = (newValue) ->\n      called += 1\n      assert.equal newValue, \"4life\"\n\n    observable.observe fn\n\n    observable(\"4life\")\n\n    observable.stopObserving fn\n\n    observable(\"wat\")\n\n    assert.equal called, 1\n\n  it \"should increment\", ->\n    observable = Observable 1\n\n    observable.increment(5)\n\n    assert.equal observable(), 6\n\n  it \"should decremnet\", ->\n    observable = Observable 1\n\n    observable.decrement 5\n\n    assert.equal observable(), -4\n\n  it \"should toggle\", ->\n    observable = Observable false\n\n    observable.toggle()\n    assert.equal observable(), true\n\n    observable.toggle()\n    assert.equal observable(), false\n\n  it \"should trigger when toggling\", (done) ->\n    observable = Observable true\n    observable.observe (v) ->\n      assert.equal v, false\n      done()\n\n    observable.toggle()\n\n  it \"should have a nice toString\", ->\n    observable = Observable 5\n\n    assert.equal observable.toString(), \"Observable(5)\"\n\ndescribe \"Observable Array\", ->\n  it \"should proxy array methods\", ->\n    o = Observable [5]\n\n    o.map (n) ->\n      assert.equal n, 5\n\n  it \"should notify on mutation methods\", (done) ->\n    o = Observable []\n\n    o.observe (newValue) ->\n      assert.equal newValue[0], 1\n\n    o.push 1\n\n    done()\n\n  it \"should have an each method\", ->\n    o = Observable []\n\n    assert o.each\n\n  it \"#get\", ->\n    o = Observable [0, 1, 2, 3]\n\n    assert.equal o.get(2), 2\n\n  it \"#first\", ->\n    o = Observable [0, 1, 2, 3]\n\n    assert.equal o.first(), 0\n\n  it \"#last\", ->\n    o = Observable [0, 1, 2, 3]\n\n    assert.equal o.last(), 3\n\n  it \"#remove\", (done) ->\n    o = Observable [0, 1, 2, 3]\n\n    o.observe (newValue) ->\n      assert.equal newValue.length, 3\n      setTimeout ->\n        done()\n      , 0\n\n    assert.equal o.remove(2), 2\n\n  it \"#remove non-existent element\", ->\n    o = Observable [1, 2, 3]\n\n    assert.equal o.remove(0), undefined\n\n  it \"should proxy the length property\", ->\n    o = Observable [1, 2, 3]\n\n    assert.equal o.length, 3\n\n    called = false\n    o.observe (value) ->\n      assert.equal value[0], 1\n      assert.equal value[1], undefined\n      called = true\n\n    o.length = 1\n    assert.equal o.length, 1\n    assert.equal called, true\n\n  it \"should auto detect conditionals of length as a dependency\", ->\n    observableArray = Observable [1, 2, 3]\n\n    o = Observable ->\n      if observableArray.length > 5\n        true\n      else\n        false\n\n    assert.equal o(), false\n\n    called = 0\n    o.observe ->\n      called += 1\n\n    observableArray.push 4, 5, 6\n\n    assert.equal called, 1\n\ndescribe \"Observable functions\", ->\n  it \"should compute dependencies\", (done) ->\n    firstName = Observable \"Duder\"\n    lastName = Observable \"Man\"\n\n    o = Observable ->\n      \"#{firstName()} #{lastName()}\"\n\n    o.observe (newValue) ->\n      assert.equal newValue, \"Duder Bro\"\n\n      done()\n\n    lastName \"Bro\"\n\n  it \"should compute array#get as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.get(0)\n\n    assert.equal observableFn(), 0\n\n    observableArray([5])\n\n    assert.equal observableFn(), 5\n\n  it \"should compute array#first as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.first() + 1\n\n    assert.equal observableFn(), 1\n\n    observableArray([5])\n\n    assert.equal observableFn(), 6\n\n  it \"should compute array#last as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.last()\n\n    assert.equal observableFn(), 2\n\n    observableArray.pop()\n\n    assert.equal observableFn(), 1\n\n    observableArray([5])\n\n    assert.equal observableFn(), 5\n\n  it \"should compute array#size as a dependency\", ->\n    observableArray = Observable [0, 1, 2]\n\n    observableFn = Observable ->\n      observableArray.size() * 2\n\n    assert.equal observableFn(), 6\n\n    observableArray.pop()\n    assert.equal observableFn(), 4\n    observableArray.shift()\n    assert.equal observableFn(), 2\n\n  it \"should allow double nesting\", (done) ->\n    bottom = Observable \"rad\"\n    middle = Observable ->\n      bottom()\n    top = Observable ->\n      middle()\n\n    top.observe (newValue) ->\n      assert.equal newValue, \"wat\"\n      assert.equal top(), newValue\n      assert.equal middle(), newValue\n\n      done()\n\n    bottom(\"wat\")\n\n  it \"should work with dynamic dependencies\", ->\n    observableArray = Observable []\n\n    dynamicObservable = Observable ->\n      observableArray.filter (item) ->\n        item.age() > 3\n\n    assert.equal dynamicObservable().length, 0\n\n    observableArray.push\n      age: Observable 1\n\n    observableArray()[0].age 5\n    assert.equal dynamicObservable().length, 1\n\n  it \"should work with context\", ->\n    model =\n      a: Observable \"Hello\"\n      b: Observable \"there\"\n\n    model.c = Observable ->\n      \"#{@a()} #{@b()}\"\n    , model\n\n    assert.equal model.c(), \"Hello there\"\n\n    model.b \"world\"\n\n    assert.equal model.c(), \"Hello world\"\n\n  it \"should be ok even if the function throws an exception\", ->\n    assert.throws ->\n      t = Observable ->\n        throw \"wat\"\n\n    # TODO: Should be able to find a test case that is affected by this rather that\n    # checking it directly\n    assert.equal global.OBSERVABLE_ROOT_HACK.length, 0\n\n  it \"should have an each method\", ->\n    o = Observable ->\n\n    assert o.each()\n\n  it \"should not invoke when returning undefined\", ->\n    o = Observable ->\n\n    o.each ->\n      assert false\n\n  it \"should invoke when returning any defined value\", (done) ->\n    o = Observable -> 5\n\n    o.each (n) ->\n      assert.equal n, 5\n      done()\n\n  it \"should work on an array dependency\", ->\n    oA = Observable [1, 2, 3]\n\n    o = Observable ->\n      oA()[0]\n\n    last = Observable ->\n      oA()[oA().length-1]\n\n    assert.equal o(), 1\n\n    oA.unshift 0\n\n    assert.equal o(), 0\n\n    oA.push 4\n\n    assert.equal last(), 4, \"Last should be 4\"\n\n  it \"should work with multiple dependencies\", ->\n    letter = Observable \"A\"\n    checked = ->\n      l = letter()\n      @name().indexOf(l) is 0\n\n    first = {name: Observable(\"Andrew\")}\n    first.checked = Observable checked, first\n\n    second = {name: Observable(\"Benjamin\")}\n    second.checked = Observable checked, second\n\n    assert.equal first.checked(), true\n    assert.equal second.checked(), false\n\n    assert.equal letter.listeners.length, 2\n\n    letter \"B\"\n\n    assert.equal first.checked(), false\n    assert.equal second.checked(), true\n\n  it \"shouldn't double count dependencies\", ->\n    dep = Observable \"yo\"\n\n    o = Observable ->\n      dep()\n      dep()\n      dep()\n\n    count = 0\n    o.observe ->\n      count += 1\n\n    dep('heyy')\n\n    assert.equal count, 1\n\n  it \"should work with nested observable construction\", ->\n    gen = Observable ->\n      Observable \"Duder\"\n\n    o = gen()\n\n    assert.equal o(), \"Duder\"\n\n    o(\"wat\")\n\n    assert.equal o(), \"wat\"\n\n  describe \"Scoping\", ->\n    it \"should be scoped to optional context\", (done) ->\n      model =\n        firstName: Observable \"Duder\"\n        lastName: Observable \"Man\"\n\n      model.name = Observable ->\n        \"#{@firstName()} #{@lastName()}\"\n      , model\n\n      model.name.observe (newValue) ->\n        assert.equal newValue, \"Duder Bro\"\n\n        done()\n\n      model.lastName \"Bro\"\n\n  describe \"concat\", ->\n    it \"should work with a single observable\", ->\n      observable = Observable \"something\"\n      observableArray = Observable.concat observable\n      assert.equal observableArray.last(), \"something\"\n\n      observable \"something else\"\n      assert.equal observableArray.last(), \"something else\"\n\n    it \"should work with an undefined observable\", ->\n      observable = Observable undefined\n      observableArray = Observable.concat observable\n      assert.equal observableArray.size(), 0\n\n      observable \"defined\"\n      assert.equal observableArray.size(), 1\n\n    it \"should work with undefined\", ->\n      observableArray = Observable.concat undefined\n      assert.equal observableArray.size(), 0\n\n    it \"should work with []\", ->\n      observableArray = Observable.concat []\n      assert.equal observableArray.size(), 0\n\n    it \"should return an observable array that changes based on changes in inputs\", ->\n      numbers = Observable [1, 2, 3]\n      letters = Observable [\"a\", \"b\", \"c\"]\n      item = Observable({})\n      nullable = Observable null\n\n      observableArray = Observable.concat numbers, \"literal\", letters, item, nullable\n\n      assert.equal observableArray().length, 3 + 1 + 3 + 1\n\n      assert.equal observableArray()[0], 1\n      assert.equal observableArray()[3], \"literal\"\n      assert.equal observableArray()[4], \"a\"\n      assert.equal observableArray()[7], item()\n\n      numbers.push 4\n\n      assert.equal observableArray().length, 9\n\n      nullable \"cool\"\n\n      assert.equal observableArray().length, 10\n\n    it \"should work with observable functions that return arrays\", ->\n      item = Observable(\"wat\")\n\n      computedArray = Observable ->\n        [item()]\n\n      observableArray = Observable.concat computedArray, computedArray\n\n      assert.equal observableArray().length, 2\n\n      assert.equal observableArray()[1], \"wat\"\n\n      item \"yolo\"\n\n      assert.equal observableArray()[1], \"yolo\"\n\n    it \"should have a push method\", ->\n      observableArray = Observable.concat()\n\n      observable = Observable \"hey\"\n\n      observableArray.push observable\n\n      assert.equal observableArray()[0], \"hey\"\n\n      observable \"wat\"\n\n      assert.equal observableArray()[0], \"wat\"\n\n      observableArray.push \"cool\"\n      observableArray.push \"radical\"\n\n      assert.equal observableArray().length, 3\n\n    it \"should be observable\", (done) ->\n      observableArray = Observable.concat()\n\n      observableArray.observe (items) ->\n        assert.equal items.length, 3\n        done()\n\n      observableArray.push [\"A\", \"B\", \"C\"]\n\n    it \"should have an each method\", ->\n      observableArray = Observable.concat([\"A\", \"B\", \"C\"])\n\n      n = 0\n      observableArray.each () ->\n        n += 1\n\n      assert.equal n, 3\n\n  describe \"nesting dependencies\", ->\n    it \"should update the correct observable\", ->\n      a = Observable \"a\"\n      b = Observable \"b\"\n\n      results = Observable ->\n        r = Observable.concat()\n\n        r.push a\n        r.push b\n\n        r\n\n      # TODO: Should this just be\n      #     results.first()\n      assert.equal results().first(), \"a\"\n\n      a(\"newA\")\n\n      assert.equal results().first(), \"newA\"\n",
              "mode": "100644",
              "type": "blob"
            }
          },
          "distribution": {
            "main": {
              "path": "main",
              "content": "(function() {\n  var Observable, PROXY_LENGTH, computeDependencies, copy, extend, flatten, get, last, magicDependency, remove, splat, tryCallWithFinallyPop,\n    __slice = [].slice;\n\n  module.exports = Observable = function(value, context) {\n    var changed, fn, listeners, notify, notifyReturning, self;\n    if (typeof (value != null ? value.observe : void 0) === \"function\") {\n      return value;\n    }\n    listeners = [];\n    notify = function(newValue) {\n      return copy(listeners).forEach(function(listener) {\n        return listener(newValue);\n      });\n    };\n    if (typeof value === 'function') {\n      fn = value;\n      self = function() {\n        magicDependency(self);\n        return value;\n      };\n      changed = function() {\n        value = computeDependencies(self, fn, changed, context);\n        return notify(value);\n      };\n      changed();\n    } else {\n      self = function(newValue) {\n        if (arguments.length > 0) {\n          if (value !== newValue) {\n            value = newValue;\n            notify(newValue);\n          }\n        } else {\n          magicDependency(self);\n        }\n        return value;\n      };\n    }\n    self.each = function(callback) {\n      magicDependency(self);\n      if (value != null) {\n        [value].forEach(function(item) {\n          return callback.call(item, item);\n        });\n      }\n      return self;\n    };\n    if (Array.isArray(value)) {\n      [\"concat\", \"every\", \"filter\", \"forEach\", \"indexOf\", \"join\", \"lastIndexOf\", \"map\", \"reduce\", \"reduceRight\", \"slice\", \"some\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          magicDependency(self);\n          return value[method].apply(value, args);\n        };\n      });\n      [\"pop\", \"push\", \"reverse\", \"shift\", \"splice\", \"sort\", \"unshift\"].forEach(function(method) {\n        return self[method] = function() {\n          var args;\n          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n          return notifyReturning(value[method].apply(value, args));\n        };\n      });\n      if (PROXY_LENGTH) {\n        Object.defineProperty(self, 'length', {\n          get: function() {\n            magicDependency(self);\n            return value.length;\n          },\n          set: function(length) {\n            value.length = length;\n            return notifyReturning(value.length);\n          }\n        });\n      }\n      notifyReturning = function(returnValue) {\n        notify(value);\n        return returnValue;\n      };\n      extend(self, {\n        each: function(callback) {\n          self.forEach(function(item, index) {\n            return callback.call(item, item, index, self);\n          });\n          return self;\n        },\n        remove: function(object) {\n          var index;\n          index = value.indexOf(object);\n          if (index >= 0) {\n            return notifyReturning(value.splice(index, 1)[0]);\n          }\n        },\n        get: function(index) {\n          magicDependency(self);\n          return value[index];\n        },\n        first: function() {\n          magicDependency(self);\n          return value[0];\n        },\n        last: function() {\n          magicDependency(self);\n          return value[value.length - 1];\n        },\n        size: function() {\n          magicDependency(self);\n          return value.length;\n        }\n      });\n    }\n    extend(self, {\n      listeners: listeners,\n      observe: function(listener) {\n        return listeners.push(listener);\n      },\n      stopObserving: function(fn) {\n        return remove(listeners, fn);\n      },\n      toggle: function() {\n        return self(!value);\n      },\n      increment: function(n) {\n        return self(value + n);\n      },\n      decrement: function(n) {\n        return self(value - n);\n      },\n      toString: function() {\n        return \"Observable(\" + value + \")\";\n      }\n    });\n    return self;\n  };\n\n  Observable.concat = function() {\n    var arg, args, collection, i, o, _i, _len;\n    args = new Array(arguments.length);\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      arg = arguments[i];\n      args[i] = arguments[i];\n    }\n    collection = Observable(args);\n    o = Observable(function() {\n      return flatten(collection.map(splat));\n    });\n    o.push = collection.push;\n    return o;\n  };\n\n  extend = function(target) {\n    var i, name, source, _i, _len;\n    for (i = _i = 0, _len = arguments.length; _i < _len; i = ++_i) {\n      source = arguments[i];\n      if (i > 0) {\n        for (name in source) {\n          target[name] = source[name];\n        }\n      }\n    }\n    return target;\n  };\n\n  global.OBSERVABLE_ROOT_HACK = [];\n\n  magicDependency = function(self) {\n    var observerSet;\n    observerSet = last(global.OBSERVABLE_ROOT_HACK);\n    if (observerSet) {\n      return observerSet.add(self);\n    }\n  };\n\n  tryCallWithFinallyPop = function(fn, context) {\n    try {\n      return fn.call(context);\n    } finally {\n      global.OBSERVABLE_ROOT_HACK.pop();\n    }\n  };\n\n  computeDependencies = function(self, fn, update, context) {\n    var deps, value, _ref;\n    deps = new Set;\n    global.OBSERVABLE_ROOT_HACK.push(deps);\n    value = tryCallWithFinallyPop(fn, context);\n    if ((_ref = self._deps) != null) {\n      _ref.forEach(function(observable) {\n        return observable.stopObserving(update);\n      });\n    }\n    self._deps = deps;\n    deps.forEach(function(observable) {\n      return observable.observe(update);\n    });\n    return value;\n  };\n\n  try {\n    Object.defineProperty((function() {}), 'length', {\n      get: function() {},\n      set: function() {}\n    });\n    PROXY_LENGTH = true;\n  } catch (_error) {\n    PROXY_LENGTH = false;\n  }\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n  copy = function(array) {\n    return array.concat([]);\n  };\n\n  get = function(arg) {\n    if (typeof arg === \"function\") {\n      return arg();\n    } else {\n      return arg;\n    }\n  };\n\n  splat = function(item) {\n    var result, results;\n    results = [];\n    if (item == null) {\n      return results;\n    }\n    if (typeof item.forEach === \"function\") {\n      item.forEach(function(i) {\n        return results.push(i);\n      });\n    } else {\n      result = get(item);\n      if (result != null) {\n        results.push(result);\n      }\n    }\n    return results;\n  };\n\n  last = function(array) {\n    return array[array.length - 1];\n  };\n\n  flatten = function(array) {\n    return array.reduce(function(a, b) {\n      return a.concat(b);\n    }, []);\n  };\n\n}).call(this);\n",
              "type": "blob"
            },
            "pixie": {
              "path": "pixie",
              "content": "module.exports = {\"version\":\"0.3.8\"};",
              "type": "blob"
            },
            "test/observable": {
              "path": "test/observable",
              "content": "(function() {\n  global.Observable = require(\"../main\");\n\n  describe('Observable', function() {\n    it('should create an observable for an object', function() {\n      var n, observable;\n      n = 5;\n      observable = Observable(n);\n      return assert.equal(observable(), n);\n    });\n    it('should fire events when setting', function() {\n      var observable, string;\n      string = \"yolo\";\n      observable = Observable(string);\n      observable.observe(function(newValue) {\n        return assert.equal(newValue, \"4life\");\n      });\n      return observable(\"4life\");\n    });\n    it(\"should not fire when setting to the same value\", function() {\n      var o;\n      o = Observable(5);\n      o.observe(function() {\n        return assert(false);\n      });\n      return o(5);\n    });\n    it('should be idempotent', function() {\n      var o;\n      o = Observable(5);\n      return assert.equal(o, Observable(o));\n    });\n    describe(\"#each\", function() {\n      it(\"should be invoked once if there is an observable\", function() {\n        var called, o;\n        o = Observable(5);\n        called = 0;\n        o.each(function(value) {\n          called += 1;\n          return assert.equal(value, 5);\n        });\n        return assert.equal(called, 1);\n      });\n      it(\"should not be invoked if observable is null\", function() {\n        var called, o;\n        o = Observable(null);\n        called = 0;\n        o.each(function(value) {\n          return called += 1;\n        });\n        return assert.equal(called, 0);\n      });\n      it(\"should have the correct `this` scope for items\", function(done) {\n        var o;\n        o = Observable(5);\n        return o.each(function() {\n          assert.equal(this, 5);\n          return done();\n        });\n      });\n      return it(\"should have the correct `this` scope for items in observable arrays\", function() {\n        var o, scopes;\n        scopes = [];\n        o = Observable([\"I'm\", \"an\", \"array\"]);\n        o.each(function() {\n          return scopes.push(this);\n        });\n        assert.equal(scopes[0], \"I'm\");\n        assert.equal(scopes[1], \"an\");\n        return assert.equal(scopes[2], \"array\");\n      });\n    });\n    it(\"should allow for stopping observation\", function() {\n      var called, fn, observable;\n      observable = Observable(\"string\");\n      called = 0;\n      fn = function(newValue) {\n        called += 1;\n        return assert.equal(newValue, \"4life\");\n      };\n      observable.observe(fn);\n      observable(\"4life\");\n      observable.stopObserving(fn);\n      observable(\"wat\");\n      return assert.equal(called, 1);\n    });\n    it(\"should increment\", function() {\n      var observable;\n      observable = Observable(1);\n      observable.increment(5);\n      return assert.equal(observable(), 6);\n    });\n    it(\"should decremnet\", function() {\n      var observable;\n      observable = Observable(1);\n      observable.decrement(5);\n      return assert.equal(observable(), -4);\n    });\n    it(\"should toggle\", function() {\n      var observable;\n      observable = Observable(false);\n      observable.toggle();\n      assert.equal(observable(), true);\n      observable.toggle();\n      return assert.equal(observable(), false);\n    });\n    it(\"should trigger when toggling\", function(done) {\n      var observable;\n      observable = Observable(true);\n      observable.observe(function(v) {\n        assert.equal(v, false);\n        return done();\n      });\n      return observable.toggle();\n    });\n    return it(\"should have a nice toString\", function() {\n      var observable;\n      observable = Observable(5);\n      return assert.equal(observable.toString(), \"Observable(5)\");\n    });\n  });\n\n  describe(\"Observable Array\", function() {\n    it(\"should proxy array methods\", function() {\n      var o;\n      o = Observable([5]);\n      return o.map(function(n) {\n        return assert.equal(n, 5);\n      });\n    });\n    it(\"should notify on mutation methods\", function(done) {\n      var o;\n      o = Observable([]);\n      o.observe(function(newValue) {\n        return assert.equal(newValue[0], 1);\n      });\n      o.push(1);\n      return done();\n    });\n    it(\"should have an each method\", function() {\n      var o;\n      o = Observable([]);\n      return assert(o.each);\n    });\n    it(\"#get\", function() {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      return assert.equal(o.get(2), 2);\n    });\n    it(\"#first\", function() {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      return assert.equal(o.first(), 0);\n    });\n    it(\"#last\", function() {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      return assert.equal(o.last(), 3);\n    });\n    it(\"#remove\", function(done) {\n      var o;\n      o = Observable([0, 1, 2, 3]);\n      o.observe(function(newValue) {\n        assert.equal(newValue.length, 3);\n        return setTimeout(function() {\n          return done();\n        }, 0);\n      });\n      return assert.equal(o.remove(2), 2);\n    });\n    it(\"#remove non-existent element\", function() {\n      var o;\n      o = Observable([1, 2, 3]);\n      return assert.equal(o.remove(0), void 0);\n    });\n    it(\"should proxy the length property\", function() {\n      var called, o;\n      o = Observable([1, 2, 3]);\n      assert.equal(o.length, 3);\n      called = false;\n      o.observe(function(value) {\n        assert.equal(value[0], 1);\n        assert.equal(value[1], void 0);\n        return called = true;\n      });\n      o.length = 1;\n      assert.equal(o.length, 1);\n      return assert.equal(called, true);\n    });\n    return it(\"should auto detect conditionals of length as a dependency\", function() {\n      var called, o, observableArray;\n      observableArray = Observable([1, 2, 3]);\n      o = Observable(function() {\n        if (observableArray.length > 5) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      assert.equal(o(), false);\n      called = 0;\n      o.observe(function() {\n        return called += 1;\n      });\n      observableArray.push(4, 5, 6);\n      return assert.equal(called, 1);\n    });\n  });\n\n  describe(\"Observable functions\", function() {\n    it(\"should compute dependencies\", function(done) {\n      var firstName, lastName, o;\n      firstName = Observable(\"Duder\");\n      lastName = Observable(\"Man\");\n      o = Observable(function() {\n        return \"\" + (firstName()) + \" \" + (lastName());\n      });\n      o.observe(function(newValue) {\n        assert.equal(newValue, \"Duder Bro\");\n        return done();\n      });\n      return lastName(\"Bro\");\n    });\n    it(\"should compute array#get as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.get(0);\n      });\n      assert.equal(observableFn(), 0);\n      observableArray([5]);\n      return assert.equal(observableFn(), 5);\n    });\n    it(\"should compute array#first as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.first() + 1;\n      });\n      assert.equal(observableFn(), 1);\n      observableArray([5]);\n      return assert.equal(observableFn(), 6);\n    });\n    it(\"should compute array#last as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.last();\n      });\n      assert.equal(observableFn(), 2);\n      observableArray.pop();\n      assert.equal(observableFn(), 1);\n      observableArray([5]);\n      return assert.equal(observableFn(), 5);\n    });\n    it(\"should compute array#size as a dependency\", function() {\n      var observableArray, observableFn;\n      observableArray = Observable([0, 1, 2]);\n      observableFn = Observable(function() {\n        return observableArray.size() * 2;\n      });\n      assert.equal(observableFn(), 6);\n      observableArray.pop();\n      assert.equal(observableFn(), 4);\n      observableArray.shift();\n      return assert.equal(observableFn(), 2);\n    });\n    it(\"should allow double nesting\", function(done) {\n      var bottom, middle, top;\n      bottom = Observable(\"rad\");\n      middle = Observable(function() {\n        return bottom();\n      });\n      top = Observable(function() {\n        return middle();\n      });\n      top.observe(function(newValue) {\n        assert.equal(newValue, \"wat\");\n        assert.equal(top(), newValue);\n        assert.equal(middle(), newValue);\n        return done();\n      });\n      return bottom(\"wat\");\n    });\n    it(\"should work with dynamic dependencies\", function() {\n      var dynamicObservable, observableArray;\n      observableArray = Observable([]);\n      dynamicObservable = Observable(function() {\n        return observableArray.filter(function(item) {\n          return item.age() > 3;\n        });\n      });\n      assert.equal(dynamicObservable().length, 0);\n      observableArray.push({\n        age: Observable(1)\n      });\n      observableArray()[0].age(5);\n      return assert.equal(dynamicObservable().length, 1);\n    });\n    it(\"should work with context\", function() {\n      var model;\n      model = {\n        a: Observable(\"Hello\"),\n        b: Observable(\"there\")\n      };\n      model.c = Observable(function() {\n        return \"\" + (this.a()) + \" \" + (this.b());\n      }, model);\n      assert.equal(model.c(), \"Hello there\");\n      model.b(\"world\");\n      return assert.equal(model.c(), \"Hello world\");\n    });\n    it(\"should be ok even if the function throws an exception\", function() {\n      assert.throws(function() {\n        var t;\n        return t = Observable(function() {\n          throw \"wat\";\n        });\n      });\n      return assert.equal(global.OBSERVABLE_ROOT_HACK.length, 0);\n    });\n    it(\"should have an each method\", function() {\n      var o;\n      o = Observable(function() {});\n      return assert(o.each());\n    });\n    it(\"should not invoke when returning undefined\", function() {\n      var o;\n      o = Observable(function() {});\n      return o.each(function() {\n        return assert(false);\n      });\n    });\n    it(\"should invoke when returning any defined value\", function(done) {\n      var o;\n      o = Observable(function() {\n        return 5;\n      });\n      return o.each(function(n) {\n        assert.equal(n, 5);\n        return done();\n      });\n    });\n    it(\"should work on an array dependency\", function() {\n      var last, o, oA;\n      oA = Observable([1, 2, 3]);\n      o = Observable(function() {\n        return oA()[0];\n      });\n      last = Observable(function() {\n        return oA()[oA().length - 1];\n      });\n      assert.equal(o(), 1);\n      oA.unshift(0);\n      assert.equal(o(), 0);\n      oA.push(4);\n      return assert.equal(last(), 4, \"Last should be 4\");\n    });\n    it(\"should work with multiple dependencies\", function() {\n      var checked, first, letter, second;\n      letter = Observable(\"A\");\n      checked = function() {\n        var l;\n        l = letter();\n        return this.name().indexOf(l) === 0;\n      };\n      first = {\n        name: Observable(\"Andrew\")\n      };\n      first.checked = Observable(checked, first);\n      second = {\n        name: Observable(\"Benjamin\")\n      };\n      second.checked = Observable(checked, second);\n      assert.equal(first.checked(), true);\n      assert.equal(second.checked(), false);\n      assert.equal(letter.listeners.length, 2);\n      letter(\"B\");\n      assert.equal(first.checked(), false);\n      return assert.equal(second.checked(), true);\n    });\n    it(\"shouldn't double count dependencies\", function() {\n      var count, dep, o;\n      dep = Observable(\"yo\");\n      o = Observable(function() {\n        dep();\n        dep();\n        return dep();\n      });\n      count = 0;\n      o.observe(function() {\n        return count += 1;\n      });\n      dep('heyy');\n      return assert.equal(count, 1);\n    });\n    it(\"should work with nested observable construction\", function() {\n      var gen, o;\n      gen = Observable(function() {\n        return Observable(\"Duder\");\n      });\n      o = gen();\n      assert.equal(o(), \"Duder\");\n      o(\"wat\");\n      return assert.equal(o(), \"wat\");\n    });\n    describe(\"Scoping\", function() {\n      return it(\"should be scoped to optional context\", function(done) {\n        var model;\n        model = {\n          firstName: Observable(\"Duder\"),\n          lastName: Observable(\"Man\")\n        };\n        model.name = Observable(function() {\n          return \"\" + (this.firstName()) + \" \" + (this.lastName());\n        }, model);\n        model.name.observe(function(newValue) {\n          assert.equal(newValue, \"Duder Bro\");\n          return done();\n        });\n        return model.lastName(\"Bro\");\n      });\n    });\n    describe(\"concat\", function() {\n      it(\"should work with a single observable\", function() {\n        var observable, observableArray;\n        observable = Observable(\"something\");\n        observableArray = Observable.concat(observable);\n        assert.equal(observableArray.last(), \"something\");\n        observable(\"something else\");\n        return assert.equal(observableArray.last(), \"something else\");\n      });\n      it(\"should work with an undefined observable\", function() {\n        var observable, observableArray;\n        observable = Observable(void 0);\n        observableArray = Observable.concat(observable);\n        assert.equal(observableArray.size(), 0);\n        observable(\"defined\");\n        return assert.equal(observableArray.size(), 1);\n      });\n      it(\"should work with undefined\", function() {\n        var observableArray;\n        observableArray = Observable.concat(void 0);\n        return assert.equal(observableArray.size(), 0);\n      });\n      it(\"should work with []\", function() {\n        var observableArray;\n        observableArray = Observable.concat([]);\n        return assert.equal(observableArray.size(), 0);\n      });\n      it(\"should return an observable array that changes based on changes in inputs\", function() {\n        var item, letters, nullable, numbers, observableArray;\n        numbers = Observable([1, 2, 3]);\n        letters = Observable([\"a\", \"b\", \"c\"]);\n        item = Observable({});\n        nullable = Observable(null);\n        observableArray = Observable.concat(numbers, \"literal\", letters, item, nullable);\n        assert.equal(observableArray().length, 3 + 1 + 3 + 1);\n        assert.equal(observableArray()[0], 1);\n        assert.equal(observableArray()[3], \"literal\");\n        assert.equal(observableArray()[4], \"a\");\n        assert.equal(observableArray()[7], item());\n        numbers.push(4);\n        assert.equal(observableArray().length, 9);\n        nullable(\"cool\");\n        return assert.equal(observableArray().length, 10);\n      });\n      it(\"should work with observable functions that return arrays\", function() {\n        var computedArray, item, observableArray;\n        item = Observable(\"wat\");\n        computedArray = Observable(function() {\n          return [item()];\n        });\n        observableArray = Observable.concat(computedArray, computedArray);\n        assert.equal(observableArray().length, 2);\n        assert.equal(observableArray()[1], \"wat\");\n        item(\"yolo\");\n        return assert.equal(observableArray()[1], \"yolo\");\n      });\n      it(\"should have a push method\", function() {\n        var observable, observableArray;\n        observableArray = Observable.concat();\n        observable = Observable(\"hey\");\n        observableArray.push(observable);\n        assert.equal(observableArray()[0], \"hey\");\n        observable(\"wat\");\n        assert.equal(observableArray()[0], \"wat\");\n        observableArray.push(\"cool\");\n        observableArray.push(\"radical\");\n        return assert.equal(observableArray().length, 3);\n      });\n      it(\"should be observable\", function(done) {\n        var observableArray;\n        observableArray = Observable.concat();\n        observableArray.observe(function(items) {\n          assert.equal(items.length, 3);\n          return done();\n        });\n        return observableArray.push([\"A\", \"B\", \"C\"]);\n      });\n      return it(\"should have an each method\", function() {\n        var n, observableArray;\n        observableArray = Observable.concat([\"A\", \"B\", \"C\"]);\n        n = 0;\n        observableArray.each(function() {\n          return n += 1;\n        });\n        return assert.equal(n, 3);\n      });\n    });\n    return describe(\"nesting dependencies\", function() {\n      return it(\"should update the correct observable\", function() {\n        var a, b, results;\n        a = Observable(\"a\");\n        b = Observable(\"b\");\n        results = Observable(function() {\n          var r;\n          r = Observable.concat();\n          r.push(a);\n          r.push(b);\n          return r;\n        });\n        assert.equal(results().first(), \"a\");\n        a(\"newA\");\n        return assert.equal(results().first(), \"newA\");\n      });\n    });\n  });\n\n}).call(this);\n",
              "type": "blob"
            }
          },
          "progenitor": {
            "url": "https://danielx.net/editor/"
          },
          "config": {
            "version": "0.3.8"
          },
          "version": "0.3.8",
          "entryPoint": "main",
          "repository": {
            "branch": "master",
            "default_branch": "master",
            "full_name": "distri/observable",
            "homepage": "http://observable.us",
            "description": null,
            "html_url": "https://github.com/distri/observable",
            "url": "https://api.github.com/repos/distri/observable",
            "publishBranch": "gh-pages"
          },
          "dependencies": {}
        },
        "bindable": {
          "source": {
            "LICENSE": {
              "path": "LICENSE",
              "content": "The MIT License (MIT)\n\nCopyright (c) 2014 distri\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
              "mode": "100644",
              "type": "blob"
            },
            "README.coffee.md": {
              "path": "README.coffee.md",
              "content": "Bindable\n========\n\nAdd event binding to objects.\n\n>     bindable = Bindable()\n>     bindable.on \"greet\", ->\n>       console.log \"yo!\"\n>     bindable.trigger \"greet\"\n>     #=> \"yo!\" is printed to log\n\nUse as a mixin.\n\n>    self.include Bindable\n\n    module.exports = (I={}, self={}) ->\n      eventCallbacks = {}\n\nAdds a function as an event listener.\n\nThis will call `coolEventHandler` after `yourObject.trigger \"someCustomEvent\"`\nis called.\n\n>     yourObject.on \"someCustomEvent\", coolEventHandler\n\nHandlers can be attached to namespaces as well. The namespaces are only used\nfor finer control of targeting event removal. For example if you are making a\ncustom drawing system you could unbind `\".Drawable\"` events and add your own.\n\n>     yourObject.on \"\"\n\n      self.on = (namespacedEvent, callback) ->\n        [event, namespace] = namespacedEvent.split(\".\")\n\n        # HACK: Here we annotate the callback function with namespace metadata\n        # This will probably lead to some strange edge cases, but should work fine\n        # for simple cases.\n        if namespace\n          callback.__PIXIE ||= {}\n          callback.__PIXIE[namespace] = true\n\n        eventCallbacks[event] ||= []\n        eventCallbacks[event].push(callback)\n\n        return self\n\nRemoves a specific event listener, or all event listeners if\nno specific listener is given.\n\nRemoves the handler coolEventHandler from the event `\"someCustomEvent\"` while\nleaving the other events intact.\n\n>     yourObject.off \"someCustomEvent\", coolEventHandler\n\nRemoves all handlers attached to `\"anotherCustomEvent\"`\n\n>     yourObject.off \"anotherCustomEvent\"\n\nRemove all handlers from the `\".Drawable\" namespace`\n\n>     yourObject.off \".Drawable\"\n\n      self.off = (namespacedEvent, callback) ->\n        [event, namespace] = namespacedEvent.split(\".\")\n\n        if event\n          eventCallbacks[event] ||= []\n\n          if namespace\n            # Select only the callbacks that do not have this namespace metadata\n            eventCallbacks[event] = eventCallbacks.filter (callback) ->\n              !callback.__PIXIE?[namespace]?\n\n          else\n            if callback\n              remove eventCallbacks[event], callback\n            else\n              eventCallbacks[event] = []\n        else if namespace\n          # No event given\n          # Select only the callbacks that do not have this namespace metadata\n          # for any events bound\n          for key, callbacks of eventCallbacks\n            eventCallbacks[key] = callbacks.filter (callback) ->\n              !callback.__PIXIE?[namespace]?\n\n        return self\n\nCalls all listeners attached to the specified event.\n\n>     # calls each event handler bound to \"someCustomEvent\"\n>     yourObject.trigger \"someCustomEvent\"\n\nAdditional parameters can be passed to the handlers.\n\n>     yourObject.trigger \"someEvent\", \"hello\", \"anotherParameter\"\n\n      self.trigger = (event, parameters...) ->\n        callbacks = eventCallbacks[event]\n\n        if callbacks\n          callbacks.forEach (callback) ->\n            callback.apply(self, parameters)\n\n        return self\n\n      return self\n\nHelpers\n-------\n\nRemove a value from an array.\n\n    remove = (array, value) ->\n      index = array.indexOf(value)\n\n      if index >= 0\n        array.splice(index, 1)[0]\n",
              "mode": "100644",
              "type": "blob"
            },
            "pixie.cson": {
              "path": "pixie.cson",
              "content": "entryPoint: \"README\"\nversion: \"0.2.0\"\n",
              "mode": "100644",
              "type": "blob"
            },
            "test/bindable.coffee": {
              "path": "test/bindable.coffee",
              "content": "test = it\nok = assert\nequal = assert.equal\n\nBindable = require \"../README\"\n\ndescribe \"Bindable\", ->\n\n  test \"#bind and #trigger\", ->\n    o = Bindable()\n\n    o.on(\"test\", -> ok true)\n\n    o.trigger(\"test\")\n\n  test \"Multiple bindings\", ->\n    o = Bindable()\n\n    o.on(\"test\", -> ok true)\n    o.on(\"test\", -> ok true)\n\n    o.trigger(\"test\")\n\n  test \"#trigger arguments\", ->\n    o = Bindable()\n\n    param1 = \"the message\"\n    param2 = 3\n\n    o.on \"test\", (p1, p2) ->\n      equal(p1, param1)\n      equal(p2, param2)\n\n    o.trigger \"test\", param1, param2\n\n  test \"#unbind\", ->\n    o = Bindable()\n\n    callback = ->\n      ok false\n\n    o.on \"test\", callback\n    # Unbind specific event\n    o.off \"test\", callback\n    o.trigger \"test\"\n\n    o.on \"test\", callback\n    # Unbind all events\n    o.off \"test\"\n    o.trigger \"test\"\n\n  test \"#trigger namespace\", ->\n    o = Bindable()\n    o.on \"test.TestNamespace\", ->\n      ok true\n\n    o.trigger \"test\"\n\n    o.off \".TestNamespace\"\n    o.trigger \"test\"\n\n  test \"#unbind namespaced\", ->\n    o = Bindable()\n\n    o.on \"test.TestNamespace\", ->\n      ok true\n\n    o.trigger \"test\"\n\n    o.off \".TestNamespace\", ->\n    o.trigger \"test\"\n",
              "mode": "100644",
              "type": "blob"
            }
          },
          "distribution": {
            "README": {
              "path": "README",
              "content": "(function() {\n  var remove,\n    __slice = [].slice;\n\n  module.exports = function(I, self) {\n    var eventCallbacks;\n    if (I == null) {\n      I = {};\n    }\n    if (self == null) {\n      self = {};\n    }\n    eventCallbacks = {};\n    self.on = function(namespacedEvent, callback) {\n      var event, namespace, _ref;\n      _ref = namespacedEvent.split(\".\"), event = _ref[0], namespace = _ref[1];\n      if (namespace) {\n        callback.__PIXIE || (callback.__PIXIE = {});\n        callback.__PIXIE[namespace] = true;\n      }\n      eventCallbacks[event] || (eventCallbacks[event] = []);\n      eventCallbacks[event].push(callback);\n      return self;\n    };\n    self.off = function(namespacedEvent, callback) {\n      var callbacks, event, key, namespace, _ref;\n      _ref = namespacedEvent.split(\".\"), event = _ref[0], namespace = _ref[1];\n      if (event) {\n        eventCallbacks[event] || (eventCallbacks[event] = []);\n        if (namespace) {\n          eventCallbacks[event] = eventCallbacks.filter(function(callback) {\n            var _ref1;\n            return ((_ref1 = callback.__PIXIE) != null ? _ref1[namespace] : void 0) == null;\n          });\n        } else {\n          if (callback) {\n            remove(eventCallbacks[event], callback);\n          } else {\n            eventCallbacks[event] = [];\n          }\n        }\n      } else if (namespace) {\n        for (key in eventCallbacks) {\n          callbacks = eventCallbacks[key];\n          eventCallbacks[key] = callbacks.filter(function(callback) {\n            var _ref1;\n            return ((_ref1 = callback.__PIXIE) != null ? _ref1[namespace] : void 0) == null;\n          });\n        }\n      }\n      return self;\n    };\n    self.trigger = function() {\n      var callbacks, event, parameters;\n      event = arguments[0], parameters = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      callbacks = eventCallbacks[event];\n      if (callbacks) {\n        callbacks.forEach(function(callback) {\n          return callback.apply(self, parameters);\n        });\n      }\n      return self;\n    };\n    return self;\n  };\n\n  remove = function(array, value) {\n    var index;\n    index = array.indexOf(value);\n    if (index >= 0) {\n      return array.splice(index, 1)[0];\n    }\n  };\n\n}).call(this);\n",
              "type": "blob"
            },
            "pixie": {
              "path": "pixie",
              "content": "module.exports = {\"entryPoint\":\"README\",\"version\":\"0.2.0\"};",
              "type": "blob"
            },
            "test/bindable": {
              "path": "test/bindable",
              "content": "(function() {\n  var Bindable, equal, ok, test;\n\n  test = it;\n\n  ok = assert;\n\n  equal = assert.equal;\n\n  Bindable = require(\"../README\");\n\n  describe(\"Bindable\", function() {\n    test(\"#bind and #trigger\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test\", function() {\n        return ok(true);\n      });\n      return o.trigger(\"test\");\n    });\n    test(\"Multiple bindings\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test\", function() {\n        return ok(true);\n      });\n      o.on(\"test\", function() {\n        return ok(true);\n      });\n      return o.trigger(\"test\");\n    });\n    test(\"#trigger arguments\", function() {\n      var o, param1, param2;\n      o = Bindable();\n      param1 = \"the message\";\n      param2 = 3;\n      o.on(\"test\", function(p1, p2) {\n        equal(p1, param1);\n        return equal(p2, param2);\n      });\n      return o.trigger(\"test\", param1, param2);\n    });\n    test(\"#unbind\", function() {\n      var callback, o;\n      o = Bindable();\n      callback = function() {\n        return ok(false);\n      };\n      o.on(\"test\", callback);\n      o.off(\"test\", callback);\n      o.trigger(\"test\");\n      o.on(\"test\", callback);\n      o.off(\"test\");\n      return o.trigger(\"test\");\n    });\n    test(\"#trigger namespace\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test.TestNamespace\", function() {\n        return ok(true);\n      });\n      o.trigger(\"test\");\n      o.off(\".TestNamespace\");\n      return o.trigger(\"test\");\n    });\n    return test(\"#unbind namespaced\", function() {\n      var o;\n      o = Bindable();\n      o.on(\"test.TestNamespace\", function() {\n        return ok(true);\n      });\n      o.trigger(\"test\");\n      o.off(\".TestNamespace\", function() {});\n      return o.trigger(\"test\");\n    });\n  });\n\n}).call(this);\n",
              "type": "blob"
            }
          },
          "progenitor": {
            "url": "https://danielx.net/editor/"
          },
          "version": "0.2.0",
          "entryPoint": "README",
          "repository": {
            "branch": "master",
            "default_branch": "master",
            "full_name": "distri/bindable",
            "homepage": null,
            "description": "Event binding",
            "html_url": "https://github.com/distri/bindable",
            "url": "https://api.github.com/repos/distri/bindable",
            "publishBranch": "gh-pages"
          },
          "dependencies": {}
        }
      }
    }
  }
}